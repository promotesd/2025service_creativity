

--- 第 1 页 ---
HZ BO0KS

 
 

mw Education

 

Ce es AAS

4

 

本 TEL     六必|  有有 )

本二胡Malliiuii MINU IT全

 

IVREULESITERLIES TITLE LE人下

As 机 f  国计  证
证了 用六生和设站届

Discrete Mathematics
iT Applications

 

  

和 庆外

半有时[过于下



--- 第 2 页 ---
全 六   《 0

离册数学及下应用 ，珊第6版.本科教学
下 Ye TEL 有 Sixth Edition

 

Wi 入本和    四衣
了极大的成功“”第6版在前5版的基础上做了大量的改进，使

离散数学课程涉及的基本内容，更加适合作为国内高校计算机

 

路索、归纳和递归等

 

Kenneth H. Rosen 客软根太学赦学学士，麻 en 院数学博士“曾就职于科罗拉多大
    实验室特别成员”除本书外，

 

 

  

 

ISBN 978-7-111-35950-0

租" [TI

LITTLERTIEEUTIRSLIIT

  

由

YY     Tie四sr人本                      9 787111

二和和让       ，                                                                             定价; 49.00元

 



--- 第 3 页 ---
四全6QO

 

原书第6版

 

 

离散数学及其应用

(美) Kenneth 了,Rosen 著 圳崇义 屈婉玲 张桂芸 等译c”陈琼 改编

 

Discrete Miathematics and Its Applications
Sixth Edition

Discrete Mathematics
ie IE

| 2
是          |
作风

 

 

 

 

机械工业出版社

Chinca Machine Press



--- 第 4 页 ---
本书是经典的离散数学教材，为全球多所大学广为采用。本书全面而系统地介绍了离散
数学的理论和方法，除包括定义、定理的严密陈述外，还配备大基的实例和图表的说明、各
种练习和题目。第 6 版在前五版的基础上做了大量的改进，使其成为更有效的教学工具。

本书可作为高等院校数学、计算机科学和计算机工程等专业的教材或参考书。

Kenneth HRosen: Discrete Mathematics and lts Applications，Sixth Edition (IJSBN 0-07-
322972-5).

Cobyright @@ 2007 by Kenneth H、Rosen.

All rights reserved.， No part of this pubjication may be rebroduced or transmitted in any form
or by any means，electronic of mechanical ，including without limitation bhotocopying，recording，
taping，or any database，information or retrieval systerm，without the prior written permission of
the pubiisher.

This authorized Chinese adaptation is jointly published by McGraw-Hill Education (Asia)
and China Machine Press，This edition is authorized for sale in the People s 了人Republic of China
onljy，excluding Hong Kong SAR，Macao SAR and Taiwan。

Copyright @@ 2011 by McGraw- Hill Education (Asia) ，a division of the Singapore Branch of
The McGraw-Hill Companies，Inc， and China Machine Press.

版权所有。未经出版人事先书面许可，对本出版物的任何部分不得以任何方式或途径复
制或传播，包括但不限于复印、录制、录音，或通过任何数据库、信息或可检索的系统。

本授权中文简体字改编版由玫格劳-希尔(亚洲)教育出版公司和机械工业出版社合作出
版。此版本经授权仅限在中华人民共和国境内(不包括香港特别行政区、澳门特别行政区和人台
湾?销售。

版权 @ 2011 由才格劳-希尔(亚洲)教育出版公司与机械工业出版社所有。

本书封面贴有 McGraw-Hill 公司防伪标签，无标签者不得销售 。

封底无防伪标均为盗版
版权所有，侵权必究
本书法律顾问 ”北京市展达律师事务所

本书版权登记号: 图字: 01-2010-3825

图书在版编目(CIP)数据

离散数学及其应用(原书第6 版。  本科教学版)/(美)罗森(Rosen， K. H. )著;，袁崇义等
译. 一北京: 机械工业出版社，2011. 11

《计算机科学丛书)

书名原文 : Discrete Mathematics and Its Applications，Sixth Edition

ISBN 978-7-111-35950-0

工. 离… 工.@罗… 加袁… 下. 离散数学一高等学校一教材 JIV.O158

中国版本图书馆 CIP 数据核字(2011)第 192847 号

机械工业出版社(北京市西城区百万庄大街 22 号”邮政编码 100037》

责任编辑: 迟振春

北京荣盛彩色印刷有限公司印刷

2011年11月第1版第1次印刷

185mmX260mm。23. 5 印张

标准书号，ISBN 978-7-111-35950-0

定价: 49. 00 元

凡购本书，如有缺页、倒页、脱页 ，由本社发行部调换
客服热线: (010)88378991，88361066

购书热线: (010)68326294;， 88379649; 68995259
投稿热线， (010)88379604

读者信箱 ， hzjsj@hzbook. com



--- 第 5 页 ---
| 出版者的话

Discrerte Mathermmatics and its AppPjlications，6下

文艺复兴以降 ，源远流长的科学精神和逐步形成的学术规范，使西方国家在自然科学的各个领域取
得了区断性的优势; 也正是这样的传统，使美国在信息技术发展的六十多年间名家辈出、独领风骚。在
商业化的进程中，美国的产业界与教育界越来越紧密地结合，计算机学科中的许多泰山北斗同时身处科
研和教学的最前线，由此而产生的经典科学著作 ，不仅壁划了研究的范畴，还揭示了学术的源变，既遵
循学术规范，又自有学者个性，其价值并不会因年月的流逝而减退。

近年，在全球信息化大潮的推动下，我国的计算机产业发展迅犯，对专业人才的需求日益人迫切。这
对计算机教育界和出版界都轻是机遇，也是挑战， 而专业教材的建设在教育战略上显得举足轻重。在我
国信息技术发展时间较短、从业人员较少的现状下，美国等发达国家在其计算机科学发展的几十年间积
淀的经典教材仍有许多值得借鉴之处。因此，引进一批国外优秀计算机教材将对我国计算机教育事业的
发展起积极的推动作用，也是与世界接轨、建设真正的世界一流大学的必由之路。

机械工业出版社华章图文信息有限公司较早意识到“出版要为教育服务"。自 1998 年开始，我们就将
工作重点放在了各选、移译国外优秀教材 上。经过多年的不懈努力，我们与 Pearson，MecGraw一 Hill，
Elsevier，MIT，jJohn Wiley & Sons，Cengage 等世界著名出版公司建立了良好的合作关系，从他们现有的
数百种教材中查选出 Andrew S，、Tanenbaum，Bijarne Stroustrup，Brain 双.Kernighan，Dennis Ritchie，Jim
Gray，Afred V. Aho，John 下Hopcroft，jJeffrey D.Ullman，Abraham Silberschatz。 William Stallings ，
Donald 下.KKnuth ，John L. Hennessy，Larry L，Peterson 等大师名家的一批经典作品，以“计算机科学从
书"为总称出版 ，供读者学习、研究及珍藏 。大理石纹理的封面，也正体现了这套丛蔬的品位和格调。

“计算机科学丛书"的出版工作得到了国内外学者的电力襄助，国内的专家不仅担供了中肯的选题指
导，还不辞劳苦地担任了恶译和审校的工作;而原书的作者也相当关注其作品在中国的传播，有的还专
程为其书的中译本作序。迄今,“计算机科学丛书"已经出版了近两百个品种，这些书籍在读者中树立了
良好的口碑，并被许多高校采用为正式教材和参考书籍。其影印版"经典原版书库"作为姊妹篇也被越来
越多实施双语教学的学校所采用。

权威的作者、经典的教材、一流的译者、严格的审校、精细的编辑，这些因素使我们的图书有了质
量的保证。随着计算机科学与技术专业学科建设的不断完善和教材改革的逐渐深化，教育界对国外计算
机教材的需求和应用都将步人一个新的阶段，我们的目标是尽善尽美，而反馈的意见正是我们达到这一
终极目标的重要帮助。华章公司欢迎老师和读者对我们的工作提出建议或给予指正，我们的联系方法
如下:

华章网站 :， www. hzbook, com

电子邮件，hzjsj@hzbook. com 下

联系电话;， (010)88379604                       元

联系地址: 北京市西城区百万庄南街 ] 号                    华章教育

邮政编码: 100037                        华章科技图书出版中心



--- 第 6 页 ---
改编者序|

Discrete Mathematics and Its Applications，6瑟

原版4离散数学及其应用》是一本优秀的教材，由 Kenneth 了,Rosen 编著，已被全球超过 600 所大学
使用。《离散数学及其应用》介绍了离散数学的主要内容以及离散数学在现实世界中的应用，节中内容全
面，一些知识点给出了相关的历史背景知识，并配有大有量的应用实例、参考资料和练习题，对学习该课
程提供了极大的帮助。

近年来，国内的许多高校都在开展双语教学，并且采用国外的优秀原版书作为教材。而《离散数学及
其应用》原版书超过 800 页 ，使得国内高校难以采用。为了将这本优秀教材介绍给更多的中国学生，在
保留原作者写作风格的前提下，我们删碱了部分章节内容编成此精编版，以适合中国学生的使用和阅
读。精编版符合本科离散数学教学大纲的要求，可用于离散数学教学和课外学习。

原书中的一些内容，如数论 、离散概率 、归纳和递归、布尔代数以及有限状态机等，在其他课程中
已有讲授或单独作为一门课程讲授 ，我们在精编版中将这些内容删除，保留了逻辑和证明、集合、函数
和关系、图、树、计数和高级计数技术等内容。

原书有 3800 多道各种类型的练习题，其中包括帮助学生掌握基本概念的习题 、提高应用所学知识分
析和解决问题能力的习题等，分较为容易、难度适中和难度较大各种类型。为了保持原书的特点，我们
保留了原书中奇数练习题 ，这样可以使得原书的各种类型 、不同难度的习题都得以保留。关于一些知识
点的相关历史背景知识未作保留 ，以减轻学生的阅读负担 ，减少本书的篇幅。

原书把一些概念放在练习题部分介绍 ，有些概念很重要，如数理逻辑中的范式，而原书对范式的描
述较为简单 ，学生较难理解，所以我们将范式的相关内容补充到精编版的第 1 章中。

-感谢我的同事杨捷在本书改编过程中提出的宝贵建议。精编版力求符合本科离散数学教学大纲的要
求并将原书的精华体现出来，但难免存在不足之处，欢迎广大教师和学生指正。

陈玉
2011 年 9 月于华南理工大学



--- 第 7 页 ---
|译者序

Discrete Mathematics and Its Applications，6己

离散数学被 IEEE&ACM 确定为计算机专业核心课程，也是《中国计算机科学与技术学科教程 2002》
中界定的计算机科学与技术专业的核心基础课程。离散数学为许多专业课程提供理论基础，尤其是大多
数算法的基础，可以说，不理解算法背后的数学含义，就不能理解算法的本质，而这种表面的一知半解
很可能会给你带来很大的麻烦。本书的写作目标就是向读者展示离散数学的实用性: 为计算机专业学生
提供一切必要的数学基础，使数学专业学生理解数学概念的重要性以及这些概念为什么对应用而言是
要的。

本书译自 Kenneth H，Rosen 所著的《Discrete Mathematics and Its Applications，Sixth Editiony，是介绍
离散数学理论和方法的经典教材，已经成为世界上使用率最高的离散数学教材之一，目前已用五种语言
出版，发行 30 多万册，仅在美国就被 600 多所高校用作教材，并获得了极大的成功。国内很多院校也选
择这本书作为教材。

这本书是计算机理论中一本很好的人门教材，几乎涉及计算机理论的所有方面。该书有如下几个
特点:

1)通俗易懂，深入浅出。问题的引人、概念的描述和定理的阐述等通俗而不失科学性。

2)书中例子很多，而且非常实用，还包含了世界名题和一些趣味性很强的问题。

3)信息量虽然很大，但安排灵活，读者可以根据自己的兴趣选择性地学习。

4)涉及面特别广，可以使读者大致了解计算机理论的方方面面，有助于读者理解计算机科学与技术
中列含的数学思想 、数学思维 ，培养读者对问题的数学建模能力，激发读者学习其他课程的兴趣。

5)习题相当丰富，形容为触目惊心"也不为过。题量大、题型多，有基础的也有探究的，有理论的
也有实践的，正像作者在前言中强调的那样 ，他相当重视练习。

整本书阅读顺畅，行文活泼，作为参考书查阅也很方便。但书中多数章节还仅仅是相关的基础知识，
也就是说，对这本书中的每一个知识点，比如还辑、函数、组合数学、概率 、算法等，都可以进行延伸
阅读。有兴趣的话，读者不妨顺着书后的推荐阅读列表 ，继续深入下去。最后建议大家花些时间仔细读
读前言 ，这对你用好本书、更好地学习离散数学等非常有帮助。

本书第 5 版主要由焉崇义、屈婉玲、王捍贫和刘田翻译完成，而第 6 版的翻译工作是在第 5 版译稿
的基础上进行的，主要由张桂芸、赵子平、裴伟东、徐计和王向云翻译完成，张桂芸做了全书的统稿和
定稿工作。由于翻译水平和时间有限 ，书中难免有不妥的地方，敬请读者不吝赐教。

译者
2011 年5月于天津



--- 第 8 页 ---
言|

Discrete Mathematics and lts Applications，6卫

本书是根据我多年讲授离散数学的经验和兴趣写成的。对学生而言，我的目的是为他们提供准确而
可读的教材，清晰地介绍离散数学的概念和技术。我的目标是向爱怀疑的学生们展示离散数学的实用
性，和希望为学习计算机科学的学生提供一切必需的数学基础，也和希望学数学的学生理解数学概念的重要
性，以及这些概念为什么对应用是重要的，还希望本书既能达到这些目标，又不含太多的水分。

对教师(指导者)而言，我的目的是使用成熟的数学教学技术设计一个灵活而全面的教学工具，和希望
为教师们提供能够以最适合特定学生特点的方式高效地讲授离散数学的教材。和希望本书能够达到这些
目标。

我为本教材在过去已经取得的巨大成功而分外高兴。根据成功使用本节的 600 多所学校的大批师生
的反馈和建议，此次第 6 版进行了许多改进。很多内容有所提高，辅助材料更加丰富，配套网站提供的
材料更有帮助性，使师生更容易达到他们的目标。

本教材是为1至 2个学期的离散数学人门课程而设计的，适用于数学、计算机科学 、工程等许多
专业的学生。虽然唯一的先修课要求是大学代数，但是要想学习好离散数学还需要掌握更多的数学
知识。

离散数学课的目标

离散数学课有多个目标。学生不仅要学会一些特定的数学知识并知道怎样应用，更重要的是，这样
一门课应教会学生怎样进行数学罗辑思维。为此，本教材特别强调数学推理及用不同的方法解题。本教
材有 5 个重要的主题交织在一起: 数学推理、组合分析、离散结构、算法思维、应用与建模。成功的离
散数学课程应该努力使这五部分内容相互融合、平衡。

1. 数学推理: 学生必须理解数学推理，以便阅读、理解和构造数学证明。本教材以数理逻辑开篇，
在后面证明方法的讨论中，数理运辑是基础。同时，本书描述了构造性证明的方法和技巧。本书还十分
强调数学归纳法，不仅用许多证明的实例进行介绍，还详细地解释了数学归纳法为什么是有效的证明
方法。

2. 组合分析: 解题的一项重要技巧是计数或枚举对象。本书中，对枚举的讨论从基本的计数方法着
手，重点是用组合分析方法来解决计数问题，而不直接使用公式。

3. 离散结构: 离散数学课应该教会学生如何使用离散结构，即学会如何使用表示离散对象及其之间
的关系的抽象数学结构。离散结构包括: 集合、置换、关系、图、树和有限状态机等。

4,， 算法思维: 有些问题是通过详细说明其算法来求解的。算法在描述后就可构造计算机程序来实
现。这一过程中用到的数学部分包括: 算法描述 、正确性证明以及执行算法所需要的计算机内存和时间
的分析。这些内容在本书中均有介绍。算法是用英语 和一种易于理解的伪码描述的。

5. 应用与建模: 离散数学几乎应用在所有研究领域中。本书既介绍了其在计算机科学和数据网络中
的许多应用，也介绍了在其他各种领域中的应用，如化学、植物学、动物学、语言学、地理、商业以及
互联网等。这些均是离散数学的实际而重要的应用，而不是编造的。用离散数学来建模是十分重要的问
题求解技巧。本书中的一些练习让学生有机会通过自己构造模型来掌握这一技巧。

名”译鞭中采用汉语。一一译者注



--- 第 9 页 ---
本书特点

易入门”实践证明: 此课本对初学者来说易读易懂。它的大部分内容只要求学生学过大学代数，
不需要其他的预备知识 ，少数几个卡及微积分的地方也有明确说明。大部分学生应该很容易理解课本
中用于表示算法的伪码，不管他们是否学过程序设计语言。本节不要求正规计算机科学方面的预备
知识。

每章都是从易理解的水平开始。本书在仔细研究基本的数学概念之后，就介绍了其他领域中更难的
部分和应用。

灵活性 ”课本为灵活使用作了精心设计。各章对其前面内容的依赖都降到最低程度。每一章分成长
度大致相等的若干节，每一节又根据内容划分成小节以方便教学。教师可以根据这些分块灵活地安排
进度。

写作风格 ”本书的写作风格是直接和实用。使用准确的数学语言，但没有过分的形式化与过分的抽
象。在记号和数学命题的词汇间作了精心的平衡 。

数学严谨性和准确性 本书中所有定义和定理的陈述都十分详细，所以学生可以欣赏其语言的准确
以及数学所需的严递。但证明则是缓慢引入并展开的，每一步都经过了详细论证。本书解释并大县使用
了递归定义。

实例 本书使用了很多例子来请述概念、建立不同内容之间的关系或导人应用。在大部分例子中，
先提出问题 ，再适当给出它的解。

应用 ”书中叙述的应用展示了离散数学在解决现实问题中的使用价值，所涉及的范围很广，包括计
算机科学、数据网络 、心理学、化学、工程、语言学、生物学、商业和互联网。

算法”离散数学的结论常常要用算法来表示，因此，本书每一章都介绍了一些关键算法。书中还简
要分析了所有算法的计算复杂性。

关键术语和结果 每一章后面都列出了本章的关键术语和结果，但只列出了学生必须学会的那些最
重要的关键木诸 ，而不是在该章中定义的所有术语。

练习 书中包含许多练习，代表了大量不同类型的问题。本书不仅提供了足够多的简单问题用于练
习基本技巧，还提供了大量的中等难度的练习和许多有挑战性的练习3。练习的叙述清晰而无坡义，并按
难易程度进行了分级。有些特殊的论题还设计成系列练习。这些练习不仅给出了正文中没有介绍的新概
念，还使学生可以遗过自己的努力发现新思想。

比平均水平稍难的练习用单个星号作标记，根当有挑战性的问题则用两个星号来标记。必须用微积
分来解的练习也作了明确说明。导出正文要用到的结果的练习则用符号“咖 "识别 。

复习题 ”每章最后都有一组复习题。设计这些问题的目的是帮助学生重点学习该章最重要的概念和
技术。要回答这些复习题，学生必须写出较长的答案 ，而只做点计算或简答是不够的。

计算机题目 每一章后面还有一组计算机题目。这些题目把学生可能已经学到的有关计算和离散数
学的内容联系起来。如果从数学角度或程序设计角度来看，其难度超过平均水平的计算机题目用一个星
号标记，特别有挑战性的则用两个星号标记。

计算和研究 ”每一章的结论部分都有一组计算和研究性问题。要完成这些练习(大约有 100 道)需要
软件工具的帮助，例如学生或教师自己编写的程序，或数学计算软件包(如 Maple 或 Mathematica) 。大部
分这样的练习为学生提供了通过计算发现新事实或新思想的机会。

写作题目 每一章后面都有一组应该书面完成的题目。要完成这类题目，学生需要参考数学文献。
有些题目在过去的历史上是很重要的，学生需要查找原始资料，其他的题目则是通往新内容和新思想的
途径。所有此类练习均向学生展示正文中没有深入探讨的思想。这些题目把数学概念和书面写作的过程
结合在一起，以帮助学生探索未来的研究领域。

推荐读物 在正文的最后，专门有一节用来为各章推荐参考读物，其中有不超过本书水平的书籍，



--- 第 10 页 ---
吊

也有较难的书籍; 有综述性文章，也有发表离散数学新发现的原始文章。其中一些是许多年前出版的经
典读物，而其他一些是在最近几年内出版的。

配套网站

为本蔬开发了一个内容广泛的配套网站，该网站将不断地维护和改进。可以以多种方式使用该网站
进一步学习离散数学，网站地址是:

www. mhhe、cormyrosen

由此地址进入该网站的主页。该网页有下列链接 ，

。 信息中心

*， 学生中心

。 教师中心

信息中心: 该中心包含本书及其辅助资料的基本信息。教师在这个网页中可以利用网页抽取系统

“Page (ut" ，建立自己的课程网页，还能学习定制出版信息。从该信息中心出发，沿着适当的链接，可

以看到本书网站的一个概观。

学生中心:; 该中心包含了可供学生使用的丰富资产，包括下列与课本紧密相关的资源(在课本中用相
应的图标加以标记) :

。 网络资源指南: 该指南提供了数百个含相关资料的外部网站的链接。可以通过关键词济
览或访问这些链接，它们将把你带到包含下列信息的网站: 历史及传记信息、谜题及问
题 、过论 、Java 小程序、程序以及其他类型的资源。

”额外的例子: 这个网站包含了大量额外的例子这些例子主要集中在学生经常需要的课
外资料的领域。虽然大部分例子只是扩充了基本概念，但还有一部分十分具有挑战性。

* 额外的步骤: 对一些困难的知识点，提供了更深入的解酸帮助理解，尤其是一些特殊的

证明和例子。

评估: 提供对七个关键概念理解程度的评估。每个评估部提供了一个题库，其中的每个

试题由两部分构成: 先是一段简短的复习，然后是一个多选题。如果你选择的答案不正

确，该系统还能提供建议，帮助你理解错在什么地方。这样的评估系统应该能诊断出你

学习中的问题，从而把精力集中在寻找纠正办法上。

* 交互式演示: 已经开发了八个交互式泪示系统，你可以用它们考查一些重要算法是怎么
工作的。这些滨示都与课本中的相应材料相对应。

的访学生中心你可以访问网络才学系统。 Net Tutor"。它提供了在线教学帮助 。当你提问与课本内容
相关的问题时，如果是在规定教学时间内 ，你会收到实时回答; 否则稍后才会收到回答。
学生中心还支持能发布消息的公告板系统。使用该系统，你可以提出问题，还可以回答其他学生提

出的问题。

除此之外，学生中心还包括下列资源，

* 证明书写指南

* 离散数学的常见错误

*。 写作题目的建议

* Maple 软件

教师中心: 除了包含学生中心和信息中心旭供的所有链接外，网站中的教师中心还包含下列链接 :
。 教学大纲样本

* 教学建议

*。《Applications of Discrete Mathematicsy一蔬中的某些章节

 

 

 



--- 第 11 页 ---
写给学生

什么是离散数学? 离散数学是数学中研究离散对象的部分。(这里“离散"的含义是“由不同的或不相
连的元素组成"。)离散数学能解决的问题包括 ;

在计算机系统中，有多少种方式可以选择一个合法口令?

。 赢彩票的概率是多少?

。 两台计算机之间在网络上是否有通路?

*。 怎样鉴别 E-mail 信息中的垃圾邮件?

。 怎样加密信息以避免不该收到的人读取该信息?

*。， 在某一交通系统下，两个城市之间的最短路径是什么?

*。 怎样把整数序列按递增序排列?

*。 完成上述排序需要多少步骤?

。 如何证明一个排序方法能正确地排序?

。 怎祥设计两个整数相加的电路?

。 有多少合法的因特网两址?

你们将学习解决诸如以上问题要用到的离散结构和技术。

更一般地，在对对象进行计数时要用到离散数学，研究两个有限(或可数)集合之间的关系时要用到
离散数学，分析只含有限步的进程时也要用到离散数学。离散数学的重要性还在不断增加，一个关键原
因就是计算机以离散的方式存储和处理信息。

为什么要学离散数学? 有几条重要的理由来说明需要学习离散数学。首先，通过这个课程你们可以
发展自己的数学素质，即理解和创造数学证明的能力。没有这些技巧，你们在学习数学时不可能太
深入。

其次，离敬数学是学习所有更高级数学课程的必经之路。离散数学为学习计算机科学课程提供必要
的数学基础，这些课程包括 : 数据结构、算法、数据库理论、自动机理论、形式语言、编译理论、计算
机安全以及操作系统。学生如果没有适当的离散数学基础，在学习上述课程时会感到很困难。有个学生
给我发电子邮件说，在她学习的每一门计算机科学的课中都用到了本蔬的知识。

以离散数学为基础的数学课程包括有逻辑、集合论 、数论 、线性代数、抽象代数、组合论、图论及概
率论(其离散部分) 。

此外，离散数学还包括了解运筹学(包括许多离散优化技术)、化学、工程及生物学等领域问题的必
要的数学背景。从本书中你将学到在上述某些领域中的应用。

许多学生都感到，与他们以前学过的课程相比，离散数学人门课程的挑战性要大得多。这是因为，
本课程的一个主要目的是教你进行数学推理和问题求解，而不只是一些分散的技巧。从课本中练习的设
计可以看出这个目的。课本中虽然有大最与重点例子类似的练习，但还是有相当比例的练习需要创造性
思维。这是有意设计的。虽然课本中的材料提供了解这些问题的工具，但你的任务是创造性地使用这些
工具并取得成功。本课程的另一个主要目的是学会处理你以前没有见过的问题。然而，只学会解特殊类
型的练习还无法保证能学会足够多的解题技巧，也不能保证在后继课程的学习中或在将来的职业生涯中
取得成功。虽然课本讨论了许多主题，但离散数学是一个极为广泛县充满变化的研究领域。作为作者，
我的任务之一是帮助你开发学习新知识的能力，在将来的奋斗中你十分需要新的知识。

练习 我愿意就如何学好离散数学(或数学的其他学科和计算机科学)给同学们提点有益的建
议。积极地做练习能使你最大地获益。我建议你尽可能地多做练习。在做完老师布置的练习后 ，我
鼓励你做更多的练习，包括本书每节后面的练习和每章后面的补充练习。(注意练习前面的分级
标记。)



--- 第 12 页 ---
 
   
   
  

常规练习
较难的练习

富有挑战性的红习

正文中要用到该练习的某个结论
解题时要用到极限或微积分的概念

 

《需要用到微积分)

   

解题时，最好在查阅答案以前，息已先进行尝试。华章网站(www. hzbook. com)提供了练习的答案。
注意，只是答案，而不是完整解答 。特别地，答案中省略了解的推导过程。

网络资源 我强烈推荐你利用网络提供的新资源，特别是专为本书设计的网站 http://www. mhhe、
comyrosen 中的资源。其中为澄清关键的概念设计了许多额外的例子，自我评测是考查你对关键问题的党
操程度; 交互演示小程序帮你探索关键算法和其他概念， 网络资源向导包含了广泛的与离散数学有关的
外部链接; 额外的解释和实践会帮助你掌握关键的概念，增加的书写证明可以避免离散数学中的一般错
误; 重要应用的深入探索指导应用 Maple 软件探索离散数学中的计算问题。在文中这些烙外的在线资源
尽可能在边缘处用特定图标标识。

本书的价值 ”我希望你对本书的投资能得到优质的回报。我们花了多年的努力来开发和优化本书及
其配套的辅助读物和网站。对大多数人来说，我很自信本书及其配套资料对掌握离散数学大有帮助。即
使你现在的课程可能略去了其中某些章节， 但当你学习新课程时会发现，阅读本书中的相关章节对新课
程仍然十分有益，许多学生都有这样的感觉。许多人会在将来的研究工作时又找到本书，把它当做一本
有用的工具书，特别是那些继续学习计算机科学 、数学或工程的人。我设计本书作为你将来研究和探索

的人门，我希望你能幸运地开始你的征程。

致谢

我要感谢很多学校中使用本书的大批师生们，他们向我提出了宝贵的反馈和有益的建议。没有他们
的反馈和建议，本书不可能有很大的改进。我要特别感谢 Jerrold Grossman、Jobhn Michaels 和 Geoge
Bergman，感谢他们对第 6 版的技术审阅，他们敏锐的目光确保了本书的准确性。我也要感谢通过网站提

交评论的人们提供的帮助 。
我感谢本节第 6 版及前面 5 版的许多评阅人，他们对我提出了许多有益的批评和鼓励，我希望本版
不事负他们的期望。
第6 版评阅人名单
Charles Ashbacher,                                Greg Cameron，                                     Beverly Diamond,
aouvmi Mercy Collese                                      riShaml }DMnS Liversipy                               College or Charleston
lan Barland，                                            John Carter，                                            Thomas Dunion，
Rice University                                            Liversib' or Tpronio                                   tiantic Unrion Coliege
Geofge Beregraan，                                      Greg Chaprman，                                         Bruce Ele           ，
Zipversiy or Caltprnria, Berkeley                      Cosuinnes River College                                    Ziversity ohichigam Dearporm
David Berman，                                             Chao-Kun Cheng，                                         Herbert Enderton ，
Criversipy Q Nor矶 Carpiina,                           防reimia Comarrtomrweaiip Limivers训,                  Diversity orCaiiprmia，
 Jr1nBAo                                           Thomas Cooper,                                           LOs 47Seies
Mikios Bona，                                               Ceorsia Perimeler College，                      Anthony Evans，
Universib or Fiorida                                           了onuremceviplle                                                       陷7襄后 State CUniversibp
Prosenjit Bose，                                     Barbara Cortzen，                                  im Factor
Caryetom Liyers克，                                    DeRazxl Lirersib，                                      Maryxette Livers太，
Kirby Brown，                                             Daniel Cunningham，                                  William Farmer,
PEojytechnic Liversigy                              Bu1aio Store Coliege                              WicMasrter Universipy
Michael Button，                                     George Davis，                                        Li Feng，
The Wasters Coillege                                       University of Georgia                                      416bany Stafe Cniverstitgy



--- 第 13 页 ---
Stephanie Fitchett，
Piorida dtiantic Lpniversipy

Jerry Fluharty，
Gastermi Sore COMINUTID College

Joel Fowler，
Southern PPptechnic Siate

Limivers芍，
William Gasarch，
Universib of Mamyiard
Sudpito Ghosh,
Colorado Starle Liversity
Jerrold Grossman，
Oakianad LUmiversiby

Ruth Haas，
Spa Colese

Patricia Hammer，
ollins LUmiversity
Keith Harrow，
Brookpmn Colilese
Bert Hartnel]，
St hfaryS Liniversity

Julia Hassett，
Oakton College

Kavita Hatwal，

Portiand Comammaunitby' Collese
John Heim，

Radfprd Universigy

Arthur Hobbs，
Texas 4&hMf Liiversip)

Fannie Howell，
Roanoke Fish School

Wei Hu，
五oughiom Coliese

Nan Jiang，
Viversig or Sok纹 Dakota

Margaret Johnson,
Sianmma Livers克)

Martin Jones，
Coliege or Charieston

Tim Kearns，
Caliprnia Poiytecjhnic State
Liniversiiy San Luis Opispo

前5 版评冻人名单
Eric Aliender,
Ruitgers Lmiversib)

Stephen Andrilli，
了La Salie Liversip

Kendall Atkinson，
Liyversib of Jowa, fowa Cipy

Scott Buffett,，
Liversiby or New BrumSwWic天

Russell Campbel]，
Livers区or Northerr Jowa

Jonathan 氏nappenberger，
LaSalle Limiversity

Ed Korntved
Northwest Nazareme Liversipy

Przemo Kranz，

Zniversipby or hfissi35ipPF
Loredana Lanzani，

Cniversibp or drkansas
Yoonjin Lee，

Smaith Coliege

Miguel Lerma，
Norrthwesterm Li1tiversigy

Jason Levy，
Liyversipy or Fawai

Lauren Lilly，
Tzpor College

Ekaterina Lioutikova，
Saimtt JosepF College

Vladimir Logvinenko,
De 4nmza College

Joan Lukas，
Liniversiby of hfassachauisetrty, Bostom

Lester McCann，
Liversiby or 4rizona

Jennifer McNulty，
Liversiny' or Momtanma

John G. Michaels，
SUNY Brockport

Michael Oppedisano，
aforrigville Srare Colilege

Michael O"Sullivan,，
San Diego Siale Liniversity

Charles Parry，
护rginia PoiyiecHnmric mstittte

Linda Powers，

Jrgipia Popppiechnic Jpsfitute
Dan Pritikin,

Aianmi Universipgy
Anthony Quas，

Liversitby or fenmphnis

Eric Rawdon，
Dugresnme Liiversity

Zhaojun Bai，
Liversib orCaliprnia Davis

Jack R. Barone，
Baruch Collesge

玫laus Bichteler，,
Lpiversib) or TBxas, 4MS1im

David Jonah，
Japme State Liiversity
Akihiro Kanamori，

Bostom University

Henry Ricardo，
hfedsgar Evers Coilege

Oskars Rieksts，
天kiztowH Liversipy

Stefan Robila,

Adfoniciair Stafe Liniversib
Chris Rodgen

dupurn Liversib，

Robert Rodman，
Nort Carojina Siaie Liniversity

Shai Simonson，
Stone College

Barbara Smith，
Cochise College

Wasin So，
San Jose State Universiby

Diana Staats，
Dutchess Comrmunitby Coliege

Lorna Stewart，
Liniversiby or diberia

Bogdan Suceava，
Caiiprnia State Liversity
天Reliertonm

Kathleen Sullivan，
Seattle Liversipy

Laszlo Szekely，
Universib or SokI Carolina

Daniel Tauritz，
Liyersiby of hfissoxrl Rolla

Don VanderJagt，
Grand 了Jey State Lpnivers

Fran Vasko，
天ML1ZiOW7E Liversity，

Susan Wallace，
Liniversiby or Nor态 Forida

Zhenyuan Wang，
Liversib of Nebraska, Omaha

Tom Wineinger,
Liversiby or scons训
Ear Ciaire

Charlotte Young，
Sor态 Plains Coliege

Alfred E. Borm，
Sok要West TExaS State Liversiby

天en W. Bosworth，
Liniversipy or Maryiand

Lois Brady,
Caliprnia Popytechnic Sitate
Liiversib Sam ZUiS Opispo

Ho Kuen Ng，
Sam Jose State Upiversity

Timothy S. Norfolk, Sr
Liiversib or 4jporm



--- 第 14 页 ---
目

Discrete Mathematics and lts Applications，6蕊

录 |

出版者的话
改编者序
译者序

前言

第1章 基础: 运辑和证明.………………
1.

考:

命题逻辑 …
引言

条件语句

翻译语句

系统规范说明
布尔检索

四     。
一产姜一一靖 王
     旬     人     二     人     人     人

PPO nn上 忆一

1
1
1
1
1
1
1
1
1
T
1

一

练习

.2 命题等价 pp
1.2.1 引言
1.2.2 还辑等价 pe
1.2.3 德摩根律的运用 ppp

1.2.4 构建新的有辑等价式…
练习

,3   谓词和量词 eeeaeessssseeeesossssaassee

1.3.1 引言

谓词 .……

一
的
co Do上

命题

复合命题的真值表 pp.
远辑运算符的优先级

辑难题
,1.10 还辑运算和位运算

人  3 2
四中cc-中避r一一

量词 .pe
涉及量词的逻辑等价 .…………….

2

BR
必 必宙汪上

1.

1. 3. 10
1
]
1

3.9 否定量化表达式
翻译语揣为远辑表达式
3,.11 在系统说明中运用量词
.3.]12 选自 Lewis Carrol] 的例子
.3.13 还辑程序设计

练习

1. 4

1.
1
1.

1

1

1.

财套量词 .………-
4.1 引言
4.2 量词的顺序 …

ee

vv

”25

26
28
28

”29
.30
， 32
32
33

4.3 将数学语句翻译成涉及广套

量词的语句 ，

4.4 将散套量词翻译为汉语 …….
.4.5 将汉语语句翻译成去辑

表达式…

练习

1. 5

1.

后
RE

推理规则 ……….
引言 …………

cn an ca an 四on on
=    ”>    s    地    *    =    ，
眉 co 手

oo ~ ccn

练习

1.6

Fi

.6.1 引言
.6.2 一些专用术语 .……
.6.3 定理陈述的理解 .………

命题远辑的有效论证 …

命题逻辑的推理规则 ……………
用推理规则建立论证 ……………-
带量词命题的推理规则 ……人…
命题推理和量化语身推理规则

34

.35

”35
4.6 否定庶套量词 .pp

36

”36
”39
.、39
”39

40
42
43

"，43

”45
，… 45
证明导论 pp
7
”47

6.4 证明定理的方法 .pe

.6.5 直接证明 .pe
.6.6 反证法.pp

47

47
48

”48

49



--- 第 15 页 ---
1. 6.
1. 6，
1. 6，
练习

1.7 证明的方法和策略…

rm

一

a    =    a    e     4    由    本    时    4
mv -mn ~ -
。    *    四     。    。    地    昌    。    。
Po中划一

~

练习

关键术语和结果 、
复习题

8 证明中的错误 pp

引言
穷举证明和分情形证明 -………
存在性证明 pp
寻找反例
行动证明策略
未解决问题的作用 .…………

.10 其他证明方法 .pe

补充练习

计算机题目

计算和研究

写作题目

第 2 章

2. 1   集合 ……… 。

2. 1.
2. 1
2,. 1
2. 1.
2. 1
练习

2.2 集合运算 …:

2. 2.
2 2.
2.2
2.2
练习

2. 3，

.3 扩展的并集和交和全 ……
.4 计算机表示集合的方式 …………

基本结构: 集合、函数、
数列与求和 …….

言 .…..
1 引言    es

4 使用带量词的集合符号…
5 量词的真值集合 .ev

”68

”70

，70
” 70
.3 共卡多机-

72

-73
74

74

4

”75

75
77

”79

80

”81

1 引言

83
83

2.3.2 一对一邓数和了映上函数
2.3.3
2. 3. 4
2. 3. 5
练习

.4 序列与求和 …………
2. 4. 1
2.4.2
2.4.3
练习 让

关键术语和结果 oa

复习题 ooooooooo ooooeoooeseseeeess

5

计算和研究 .……….….
写作题目…

第 3 章

3.1 计数基础

3.1.1 引言

3.1.2 基本的计数原则
3.1.3 比较复杂的计数问题
3.1.4 容斥原理

3.1.5 树图
3.2 铝巢原理 …

3.2.1 引言

练习

Ko

3.3.1 引言

3.3.2 排列

3.3.3 组合 …

.4 二项式系数 .…………
3. 4.1
3.4.2 帕斯卡恒等式和三角形

CD

反函数和函数组合 .ee
函数的图像 .pp
” 91
… 93
特殊的整数序列 .pp
”96
”98
”100
”101
103

86
88
89

93
93
94

103

”105
0 105

… 106

”106
”106
.106
”109
… 110
… 111
”112

- 114
3.2.2 广义饮筑原理 .pe
3.2.3 巧妙使用后旭原理
- 117

118
ee 118

120

122
,123
二项式定理 ov

115
116

]118

123



--- 第 16 页 ---
划

练习 -

.5 排列与组合的推广
3.5.1 引言

有重复的排列

CD

cn cn 届 CT
1

3
3.
3
排列
3.5.5 把物体放入盒子
练习 、
3. 6 生成排列和组合 oo
3.6.1 引言
3.6.2 生成排列

关键术语和结果 .pe
复习题 …….
补充练习 .…

第 4章

4.1 递推关系基础 .…….
4.1.1 引言 .ev
4.1.2 递推关系

4.1.3 用递推关系构造模型
练习 .

.2 求解线性递推关系 …

4.2.1 引言
4. 2.2

心

关系
党系喜虑性非寺次的通推
关系

4. 2.3

练习
.3 分治算法和递推关系

心

4.3.1 引言

4.3.2 分治递推关系
练习，

3.4.3 其他的二项式系数恒等式 …
27

ee 129

， 129

2             129

3 有重复的组合 pe

4 具有不可区别物体的集合的

高级计数技术

家解党系数斤性齐次运推

126

129

”132
”132
”135
1136

”136

-” 137
3.6.3 生成组合 pp

138

139
1140
… 141
计算机题目 .pe
144
”144

144

”145
”145
”145
”146
”150
”152
”152

4.4.1I 引言 ，
4.4.2 关于办级数的有用事实
4. 4. 3
4.4.4 使用生成函数求解递扒
关系
4.4.5
练习 ，
4.5 容斥
4.5.1] 引言
4.5.2 容斥原理 ，

6
4.6.1 引言
4

.6.2 容斤原理的另一种形式 ….

4.6.3
4. 6. 4
4.6.5 错位排列

练习
关键术语和结果 .9
补充练习 .………

埃拉托色尼短

计算机题目 .pp

计算和研究 ……
写作题目 ea eseese

第5章 关系.…….

关系及其性质 ………
引言

通数作为关系
集合的关系

5.

一   一   Fr   Le   Je
四    ea     4    w    由
居于

<

过

2元关系及其应用
引言

7元关系
数据库和关系
.元关系的运算

tb
车由
多    人

RN RN RN SN
上tf 必

计数问题与生成冰数

使用生成函教证明恒等式 …
174
176

.166
”167

170

174

”176
练习
容斥原理的应用 ee

179

… 180
”180

180

181
映上函数的 个教  人
183
184
， 185
，186
186
188
189
189

182

”190

190
， 190
.191

必 191

关系的性质 pe

关系的组合 pp

-195
”197
”197
”197
”197
… 199
”200

vv 201

192
194



--- 第 17 页 ---
5.3 关系
5. 3.1
5. 3. 2
5. 3. 3

的表示 …
引言

用矩阵表示关系
用图表示关系

《nm

.4 关系
5. 4.1
5. 4.2
5. 4. 3
5. 4.44
5. 4.5
练习…
.5 等价
5. 5. 1
5.5.2
5. 5. 3
5. 5.4

cm

引言

闭包

有向图的路径 …'
传递闭包  ve
沃舍尔算法

关系基础
引言

等价关系
等价类

等价类与划分

”202

练习 oo

. 6. 1
6. 2
6. 3
6. 4
6. 5
.6.6

mnmonomnmon 呆
1

信序 ………

引言

字典顺序 pe

哈塞图
极大元素与极小元素

格  oo
拓扑排序 ee

练习
关键术语和结果 pp

计算机题目 ee
写作题目…

第6章 图 …….

6.1 图和
练习 .
6.2 图的
6. 2. 1
6. 2.2
6. 2. 3

图模型 ……

225

”237

9术语和玫种特殊的图

引言

”246

一些特殊的简单图

6.2.4 偶图

6.2.5 特殊类型的图的一些应用
6.2.6. 从旧图到新图

练习 ，

3 图的表示和图的同构

6.3.1 引言

6.3.2 图的表示

史

6.3.3 邻接短阵pp

6.3.4 关联给阵 ………
6.3.5 图的同构

乡习
连通性 pe

引言

四
上

全 少 从 中 省 人

通路与同构

人一

6.
练习

6.5 欧拉通路与哈密顿通路 ee

6.5.1 引言

6.5.2 欧拉通路与欧拉回路
6.5.3 哈密顿通路与哈密顿回路 …

练习
6.6 最短通路问题 ，
6.6.1 引言

6.6.2 最短通路算法
6.6.3 旅行商问题
练习 ……

6.7 可平面图

6.7.1 引言

6.7.2 欧拉公式
6.7.3 库拉图斯基定理

练习
6.8 图着色

6.8.1 引言

6.8.2 图着色的应用
练习
关键术语和结果 .…

复习题

无向图的连通性
有向图的连通性 pe

计算顶点之间的通路数 …:

254

272

”281



--- 第 18 页 ---
|

计算机题目 .…………
计算和研究 ，…………………-
写作题目 .ee

第7 章。树

7.1.1 树作为模型
7.1.2 树的性质

7.2 树的应用

7.2.1 引言

7.2.2 二又搜索树 …
7.2.3 决策树 ，……:
7.2.4 前组码

7.2.5 博弈树 pe

7.3 树的遍历

7.3.1 引言
7.3.2 通用地址系统 …，
7.3.3 遍历算法 ，

 

马 见华章网站 www. hzbook. com。

.299
ee  303
303
es  304

”325

7.3.4 中缓、前缓和后缓记法

2

.4.1 引言
-4.2 深度优先搜索
-4.3 宽度优先搜索
.4.4 回漳

~ ~] >] ~上] 心

练习 ae es oo。

.5 最小生成树 ，…
7.5.1 引言

7.5.2 最小生成树算法

~

-4.5 有向图中的深度优先搜索

338

ee

练习

计算机题目 verooo
计算和研究 人
写作题目 oo

练习题答案。

350



--- 第 19 页 ---
|第1L章

Discrete Mathematics and Its Applications、6EE

基础: 逻辑和证明

逻辑规则给出数学语句的准确含义。例如，逻辑规则有助于我们理解下列语句及其推理:“存
在一个不是两个整数的平方和的整数"，以及“对每个正整数 n，小于等于”的正整数之和是
mn十1)/2”。逻辑是所有数学推理及所有自动推理的基础。对计算机的设计、系统规范说明、人
工智能、计算机程序设计、程序设计语言以及计算机科学的其他许多领域，逻辑都有实际的应用。

为了理解数学，我们必须理解正确的数学论证(即证明)是由什么组成的。只要证明一个数学
语句是真的，我们就称之为一个定理。围绕一个论题的定理的集合就将我们对这个论题的认知组
织起来了。为了学习一个数学论题，我们需要积极地构造关于此论题的数学论证，而不仅仅是阅
读说明。此外，因为一个定理的证明常常可能需要修改结论以适应新情境，所以证明在新思想的
发展中扮演了极其重要的角色。计算机科学专业的学生常常发现，在计算机科学中证明的重要程
度令人人惊讶。事实上 ，当我们证实计算机程序对所有可能的输入值产生正确输出值的时候，当我
们证明算法总是产生正确结果的时候，当我们建立系统安全，以及创造人工智能的时候，证明都
扮演了极其重要的角色。自动推理系统已经被构造出来，它允许计算机构造自己的证明。

本章将解释一个正确的数学论证的组成，并介绍构造这些论证的工具。我们将发展一系列不
同的证明方法以证明许多不同类型的结果。介绍完证明的多种不同方法后，我们将介绍一些构造
证明的策略。我们将介绍猜想的概念，并解释用学习猜想来发展数学的过程。

1.1 命题逻辑

1.1.1 引言

膛辑规则给出数学语句的准确含义，这些规则用来区分有效和无效的数学论证。由于本书的
一个主要目的是教会读者如何理解和如何构造正确的数学论证，所以我们从介绍逻辑开始离散数
学的学习。

逻辑不仅对理解数学推理十分重要，而且在计算机科学中有许多应用。这些多辑规则用于计
算机电路设计、计算机程序构造、程序正确性证明以及许多其他方面。在随后的几章中将逐一讨
论这些应用。

1.1.2 命题

我们首先介绍逻辑的基本成分一一命题。命题是一个或真或假的陈述语句，即一个陈述事实
的句子，但不能既真又假。

到铬,，。 例1 下面的陈述句均为命题。

1. 华盛顿是美国的首都。

2. 多伦多是加拿大的首都。

3. 1I十1一2。

4. 2十2一3。

命题 1 和 3 为真，命题 2 和4 为假。                        国

例 2 给出了不是命题的若干语句。

例2 考虑下述语句:

1. 几点了?

2. 仔细读这个。



--- 第 20 页 ---
2 "第1章 基础: 远辑和证明

3，x十1一2。

4，T十y一z。

语句1 和2 不是命题，因为它们不是陈述语句。语句 3 和4 不是命题，因为它们既不为真，也
不为假。注意，如果我们给语句 3 和 4 中的变量赋值，那么语句3 和4 可以变成命题。1. 3 节将讨

论把这一类语句改成命题的多种方法。                         国
我们用字母来表示命题变元，代表命题的变量，就像用字母表示数字变量那样。习惯上用字
母 bp，9，r，5s，…表示命题。如果一个命题是真命题，它的真值为真，用工表示;， 如果它是假命

题 ，其真值为假，用F表示。
涉及命题的逻辑领域称为命题演算或命题远辑。它最初是 2300 多年前由古希腊哲学家亚里士

多德系统地创建的。

2 现在我们转而证站从那些已有的命题产生新命题的方法，这些方法在 1854 年曾由英国
“… ”数学家布尔在他的题为 The Larus of Thovght 的书中讨论过。许多数学陈述都是由一个

或多个命题组合而来。称为复合命题的新命题由已有的命题用逻辑运算符组合而来。
EEE 令 为一命题，则 思的否定表示为上(也可表示成万) ，指“不是请所说的情形"。
命题?户读作*非 冯。-户的真值和畏的真值相反 。

-可兴， 例3 找出命题

“今天是星期五”
的否定，并用中文表示 。
解 否定为
“并非今天是星期五
也可以更简单地表达为
“今天不是星期五                加
例4 找出命题
“迈阿密今天至少下了 10 英寸的雨”
的否定并用中文表示。
解 否定为
“并非迈阿密今天至少下了 10 英寸的雨”
或者可以更简单地表达为

“迈阿密今天下了不足 10 英寸的雨”                        力

注意 严格地说，像例3 和例4 这种含有可变时间的语句不是命题，除非假定了一个确定
的时间。同样，除非假定了确定的地点，否则含有可变地点的语句不是命题; 除非假定
了确定的人，否则含有可变代词的语句不是命题。我们总是假定命题中有确定的时间、
地点和特定的人，除非另有说明。

表 1-1 是命题请及其否定的真值表。此表列出命题请的两种可能 “”表 L-1 命题之否定的真值

真值。每一行显示的?户的真值对应 谊 的真值。                       刀         Dp
命题的否定也可以看做非运算符作用在命题上的结果。非运算符     工       F
从一个已有的命题构造出一个新命题。现在将引人从两个或多个已有     F        工

命题构造新命题的逻辑运算符，这些逻辑运算符也称为联接词 。

人 令 户和9 为命题。 户、9 的合取用请人表示，即命题"请并且9g”。当请和9 都是真时，
户人Ag 命题为真，否则为假。

表1-2是庆Ad的真值表。此表每一行有是户和4 真值变化的 4 种可能组合中的一种。4 行分
别对应真值对 TT、TF、FT 和FF，这里只有第一对真值为真，即 户的真值为真，对应 9 的真值也
为真。



--- 第 21 页 ---
第1章 基础: 逻辑和证明 "3

注意在逻辑中，在一个合取的“但是”一词有时可以用并且”人代替。比如，语句“阳光灿烂，但
是在下雨>，还可以表示为“阳光灿烂并且在下十>。(在自然语言中,“并且”和*但是”在意思上有
微妙的不同，这里我们不关心这个细微差别。)

例S 找出命题户和49 的合取，其中 户为命题“今天是星期五>，9 为命题“今天下两”。

解 这两个命题的合取 户Ag 是命题“今天是星期五并且下十”>。这一命题在下雨的星期五为
真，不是星期五的日子为假，不下十的星期五也为假。                          国

人 邻刀和9 为命题。 户、9的析取用如V9表示，即命题“或g9”。当户和9 均为假时，
bpVag 命题为假，否则为真。

byVad 的真值表如表 1-3 所示。联接词“或?在析取中的使用对应于词“或"(or)包含的两种情况
之一，即“同或”(inclusive or) 。析取所含两命题之一为真或两者均为真时，析取的真值为真。例
如，下面这句话中,“或?表达的即是“同或”:

“选修过微积分或计算机科学的学生可以选修本课。.”
这里我们指的是，选修过微积分和计算机科学两门课的学生，以及只选修过其中一门课的学生都
可以选修本课。另一方面，当我们说:

“学过微积分或学过计算机科学，但不是两者都学过的学生，可以选修本课。”      ，

使用的“或?是“措或”。这里我们的意思是既学过微积分，又学过计算机科学的学生不能选修
本课; 只有那些恰好在这两门课中选修过一门的学生可以选修本课。

表 1-2 两命题合取的真值表           表 1-3 两命题析取的真值表

 

PPVd

 

可可口妆|忆
中 喇口口|=
可 门 站 癌

 

同样，若餐馆的菜单上写着“汤或沙拉，加一道小菜”，则一般这都表示顾客可以选择汤，也
可以选择沙拉，但不是既选汤又选沙拉时，才加一道小菜。因此，这里是“异或"而不是“同或”。
例6 若户和9就是例 5 中的两个命题，它们的析取是什么?
解 户和9 的析取刀V9是命题
“今天是星期五 ,或今天下十
这一命题在星期五或下雨天(包括下雨的星期五)的任何一天都成真。只有在既不是星期五，又不
下雨的日子，此命题为假。                                              加
前面已经说过，在析取中使用的联接词“或"(or)对应于两种情形之一，即“*同或"。所以当析取
中的两个命题之一为真或两者均为真时，析取成真。有时我们也按“异或”的含义使用*或”。用昼
或来联结命题 训和4 时，就得到命题*户或9(但非两者)”。这一命题当 为真且9 为假时成真，或
反过来当 为假且49 为真时也为真。户和9 两者均为假或均为真时，这一命题为假。
  令户和9 为命题。户和49 的异或(用 户弗g 表示)是一个命题。当 户和ge 中只有-一个为
真时命题为真，否则为假。
两个命题异或的真值表如表 1-4 所示。

1.1.3 条件语和铝
下面讨论其他几个重要的命题组合方式。
加 令户和9为命题。条件语句 p-9 是命题“若 p，则 o”。当 户为真而 9 为假时， 条件语
名 闫~9 为假，否则为真。在条件语句 户-qd 中，妃称为假设(或前项、前提)，9 称为结论(或推论) ，
asejeaoreni: 称语句 户一9 为条件语句，是因为 ~>g 可以断定在条件 户成立的时候 9 为真。 条件语句
也称为蕴含。

 



--- 第 22 页 ---
4 "第1章 基础: 逻辑和证明

条件语句 六~d 的真值表如表 1-5 所示。注意，当刀和9 都为真，或者当户为假(与9 的真值无
关)时，户一4 为真。

表1-4 两命题异或的真值表           表1-5 条件命题 p 一4 的真值表

 

由于在数学推理中许多地方会用到条件语句，因此表示 户-一9 的术语很多，下面是常用的
几个:

“。“如果 户，那么 9     *“户草含g”

*““如果畏，则四       "。 “9g仅当尹”

"“尹是9 的充分条件”    ““g 的充分条件是户”
*。 "9 如果疡”             " “9每当户”

*。“当刀则97”        “ “9是思的必要条件”
*。“户的必要条件是g”     *““9g 跟随加"

"““9，除非?加

为了便于理解条件语句的真值表，可以将条件语名想象为合同或义务。例如，许多政治家在

竞选时都许诺，                  ，

“如果我当选了，那么我将会减税。”
如果这个政治家当选了，选民将期望他能减税。进一步地，如果这个政治家没有当选，那么选民
就无法指望他能减税，尽管这个人也许有足够的影响力可令当权者减税。只有在该政治家当选但
却没有减税的情况下，选民才能说政治家违背了竞选诺言。这种情形对应于在 问一g 中卫 为真但q
为假的情况 。

类似地，考虑教授可能作出的如下陈述;

“如果你在期末考试得了满分，那么你的成绩将被评定为 A。”
如果你设法在期末考试得了满分,那么你可以期望得到 A。如果你没得到满分，那么你是否能得
到 A 将取决于其他因素。然而，如果你得到满分，但教授没有给你 A，你会有受骗的感觉。

许多人对"关仅当9 ”与“如果 训，那么 g”表示同一意思感到有些不解。要理解这一点，请记住，
“户仅当9"说的是当9不为真时户不能为真。也就是说，如果 户为真但9 为假，则这个语句为假。
当力为假时，9 或者为真，或者为假，因为语句并没有谈及 9 的真值。人们常犯的一个错误是用“ec
仅当思"来表达 户一9。然而，当户和9 有不同的真值时，这两个语句有不同的真值。

“除非”这个词经常用于表达条件语句。例如“9g，除非]加，意思是如果 ”户是假的，则 9 必是
真的。也就是说，当尹为真，9 为假时，语句“g，除非”加是假的，否则是真的。因此,“9，除非
nt"与户一9总是有相同的真值。

例7 说明了条件语句与中文语句之间的转换。

例7 令为语句"玛利亚学离散数学”，4 为语句“玛利亚将找到好工作”。用中文表达语名
户一q。

攻下 解 ”从条件语句的定义我们得知，当 妨为语句“玛利亚学离散数学”，9 为语句*玛利

  亚将找到好工作”时，z~>9 代表了语句

“如果玛利亚学习离散数学，那么她将找到好工作。?”
还有许多其他表述方法来表达这个条件语句。其中大多数自然的是:
“玛利亚学离散数学时，她将找到一份好工作。.”



--- 第 23 页 ---
第1章 基础: 运辑和证明。5

“玛利亚为了得到一份好工作，她需要学离散数学。
以及
“玛利亚将找到一份好工作，除非她不学离散数学。”         固
注意我们定义条件语句的方法比其汉语陈述更加通用。比如，在例 7 中的条件语句，又如
语句
“如果今日天晴，那么我们将去海滩。”
中有假设和结论之间的联系，这是一般语言中的语句。而且除非玛利亚学离散数学但没有找到好
工作，以及除非今日的确天畏但我们不去海滩，和否则上述语句总是成立。另一方面，语名
“如果今天是星期五，那么 2十3一5。”
总是成立的，因为它的结论是真的(于是假设部分的真值不起作用)。条件语句
“如果今天是星期五，那么 2十3一6。”
是除星期五以外天天成真，尽管 ?十3=6 为假。
在自然语言中，我们不会使用最后这两个条件语句(除非偶尔在讽刺中用到)，因为其中的假
设和结论之间没有什么联系。在数学推理中我们考虑的条件语句比语言中使用的要广泛一些。条
件语句作为一个数学概念不依赖于假设和结论之间的因果关系。我们关于条件语句的定义规定了
它的真值，而这一定义不是以语言的用法为基础的。命题语言是一种人工语言，这里为了便于使
用和记忆，才将其类比于语言的用法。
许多程序设计语言中使用的 ithen(如果-那么)结构与逻辑中使用的不同。大部分程序设计语
言中都有证户then S 这样的语句，其中户是命题而S 是一个程序段(待执行的一条或多条语句) 。当
程序的运行遇到这样一条语句时，如果 户为真，就执行 S; 但若户为假，则 S 不执行。下面的例子
说明这一点。
例8 若执行语句
证2十2一4 then 工:一工十1
之前，z一0，执行以后的值是什么? (符号 :一代表赋值，语句 zx :一x二1 表示将 zx十1 的值赋

给 z。)
解 因为2十2一4为真，所以赋值语句 zx :一zx十1 被执行。 因此，在执行此语句之后，z 的值
是0十1一1。                                              [|
逆、倒置与反

由条件语句 户~9 可以构成一些新的条件语句。特别地，产生有 3 个相关的条件语句，通常它
们拥有特殊的名称。命题 4一请称为户一9 的北蕴含，而 户-=g 的倒置蔓含是命题gp。命题
pp一9 称为请一9的反冀含。我们会发现，3 个由请->q 衍生的条件语句中，只有倒置芍含和
六一9 总是有相同的真值。

我们首先看到，与 娟一 有相同真值的是倒置蕴含q 一)。注意，只有当- 为假且ng 为真，
即 户为真且9 为假时，该倒置蕴含为假。现在我们确定，无论 请和4 的真值如何，逆g ~请和反蕴
含4一”户与原萄含户一4 都没有相同的真值。注意，当 户为真g 为假时，原区含命题为假，而逆
命题和反命题都为真。

当两个复合命题总是具有相同真值时，我们称之为等价。因此一个条件语句与它的倒置等价，
一个蕴含的逆区含与反蕴含也是等价的，读者可以验证这一点，但它们都不与原条件语句等价
(1.2 节将介绍等价命题) 。一个常见的逻辑错误是假设一个条件语句的逆列含和反蕴含等价于这个
条件语句。

例 9 说明蕴含的用法。

Re 例9 找出如下语句的倒警芍含、闭蕴含和反蕴含，
“每当下十时，主队就能获胜。.”
解 ”因为“9每当思"是表达语句 户一9 的一种方式，原始语句可以被改写为;
“如果下雨，那么主队就能获胜。”



--- 第 24 页 ---
6"*第1章 基础: 逻辑和证明

因此，这个列含的倒置列含是
“如果主队没有获胜，那么没有下雨。

道荀含是
“如果主队获胜，那么下雨了。”
反芍含是
“如果没有下雨，那么主队没有获胜。”
其中只有倒置荀含等价于原始语句。
双条件语名

下可们介绍机个合古具有相丫真仁的复合命题的另外一 一种表达方式。
全习 令 P和3为命题。双条件语句 六+**g是命题“户当且仅当g”。当请和9 有同样的真值
时，  双条件语句为真，  否则为假。双条件语句也称为双兹含。
记**9 的真值表如表 1-6 所示。注意，双草含
记*9 恰在户一9 和9一户两个芍含均为真，以及均
为假时为真。因此，我们用*当且仅当?来表示这一
逻辑联接词，并且在符号书写时把符号二和一结合
起来。一般还有一些其他方式表达 户<9:
“轧是9 的充分必要条件”，
“如果 户那么g9; 反之亦然”，
“旋当且仅当g?”。
双条件语句的最后一种表示方式可以用缩写符号“if代替“当且仅当”。注意， eg 与(pp-o)人
(9q9一力有完全相同的真值。
例10 令户为语句"你可以坐飞机”，令 9 为语句“你买机票了"。则 户**g9 为语句
“你可以坐飞机当且仅当你买机票了。”
本  若记和9 均为真或均为假，此语句为真。也就是说，如果你买机票了就能坐飞机，或
是如果你没买机票就不能坐飞机。当户和9 有对立真值时，此命题为价，也就是说，
当你没买机票但却能坐飞机时(比如你获得一次免费旅行)或当你买了机票却不能坐飞机时(比如航
空公司拒绝你登机) 。                                               [|
双条件的隐含应用
你应该意识到，在自然语言中，双条件并不总是显示的。特别是在双条件中使用的“当且仅
当”结构在普通语言中很少用。通常用如果，那么?或“仅当”结构来表示双殖含,“当且仅当”的另
一部分是隐含的。例如，考虑这个自然语句“你吃完饭才可以吃餐后甜点"。它意味着“你可以吃餐
后甜点当且仅当你吃完饭”，这个语句逻辑等价于“如果你吃完饭，那么你可以吃餐后甜点"和“你
可以吃餐后甜点，仅当你吃完饭”。后面这个语句在逻辑上等价于两个语句，一个是“如果你吃完
饭，那么你可以吃甜点”，另一个是“仅当你吃完了饭，你才能吃甜点.”由于自然语言的这种不精
确性，我们需要对自然语言中的条件语句是否降含它的逆做出假设。因为数学和逻辑注重精确，
所以我们总是区分条件语句 请一9 和双条件语句户汪9。

1.1.4 复合命题的真值表
:plain 现在已经介绍了 4 个重要的逻辑联接词一一合取，析取，条件，双条件，还有否定。
” ” 我们可以用这些联接词包括一些命题变元构造结构复杂的复合命题。我们可以按照例
11 中阐明的方法，用真值表来决定这些复合命题的真值，用一个分栏来决定在这个复合命题中出
现的每个复合表达式的真值。由每个命题变元的真值组合成的复合命题的真值在最后一栏中表示 。
例11 构造复合命题 (pvV-9)~(Ad)的真值表。
解 ”因为真值表涉及 2 个命题变元 训和9q，因而此表有4 行，对应 4 种真值组合 TT、TF、FT
和FF。前两列分别表示 户和9 的真值。第三列为上4 的真值，以此决定在第 4 列中 Vane 的真值。

 

表 1-6 双列含 p**d 的真值表

 



--- 第 25 页 ---
第1章 基础: 运辑和证明 "7

亡人ad的真值在第 5列。最后，(bV-9)一(人9)的真值在最后一列。真值表的结果如表 1-7 所示。国
表1-7 复合命题(pVn9)一(人9)的真值表

 

1.1.5 逻辑运算符的优先级

使用目前为止学到的否定运算符和边辑运算符，可以构造复合命题。一般地，我们使用括号
来指明复合命题中的逻辑运算符的顺序。例如，(pVvVg)A(nr)是训Vo和=r的合取。然而，为了
减少括号的数量，我们指定否定运算符在其他所有逻辑运算符前执行。这意味着上aAe是如和4
的合取，即(zt) Ag，而不是户和aq 的合取的否定，即 ](记人A9) 。

另一个常用的优先级规则是合取运算符优先于析取运算
符，因此 训AdqgVr意味着(户人Ad) Vzr，而不是户A(qVr)。
因为这个规则不太好记，所以我们将继续使用括号来区别析
取运算符和合取运算符的顺序。

最后，一个已被接受的规则是条件运算符和双条件运算
符的优先级低于合取和析取运算符。因此，bVgr等同于
(pyVag)一r。当涉及条件运算符和双条件运算符时，我们也
将使用括号，尽管条件运算的优先级高于双条件运算。
表 1-8 显示出各种逻辑运算符的优先级。

1.1.6 翻译语句
有许多理由需把语言翻译成由命题变量和逻辑联接词组成的表达式，特别是因为语言(包括一
切人类语言)常有二义性，而把句子译成逻辑表达式可以消除歧义。注意，做这种翻译也许要在句
子含义的基础上做些合理的假设。此外，一旦我们完成了从句子到逻辑表达式的翻译，我们就可
以分析这些逻辑表达式以决定它们的真值。我们还可以对它们进行处理，并用推理规则(参见 1.5
节)对它们进行推理。
为说明把语句翻译成逻辑表达式的过程，考虑下面两个例子。
例12 怎样把下面的句子翻译成届辑表达式?
“只有你主修计算机科学或不是新生，才可以从校园网访问因特网。”
0 解 ”翻译这一句子为逻辑表达式有许多方法。可以用一个命题变元，例如 这来表示这
   一句子，但在分析其含义或用它做推理时，这种表示不会有什么作用。我们的办法是
用命题变元表示其中的每一个句子成分，并找出其间合适的逻辑联接词。具体地说，令 ce、c 和上了
分别表示“你可以从校园网访问因特网”"、“你主修计算机科学?和*你是个新生”。注意到“只有……-
才……”是表达条件语句的一种方式，上述句子可以译为
a->(cVD亡                         [
例13 怎样把下面的句子翻译成还辑表达式?
“除非你已满 16 周岁，否则只要你身高不足 4 英尺就不能乘公园滑行铁道游乐车.>”
解 令9g9、-r和* 分别表示“你能乘公园滑行铁道游乐车”"、“你身高不足4英尺”和“你已满 16
周岁”，则上述句子可以翻译为

表1-8 远辑运算符的优先级

 

(CrAD5s) 一9

日 1英尺=王30. 48 厘米。一一译者注



--- 第 26 页 ---
34 "第1章 基础: 远辑和证了明

当然，还有其他方式可以把上述句子表示为导辑表达式，但上面使用的这一表达式已满足我
们的需要 。                                                           国

1.1.7 系统规范说明

在说明硬件系统和软件系统时，将自然语言语句翻译成巡辑表达式是很重要的一部分。系统
和软件工程师从自然语言中提取需求，生成精确、无二义性的规范说明，这些规范说明可作为系
统开发的基础。例 14 说明如何在这一过程中使用复合命题。

例14 使用逻辑联接词表示规范说明"当文件系统满时，自动应答不能够发出”。

ES 。 解  翻译这个规范说明的方法之一是令 户表示“自动应答能够发出”，令 g 表示“文件系
统满了”，则>”思表示”“自动应答不能够发出"。因此，题中的规范说明可以用条件语句
9一=-户来表示 。                                                    屋

这些系统规范说明应该是一致的，也就是说，系统规范说明不应该包含有冲突的需求。当规
范说明不一致时，无法开发出满足所有规范说明的系统。

例1s 确定下列系统规范说明是否一致 :

“诊断消息存储在缓冲区中或者被重传。”

“诊断消息没有存储在缓冲区中。?”

“如果诊断消息存储在缓冲区中，那么它被重传。

解”要判断这些规范说明是否一致，我们首先用逻辑表达式表示它们。今 训为“诊断消息存储
在缓冲区中”，令 9 表示“诊断消息被重传”。则上面几个规范说明可以写为 mVqg，5Dp和尹一4。使
所有三个规范说明为真的一个真值赋值必须有 为假使?为真。因为我们要使 pVg 为真，但
必须为假，9 必须为真。由于当思为假且9 为真时，z 一9 为真，我们得出结论这些规范说明是一
致的，因为当思为假且4 为真时它们都是真的。使用一个真值表检验有关卢和4 的真值的四种可能
赋值，我们可以得出同样的结论。                                       国

例 16 如果在例 15 中加上一个系统规范说明*诊断消息不被重传"，它们还能保持一致吗?

解 由例15 可知，只有当户为假且9 为真时那三个规范说明才为真。然而，本例中的新规范
说明是g，当 4 为真时它为假。因此，这四个规范说明不是一致的。                 国

1.1.8 布尔检索
1 逻辑联接词广泛用于大量信息检索中，例如， 检索网页索引。由于这些检索使用来自
”命题逻辑的技术，所以称为布尔检索。

在布尔检索中，联接词 AND 由于匹配包含两个检索项的记录，联接词 OR 用于匹配两个检索
项之一或两项均匹配的记录，而联接词 NOT(有时写作 AND NOT)用于排除某个特定的检索项。
当用布尔检索为有潜在价值的信息定位时，常需要细心安排逻辑联接词的使用。下面的例子说明
布尔检索是怎样执行的。

… 例17 网页检索。大部分网上搜索引擎支持布尔检索技术，它有助于找到有关特定主

题的网页。例如，要用布尔检索找出关于新墨西哥州(New Mexico)各大学的网页，我

们可以寻找与NEW AND MEXICO 4AND UNIVERSITIES 匹配的网页，检索的结果将包括含
NEW(新)、MEXICO(墨西哥)和 UNIVERSITIES(大学)三个词的那些网页。这里面包含了所有我
们感兴趣的网页，还包括其他网页，例如有关墨西哥的新大学的网页。另一例子是，要找出与新
墨西哥州或亚利桑那州(Arizona) 的大学有关的网页，我们可以检索与(NEW AND MEXICO OR
ARIZONA)AND UNIVERSITIES 匹配的网页。(注意，其中联接词 AND 优先于联接词 OR .)这一
检索的结果将包括含 UNIVERSITIES 一词和 NEW 与 MEXICO 两词的所有网页及含
UNIVERSITIES 一词和 ARIZONA 一词的所有网页。同样除这两类我们感兴趣的网页外还会列出
其他网页。最后，要想找出有关墨西哥(不是新墨西哥州)的大学的网页，可以先找与 MEXICO
JWND UNIVERSITIES 匹配的网页， 但由于这一检索的结果将会包括有关新墨西哥州的大学的网
页以及墨西哥的大学的网页，所以更好的办法是检索与(MEXICO AND UNIVERSITIES) NOT



--- 第 27 页 ---
第1章 基础: 逻辑和证明 "9

NEW 匹配的网页。这一检索的结果将包括含 MEXICO 和 UNIVERSITIES 两个词但不含词 NEW
的所有了网页。在一些搜索引擎中，词 NOT 会被减号所代替，因此最后搜索的短语会是 MEXICO
UNIVERSITIES-NEW。                                                                                                国

1.1.9 逻辑难题

二卫5 可以用逻辑推理解决的难题称为逻辑难题。求解远辑难题是实践逻辑规则的一种好方
卫生”法。同样，设计用于执行逻辑推理的计算机程序通常也使用著名的逻辑难题来演示它
们的能力。许多人对求解逻辑难题感兴趣 ，有许多书和杂志也登载逻辑难题以供娱乐。

在此我们将讨论两个逻辑难题。首先介绍一个由逻辑学家和难题制作大师 Raymond Smullyan
提出的难题，Smullyan 已经出版了十多本与旬辑难题(涉及逻辑推理)有关的书。

RE  例18 Smullyan[LSm78]中提出了许多与如下情形有关的难题: 一个岛上居住着两类
人一一骑士和流氓。骑士说的都是实话，而流氓只会说谎。你磁到两个人 4 和吾，如
果 A 说*电是骑士*，召说“我们两人不是一类人”。请判断4A、刀两人到底是流训还是骑士。

解 令户和9 分别表示语句“A 是骑士?和“也 是骑士">，则 ]户和 9 分别表示“A 是流让>和*BB
是流吝”。

我们首先考虑 A 是骑士的情形，这就是说 尹是真的。如果A 是骑士，那他说“B 是骑士>就是
真话，因此4 为真, 4 和时就是一类人。但是，如果避是骑士,那么 日说的话应该为真，即
(户人Ag) V (nA9)为真，然而却并非如此，因为A和昌都是骑士。因此，我们可以得出A不是骑
士，即 请为假。

如果A 是流氓，则据题目可知 A 所说的“是骑士?就不是真话，这意味着 g 为假且忆也是流
氓。而县，如果妃是流总,那么 也说的话也是假的,这与A和了 都是流谍是一致的。所以，我们
得出结论A 和昌都是流氓。                            国

在本节末的练习 28一30 中，我们会进一步讨论 Smullyan 关于骑士和流氓的难题。接下来，我
们介绍一个与两个孩子有关的“泥巴孩子难题”muddy children puzzle) 。

例 19 父亲让两个孩子(一个男孩，一个女孩)在后院玩于，并让他们不要把身上搞脏。然而，
在玩的过程中，两个孩子都在额头上沾了泥。当孩子们回来后，父亲说“你们当中至少有一个人额
头上有泥”，然后他问每一个孩子“你知道你额头上有没有泥蚂?”同样的问题对每个孩子都问了两
遍。假设每个孩子都可以看到对方的额头上是否有泥，但不能看见自己的额头，孩子们将会怎样
回答呢? 假设两个孩子都很诚实并且都同时回答每一次提问。

解 令:和dz 分别表示语句“儿子的额头上有泥?"和"女儿的额头上有泥?。当父亲说“你们当中
至少有一个人额头上有泥”时，表示的是sVd 为真。当父亲第一次问那个问题时两个孩子都将回
答"不知道*，因为他们都看到对方的额头上有泥。也就是说，儿子知道 & 为真，但不知道 * 是否为
真。而女儿知道 * 为真，但不知道@ 是否为真。

在儿子对第一次询问回答“不知道?5后，女儿可以判断出 d 必为真。这是因为问第一次问题时，
儿子知道 *V ad 为真，但不能判断 *是否为真。利用这个信息，女儿能够得出结论 d 必定为真，因
为如果 4 为假，儿子有理由推出，由于 sVd 为真，那么 * 必定为真， 因此他对第一个问题的回答
应为"知道”。儿子也可以类似推断出 * 必为真。因此，第二次两个孩子都将回答“知道”。     |

1.1.10 逻辑运算和位运算
:了:: 计算机用字位表示信息，每个字位有两个可能的值，即 0 和 1。字位的这一含义来自二
“”  ， 进制数字，因为0 和1 是用在数的二进制表示中的数字。1946 年著名的
统计学家图基(John Tukey)引入了这一术语。字位可以用于表示真值，因为只有
两个真值，即责与假。习惯上用 1 表示真，用 0 表示假。也就是说，1 表示 工  T
〈真)，0 表示 F(假) 。若变量的值或为真或为假，则此变量称为布尔变量。于是一  中本
个布尔变量可以用一个字位表示。
计算机的字位运算对应于逻辑联接词，只要在运算符人A 、V 和全的真值表中用 1 代替熙,用0



--- 第 28 页 ---
10*第1章 基础: 逻辑和证明

代替 FE，就能得到表 1-9 所示的对应的字位运算表。我们还将用符号 OR、AND 和 XOR 表示运算
符V、A和旨，许多程序设计语言正是这样表示的。
信息一般用位串表示，也就是用0 和 1 的序列表示。这时，对位串的运算即可用来处理信息。

表1-9 字位运算符 OR、AND 和 XOR 的真值表

 

 位事是 0 个或多个字位的序列。位串的长度就是它所含的字位的个数。
例20 101010011 是长度为 9 的一个位串。                                                     |
我们可以把字位运算扩展到位串上。我们在长度相同的两个位串上定义它们的按位 OR、按位
AND 和按位 XOR 分别为这样的位串，其中每个字位均由被运算的两个位串对应字位经 OR、AND
和 XOR 运算而得。我们分别用符号 V 、A 和全表示按位 OR、按位 AND 和按位 XOR 运算。我们
用下面的例子解释对位串的这些按位运算。
例21 求位串 01 1011 0110 和 11 0001 1101 的按位 OR、按位 AND 和按位 XOR(这里以及本
书其他地方均把位串按 4 位分块以便于阅读) 。
解 ”这两个位串的按位 OR、按位 AND 和按位 XOR 分别由对应字位的OR、AND 和 XOR 得
到，其结果是
01 1011 0110
11 0001 1101
11 1011 1111 按位 OR
01 0001 0100 ”按位 AND
10 1010 1011 按位 XOR

[

练习
1. 下列哪些语句是命题? 这些是命题的语句的真值是什么?

a)波士顿是马萨诸塞州首府。             b)迈阿密是佛罗里达州首府。

c)2十3一5。                          d)5十7一10。

e)z十2一11。                         多回答这一问题。
2. 下列各命题的香定是什么?

a)今天是星期四。                      b)新泽西没有污染。

c)2十1一3。                          d)缅因州的夏天又热又晒。

K

. 令户和9 分别表示命题“在新泽西海岸游泳是允许的”和*在海岸附近发现过获鱼"。把下列各复合命题表达
为汉语句子:
a)D9             b)访Ag           c)D访V9          d)妨一9
e)Q 一访          全有庆一”9         名)户+*9          hb)如人(PPVn9)
4. 令户、 4为如下命题:
记: 气温在零度以下 。
9: 正在下雪。
用请、g 和逻辑联接词写出下列各命题;
a)气温在零度以下且正在下雪。
b)气温在零度以下，但没下雪。
c)气温不在零度以下，也不下雪。
d)也许在下雪，也许在零度以下(也许两者在内) 。



--- 第 29 页 ---
Co

第1章 基础: 逻辑和证明。11

e)若气温在零度以下，那也就在下雪 。
人也许气温在零度以下，也许在下下，但如果在零度以下，就不在下要。 ，
g)气温在零度以下是下雪的充分必要条件。

.今记0 为如下命题;

户: 你的车速超过每小时 65 英里(1 英里一1.6 公里) 。

4: 你接到一张超速罚单。

用 p、9 和逻辑联接词写出下列命题:

a)你的车速没有超过每小时 65 英里。

b)你的车速超过每小时 65 英里，但没接到超速罚单 。

c)你的车速若超过每小时 65 英里，将接到一张超速罚单。

d)你的车速不超过每小时 65 英里，就不会接到超速罚单。

e)车速超过每小时 65 英里足以接到超速罚单 。

f你接到一张超速罚单，但你的车速没超过每小时 65 英里。
8g)只要你接到一张超速罚单，你的车速就超过每小时 65 英里。

- 令户、9、r为如下命题:

户: 在这个地区发现过灰熊。

9: 在小路上徒步旅行是安全的。

r: 小路两旁的草莓成熟了。

用 、9、r 和逻辑联接词写出下列命题:

a)小路两旁的草莓成熟了，但在这个地区没有发现过灰熊。

b)在这个地区没有发现过藉能，且在小路上徒步旅行是安全的，但小路两旁的草花成熟了。

c)如果小路两旁的草莓成熟了，徒步旅行是安全的当且仅当在这个地区没有发现过灰熊。

d)在小路上徒步旅行不安全，但在这个地区没有发现过灰熊且小路两旁的草花成熟了。

e)为了使在小路上旅行很安全，其必要条件(但并不充分)是小路两旁的草莓没有成熟且在这个地区没有发
现过灰熊。

缚无论何时在这个地区发现过灰熊且小路两旁的草莓成熟了，在小路上徒步旅行就不安全。

,判断下列各条件语句是真是假，
a)若 1十1一2，则 2十2一5。           b)若 1十1=3，则 2十2一4。
c)若 1十1一3，则 2十2=5。            d)若猴子会飞，那么 1十1=3。

. 下列各语句，判断其中想表达的是同或还是异或，说明理由:

a)晚筑有咖啡或者茶。

b)关键词一定至少要有 3 个数字或至少 8 个字符长。
c)这个课程的必要条件是数论课程或者是密码课程。
d)你能用美元或者欧元。

- 对下列各语句，说一说其中的或是同或(即析取)与异或时它们的含义。你认为语句想表示的是哪个或?

a)要选修离散数学课，你必须已经选修微积分或计算机科学的一门课。

b)从 Acme 汽车公司购买一部新车 ，你就能得到 2 000 美元现金回扣，或 2%的汽车贷款。
c)两人套餐包括 A 列中的两项或 B列中的三项。

d)若下雪超过两英尺或寒风低于一100，学校就停课。

10. 把下列语句写成“如果 户，那么 9”的形式。[提示: 参考本节列出的通常表达条件语句的方式。]

a)吹东北风的时候就下雪。

b)暖天持续一周苹果树就开花。

c)活塞队赢得冠军就意味着他们打败了湖人队。

d)必须走 8 英里才能到朗斯峰的顶峰。

e)要得到教授职位，世界闻名就够了 。

们如果你驾车超过 400 英里，就需要买汽油了。

g)只有你购买的 CD 机不超过 90 天，你的保修单才有效。
h)除非水太凉了，和否则 Jan 将去游泳 。



--- 第 30 页 ---
12。第1章 基础: 逻辑和证了明

11I.

12，

13，

16.

17.

19.

把下列命题写成*户当且仅当4"的形式:
a)如果外边热你就买冰激凌;如果你买冰激凌，外边就热。
b)你赢得竞赛的充分必要条件是你有那唯一的获胜券。

<c)?只有你有关系才能得到提拔，只有得到提拔你才有关系。

d)如果你看电视，记忆会衰退:反之亦然。

e)火车恰在我乘坐的那些日子晚点。

给出下列各条件语句的逆命题、逆否命题和和否命题:

a)如果今天下雪，我明天就去滑雪。

b)只要有测验，我就来上课。

c)只有当正整数没有 1 和它自己以外的因数时，它才是素数。
下列各复合命题的真值表显示有多少行?

a)户一下力                            b)(CpVanr)A(CeVD5)
c)4gV户VSVDrVnTIVY                d)(态ArAt)r(9gAt)
. 为下列各复合命题构造真值表 :
aa)户全户                  b)户VD户                  c)(户VD9) -0
d)(记Va)一(户人q)          e)(访一g)*(D9一门户)        人(轧一q)一(9一力)
,. 为下列各复合命题构造真值表 :
a)(phVvVad)一(户由o)          b) (户息q) 一(户人9)          cpVvgq)四(pq)
dpr9g)中(关9)         e)(户-9)申(5户当门        人(户外co) 一(由9)
为下列各复合命题构造真值表 ，
a)访一9                  bp                  Cc)(力一9) V (门户一9)
d)(户-=g) 人(户-9)         e) (户-g) V (-户->g)         人(png)-(b<g)
为下列各复合命题构造真值表
引)户一(9GV 大               b)户一(9一三)              c)访一9) VD户一rr)
d)(户一g) 人(户一方         e)(记+*>g)V (DG+er)          上全(六二站9) (ge六
. 构造(pp**dq)汪(re*s)的真值表。
求下列各对位串的按位 OR、按位 AND 及按位XOR :
a)101 1110，010 0001                    b)1l11il 0000，1010 1010
c)00 0111 0001，10 0100 1000             d)11 1111 1111，00 0000 0000

模糊去辑可用于人工智能。在模糊逻辑中命题的真值是介于 0 和 1(包括 0 和1)之间的数。以 0 为真值的

命题为假，以 1 为真值的命题为真。0 和 1 之间的真值表示不同程度的真值。例如，语句“傅雷德是幸福的”
的真值可以是 0.8，因为傅雷德大部分时间是幸福的; “约翰是幸福的”的真值可能是 0.4，因为他幸福的时间
比一半稍短。

20，
21.

#22.

23.

24.

模糊馆辑中命题否定的真值是 1 减去该命题的真值。语句“传雷德不幸福"和“约翰不幸福”的真值是什么?
模糊逻辑中两个命题的析取的真值是两个命题真值的最大值。语句“传雷德幸福或约翰幸福”与“传雷德不
幸福或约翰不幸柱"的真值是什么?

在一个 100 条语句的列表中，第条诸句是“在这个列表中,恰有条语句为假。”

a)从这些语句中你可以得出什么结论?

b)若第?条语句是“在这个列表中，至少有?条语句为假*，回答问题 a) 。

c)假设这个列表包含 99 条语句，回答问题 b) 。

边远村庄的每个人要么总说真话，要么总说谎。对旅游者的问题，村民要么回答“是”"，要么回答“不"。
假定你在这一地区旅游，走到了一个岔路口，一条岔路通向你想去的遗址，另一条岔路通向从林深处。
此时恰有一村民站在岔路口，问村民什么样的一个问题就能决定走哪条路?

使用命题 如扫描消息中的病毒"和 9消息来自一个未知的系统"以及逻辑联接词来表达下列系统规范说明 。

a) “每当消息来自一个未知的系统时，就扫描消息中的病毒”

b) “消息来自一个未知的系统，但不扫描消息中的病毒.”

c) "每当消息来自一个未知的系统时，就有必要扫描消息中的病毒."

d) “当消息不是来自一个未知的系统时，就不扫描消息中的病毒。”



--- 第 31 页 ---
第1章 基础: 运辑和证明。13

25. 下列系统规范说明-一致吗?

“当且仅当系统正常操作时，系统处于多用户状态。如果系统正常操作，则它的核心程序正在运行。

核心程序不能正常运行，或者系统处于中断模式。如果系统不处于多用户状态，它就处于中断模式。系
统不处在中断模式。

26. 下列系统规范说明一致吗?

“路由器能向边缘系统发送分组仅当它支持新的地址空间时。要让路由器支持新的地址空间，就必须
安装最新的软件发布。如果最新的软件发布被安装了，路由器就能向边缘系统发送分组。路由器不支持
新的地址空间。”

27. 你会用什么样的布尔检索来寻找关于新泽西州海滩的网页”如果你想找关于泽西岛(在英吉利海峡海滩
的网页呢?
练习 28一30 是关于 Smullyan 的趣味逻辑的。一个岛上居住着两类人， 骑士和流误。骑士说的都是实话，

而流让只会说谎。根据下列不同情况判断 A、忆两人到底是流总还是骑士，如果认为得不出最终结论的，也

请说出任何可能的结论。

28. A 说:“我们之间至少有一个是流滤"，B 什么都没说。

29. A 说;“我是流让或者 日是骑士"，忆什么都没说。

30. A 说:“我们都是流让"，了什么都没说。
练习 31~33 是逻辑难题，解题时可以先把语句翻译成逻辑表达式，再用走值表从这些表达式作推理。

31. 斯蒂夫想用两个事实来判断三位工作伙伴的相对务水。首先他知道如果傅雷德的务水不是三人中最高的，
那么杰尼斯的最高。其次他知道如果杰尼斯的薪水不是最低的，那么麦吉的最高。从以上斯蒂夫知道的
事实，有可能决定传雷德、麦吉和杰尼斯的相对薪水吗? 如果能，谁的最高，谁的最低? 解释你的推理。

32. 侦探调查了罪案的四位证人。从证人的话侦探得出的结论是 如果男管家说的是实话，那么厨师说的也
是真话，司师和园丁说的不可能都是真话， 园丁和杂役不可能都在说谎，如果杂役说真话，那么厨师在
说谎。侦探能判定这四位证人分别是在说谎还是在说真话吗? 解释你的推理。

*33. 试求解下面这个由爱因斯坦提出的著名的逻辑难题(也称为斑马难题)。5 个不同国家目工作各不相同的
人分别住在一条街上的 5 所房子里，每所房子的颜色不同，每个人都有自己养的不同的宠物，喜欢喝不
同的饮料。根据以下提示，你能告诉我哪所房子里的人养班马(zebra) ，哪所房子里的人喜欢喝矿泉水吗?
全吕英国人住在红色的房子里。西班牙人养了一条狗。日本人是一个油漆工。意大利人喜欢喝茶。氛
威人住在左边的第一个房子里。绿房子在白房子的右边。摄影师养了一只蜗牛。外交宜住在黄房子里。
中间那个房子里的人喜欢喝牛奶。喜欢喝咖啡的人住在绿房子里。挪威人住在蓝色的房子旁边。小提琴
家喜欢喝橘子汁。养狐狸的人所住的房子与医师的房子相邻。养马的人所住的房子与外交官的房子相邻。
[提示， 绘一张表，其中行表示每个人，列表示他们所住的房子的颜色、他们的工作、他们养的宠物以及
他们喜欢喝的饮料，用逻辑推理来判断表中正确的项.]

1.2 命题等价

1.2.1 引言

数学证明中使用的一种重要方法是用真值相同的一条语句取代另一条语句。因此， 在构造数
学证明时广泛使用从已知复合命题产生具有同样真值的其他命题的方法。注意， 我们将用术语“复
合命题"来解释由用于多辑运算的命题变元形成的表达式，比如 入9。

我们就从根据可能的真值对复合命题进行分类开始讨论。

 复合命题称为永真式(或重言式)，如果无论其中出现的命题的真值是什么，它的真值
总是真。真值永远为假的复合命题称为了矛盾。最后， 既不是永真式又不是矛盾的命题称为可能式。

在数学推理中永真式和了矛盾往往很重要，下面的例 1 解释了这两类复合命题。

例1 我们可以只用一个命题构造永真式和      表 1-10 永真式和矛盾的例子
矛盾。pVnzb和户人ADz的真值表如表 1-10 所
示。因为 VD户总是真，所以它是永真式。因
为 训A-妃总是假，所以它是矛盾。    国

 



--- 第 32 页 ---
14 "第1章 基础: 逻辑和证明

1.2.2 竖辑等价
: 在所有可能的情况下都有相同真值的两个复合命题称为运辑等价。我们也可以如下定
0 文这一概念。

ER如果 9是永真式，命题 和9 称为是远辑等价的。记号 pz二9表示如和9逻辑等价。
注意，特号三不是逻辑联接词，因为 =g 不是复合命题，而语句 eg是永真式。符
号名有时用来代替和表示等价。

区 判定两个命题是否等价的方法之一是使用真值表。特别     表1-11 德摩根定律

    地，命题靖和49 等价当且仅当给出它们真值的两列完全        npPAo)=]pVa5e
一致。例 2 建立了一个非常重要且有用的逻辑等价，即”(户V 9)或
”bpA-9，用以说明这个方法。这个逻辑等价是两大德摩根律之一，

如表 1- 11 所示。这是用 19 世纪中叶英国数学家德摩根(Augustus De Morgan)的名字命名的。

例2 证明1CpV9q)和ppAnd 有逻辑等价。

解 ”表1-12给出了这些复合命题的真值。由于对请和9 所有可能的真值组合，命题(zV 9)
和-5训A59的真值都一样，所以](pVa)**(pA人AD)是永真式，这两个命题逻辑等价。

 

nbhVg)=”力An

表1-12 (PPV9)和-pPAn9的真值表

 

例3 证明命题 -一9 和-pvV9g逻辑等价。
解 ”在表 1-13 中构造了这两个复合命题的真值表。由于pvVe和户一g的真值一致，因此它
们是逻辑等价的。

囊1-13 -pvVqg和P~9的真值表

 

重

现在，我们将建立涉及 3 个不同命题变元 训、9、r的 2个复合命题的逻辑等价。真值表需要建
立8行,每一行为 3 个变元真值的一种可能组合。列出 训、9、r 的真值来标记这些组合。这 8 种真
值组合是 TTT，TTF，TFT，TFF，FTT，FTF，FFT，以及FFF;， 我们用这个顺序显示真值表
行。注意在真值表中增加一个命题变元，我们需要用原来行数的 2 倍来展示复合命题是等价的，
这样就需要 16 行来建立由4个命题变元组成的 2 个复合命题的逻辑等价，以此类推，如果一个复
合命题由”个命题变元组成，则需要 2" 行。

例4 证明命题上V(9A和(pV9q)A(CpVvz)膛辑等价。这是析取对合取的分配律。

解 表1-14中构造了这两个复合命题的真值表。因为 mV (9A盖和(pvV9)A(pyvr)的真值一
样，它们是逻辑等价的。



--- 第 33 页 ---
第1章 基础: 运辑和证明 "15

表1-14 pVI(qAr)和(PV9)A{(pVn逻辑等价的演示

疡VCgAr)                                 (户V9)A(记Vr)

 

/               Eve | av |
工   工        工     工     工
工   工         下      工      工
工   FE         F     工     工
工   下         F      工     工
下   工        工      了     工
下   工         F      F      了
F   F         下      F      F
F   F         F      FE      F

国

表 1-15 给出了若干重要的等价关系” 。在这些等价关系中, 了表示永远为真的复合命题，F 表

示永远为假的复合命题。对于涉及条件语句和双条件语句的复合命题，我们也在表 1-16 和表 1-17
中给出了一些有用的等价关系。本节末的练习中要求读者证明表 1-15一表 1-17 中的等价关系。

表 1-15 远辑等价                          表1-16 涉及条件语句的远辑等价

等价关系                  名    称                     户-一q三六V9
六AT                     - 恒等律                     户一gg一个访
力VF三户
户VT=T                       支配律                      户V 9三站户一9
户人下=王F                                                  户人9二中(力-]9)
PVP                      守等健                     mpP9)二户人9
户人访反户
-GOp)Ep                     双非律                     〈《户一9) 人(pb一门二户>(9人r)
户V 9=9V户                     交换律                      《>r) 人(9g->r三(旋VGg)-=r
 Ag一9AP                                             《一9) V (户一门二户~(9Vr)
《(声Yg) Vr二户VI9V 站
(pAg)Ar=记人A(9Am)            结合律                      (PP V (9一门二(记A9)一
户V (9g人站三(bpVg)A(CbpVI)        分配律

疡人(9gV 门生(产Ag)V(户人六

1-17
ADE3DV39          德摩根定律        _ ”末1-17 涉及双条件的逻辑等价
=(旋V 9g)三志和人9                          户g=(户9) 人(9~户)
户V (户人9)注记            吸收律              pp
妨人(户V 9)二户
户汪9三(疡Ag)V (大人人门9)
PPV-b三T             否定律                      和
户人户三F                              了Cpere*g)二力 9

析取的结合律表明表达式 VqgVr是有定义的。因为先析取 请和49 再与r 析取或先析取9 和
再与丸 析取，其结果一样。同样,户和AgAr也是有定义的。扩展这一推理过程可以证明:
轧VtpVv…Vvp和户人思人…人思。 均有定义， 只要 思，户，…，力， 为命题。 进而可以注意到德
摩根律可以扩展为

nm人pyVnyvV…yVDzpt)三(办 如加人人…人于记)
和

(和入记和人…人人加)三(和VD V…VDD)

号 ”这些恒等式是布尔代数中恒等式的一种特殊情况。请将这些便等式与 2. 2 节表 2-21 中的集合恒等式比较一下。



--- 第 34 页 ---
16 "第1章 基础: 运辑和证了明

1.2.3 德摩根律的运用

德摩根律的两个逻辑等价式非常重要。它们告诉我们怎么去否定合取和析取。特别地，等价式
(bpVg)=1pAn9说明，析取的否定是由各分命题的否定的合取组成的。同理，等价式](户A9)=
”pvVng说明，一个合取的否定是由各分命题的否定的析取组成的。例 5 说明了德摩根律的运用。

例5 用德摩根律分别表达“迈格尔有一部手机且有一台便携式电脑"和*和希瑟或史蒂夫将去看
音乐会”的否定。

解 令少为*迈格尔有一部手机"，9 为“迈格尔有一个便携式电脑”，那么“迈格尔有一部手机
且有一台便携式电脑”可以表达为 训Ag。用德摩根第一定律，- (pp人Ag)等价于jpV59g。结果，我们
可以将原命题的否定表达为“迈格尔没有一部手机或没有一台便携式电脑”。

令 -为"希瑟将去看音乐会”，* 为“史蒂夫将去看音乐会*，那么“希瑟或史蒂夫将去看音乐会
可以表达为 ~>Vs。用德摩根第二定律，-(rVs) 反”r人Ans。结果，我们可以将原命题的否定表达为
“希瑟和史蒂夫都将不去看音乐会”。                                       器

1.2.4 构建新的逻辑等价式

表 1-15 中的逻辑等价关系以及业已建立起来的其他(如表 1-16 和表 1-17 中所示的那些)等价
关系，可以用于构造其他等价关系，原因是复合命题中的一个命题可以用与它逻辑等价的复合命
题蔡换而不改变原复合命题的真值。这种方法可由例6 至例 8 得到说明。在这些例子中，我们还使
用了如下事实: 如果户和9 逻辑等价，g 和 逻辑等价，那么 请和r 也导辑等价。

Ex 例6 证明-(记一9)和户人AD9逻辑等价。
解 ”我们可以用真值表来证明这两个复合命题是等价的(和例 4 中的方法相似)。事实

上，不必那么复杂。然而，想解释如何用我们已经知道的逻辑证明来建立新的导辑证明，要用到
大量的变元。因此，以”(Cp-=9g)开始，以请Ag 结束，每次用表 1-15 中的一个等价式，通过发展
一系列逻辑等价式的方法来建立这个等价式。我们有下列等价式。

mp一g)三(5D记Vg)         由例 3
乓(np) 人5D9         由德摩根第二定律
二户人9            由双非律                    图

例7 证明(CpV(npAd))和bpAn9 逻辑等价。

解 ”我们可用真值表证明这两个复合命题等价。不过我们不这样做，而是每次使用表 1-15 中
的一个等价关系，依次建立一串等价。从-CpV (nphAq))开始，到?p和ng结束，最终证明它们等
价。我们有下列等价关系。

=中(pV (nbAg))三户人DCD力人9)           由德摩根第二定律
捕A[n(np)Vn9g]           由德摩根第一定律
三户人(ppVDdg)             由双非律
三(D访人轧) V (D户人9)       由分配律
三了V (户人9)             由于”户人户三F
三(D户人Ag) V下              由析取的交换律
反站)娘人4                   由了的恒等律

于是(pzV(nzbpA9d))和nbAnq 逻辑等价。                                         图

例8 证明(训Ac)一(bpVga)为永真式。
解 ”为证明这个命题是永真式，我们将用有还辑等价证明它逻辑上等价于T。(注意; 这也可以
用真值表来完成。)

(旋人9) 一(户V9g)=(bA9)V(CpV9)      由例 3
=一(bpVnoV(CpVo)      由德摩根第一定律
=(nzpVvVp)V(noV9)        由析取的结合律和交换律
=TVT               由例 1 和析取的交换律

=了工                    由支配律                         国



--- 第 35 页 ---
第1章 基础: 运辑和证明 "17

真值表可以用于判定复合命题是否为水真式。对于只含少数变基的复合命题，可以用手工完
成这一工作。但当变量数目增多时，就不可行了。例如，对于含 20 个变量的复合命题，它的真值
表就有2”一1048576 行。显然，你需要一台计算机帮助你以这种方式判定含 20 个变量的复合命题
是否为永真式。但是当变量数为 1000 时，一台计算机能在一个可以接受的时间内判定复合命题是
和否为永真式吗? 要检查 2种(这是一个超过 300 位的十进制数?可能的真值组合中的每一种，一台
计算机在几万亿年之内都不可能完成。而且迄今尚没有其他已知的计算过程能使计算机在合理的
时间之内判定变量数这么大的复合命题是否为永真式。

含有两个变量的简单合取式有 户Aq，-z人9，户人9 和nm人An9。只有当刀和9 的真值都为真
时，户Ag 的真值为真; 类似地，n记和A9 为真，仅当 六为假和9 为真， 户A59 为真，仅当 畏 为真和
4 为假; 7An9 为真，仅当户和9 都为假。

例9 请写出一个命题公式，使其具有如表 1-18 所示的真值表。

表 1-18 真值表

 

对于真值表中真值为真的每一行，选择变量仅在该行所列取值时真值为真的二元合取式，将
它们用V 连接，得到的就是以这个表为真值表的命题公式。真值表中真值为真的三行对应的合取
式为ppA人Ag, pAnqg 和5pbAnq，所以该真值表的命题公式为

《户人gd) V (疡人9) V (5万人9)                     力

含有三个变量的合取式有类似的情况 。对于表 1-19 的每一行，合取式的真值为真仅当其中的

变量的取值为该行所列的变量值，否则合取式的真值为假。

表 1-19 含有三个变量的合取式情况

 
                                                                                                               

恩人唱人太
五人9人Dr
户人9从
户人ng人Dr
D户人9人
司户人Ag人Dr
PP人Am9人Ar
npAngAnr

可可相间口中
四加 口吕四本癌噩
本 虽四虽虽癌品曲

        

注意， 在表 1-19 的每一行，当一个变量的取值为假时，该变量在合取式中被否定。

 

一个合取式包含每个变量，每个变量(包括变量的否定)出现一次且仅一次，称这样
的合取式为小项。  日大了人小项的析取构成的析取式，  称为析取范式。如果 ml ，mz ，rma ，… ，mm
是小项，m V ma V ms V… V nm是析取范式。
要技到一个命题公式， 使它的真值表是给定的真值表，可以对真值表中真值为真的每一行在
表 1-19 中找到对应的合取式，将它们用V 连接。例如，要找到一个命题公式，使它的真值表如表
1-20 所示。表 1-20 中有三行真值为真，它对应的命题公式为
(户AgADmV(CpAn9ADr) VD人AAA



--- 第 36 页 ---
18。第1章 基础: 运辑和证明

这个析取式就是析取范式，其中的合取式 人AgAr, 训A人-9gAnr， npA人9人Ar为小项。
表 1-20 真值表

    

   

可可可可门口癌口|
本可门叫门梓

   

可可加门口中 口

 

可辐口四串口

类似地，析取式 V9Vr的真值为假，仅当 P, 9 和-都为假。表 1-21 列出所有三个变量的
析取式。

表 1-21 含有三个变量的析取式情况

  

 
  

户
nzVngVnr                           工                    工                     开
D六Vng9Vr                            T                    工                     下
npPVSVnmr                            工                    F                     工
phV9gVr                             T                    F                     F
声VDgVDr                            FE                    工                     工
疡VD9V                              下                    工                     F
户V9V Dr                              F                     F                     工
户V3Vr                      F               FF               F

表 1- 21 中每行的析取式，仅当变量取值为这一行所列变量值时，它的真值为假，否则它的真
值为真。 注意，当一个变量的取值为真时，该变量在对应的析取式中被否定。

号 一个析取式包含每个变量，每个变量(包括变量的否定)出现一次且仅一次，称这样
的析取式为大项。  由若干个大项的合取构成的合取式 ，称为合取范式。如果 M ，M: ，M: ，… ，ML，
是大项，M 人AM: 人M: 和人…人M, 是合取范式。

要找到一个命题公式，使它的真值表是给定的真值表，可以对真值表中真值为假的每一行在
表 1-21 中找到对应的析取式，将它们用人连接。例如，要找到一个命题公式，使它的真值表如表
1-20 所示。表 1-20 中有 5 行真值为假，它对应的命题公式为

(pvVanqymACnpVgqVnmDACPVD9qVmDACPV9VDnDACPpPV9gVD

这个合取式就是合取范式，其中的析取式pPVnmeVr，npVvaqVvVnry pvneovry pvqVnry pvaqVr
为大项。

练习
1. 用真值表证明下列等价关系。
a)户人T=三也              b)户VE一户              c)户人=了
d)访VT=T             e)访V 户三旋              乒轧A户三请
. 用真值表证明交换律。
a)记Vdqs=和dgV旋           bbpAg=g9人户
. 用真值表证明分配律 。
声人(9V rm三(户人人9)V(D人7

 

ff

9



--- 第 37 页 ---
第1章 基础: 逻辑和证明，19

4. 用德摩根律求下列命题的否定。
a)Jan 是富裕的，也是快乐的。
b)Carios 明天骑自行车或者跑步。
c) Mei 步行或乘公共汽车去上课。
d)Ibrahim 既聪明又工作努力。
5. 用真值表证明下列各条件语句为永真式。
a)(旋人Ad) -一户           b)pPpP一(户Vg9)           C)户一(户一9)
d)(户人9) 一(志一9)        e)(户一9) -~力            人站(力一9g) 一9
6. 不用真值表证明练习 5 中的各条件语句为永真式。
7. 用真值表证明下列称为吸收律的等价关系。
a)pV(记人人9)三户         b)户人A(户V 9)三户
8. 判断(9gA(户一9)) 一-户是否为永真式。

练习 9一14 都是要求证明两个复合命题逻辑等价。做这样的题目，你要证明表达式中命题变元的相同真
值组合，或者都为真，或者都为假。(每题都很容易。)
9. 证明(p*a)和z*d逻辑等价。

10. 证明p*>qg 和户*…D]9逻辑等价。

11. 证明-(pg)和站六9g 逻辑等价。

12. 证明(p一mA人(gg一”和(bpVaq) -rr逻辑等价。

13. 证明(盖r)YV(q一上)和(户人Adq) 一-逻辑等价。

14. 证明 pg 和(b一9)人(9一记逻辑等价。

15. 证明(一9)A人(9g一r) 一(户一r)是永真式。

16. 证明(户一ga) 一rr 和户一(9一门不等价。

17. 证明(疡一q)一(r一>)和(户一r)-~(q一5)不逻辑等价。

只含逻辑运算符V 、A 和5的复合命题的对偶是将该命题中的每个V用人代替，每个人用V 代替，每个了T

用下代替,每个上F用T代替得到的命题。命题 * 的对偶用s' 表示。

18. 求下列命题的对偶。

a)访人9人r      b)(庆AdAr)Vs      c)(pVF)ACVT)

19. 当*是复合命题时，证明(*” ) "一 >。

*#20。 为什么两个只含运算符A 、V 和5的等价复合命题的对偶也等价?

21. 找一个只含命题 pP、g 和 的复合命题，在 户、g 和r 中恰有两个为真时命题为真，杏则为假。[提示: 构
造合取的析取。对命题成真的每一种组合包含一个合取。每个合取都应包含三个命题变元中每个或它的
否定。]

22. 证明”、A和V 构成一个功能完备的逻辑运算符集合。[提示: 利用每个复合命题都逻辑等价于一个析取
范式这个事实。]

*23. 证明和V 构成一个功能完备的逻辑运算符集合。

下面几道题用到逻辑运算符 NAND(与非)和 NOR(或非)。命题 p NAND g 在 缚 为假或4 为假或两者均为
假时为真，当户和9 均为真时为假。命题 请NOR 9 只在请和4 均为假时为真，否则为假。命题训NAND 9 和
户NOR 4 分别表示为娟| g 和户+ 9g。(运算符 | 和+ 分别以谢佛和皮尔斯的名字命名为谢佛竖(Sheffer stroke)
和皮尔斯薪头。)

24. 证明 训| g 逻辑等价于站(户人9) 。

25. 证明 训+ aq 逻辑等价于(ppVa)。

*26. 只用运算符 + 构造一个等价于 户-4 的命题。

27. 证明户| g 和9 | 请等价。

*28. 只用命题变元 请和9 能有多少不同的复合命题真值表?

29. 下面的语句取自一个电话系统的规范说明:“如果电话号码数据库是打开的，那么监督程序被置于关闭状

态，只要系统不在初态."这句话有两个条件语句，使规范说明很难民。找一个等价的易民的规范说明，

使其只涉及析取和否定，不涉及条件语句。



--- 第 38 页 ---
20 "第1童 基础: 逻辑和证明

30. 通过对 户、g、r、x 赋真值，析取表达式 pPVDmqVs，nphVvanmryvs， npVvnrVns，npbpVgoVvns，qgVrVans，
qVYnmrVans， npVvnqVvns phVvrys,， bpvryvan中有多少可以同时为真?
如果对命题变量的真值赋值可使复合命题为真，则称这个复合命题是可满足的。

31. 解释一下用于判定复合命题可满足性的算法如何能用来判断一个复合命题是否是永真式。[提示: 考虑
np，其中户是已经考察过的命题.]

1.3 谓词和量词

1.3.1 引言
在1.1节和1.2节中学习的命题逻辑，不能充分地表达数学语言和自然语言中语句的意思。比
如，假设我们知道
“每个连接到大学网络的电脑运行正常。”
没有命题巡辑规则让我们判断
“MATH3 在正常运行”
这句话的真实性，其中 MATH3 是连接在大学网络的一台电脑。同样，我们不能用命题逻辑的规
则判断以下语句的正确性:
“CS2 被一个人侵者攻击.”
其中 CS2 是连接在大学网络的计算机;“有一台连接在大学网络的计算机正遭受一入侵者的攻击”。
本节将介绍一种更强类型的逻辑，即谓词逻辑。我们将明白如何用谓词多辑表达命题在数学
和计算机科学中广泛的语句意义，用这个方法可以帮助我们推理和探索对象之间的关系。为了理
解谓词逻辑，我们首先需要介绍谓词的概念，之后，介绍量词的概念，它可以让我们用能够判断
语句属于某种类型的所有对象拥有某种性质的语句断言，以及具有特定性质的语句断言。

1.3.2 谓词
含变量的语句，如
“TD>3”人7一3十37人并十y一2
“计算机工被一个人侵者攻击”
以及
“计算机 z在正常运行”
常见于数学断言、计算机程序，以及系统规格说明。在变量值未知的时候，这些语句既不为真也
不为假。本节将讨论从这种语句产生命题的方式。

语句“大于 3有两部分，第一部分即变量 zx 是语句的主语; 第二部分谓词“大于 3”，表明语
名的主语会有的一个性质。我们可以用 P(z)表示语句“z 大于 3?，其中 己表示谓词“大于3”，而>
是变量。也把语句 P(z)说成是命题函数尸在zx 的值。一旦给变量 zx 赋一个值，语句 P(z)就成为
命题，因而有真值。考虑下面的例 1 和例 2。

例1 令 P(z)表示语句“z>3”，P(4)和 P(2)的真值是什么?

解 ”在语句“z>3?”中让 z一4即得到语句 P(4) 。因此 P(4)即语句“4之3”，为真; 但语句放(2)
即“2之3”，为假。                                             国

例2 令A(z)表示语名“计算机 z正被一个人侵者攻击”。假设在校园的计算机中，只有 CS2
和 MATHI1 经常被人侵者攻击,那么 4(CS1)、4(CS2)和4(MATHI1)的真值是什么?

解 ”在语句"计算机 z 正被一个人侵者攻击”中，设 zx= CS1 得到语句 A(CS1) 。因为 CS1 不在
经常受到攻击的名单中，所以判断 A(CS1 )为假。同样，因为 CS2 和 MATHI 在经常受攻击的名单
中，我们知道 A(CS2)和 A(MATHI1)为真。                       轿

还可以让语句中含不止一个变量 ，例如，考虑语句“zx一y十3”。我们可以用 QCx， y)表示这条
语句，其中 zx、y 为变量，Q 为谓词。在赋值给 x 和y 时，语句 QCz，光就有了真值。

人例3 令QCzr，y)表示语句"z一?>十3"，命题 Q(1，2)和 Q(3，0)的真值是什么?
解 ”要得到QI，2)，在 QIrz，y)中令 rz=1，y一2。因此，Q(1，2)为语句“1一2十3".



--- 第 39 页 ---
第1章 基础: 运辑和证明"，21

为假。语句 Q(3，0)为语句“3一0十3?，为真。                                国
例4 令A(Cc，站表示语句“计算机<被连接到网络z”，其中变量 代表一台计算机，变量”代
表一网络。假设计算机 MATHI1 被连接到 CAMPUS2，但没有被连接到 CAMPUS1。A4A(MATH1，
CAMPUS1)和 A(MATH1，CAMPUS2)的真值是什么?
解 ”因为 MATHI 没有连接到CAMPUS1 网络，我们知道 A(MATH1，CAMPUS1)为假。然

而，因为 MATHI1 连接到了 CAMPUS2 网络，我们知道 A(MATH1，CAMPUS2)为真。       于
同样，我们可以令 RIz，2》，z)表示语句"“z十?一z”，当变量 zx、?、z 被赋值时，此句就有
真值。

例5 命题RII1，2，3)和R(O0，0，1)的真值是什么?
解 在语句RCz，y，z)中令 =1，y=一2，z一3，即得到命题RII1，2，3)。可以看出

R(1，2，3)就是语句"1十2一3”，为真。R0，0，1)即语句“0十0二1”，为假。            面
一般涉及 7个变量 r, ， 2， 的语句可以用PCz ， 2 zu)表示 。
形为 PIz ，zm ，…，xzu)的语句是命题函数卫在?元组(z ，，…，z,)的值，己也称为于元
谓词。
下面的例子说明命题机数可以出现在计算机程序中。
例6 考虑语句

证 zx盖0 then z :一并十1

当程序中遇到这样一条语句时，变量 z 在程序运行到此刻的值即被代入 P(z)，也就是代人
“xz>>0"。如果对并的这一值 PCz)为真，即执行赋值语句 z :一zx十1，于是z的值增加 1。如果对
的这一值 PCz)为假，则不执行赋值语句，所以zx的值不改变。                     图

也可以用谓词验证计算机程序，当有有效输入时总能得到正确的输出。描述有效输入的语句
叫做前置条件，当程序运行时，输出应该满足的条件称为后置条件。如例 7 所示，用谓词来表达
前置条件和后置条件。

例7 考虑下面的交换变量 rz 和>y 值的程序。

t+上emp : = X
X :三区
Y ; = temp

找出能作为前置条件和后置条件的谓词，以证明此程序的正确性。然后解释如何用它们验证对所
有有效的输入,程序的运行都能达到目的。

解”对于前置条件，我们需要表达在运行程序之前zx 和>y 被赋值。因此，对于这个前置条件
可以用谓词 PCz，y)表示，其中 PCz，妇指语句“xz一a，?y一所，a 和是在运行程序之前zx 和>y 的
值。因为我们想证明对于所有输入变量，程序交换了 rz 和y 的值，对后置条件可以用 QCz，y)表
示，其中 QCrz，力表示语句“zx一0，?y一a”。

为证明程序总是按照预期运行，假设前兽条件 P(z，y)成立。也就是说，假设命题“zx一a，
2一刀为真，这意味着 zx一a，y一02。程序的第一步，iemzp: =z，将工的值赋给 rembp，所以下一步
是 z一<，tenmtzb一4，y一0。程序第二步，r: =一y，因此 xz一0，remzb一wa，y=5。最后，第三步，我
们知道 zx一5，tenzp一a，以及 y一a。结果，程序运行后，后置条件 QCz，y)成立，也就是说，语
名“xz一0，3一a?为真。                                                 一

1.3.3 量词

当命题函数中所有变量均被赋值时，得到的命题有一个真值。还有另一重要方式，也可以从
命题函数产生命题，这就是量化。量化表示谓词在一定范围的事物上成立的程度。在语言中，单
词"所有”、“一些"、“许多"、“没有”以及“没几个”被用于量化。这里讨论两类量化: 全称量化，
它告诉我们一个谓词在所考虑的每一对象中都为真;，存在量化，它告诉我们一个谓词对所考虑中
的一个或多个对象成真。处理谓词和量词的逻辑领域称为谓词演算。



--- 第 40 页 ---
22 "第1章 基础: 逻辑和证了明

. 全称量词 ”许多数学命题对于某一性质在变量的某一特定域内的所有值均为真，这一
“… ”特定域称为变量的论域(或全体域) ，时常简单地称为域。这类语句用全称量化表示。
P(z)对特定论域的全称量化是指: 它断言 P(z)对在其论域中的所有值为真。注意，论域是变量
并所有可能指定的值。当我们改变论域时，P(z)?的全称量化的意义也随之改变。在用全称量词时，
必须指定论域，否则语句的全称量词无意义。
定义  P(z)的全称量化是语句“P(z)对 zx在其论域的所有值为真”。
符号 YrP(z)表示 P(z)的全称量化，其中Y 称为全称量词。命题 vyrP(z)也可表示为“对所有
Z，P(r)”或“对每个zx，P(z)”。对于 P(z)是假的对象称为 YrP(z)的反例。
全称量词的意义在表 1-22 的第一行做了总结。我们用例 8一13 来说明全称量词的使用。

 

 

表 1-22 量词

    
 

    

    
 

   
   

    
  

有一个 r， 使 P(z)为假
对每一个<，P(z)都为假

对每一个z，P(，… 部力喜
有一个z,，使六为下

VzrP(z)
3了rP(zr)

                                                                                                                                                                                                                                    

     

 

例8 令 PCz)为俞题*“z十1]>z"，量化语句 YrPtr)的真值是什么?其中论域是实数集合。
Rs  解 由于P(z)对所有实数均为真. 基化语句
VYzP(z)
的值为真。                                                             国

注意 通常，一个隐含假设使量词的所有论域为非空的。如果论域为空，那么 VrP(z) 对
任何命题函数 P(z)都为真，因为论域中没有元素工使已(z)为假。

除了“对所有”和对“每一个"外，全称量词还可以用其他方式表达，包括“所有的”"、“对任一
个"、“任何"、“对任意的"~`“给定任何的”等。

注意 最好避免使用"对于任一 rz"?，因为它常常引起“每一"和"一些”的歧义。某种程度

上，“任一"是歧义的，就像它用于否定名时那样，如“没有任一理由忽视学习。"

当且仅当 P(z)不总为真时 VrP(z)为假，其中 P(z)是一个命题函数，z 在论域中。要证明当
z在论域中的情况下 P(z)不总为真，一种方法是找到 VrP(z)的一个反例。注意仅仅一个反例就是
我们确定 YrP(z)为假所需要的全部。例 9 解释了如何使用反例。

例9 令 QGz)表示语句*“z<2”。若论域是实数集合，量化语句 YrQ(z)的真值是什么?

解 Q(Cz)并非对所有实数都为真，例如，Q(3)就为假。也就是说，z=3 是语句 YrQ(z)的反
例。因此

VZzQ(Cz)

为假。                                     ，                    国
例10 假设 P(z)是“袜盖0"。要证明语句 YrP(z)为假(其中论域是所有整数) ，我们给出一

反例。z一0 是一个反例，因为当z=0时，字一0 而不大于0。                       四
在数学研究中，寻找全称量化语句的反例是一个重要的部分，在本书后续章节中还会介绍。
当论域中的所有元素可以一一列出时，例如列成 r ，z ，…，xr,，全称量化 YrP(x)与合了到

PCzi) 人Prz) 人… 人人Pr)
是一回事，因为这一合取为真，当上且仅当 P(zr ) ，P(z,)，…，P(zr,)全为真。

例11 若论域是不超过 4 的正整数，P(z)是语句“z<<102，VYzrP(z)的真值是什么?
解 ”语句VrP(z)就是合取
P(1) A P(2) A P(3) A _P(4)
因为论域由1、2、3 和4组成。由于 P(4)即语句“4:一10"为假，WzP(z)为假。            国
例 12 如果 NCz)指“计算机工被连到网络*，论域为校园里所有的计算机，那么 YNCzx)是什



--- 第 41 页 ---
第1章 基础: 远辑和证明*23

么意思呢?
解”语句VrN(z)的意思是对于校园里的每一台计算机 zx，它都被连到了网络。这人句话可以用
自然语言表达为“校园里每一台计算机都连到网络”。                           国

正如我们已经指出的那样，当使用量词时，说明论域是很重要的。量化语句的真值通常取决
于哪个对象处于论域中，如例 13 所示。
例 13 ”如果论域包括所有实数，Yr(袜三z)的真值是什么?如果论域包括所有整数，真值又
是什么?
解”论域是所有实数时，全称量词 Yz(空三z)为假。例如，(1/2) 六1/2。注意空伺z当且仅
当z: 一zx一Xz一1)三0。因此，妆全z当且仅当z和受0 或xz全1。由此得出，如果论域包括所有实数，
Vz(妆三7)为假(因为当0<xz<1 时，不等式不成立) 。然而，如果论域为整数，Yr(玫三z)为真，
因为对任一整数 zx都不存在 0一zx一1。                                    |
存在量词 ”许多数学定理断定有一个具有某种性质的元素。这类语句用存在量化表示。用存
在量化可以构成这样一个命题: 它成真的充分必要条件是论域中至少有一个值满足 P(z)为真。
ER P(z)的存在量化是命题*论域中存在一个元素工满足已(z)”。
我们用符号 3zP(z)表示 P(z)的存在量化，其中了称为存在量词 。
当使用语句 3rzP(z)时，必须指定论域。而且当论域变化时，3zP(z)的意义也改变。如果没
有指定论域，那么语句了3zP(z)没有意义。存在量化 3zP(z)可读作
“有一个工满足忆Crz)”，
“至少有一个满足已Cz)”，

 

或
“对某个x，PCz)”。

除了"存在”，我们也可以用许多其他方式表达存在量化，如“有一些"、“至少一个”或“有?”。

存在量词的意义见表 1-22 的第二行。例 14一16 说明了存在量词的运用。

例14 令 P(z)表示语句"z>3”，论域为实数集合，量化语句 3zP(z)的真值是什么?

ss 解 ”因为“z盖3?在如xz一4 时为真，P(z)的存在量化 3zP(z)为真。         图

和      我们发现，当且仅当论域中没有对象满足 P(z) 为真时，语句 3zP(z)为假。也就是
说，3zP(z)为假，当且仅当 P(z)对于论域中的每一个对象都为假。例 15 将解释这个发现。

例15 令 QCz)表示语名“zx一zx十1”，论域是实数集，量化语句 3zQ(z)的真值是什么?

解 ”因为对每个实数 x，Q(Cz)都为假，Q(z)的存在量化 3zQ(z)为假。              国

注意 通常，当讲到量词的论域时，隐含假设它为非空集。如果论域为室， 那么无论
Q(Cz)是什么样的命题函数，3了zQ(z)都为假。因为当论域为空时，论域中没有一个对象使
Q(Cz)为真。

当论域中的所有元素可以一一列出时，例如列成 zx ，z ，…，xz，存在量化 3zP(z)与析取
Prz) V Pr ) V …V Pr,)
是一回事，因为当且仅当 P(z )，P(zrz)，…， PCz,)中至少一个为真时，这一析取为真。
例16 若 PCz)是语句“衬10”，论域为不超过4 的正整数，3zP(z)的真值是什么?
解”由于论域为{1，2，3，4}，命题 3zP(z)就是析取
P(1) V P(2) V P(3) V PC4)
由于 P(4)即“4之10?为真，3zP(Cz)为真。                           国
在决定量化语句的真值时，借助循环与搜索来思考是有益的。假定在变量 zx 的论域中有zz 个
对象，要决定 YrP(z)是否为真，可以对z的”个值循环查看 P(z)是否总是真。如果遇到 zx 的一
个值使 P(z)为假，那就证明 VYrzP(z)为假，否则 VYrP(z)为真。要决定3zP(z)是否为真，我们循
环查看工的?个值，搜索使 P(z)为真的z之值。如果找到一个，那么 3zP(z)为真; 如果总也找
不到这样的zx，则判定 3zP(Czr)为假。(注意，当论域有无穷多个值时，这一搜索过程不适用。不过



--- 第 42 页 ---
24*第1章 基础: 逻辑和证明

以这种方式思考量化语句的真值仍是有益的。)

1.3.4 其他量词

现在已经介绍了全称量词和存在量词，它们是数学和计算机科学中最重要的量词。然而，我
们定义的不同量词没有数量的限制，如“确定有 2 个",“有不超过 3 个",“至少有 100 个"等。其他
基词中最常见的是唯一量词，用符号 3 ! 或卫表示。符号 了3!zP(z) (或了zxP(z))指"存在唯一工
使己(z)为真”。其他表示唯一量词的词语有”确切存在一个",“有且只有一个"。我们可以用前边
学过的量词，以及命题逻辑来表达唯一性，所以唯一量词是可以避免的。通常，最好坚持运用存
在量词和全称量词，因此这些量词的推理规则可以运用。

1.3.5 约束论域量词

一个缩略符号常被用来约束量词的论域。在这个符号里，在量词后有一个变量必须满足的条
件。这将在例 17 中解释。我们也将在 2. 1 节描述这个符号涉及集合成员的其他形式。

例17 语句 VYz<0(袜六0)，Vy天0(曙夭0) ，以及3z>0(守一2)的意思是什么?其中各句的论
域都为实数集。

解 ”语句 wz一0(刀>0)表示对于每一个实数 zx<0，则 也>0。也就是说，它表示“一个负实数
的平方为正实数”。这个语句与 Vr(z<0一她盖0)意义相同 。

语句 Yy天0(yY 夫0)表示对于每一个实数 >关0，则有 记夭0。也就是说，它表示“每一个非零实
数的立方不为零”。注意这个语句等价于 Yy(y天0一彤天0) 。

语句 3z>0(过一2)表示存在一个实数 =>0，使 泣一2。也就是说，它表示"有一个正数是 2 的
平方根”。这个语句等价于 3z(z盖0A袜一2) 。                       国

注意，全称量化的约束和一个条件语句的全称量化等价。比如，wr<一0(刀>0)是表达
“VYr(z<0一天>0) ”的另一种方式。另一方面，存在量化的约束和一个合取的存在量化等价。比如
3z>0(zx于一2)是表达 3z(z>>0A屏一2)的另一种方式。

1.3.6 量词的优先级
量词 Y和 了3比所有命题演算的逻辑运算符有更高的优先级。比如，VYrP(z)VQ(Cz)是YrP(Cz)和
QGz)的析取。换名话说，它表示(VrP(z))VQ(Czr)，而不是Yr(CP(Cz)VQCz))。

1.3.7 绑定变量

当量词作用于变量 zx时，我们说此变量的这一次出现为绑定的。没有被量词绑定或设置为与
某一特定值相等的变量出现称为自由的。出现在命题函数中的所有变量必须是绑定的，才能把此
命题本数转变为命题。可以用全称量词、存在量词和赋值来完成转变 。

逻辑表达式中应用量词的部分称为这个量词的作用域。因此，一个变量是自由的一一如果在
指定这个变量的公式中，变量在所有量词的作用域之外。

例18 在语句3z(z二>=1)中，变量 rz被存在量词 3z 绑定，但是变量 y 是自由的，因为它没
有被一个量词绑定且没有值被指定到这个变量。这解释了在语句3z(z十?一1)中,xz被绑定而 y 是
自由的。

在语句 3z(P(z) AQ(Gz))V YrR(z)中，所有变量都绑定了。第一个量词 3x 的作用域是表达
式忆(zxz)AQ(Gz)，因为3z 只作用于P(z)AQGz)，没有语句的其余部分。类似地，第二个量词 wz
的作用域是表达式尽(z)。也就是说，存在量词在 PCz) AQCz)中绑定变量 x，全称量词 Vr 在RCzr)
中绑定变量 <。由此，我们可以用两个不同的变量 x 和 y 将语句写为3z(P(z) AQ(Cz))V VyR(y)，
因为两个量词的作用域不重倒。读者在日常使用中应注意这一点，相同的字母经常被用于表示被
不同量词绑定而其作用域不重释的变量 。                                   团

1.3.8 涉及量词的逻辑等价
在 1.2节介绍了复合命题逻辑等价的概念。我们可将这个概念扩展到涉及谓词和量词的表达



--- 第 43 页 ---
第1章 基础: 运辑和证明。23

3    涉及谓词和量词的语句是远辑等价的，当且仅当无论什么谓词代人这些语句，也无
论用哪个个体论域于这些命题栅数里的变量上，它们都有相同的真值。用符号 S=T来表示涉及谓
词和量词的两个语句S和了 逻辑等价。

例 19 说明了如何表示两个涉及谓词和量词的语句逻辑等价。

例19 表明 wzr(CP(z)AQ(Cr))和VYrP(r)A VrQ(Czr)罗辑等价(论域始终相同)。这个逻辑等价
式表明可以在一个合取上分配全称量词。此外，也可以在一个析取上分配存在量词。然而，不能
在析取上分配全称量词，也不能在合取上分配存在量词。(见练习 26。)

解 ”为表示这两个语句逻辑等价，必须表示出，不论 已和Q 是什么谓词也不论运用哪个个
体论域，它们总有相同真值。假设有特定的谓词 P 和Q，论域为常用的。可以做两件事来表示出
Vzr(CP(z) AQGCz))和YrP(Cz)A YrQ(Czr)轩辑等价。首先，表示出如果VzCP(z) AQGCz))为真，那么
VrP(r)A YrQ(Cz)为真。第二步，表示出如果 YrP(Cz) A YrQ(Cz)为真，那么 Vyr(P(zrz) AQ(Cz))
为真。

因此，假设 vz(P(z) AQ(z))为真。这意味着如果 < 在论域中，那么 P(e) AQ(a)为真。所以，
P(a)为真，且 Q(a)为真。因为对论域中每个对象 P(a) 为真，且 Q(a)为真都成立，可以下结论，
VzP(z)和VYzQ(z)都为真。这意味着 VrP(z) 人A YzQ(z)为真。

下一步，假设 YrP(z) A YrQ(Czr)为真。那么 YrP(z)为真，是 YrQ(z)为真。因此，如果 < 在
论域中，那么 P(a)为真，且 Q(a)为真(因为 PCz)和 Q(z)对论域中所有元素都为真，所以这里用
同样的值 e 不矛盾) 。接着，对于所有的 ae，P(a) 人AQ(Ca)为真。所以 VzCP(Cz) 人Q(z))为真。现在
可以下结论

 

YzCPzr) 人AQGCz)) = YzP(r) A YazQ(z)                    国

1.3.9 否定量化表达式
我们常会考虑量化表达式的和否定，例如，考虑语句
“班上每个学生都学过一门微积分课”
的否定。这个语句是全称量化语句，即
VzP(Cz)
Tani: 其中 PCz)为语句“学过一门微积分课?，论域是你们班的所有学生。这一语句的否定
   ”是“并非班上每个学生都学过一门微积分课”。 这等价于*班上有个学生没有学过微积分
课”。这也就是原命题函数之否定的存在量化，即
本xD PCz)
这个例子说明了下面的等价关系:
DVP(z)三了zz)
为了说明” VzrP(z)和 3znP(z)不论命题机数 P(z)和论域是什么都为罗辑等价，  首先注意 YrP(z)
为真，当有上且仅当 YrP(z)为假。下一步，注意 YrP(z)为假当且仅当论域中有一个元素工使 P(z)为
假。它成立当且仅当论域中有一个元素工使PCz)为真。最后，注意论域中有一个元素 x 使
nmP(z)为真当上且仅当 3znmP(z)为真。将这些步又放在一起，可以得出结论 YrP(z)为真当上且仅当
3zDP(z)为真。接着便是上” YzP(z)和3z- PCzr)逻辑等价。
假定我们想和否定一个存在量化语句。例如， 考虑命题“班上有个学生学过一门微积分课。”就是
存在量化语句
卫zQ(Cz)
其中 Q(Cz)为语句“z 学过一门微积分课”。 这句话的否定是命题“并非班上有个学生学过微积分课”。
这等价于*班上每个学生都没学过微积分课”， 这也就是原命题函数之否定的全称量化，或用量词
语言表示为
VZzDQCz)



--- 第 44 页 ---
26 "第1章 基础: 逻辑和证明

这个例子说明了等价关系
= 3azQ(Cz)=YVzrnQGCr)
为了表示出5 3zQ(z)三 Yr nmQGCz)，即不论 QCz)和论域是什么都为逻辑等价。首先注意” 3z Q(Cz)
为真当且仅当3了rzQ(z)为假。而这个为真当且仅当论域中没有工使QCz)为真。下一步，注意论域
中没有工使QCz)为真当且仅当 Q(Cz)对论域中的每个元素 z都为假。最后，注意 QCz)对论域中每
个zx都为假当且仅当Q(Gz)对论域中所有 z都为真。而它成立当且仅当 Vz 上Q(Cz)为真。将这些步
又放在一起，发现” 3zQ(z)为真当且仅当Vz nmQ(Cz)为真。我们得出结论: ” 3zrQ(Cz)和VYrnQCzr)
逻辑等价。
量词否定的规则称为量词的德摩根定律 。这些规则总结在了表 1-23 中 。

表1-23 量词的德摩根定律
Vr PCz)        对每个zx，P(z)为假
3z=P(z)          有工使P(z)为假

  
  

 
 

  
  

 
 

有.、使 P(z)为真
对每个zx，P(zr)为真

癌3rP(Cz)
DYzrPCz)

      

注意 当谓词 P(z)的论域包含浆个元素时，其中姻是正整数，用于否定量化语句的规则
恰与 1.2 节讨论的德摩根律相同。这是称这些规则为量词的德摩根定律的原因。当论域
有z个元素 ri，碚，…，z 时,DYVrP(zr)与(PCz)APGCr)A…人Pro))相等，而后
者等价于 P(z)VDP(Crz)V…VDP(Czs)(由德摩根律) ，该式又等价于了3zDP(Czr)。类似
地,站3zrP(zr)与(PCzri)VP(Cr)V…VP(Cr,))相等，后者由德摩根律等价于DPCzr ) 人
DPCr )A…A人DPCr,)，该式又等于VrDP(zr)。

例 20 和例 21 中解释了量化语句的否定。

例20 语句“有的政治家诚实和"所有美国人都吃和干酪汉堡包”的否定是什么?

解 令克(z)表示“"z 是诚实的"，则语句“有诚实的政治家?可以用 3z末(z)来表示，其中论域
包括所有政治家。这个语句的否定是” 3zr互(z)，它等价于 Yz 五(z)。这个否定可以表达为“每个
政治家都不诚实。 ?注意，在自然语言中，语名“所有政治家是不诚实的?是含糊的。在一般应用中，
这个语句通常意味着“并不是所有的政治家都是诚实的”。因此我们不用这个语句表达它的否定。

令 CCz)为“zz上吃干酪汉堡包"，则语句“所有美国人都吃和干酪汉堡包"可以用 YzC(z)来表
示，其中论域包括所有美国人。这个语句的否定是” YrC(z)，它等价于3zrnmC(Cz)。这
个否定可以用几种不同的方式来表达，包括*一些美国人不吃干酪汉堡包”和“有一个美国人不旋干
酪汉堡包”。                                                      力

例21 语句Vr(忆xz)和3了z(z一2)的否定是什么?

解 Vzr(z>z)的否定是语句 Yr(袜盖z)，它等价于 3znm(z忆>>z)。这个表达式可以重写为
3z(z<生zxz)。3z(z:一2)的否定是语句] 3z(导一2)，它等价于Yz nm (zz一2)。这个表达式可以重写
为 wz(乙和关2)。这些语名的真值取决于论域。                                   力

在例 22 中用量词的德摩根律。

例 22 证明” YrCP(Cz)-=>Q(Cz))和3了JzCP(Cz)ADQCzr))逻辑等价 。

解”用全称量词德摩根律，我们知道 Yr(P(z)一Q(Cz))和3z(D(PCr)-*QCr)))逻辑等价。
用1.2节表1-16 中第5个逻辑等价式，我们知道7C(P(z)一Q(Cz))和 P(z) AnmQGCz)对每个上逻辑等
价。因为在一个逻辑等价中可以将一个逻辑等价表达式转换为另一个，得到 Yr(CP(z)一QCz))和
3z(P(z)A人AnQ(z))逻辑等价。                                          口

1.3. 10 翻译语句为逻辑表达式
将汉语(或其他自然语言)语句翻译成逻辑表达式，这在数学、有逻辑编程、人工智能、软件工
程及许多其他学科中是一项重要的任务。在 1.1 节中,我们学习了把句子译成由命题和逻辑联接



--- 第 45 页 ---
第1章 基础: 逻辑和证明*

词构成逻辑表达式的过程。那时，我们特意对要求谓词和量词的语句翻译避而不谈。当用到量词
时，将语句翻译成逻辑表达式会变得更复杂。而且，有多种方式可用于翻译一个特定的语句。(因
此，没有“菜谱?式的方法可供你按部就班地学习。)我们会给出一些例子说明如何将汉语语句翻译
成逻辑表达式 。翻译的目标是生成简单而有用的逻辑表达式。本节我们只讨论这样的语句，可将
其翻译成使用单个量词的逻辑表达式。下一节会讨论一些更复杂的要求多个量词的语句。
例23 使用谓词和量词表达语句“班上的每个学生都学过微积分课”。
了  解 ”首先，重写语句以确定要使用的量词。重写后可得;
“对班上的每一个学生，该学生学过微积分课。”

接着，引和变量 zx，语名就变成

“对班上的每一个学生 zx，z学过微积分课。”

然后，引人谓词 CCz)，表示请句“z 学过微积分课?”。因此，如果工的论域是班上的学生，我
们可以将语句翻译为 YrC(z) 。

然而，还有其他正确的翻译方法，并可使用不同的论域和其他谓词。具体选择什么方法取决
于后续要进行的推理。例如，我们可能对更广泛的人群感兴趣，而不仅仅是班上的学生。如果将
论域改成所有人 ，则语句就要变成

“对每个人 xz，如果 工是班上的学生，那么 z学过微积分课。”

如果 SCz)表示语名并在这个班上，则我们的语句可表达为 Vr(SCz)->C(z))。(警告，语句不
能被表达为 wz(S(Cz) AC(z))，因为这表示的是所有人都是这个班上的学生并且学过微积分课。)

最后，如果我们对学生除微积分之外的其他主修课程感兴趣，可以使用双变量量词QCz，y)表
示语名“学生 z学过课程 y>”。这样在上述两种方法中我们就要把 C(z)替换成 QQz，微积分) ，得到
YzQGCz，微积分)或 wz(SCz) 一QCz，微积分)) 。                              国

在例 23 中演示了采用谓词和量词表达相同语句的不同方法。不过要记住、应该总是采用适合
后续推理使用的最简单的方法。

例 24 用谓词和量词表达语句“这个班上某个学生去过墨西哥”和“这个班上每个学生或去过加
拿大，或去过墨西哥。”

解 ”语句"这个班上某个学生去过墨西哥”在意思是“在这个班上有个学生，他去过墨西哥”。
引入变量 zx，因此语句变成“在这个班上有个学生 zx，去过墨西哥”。

引人和谓词 M(z)表示语句“z 去过墨西哥"。如果 z 的论域是这个班上的学生，我们就可以将第
一个语句翻译为 3zM(z) 。

然而，如果我们感兴趣的人不在这个班上，我们会看到这个语句会有些不同。语句可表达为
“有这样一个人 z: 工是这个班的学生，并且 zx 去过墨西哥"在这种情况下，z 的论域是所有人，
我们引入谓词 SCz)表示语名“zx 是这个班上的一个学生”。答案就变成了 3zr(S(Cz) AM(Cz))，因为
它表示有某个人工是这个班上的一个学生并且去过墨西哥。[警告: 语句不能表示为 3z(S(z)~
AM(Cz))，因为对于某个不在这个班的人它也是真的，由于对这样的 zx，S(Cz)一M(z)就变成F_>T或
者 F-~FE，两个都是真的。]

类似地，对第二个语句，能够表示成“对于在这个班上的每一个zx, xz去过加拿大，或x去过黑
西哥"。(注意:“或?在这里，假设是包容的，而不是排斥的。)我们令 CCz)表示语句“z 去过加拿
大”。由前面的推理，如果=的论域是这个班上的学生，则第二个语句可以表达为 W(CCz) V
M(z))。然而，如果的论域是所有人，我们的语句就表示成:“对于每一个人 z，如果工在这个
班，则 z 去过加拿大，或 zx去过墨西再”因而语句被表示成 Ve(S(Cz) ->(CCz) VMCz)))。

不同于使用谓词 MCz)和 C(z)分别表示 z去过墨西哥和xz 去过加拿大，我们可以使用两个变
量谓词 Y(z，2)表示“z 去过国家?”。在本例中，V(z, 墨西责)和 V(z, 加拿大)与 M(z)和CCz)意
思相同并可以代替它们 。如果碰到某人去过多个国家的语句，用这种双变量的方法更可取。和否则
为了简单将坚持用单变量谓词 MCz)和 CCz) 。                                                       国



--- 第 46 页 ---
28。"第1章 基础: 远辑和证明

1.3.11 在系统说明中运用量词
在 1. 1 节用命题来表示系统说明。然而，许多系统说明涉及谓词和量词。这将在例 25 中说明。
例 25 用谓词和量词表达系统说明“每封大于 1MB 的邮件将被压缩?和”如果用户处于活动状
态，那么至少有一个网络连接有效"。
ss  解 令 SCOm，妇表示“邮件记大于y MB”，其中变量 z 的论域是所有邮件，变量 > 是一
个正实数。令 C(m)表示“邮件 mm 将被压缩”>，那么说明“每封大于 1MB 的邮件将被压
缩?”。可以表达为
VSCmna，1)->C(Cm))
令A(ow)表示“用户 xx处于活动状态”，其中变量 x 的论域是所有用户。令 SCz，xz)表示“网络连
接 处于xz 状态"，其中对的论域是所有网络连接，xz 的论域是所有可能的网络连接状态。那么说
明”*如果用户处于活动状态，那么至少有一个网络连接有效"可以表达为
3xA(Cx)-~> 3aS(2，available)                     国

1.3.12 选自 Lewis Carroll 的例子
Lewis Carroll(实际上是 C. L. Dodgson 的笔名)是(Alice in Wonderland》的作者，也是有关符号
逻辑几篇论文的作者。他的书中有用量词推理的例子。下面的两个例子选自他的书4Symbolic
logic》，选自这本书的其他例子在本节末的练习中给出。这些例子说明了怎样用量词表示各种类型
的词句。
例26 考虑下面这些语句，其中头两句称为前提，第三句称为结论。作为一个整体它们被称
为一个论证。
“所有狮子都是凶猛的。”
“有些狮子不喝咖啡。”
“有些凶猛的动物不喝咖啡。”
《1.5 节将讨论判定结论部分是不是前提部分有效后果的问题，就这个例子来说，结论是有效的。)
令 P(z)，Q(GCz)和RCz)分别为语句“z 是狮子",“z 是凶猛的"和“z 喝咖啡>。假定所有动物的集合
为论域，用量词及 P(z) 、Q(z)和RCz)表示上面这些语句。
解 ”可以将这些句子表示为:
VzCP(z)一QCzr))
3xz(CP(z) 人A- Rz))
习z(Q(Cz) ARCzr))》
注意，第二句不能表示为 3z(P(z) 一”RGz))。原因是 PCz) 一5RCz)在工不是狮子时总是成
真，所以只要有一只不是狮子的动物，3z(CP(z) ->5R(Cz))就成真，即使所有狮子都喝早啡它也成
真。同样，第三句也不能写成                ，
了xzCQ(Cz) 一避R(z))                       畏
例27 考虑下面的语句，其中前 3 个语句为前提，第 4 个语句为有效结论。
“所有蜂鸟都五彩斑痫。”
“没有大鸟以蜜为生。”
“不以蜜为生的鸟都色彩单调。”
“蜂鸟都是小岛。”
令 P(z)，Q(z)，RGz)和SCz)分别为语句“zx 是只蜂鸟",“z 是大的”,“z 以蜜为生>?和"xz 五彩斑
凋"。假定以所有鸟的集合为论域，用量词及 P(z) 、Q(Cz) 、R(z)和 SCz)表示上述语句。
解 ”可以把论证中的语句表示为
Vz(P(Czr) 一SCzr))
癌 3z(QGCz) 人ARCz))
Vz( DRCz)一SCz))



--- 第 47 页 ---
第1章 基础: 逻辑和证明 "27

Vz(CP(Cz) 一站QICz))
(注意，我们假定了“小?就是“不大”,“色彩单调"就是“不五彩斑凋”。为证明第 4 句是前 3 句的有
效结论，需要用到将在 1.5 节讨论的推理规则.)                                             国

1.3.13 膛辑程序设计
2 有一类重要的程序设计语言，使用谓词远辑的规则进行推理。其中之一就是 Prolog
“′…” (Programming in Logic 的缩写) ，这种语言开发于 20 世纪 70 年代，应用于人工智能领
域。Prolog 程序包括一组声明，其中包括两类语句: Prolgo 事实和 Prolog 规则。Prolog 事实定义谓
词，这是通过指定满足这些谓词的元素来实现的。Prolog 规则使用那些 Prolog 事实定义好的谓词
来定义新的谓词。例 28 演示这些概念 。
例28 考虑一个 Prolog 程序，给出的事实是每门课程的教师和学生注册的课程。程序使用这
些事实阿答与教师授课情况相关的查询。这样的程序可使用谓词 instructor(户，c) 和 enrolled(s，c)
分别表示教授媚是讲授课程c 的老师及学生* 注册课程<c。例如，此程序中的 Prolog 事实可能包含 :

instructor(chan，math273)
instructor(patel，ee222)
instructor(grossman，cs301)
enrolled(kevin，math273)
enrolled(juana，ee222)
enrolled(Jjuama，cs301)
enrolled(kikco，math273)
enroljed(kiko，cs301)

(用小写字母表示项目是因为 Prolog 把以大写字母开始的名字当做变量。)

一个新的谓词 teaches(户，*)表示教授 户教学生*，可以用 Prolog 规则来定义，

teaches(P，S) ，-instructor(P，C) ，enrolled(S，C)

上述语句意味着如果教授 户是课程c 的老师，学生 * 注册课程 c，teaches(户，s)为真。(注意，
在 Prolog 中逗号用于表示谓词合取。类似地，分号表示谓词析取。)

Proiog 使用给定的事实和规则回答查询。例如，使用上述的事实和规则，查询

? enrolled(kevin，math273)
生成应答
Yes
因为事实 enrolled(kevin ，math273)是一个输入 。查询
?2 enrolled(X，math273)
生成应答
kevin
kiko
要生成上面的应答 ，Prolog 确定 enrolled(X，math273)包含的作为 Prolog 事实的 X 所有可能的值。
类似地，要找到 Juana 所选课程的教师，可以用查询
? teaches(X，juana)
这个查询返回
patel

9rossman                                                                                                                                                                                                            图



--- 第 48 页 ---
30。

第 1章 基础: 逻辑和证明

练习

1

2.

8

小

“nn

cn

w]

oO

10.

11.

12.

15.

令 P(z)表示语句“z<委4"。下列各项的真值是什么?

a)P(0)            b)Pk4)            c)P(6)

令 QCz，力表示语句“z 是?的首府."下列各项的真值是什么?

a)Q(丹佛，科罗拉多) “”b)Q(底特律，密炊根) “ce)Q(马萨诸塞，波士顿) ”d)Q(纽约，纽约)

. 令 P(z)为语句“z 每个工作日都花 5 个多小时上课”，其中工的论域是学生集合。用句子表达下列各量化

语句。
a) 3rP(Cz)                   b) YrP(z)                   c) 3z一PCz)                   d) yzrP(z)

. 将下列语句翻译成汉语语句，其中 C(z)是“z 是一个喜剧演员”，F(z)是“z 很有趣”，论域是所有人。

a) Vzr(C(CZ) 一下(Z))      b) YzrCCCz) 人ECz))      c) 本r(CCr) 一下(z))        d) 了3rGCCGCz)人ECz))

,，令 P(z)为语句“z 说俄语"，Q(z)为语句“z 了解计算机语言 C十十"”。用 P(z)、Q(GCz)、量词和逻辑联接词

表示下列各句子，量词的论域为你校全体学生的集合 。

a)你校有个学生既会说俄语又了解 C十十 。           b)你校有个学生会说俄语，但不了解 C十十。

c)你校所有学生或会说俄语，或了解 C十十 。       d)你校没有学生会说俄语或了解 C十十 。
- 令 P(zr)为语句“rz一王?”。如果论域是整数集合，下列各项的真值是什么?

a)PCO)                   b)P(C1)                   c)P(2)

d)P(一1)                  e) 习zP(Cz)                 位 YrP(Cz)
- 如果论域为整数集合，下列各语句的真值是什么?

a) yn(n十1二7z)           b) 3n(2m一37)            c) 了nm(?一一2              d) VWaz(天之m)
- 如果所有变量的论域为整数集合，下列各语句的真值是什么?

a) Va(iz 三0)             b) 3nr(z2一2)             c) War 7)               d) 3nz(zz <0)
. 假设命题函数 P(z)的论域为整数0，1，2，3 和4。使用析取、合取和和否定写出下列命题。

a) 3zP(Cz)                    b) YzP(z)                    c) 了z PCz)

d) Yz PCz)                 e)D 了3zP(z)                  提”VYrPCz)

假设命题函数 P(z)的论域为整数 1，2，3，4 和5。使用析取、合取和否定(而不使用量词)表达下列
语句。

a) 3zP(zx)                 b) VrP(zr)                  c)D 3rP(z)                   d) YrP(Cz)
e) VrC(zr天3) 一Prz))V 3zDDPCz)

给下列语句分别为真和假的相应论域。

a)每一个人都在学离散数学。                        b) 每一个人都超过 21 岁 。

c)每两个人都有相同的妈妈。                     d)没有两个不同的人有相同的祖母。

使用谓词、量词和逻辑联接词，以两种方式将下列请名翻译成逻辑表达式。首先，令论域为班上的学生，
其次，令论域为所有人。

a)班上有人会说印地语。                b)班上的每个人都很友好 。

c)班上有个学生不是出生在加利福尼亚。       d)班上有个学生曾演过电影。

e)班上没有学生上过逻辑编程课程。

. 使用谓词、量词和逻辑联接词，将下列语句翻译成逮辑表达式。

a)人无完人。                                     b)不是每个人都很完美。
c)你的所有朋友都很完美。                   d)你的某个朋友很完美。
e)每个人都是你的朋友并且很完美。            B)不是每个人都是你的朋友或有人并不完美。

. 使用谓词(带有一个或两个变量)，通过改变论域，以三种不同的方式将下列语句翻译成逻辑表达式。

a)学校里的某个学生曾在越南居住过。         b)学校里的有个学生不会说印地语 。
c)学校里的某个学生会用 Java、Prolog 和 C+十。由班上的每个学生都喜欢泰国食物 。
e)班上的某个学生不打曲棍球。

使用逻辑运算符、谓词和量词来表达下列语句。

a)某些命题是永真式。                   b)记盾的否定是永真式。

c)两个可能式的析取可以是一个永真式。       d)两个永真式的合取是一个永真式。



--- 第 49 页 ---
17.

18.

19.

20.

21，

22.
23.

24.

25.

26.
27，

28.

29.

30.

第1章 基础: 进辑和证了明

- 假定 QGz，y，z)的论域由z、>y和= 的三元组组成，其中 zx一0、1 或 2，?一 0或1，*一 0或1。用析取

和合取写出下列命题。

a) yyQ(0，y，0)     b) 3zQGrz，1，1)     c) 3xmQ(0，0，z)      d) 3znmQGz，0，1)

用量词表达下列语句，然后取该语句的否定并使和否定词不在量词的左边。再用简单语句表达这否定(不要

简单地表达为“不是……”) 。

a)一些年长的狗会学习新的技巧。            b)没有会微积分的兔子。

c)每只鸟都会飞。                      d)没有会说话的狗 。

e)班上没有人会法语和俄语。

找出下列全称有量化语句的反例(如果可能的话)，其中所有变量的论域是整数集合

a) Yz(z2z二工)               b) Yzr(z>0Vxz<0)         c) Yr(Cz一1)

用谓词和量词表达下列语句。

a)一名飞机桶客如果在一年中飞行的里程超过 25 000 英里，或在那一年坐飞机的次数超过 25 次，  就表明
他是高贵乘客 。

b)一名男选手，若他的马拉松比赛过去最好成绩在 3 小时内，他就有资格参赛。一名女选手，若她的过
去最好成绩在 3. 5 小时内，她就有资格参赛。

c)一名学生要想取得硕士学位，必须至少修满 60 个学分，或至少修满 45 个学分并通过硕士论文答辩，
并且所有必修课程的成绩不低于 B。

d)有某个学生在一个学期内修了 21 个学分并且全部课程的成绩都为 A。

练习 20一21 主要进行系统规范说明和逻辑表达式之间的翻译，当中涉及量词。

将下列规范说明翻译成语句，其中 F(p)是“打印机 户不能提供服务"，B(思)是“打印机 户很忙"， 工(7是

“打印作业了丢失了”，Q()是“打印作业了在队列中”。

8a) 了户(下(力) 亿(户)) 一 了7工(方              b) Vp了BCp) 一本iQCO)

c) 3了(QGD) ALOD) 一3pF(Cp)                 d)(VypB(p)AWQ(CD))-了1LL(让

使用谓词、量词和逻辑联接词表达下列系统规范说明。

a)如果磁盘有 10MB 以上的空闲空间，那么至少能保存一条邮件消息。

b)每当有主动报警时，所有排队的消息都被传送。

c)诊断监控器跟踪所有系统的状态，除了主控制台。

中对参与电话会议的每一方，不在特殊列表上的主叫方应当付费。

判断 VzCP(z) 一QCz))和YrP(z) 一 VrQ(z)是否逻辑等价，并证明。

证明 3zCP(Cz)VQCz))和3zP(z)V 3zQ(z)是逻辑等价的。

练习 24一25 给出了空量词规则，当基化变元不出现在语句部分的时候就能用。

证明下列逻辑等价关系，其距在4A 中不作为自由变元出现。假设论域非空 。

al( yzPz))AA4=VrCP(z)AA)                     b)(3zrP(Cz))AA= 3zCPCz)AA4)

证明下列逻辑等价关系，其中在4 中不作为自由变元出现。假设论域非空。

a) Vr(P(z) 一4)=了rzP(z) 一上A                       b) 3zCP(Cz)一4A)三VrPCzr) 一A

证明 3zP(z)A 3zQGz)和3z(P(z)AQCz))不是逻辑等价的。

下列请句的真值是什么?

a) 31zP(Cz)一3zP(z) b) YrP(z)一3izPGzr) ec)3lznPr)一-VrP(z)

给定例 28 的 Prolog 事实，对下列查询 Prolog 返回的是什么?

a)? instructor(chan，math273)                   b)? instructor(patel，cs301)

c)? enrolled(X，cs301)                  d)? enrolled(Kkiko，Y)

e)? teaches(grossman，Y)

假定 Prolog 事实用于定义谓词 motherCM，Y) 和 father(F，X)，这表示 M是Y 的母亲, 下是X 的父亲，
给出一个 Prolog 规则定义谓词 sibling(X，Y) ，表示 X 和 立是兄弟(也就是，有相同的父亲和母亲) 。

练习 30一31 是根据 Lewis Carroll 的《Symbolic Logicy一书中的问题编写的。
令 P(z)、Q(Cz)和尺(z)分别为语句“z 是教授?、“z 无知"”和“xz 爱呆荣"。用量词、  逻辑联接词和 P(z)、

"31



--- 第 50 页 ---
32。第1章 基础: 逻辑和证了明

Q(Gz)、R(r)表达下列语句。假定论域是所有人的集合。
a)没有无知的教授。
b)所有无知者均爱荣。
c)没有爱虚荣的教授。
d)能从 al和 b)推出 c)吗? 若不能，有没有一个正确的结论?
31. 令 P(rz) 、Q(Cz)、R(z)和 SCr)分别为语句“z 是要儿”、“z 的行为符合逻辑”"、“z 能管理鲍鱼"和“上 被人
轻视*。假定工的论域是所有人的集合。用基词、逻辑联接词和P(z)、Q(z)、R(z)和 SCz)表达下列

语句。
a)婴儿行为不合逻辑。                     b)能管理名鱼的人不被人轻视。
c)行为不合逻辑的人被人轻视。              d)枫儿不能管理鳄鱼。
*e)能从 a) 、b)和 c)推出 d)吗? 若不能，有没有一个正确的结论?
1.4 姥套量词
1.4.1 引言

在1.3节定义了存在量词和全称最词，并展示了如何用它们来表示数学语句。我们也解释了
如何用它们来将汉语语句翻译成逻辑表达式。本节我们将学习做赛量词，它是出现在其他量词的
作用域内的量词，如在语句 Yr 3y(z十y一0)中。注意量词范围内的所有事物都可以被认为是命题
函数。比如，Yz 3y(z二3y一0)和 YrQ(Cz)相同，其中 Q(Cz)指3yP(Cz，y)，而 P(z，y)表示 z十y一
0。均套量词通常在数学和计算机科学中出现。尽管和庶套量词有时比较难理解，但在 1. 3 节介绍过
的规则却有助于我们使用它们 。

为理解这些涉及许多量词的语句，我们需要阐明出现的量词和谓词的含义。具体如例 1 和例 2
所示 。

例1 假定变量 x 和>y 的论域是所有实数的集合，语句

VzrVyCzr二yy一y十z)
说的是对所有实数 x 和y，z十y一?十rz。这是实数加法的交换律。同样 ，语句
VxzayCzr十y一0)
说的是对所有实数 x，有一个实数 >，使得 rz十>一0。也就是每个实数都有一个加法的着。同样，
语句
VzVYyVyz(z十(>y十zx)一(z十y)十z)
是实数加法的结合律。                                               国

例2 将下列语句翻译成汉语句子

VzryyCr>0)A(y<一0一(zy一0))
其中变量 x 和> 的论域都是全体实数。

解 ”这个语句表示对任意实数 x 和y，如果z>0且 ><0， 那么 xy<0。也就是说，这个语句
表示对实数 zx 和》，如果z是正的且y 是负的,那么 zy 就是负的。这可以更简洁地叙述为“一个正
实数与一个负实数的积是一个负实数”。                                     国

循环量化考虑”对多个变量使用量词时，借助谷套循环来思考是有益的。(当然，如果某个变
量的论域有无穷多个元素，是无法真正对所有值做循环的。不过这种考虑方式对理解皂套量词总
是有益的.)例如，要决定 Yz yy P(z，y)是否为真，我们先对 zx 的所有值做循环，而对 zx 的每个值
再对y 的所有值循环。如果我们发现对xz和> 的所有值 P(z，y)都为真，那么我们就判定了
wz yy P(z，y)为真。只要我们碰上一个并值，对这个值又有一个 y值使P(z，y为假，那么就证
明了YVzyy P(z，y为假。

同样，要判定 Yr 3y P(z，y)是否为真，我们对工的所有值循环，对 zx 的每个值，对 y 的值循
坏直到找到一个> 使 P(z，y)为真。如果对的所有值，我们都能碰上这样的一个y值那么



--- 第 51 页 ---
第1章 基础: 逻辑和证明 "33

wz 3y P(z，y)为真。如果对某个工我们碰不上这样的>，那么 vz 3y P(z，2)就为假。

要决定 3z yy P(z，妨是否为真，需要对 zx 的值循环直到找到某个zx，就这个对y 的所有值
循环时 P(z，y?y)总是成真。如果能找到这样的zx，3zyy P(z，y)就为真。如果总也碰不上这样的
z，那么我们知道 3r yy P(z，y)为假。

最后要看 3z 3y P(z，y)是否为真。我们对 z的值循环， 循环时对 zx的每个值都对 y 的值循
环，直到找到 zx 的一个值和>y 的一个值使PC(z，y)为真。只有当我们永远碰不上这样的zx和>能
使PP(z，y)成真时，语句3r3y P(Cz，y)才为假。

1.4.2 量词的顺序
许多数学语句需要对多变量命题贾数作多重量化。除非所有量词均为全称量词或均为存在量
词，和否则量词的顺序是重要的。例 3一5 说明了这一点。
Re 例3 令 P(rz，y)为语句“>十y一?十z"，量化语句Vr yy P(z，y)和VyVr PCr，y)的
真值是什么? 这里所有变元的论域是全体实数。
解 量化语句
VzyyPryy)
表示的命题是
“对所有实数 x 和所有实数y,z十y一?十并成立。”
因为 P(z，y)对所有实数 zx 和>y 都为真，Yz yy P(z，y)为真。注意语句 wz yyP(z，y)表示“对所
有实数 >，对所有实数 zx，z十y一y十z。"这句的意思和“对所有实数 *x，对所有实数 >，z十y一y十
xz意义相同"也就是说，Vr yyP(z，y)和YyVYrP(z，y)意义相同，都为真。这说明在没有其他量
词的语句中，在不改变量化语句意义的前提下骨套全称量词的顺序原则上可以改变。        国
例4 令 QCr，2刀表示“z十?一0"，量化语句 3y yzQ(z，y)和Vr3yQ(Cz，y)的真值是什么?
这里所有变元的论域是全体实数。
解 量化语句
村yYzQ(Czr,y)
表示的命题是
“有个实数 能使QCz，y)对每一个实数 zx成立。”"
不管y取什么值，只有一个工的值能使=十y一0 成立。因为没有实数 y 能使zx十y一0 对所有实数>
成立，语句 3yYrQ(Gz，y)为假。
量化语句
Vzr3了3yQCzyy)
表示的命题是
“对每个实数 x 都有一个实数 使RQ(z，y)成立。
给定一个实数 x，总有一个实数 》 能使>十y王0,这个实数就是 >= 一r。因此，语句
Vzrz 3yQ(z，?y)为真。                                                    而
例 4 说明量词出现的顺序不同含义也不同。语句 3y VzP(z，y)和Vr3y P(z，y)不是逻辑等
价的，语句 3y YrzP(z，?)为真当是仅当存在一个 y，使得 PCz，y)对每个zx都成立。因此，要使
这一语句为真，必须有一个特定的y值，对这个值无论是什么样的zx，P(z，y)都成立;另一方
面，vz 3y PCz，y)为真当上且仅当对 z的每一个值都有一个 y 的值使PCrz，y)成立。所以，要使这
个语句为真，不管你选什么 x，总有 y 的一个值(也许依赖于你选的 z)使 PCz，y)成立。换言之，
在第二种情况下，y 随着 z 而定，但在第一种情况下，> 是与 z 无关的常数。
从这些观察可以看出，如果 3y YrP(z，y)为真，则 yz 3y P(Cz，y)必定也为真; 可是如果
vz 3jyP(z，2y)为真，3yYrP(z，y)不一定为真(参见本章补充练习24 和 25) 。
表 1-24 是两个变量所有不同的可能量化方式的总结。



--- 第 52 页 ---
34。第1章 基础: 逻辑和证明

表1-24 两个变量的量化

对每一对二、y，P(z，y)均为真

     

VYrVyCz，y)
Vy YzPCzr，y)

 
 

有一对工、y使P(z，y)为假

 
 
   
 

对每个zx，都有?使P(z，2)为真            有<z，使 P(z，2?)对每个y 总是假

                                                                                                                                                                                                                                                                 

Vr3y忆Cr，y)

      

  

有一个 r，                                   对每个zx都有y 使已(z，y)为假

  

3了zy Prz，y)

    
 

  
  

3z3yPCz，y)
3y3zP(z，y)

 
 
  
 

有一对 rz、y使PCz，、y为真               对每一对工_ >，P(z，y?)均为假

超过两个变量的量词也很常见，如例 5 所示。

例5 令QGrz，y，z)为语句“7z十y一z”，语句Vz yy 3zQGz，y>，z)和33zVyzyyQ(Crz，y，z)的
真值是什么?                                          .
解 ”假定给z和>y赋了值，那么就有一个实数 >，使得 xz十y一*。于是量化语句
VYzVy了xzxe@QGzyyyz)
为真，因为它其实就是语句
“对所有实数 zx 和所有实数 >，有实数 >，使得 z十y一z。?
这里量词出现的顺序是重要的，因为量化语句
zVzyyQCzyyyz)
也就是语句
“有实数 = 使得对所有实数 z 和所有实数y，z十y一z。”
为假，因为没有 z的值能使x*十?=一=对zx 和>y 的所有值都成立。                           加

1.4.3 将数学语句翻译成涉及典套量词的语句
用汉语表达的数学语句可以被翻译成逻辑表达式，如例 6一8 所示 。
例6 将语句“两个正整数的和是正数”番译成逻辑表达式。
es 解 ”要将这个语句翻译成导辑表达式，我们首先重写它以示出隐含的量词和论域:“对
   每两个整数，如果它们都是正的,那么它们的和是正数”。然后，引入变量 zx 和>y 就得
到“对所有正整数zx 和y，z十y 是正数"。因此，可以将这个语句表达为
VzryyCzD>0)A(y二0)- (rz十yy全0))
其中这两个变量的论域是全体整数。注意，也可以将正整数作为论域。那么语句“两个正整数的和
是正整数"变为"对每两个正整数，它们的和为正”。可以将它表达为
VzVyCzr十y二0)
其中两个变量的论域为全体正整数。                                       国
例7 将语句“每个实数(除了 0)都有乘法逆元”(实数 z的乘法逆元是使 xy一1 的实数 y)翻译
成逻辑表达式。
解”我们首先重写这个语句为“对每个实数 zx(除了 0)，并有乘法送元”，然后可以再将之重写
为“对每个实数 x，如果 z夭0，那么存在一个实数 > 使得 xy一1”。这可以重写为
Vz(CCzr天0)一了yzy 一1))                       国
正如前面提到的，量词常用于数学概念的定义，你可能熟悉的极限概念即为一例。极限是微积分
中的重要概念 。
例8 《〈和需要徽积分知识)用量词表示极限的定义。
解  回顾语句limj(z)?一二 的定义: 对每个实数 s盖0，存在一个实数 80，使得对每一个 zx，
只要 0一 | xz一a | 一SG，就有 | Fz)一工| 一se 。极限的这一定义用量词表示为



--- 第 53 页 ---
第1章 基础: 逻辑和证明，35

Ve36Vr(0一| zx一aa一9一| zxz)一工|王ee)
其中e和人 的论域是正实数集合，z 的论域是实数集合。
这一定义还可表示为
Ye二0369>>0Yz(0一|7一xi1一-| xz)一工|一e)
其中e和4 的论域为实数集合，而不是正实数集合。(这里用到了约束量词。回忆 Yz>0P(z)的意
义是对所有 z>0 的数，P(z)为真。)                          国

1.4.4 将丹套量词翻译为汉语

表达汉语语句的带舱套量词的表达式可以相当复杂。在翻译这样的表达式时，第一步是写出
表达式中的量词和谓词的含义，第二步是用简单的句子来表达这个含义。例 9 和例 10 说明了这个
过程。

例9 把语句

VYzCCCr) V 了y(CCGCy) A FCzyy)))

翻译成汉语。其中 CCz)是“z 有台计算机”，F(Cz，y)是“zx 和y 是朋友”，而工和>y 的共同论域是学
校全体学生的集合。

解 ”该语句说的是，对学校的每个学生 zx，或者工有台计算机，或者另有学生 >，他有台计算
机，且工和? 是朋友。换言之，学校的每个学生或有计算机，或有个有计算机的朋友。      面

例 10 把语句

了rzrYyVyz(CCFGCry) 人A人Frzz) 人A (yy天z))一下(yz))

翻译成汉语，其中 F(a，0)的含义是 ae 和刁是朋友，而z、y 和= 的论域是学校所有学生的集合。

解 ”这个语句说的是，有一个学生 zx，对所有的学生 y 及不同于 y 的所有学生=，只要工和y
是朋友,并和= 也是朋友，那么 y和z 就不是朋友 。换句话说，有个学生，他的朋友之间都不是
朋友。                                                          国

1.4.5 将汉语语句翻译成到辑表达式
在 1.3 节展示了如何用量词来将句子翻译成逻辑表达式。然而，当时没有谈及这样的句子，
即将其翻译成逻辑表达式要求使用孝套量词 。我们现在介绍如何翻译这样的句子。
例11 将语句"如果某人是女性且为人父母，这个人是某人的母亲”翻译成逻辑表达式，当中
涉及谓词、量词(论域是所有人)以及逻辑联接词。
解 ”语句“如果某人是女性量为人父母，这个人是某人的母亲”可以表达为“对每个人 =，如果
并是女性且 是父母,那么存在一个人y使zx是y的母亲”。我们引入谓词 FE(z)来表示“z 是女
性”，P(z)表示“>z 是父母”，M(Cz，y)表示“z 是y 的母亲”。则初始语句可以表示为
VzCFCz) 人Pr))-一了yMCzryy))
在 1. 3 节练习 24 的(b)部分用空间量词规则，可以把 3y 移到左边，以致它恰好出现在Vzr 之后，
因为 y不在F(Gz)AP(Cz)中出现。这样得到一个等价的表达式
Vzr3了xyz) A Pr))一AMCzy))                        面
例 12 将语句"每个人都恰有一个最好的朋友”翻译成逻辑表达式，当中涉及谓词、量词(论
域是所有人)以及逻辑联接词。
解 ”语句“每个人都丛有一个最好的朋友”可以表达为“对每个人 =，zr恰有一个最好的朋友"”。
引信全称量词，可以看到这个语句等价于” Vr(z 怡有一个最好的朋友)”，其中论域是所有人 。
工恰有一个最好的朋友意味着有一个人y 是xz 的最好的朋友， 而且，对每个人 *，如果 = 不是
>，那么 =不是z 的最好的朋友。当我们引人谓词 B(z，y)为语句“> 是zx 的最好的朋友”，则语句
“并恰有一个最好的朋友”可以表示为
了y(CB(Cz,y) 人 VYz((z天让一BOzryz)))
因此，初始语句可以表示为
VYz3了ay Bry) AVz(Cz天让一-BCzyz)))                      国



--- 第 54 页 ---
36 "第1章 基础: 还辑和证明

和注意，我们可以把这个语句写为 Yz3了lyB(zr,y) ，这里 3!是1.3.4节定义的存在唯一量词。

例 13 用量词表示语句“有位妇女已搭乘过世界上每一条航线上的航班”。

解 令 P(w，契为"凤措乘过户，而 QCF，a)为"了是w 上的航班">。于是可将上述语句表示为

3wya3 CPP六 AQCr,a))

其中, ww、三和a 的论域分别为世界上所有妇女、所有空中航班和所有航线。

这个语句也可以表示为

3awva3 玉(w,ra)

其中R(z，和，a)为"也已搭乘过ea 上的 放。虽然这样表示更紧凑，但它使变量之间的关系有点含
糊不清，因此，第一个解要好些。                                     男

1.4.6 否定典套量词
semi 带典套量词的语句可以通过连续地应用否定带单个量词的语句的规则成为否定的。具
体如例 14一16 所示。
例 14 ”表达语句 Yr 3y(zry一1)的否定，使得量词前面没有否定词。
解 ”通过连续地应用否定量化语句的规则(见 1.3 节表 1-23)，可以将 1 Yrz3y(zy一1)
中的否定词移人所有最词里面。我们发现, 上 Vr 3y(zy一1)等价于 3zn 3y(Cry=一1)，
而后者又等价于 3z V和(zy一1)。由于nzy一1)可以简化为 zy夭1 ，所以，我们的否定语句可以
表达为 3rzVYy(xzy天1) 。                                             图

例 15 使用量词表达语句“没有一个妇女已搭乘过世界上每一条航线上的航班”。

解 ”这个语句是例 13 的语句“有位妇女已搭乘过世界上每一条航线上的航班?的否定。由例
13，我们的语句可以表达为 3uw ye3A(P(w，六人AQCF，a)，其中 P(w，记是“搭乘过 户，
而 Q(C/，o)为“了是4a上的航班>。通过连续地应用否定量化语句的规则(见 1. 3 节表 1-23)并在最
后一步应用德摩根律，可发现我们的语句等价于如下语句;

Yazm ya了Pum,Pm AQCa))= Yuwdgao 3FCPOuw,站AQCFa))
VYm3aay疡(CPP门人AQGCFa))
Yiw3daVyn PPm vanQCra))       国

最后这条语句表示“对于每位妇女，存在一条航线，使得对所有的航班，这位妇女要么没有搭
乘过航班,要么没有搭乘过不在这条航线的航班”。

例 16 《需要微积分知识使用量词和谓词表达limy(z)不存在这一事实。

解 limf(z)不存在意味着对全体实数 二， limf(z)天。根据例 8， lim7j(z)天工可以表达为

mVve>>036>0VYxz(0一| zx一a |一8S->| FCz)一工|一e)
连续地应用否定量化表达式的规则，可得到如下等价语句序列 :
mVye>036>>0VYr(0一| rz一al一5一| Frz) 一工|一6
=3e>>0 3868>0Vzr(0一| z一a |一6一| FGz)一上|一6)
=了e>0Y86二0 Vzr(0一| zx一a1一6一| F(z) 一工|一昌
=3e>0VI>03zrn(0一| zx一al一8一| F(z) 一工|一引)
=3js>0YV6二03xz(0一| zx一al一SA Frz)一工|全6)
在最后一步使用等价式 "(P一9)捕人ng。这里依据 1. 2 节表 1-16 的第 5 个等式。
由于”lim/(z)不存在"意味着对全体实数工， limy7(z)尖L。这个语句可以表达为
YL3es>>0Y6>>03zr(00一|z一al一AIFGz) 一工|三昌
这最后一个语句表示，对每个实数 L，存在实数 s>0 使得对每个实数 $>0，存在实数 x 使得
0一 | z一a | 二6和 | F(z)一人| 三e。                                             |

练习
1. 将下列语句翻译成汉诸句子，其中每个变量的论域是全体实数。

咱 咯



--- 第 55 页 ---
Fo

CD

4

CE

TD

=

第1章 基础: 逻辑和证明。37

a) Vr习y(r<<y)                   b) Vr yy(((z二0) A (7二0)) 一(zy之0))
c) Yryyz(Czry一=)

. 令 QGz，切是语句"zx 已经发送电子邮件消息给y"”，其中二和>y 的论域都是班上的所有学生， 将下列量化

式子表达成汉语句子。
a)3z3yQGr，y)          b) 3zrvyQGr，y)        cJ) yzr3yQGCr，y7)
d) yyVrQ(Cr，y)         evyy3zrQGr，y)        人 VzVyyQGCrz，y)

- 令多(rz，世表示">访问过y"，其中并的论域是你校全体学生集合，y 的论域是所有网站的集合。用简单

的句子表达下列语句。

a)W(Sarah Smith，www. att, com)

b) 3rW(Cr，www.imdb. org)

c) 习yW(jose ()rez，y)

d) 3y(W(CAshok Puri，?) AW(CCindy Yoon，y))

e) 了3y Vz(y天(David Belcher) 人A(W(David Belcher，z) 一多(y，z)))
f) 3z 了y Vs((Cr天阅A(W(r，z)reW(y，z)))

. 令 TCzr，光表示学生 了喜欢菜肴>，其中工的论域是学校的所有学生，y 的论域是所有菜着。用简单的汉

语句子表达下列诸句。
a)DT(Abdallah Hussein、Japanese)                      b) 3zT(rz，Korean) 人 VrT(r，Mexican)
c) 3y(T(Monique Arsenauljt，y)VT(jay Johnson，y))  d) 人风3y((z天z) 一-CTCr，y)ATCz，y)))
e) 3了3z3zyy(CT(rz，、，y)二TIz，y))                           人 Yryz 3y(TCr，y)reTIz，y))
- 令L(z，y?)为语句“xz 爱y"，其中zx和> 的论域都是全世界所有人的集合。用量词表达下列各语句。
a)每个人都爱 Jerry。             b)每个人都爱某个人。             c)有个人人都爱的人。
d)没有人爱所有的人。           e)有个 Lydia 不爱的人。          1)有个人人都不爱的人。
g)恰有一个人人都爱的人。      h)Lynn 爱的人恰有两个。        iD每个人都爱自己 。
ji有人除自己以外谁都不爱 。

. 令 SCr)为谓词"z 是学生"”，F(z)为谓词"z 是教员”，而 4A(z，y)是谓词“xz 问过 v 问题">，其中论域是你校

所有人员的集合， 用量词表达下列语句。

a)l.ois 问过 Michaels 教授问题。                                     b)每个学生都问过 Gross 教授问题。
c)每位教员都问过 Miller 教授问题或被 Miller 教授问过问题。       d)某个学生从未问过任何教员问题。
e)有位教员从未被学生问过问题。                              ID有个学生问过所有教员问题。
g)有位教员问过所有其他教员问题。                            h)有学生从未被教员问过问题。

: 令 MGCzr，切为"z已发给y 电子邮件"，T(Cr，y)为"zx 给》 打过电话”，其中论域为你们班上所有学生。用

量词表达下列语句。(假定所有被发出的电子邮件都能收到，尽管事实并非如此,)
a)Chou 从未给 Koko 发过电子邮件。

b)Arlene 从未给 Sarah 发过电子邮件，或未打过电话。

c)Jose 从未收到过 Deborah 的电子邮件。

d班上每个学生都给 Ken 发过电子邮件 。

e班上没有人给 Nina 打过电话。

缚班上每个人或给 Avi 打过电话或给他发过电子邮件。

g)班上有个学生给班上其他人都发过电子邮件。

h)班上有人给班上其他人或打过电话. 或发过电子邮件。

D班上有两个学生互发过电子邮件。

ji班上有个学生给自己发过电子邮件 。

k)班上有个学生既没从班上其他人那里收到过电子邮件，、也没有人给他打过电话。
1)班上每个学生都或从同班同学那里收到过电子邮件，或接到过同班同学的电话。
m)班上至少有两个学生，一个给另一个发过电子邮件,第二个则给第一个打过电话。
n)班上有两个同学，他们当中有一个给班上其余同学或发过电子邮件，或打过电话。

- 用重词和谓词表达下列语句。

3每位学计算机科学的学生都需要上一门离散数学课。



--- 第 56 页 ---
38。第1章 基础: 运辑和证明

b)班上有个学生有一台个人电脑。

c)班上每个学生至少选修了一门计算机科学课。

d)班上有个学生至少选修过一门计算机科学课。

e班上每个学生都去过校园里每座建筑。

f班上有个学生去过校园里至少一座楼的每个房间 。
g)班上每个学生都去过校园里每座楼的至少一个房间。

, 使用谓词、基词和逻辑联接词(如果有必要)表达下列系统规范说明。

a)每个用户恰能访问一个邮箱 。
b)在所有错误条件下某个进程能继续运行，仅当内核运行正确。
c)校园网的所有用户都能访问具有 . edu 后缀的 URL 的所有站点。

*#d)恰有两个系统监控着每一个远程服务器。
10. 使用数学和逻辑运算符、谓词及量词表达下列语句，论域是全体整数。

1

玫

14.

15.

16.

17.

18.

20，

al)两个负整数的和是负数。

b)两个正整数的差不一定是正数。

c)两个整数的平方和大于等于它们的和的平方。
d)两个整数的积的绝对值等于它们的绝对值的积。

. 使用谓词、量词、逻辑联接词和数学运算符表达语句“每个正整数是四个整数的平方的和"”。
12.

使用谓词、量词、逻辑联接词和数学运算符表达下列数学语句:

a)两个负实数的积是正数。                 b)一个实数与它自身的差是零 。
c)每个正实数恰有两个平方根。              d)负实数没有实数平方根。
. 将下列人套量化式子翻译成表达出数学事实的汉语语句。论域均为全体实数。
a) 3zVy(zy一y)                          b) YrVyy(CCCz<0) 人A(y<0)) 一(Ty一0))
c) 3z3y((z盖7人A(Cz<y))                 d) Vrz yy 3z(z十?一zx)
假定所有变量的论域都是整数集合，确定下列语句的真值。
a) WwWna 了m(m2 一ma)               b) 3n Ymn(n<<zzz )               c) Wra 3m (na十如一0)
d) 习nr VCmPzz一zz)              e) 3n 3m(zz 十zz一5)           提 3n 3m(守十me 一6)

g) 3了nm 导m(7十阅一4人交一下一1)   hy) 习?2 习m(2十到一4人天一让一2)   ji) Yn Wo 习轧(力一(mm十2)72)
假定命题函数 P(z，y)的论域由xz 和>y 的序偶组成，其中zx是1、2或3，y是1、2或3。用析取和合取
写出下列命题。

a) yryy忆(rz，y)                   bl) 3r3yPGz，y)

c) azyy PCz，y)                   d) yy3zP(zrz，y)

表达出下列语句的和否定，并且所有的否定词紧跟在谓词之前。

a) yr 了yVzT(rz，y，z)                by)yrz3ayPGz，y)V vvr3yQCGrz，y)

c) yz3y(CPCzr，y)A 33zRGz，y，z))       d) yzr3yCPCzr，y) 一QCr，y))

重写下列语句，使否定只出现在谓词中(即和否定词不在量词外边，也不在含还辑联接词的表达式外边) 。
a)VryyP(r，y)                 b)”yy3zrzPCz，y)

CDmVyVzrCPr，y)VQGCz，y))          d)D(3r3ynPz，y)AYryyQGCr，y))

e)站yz(3ayyzPr，y，z)A3zyyPr，y，z))
给出变元z、y>、z 和mu 的一般论域，使语句 Yr Vy Vz jw((w天z) Auw天y人(uw天z)为真，给出另外的论
域使其为假。

- 用量词表达下列语句，然后取该语句的否定并使否定词不在量词的左边。再用简单语句表达这否定(不要

简单地表达为“不是……”) 。

a)班上每个学生都恰好选修过本校两门数学课。

b)有人去过世界上除利比亚以外的每个国家 。

c)没有人攀登过喜马拉雅山的每座山峰。

d)每位电影演员都或与 Kevin Bacon 同拍过电影，或跟与 Kevin Bacon 同拍过电影的人同拍过电影。
找出下列全称有量化语句的反例(如果可能的话) ，其中所有变量的论域是全体整数。

a) Vr yy(zrz一内一工一y)          b) Vr 3y(史一          c) VYzr Yy(Zzy志并)



--- 第 57 页 ---
第1章 基础: 逻辑和证明，39

21. 用量词表达实数乘法的结合律 。
22, 用基词和逻辑联接词表示事实: 每一个线性多项式(也就是次数为 1 的多项式)，其中工带有非零实系数，

其一定有一个实根。

23. 如果变量的论域分别如下 ，确定语句 Yz dy(zy一1)的真值。
a)非零实数                 b)非零整数           c)正实数

24. 证明语句] 3z yy P(z，y)和Yr3ynPz，y)逻辑等价。这里在 P(z，y)中两个量词的第一和第二变元有
相同的论域。

*25，a)证明 YzP(z)A 3zQGz)和Yr3y(P(r)AQ(Cy))逻辑等价。这里所有量词都有相同的非空论域。
b)证明 VzP(z)V 3zQCz)和YVr3y(P(Cz)VQ(y))逻辑等价。这里所有量词都有相同的非空论域。
一个语句称为前东范式(PNF)的充分必要条件是其表达形式为
QiziQsr…QirtP(z za yzt)
其中每个 Q, (ti一1，2， …，A)或是全称量词，或是存在量词;而 PCz ，zr ，…，xz)是不含量词的谓词。
例如 3zvyy(P(z，y) AQ(?y))是前东范式，而3zP(z)V VrQ(z)不是(因为并不是所有量词都先出现) 。
将命题变量、谓词、T 和E 用逻辑联接词和量词组合在一起形成的每一个语句都等价于一个前束范式。
练习 26 要求的就是对这一事实的证明。
**26. 给出并证明把任意语句变换为等价的前束范式的方法 。

1.5 推理规则

1.5.1 引言

本章后一部分将学习证明。在数学中,证明是建立在数学命题真实性之上的有效论证。对于
一个论证，是指表示一连串的命题最终得出结论。对于有效性，是计划得出结论或者论证的最终
命题，其过程必须依据前面命题或者论证的前提的真实性。也就是说，一个论证是真实的，当且
仅当它对所有的前提为真而结论为假是不可能的。为从已有的命题中推出新的命题，应用推理规
则，它是构造有效论证的模板。推理规则是建立命题真实性的基本工具。

在学习数学证明之前，将看到涉及唯一复合命题的论证。我们将定义涉及复合命题论证的意
义，然后介绍命题逻辑的一系列推理规则。这些规则在产生有效论证中是最重要的组成部分。在
说明推理规则如何用于产生有效论证后，将描述不正确推理的常见形式，也就是户误，它会导致
无效论证。

在学习了命题逻辑中的推理规则后，将介绍量化语句的逻辑规则。我们将描述这些推理规则
如何用于产生有效论证。这些涉及存在量词和全称量词的语句推理规则在计算机科学和数学中扮
演了非常重要的角色，尽管用时常常没有明显提及它们。

最后，我们将显示命题的推理规则和量化语句的推理规则如何结合。这些推理规则地结合在
复杂的论证中综合在一起使用。

1.5.2 命题远辑的有效论证
考虑下面涉及命题的论证(从定义上讲，是一连串命题) :
“如果你有一个正确的密码，那么你可以登录到网络。”
“你有一个正确的密码。”
所以
“你可以登录到网络。”
我们想决定这是否是一个有效论证。也就是说，想要决定当前所“如果你有一个正确的密码，
那么你可以登录到网络"和"你有一个正确的密码”都为真时，结论“你可以登录到网络”是否为真。
在讨论这个特定论证的有效性之前，将看它的形式化表示。用尹代表“你有一个正确的密码”，
用9代表“你可以登录到网络”，那么，这个论证形式化表示如下，
户一9
*。 证

9



--- 第 58 页 ---
40 "第1章 基础: 逻辑和证了明

其中“…是表示"所以”的符号。

我们知道，当户和9 是命题变量时，语句(( -9) A)-9 是个永真式。特别地，当户-~=g 和户
都为真时，我们知道 9 肯定为真。我们说语句的这种论证形式是有效的，因为无论什么时候，只
要它的所有前提(论证中的所有语句，而不是最后一句结论)为真，那么结论也必须为真。现在候
设*如果你有一个正确的密码，那么你可以登录到网络"”和"你有一个正确的密码"都为真。当用
表示“你有一个正确的密码"，用 g 表示“你可以登录到网络"，那么接下来必然的结论是“你可以合
录到网络"为真。这个论证有效是因为它的形式有效。注意，无论用什么命题蔡换户和9、且 pg
和户 都为真时，那么 9也肯定为真。

当用命题将这个论证形式替换到户和9，其中户和户一9 不都为真时会如何呢? 比如，假设
代表"你可以人网"，9 代表“你可以改变你的年级"，户为真，但是户-=9 为假。将 户和9 的值蔡换
为论证形式，得到的论证为:

“如果你能入网,那么你可以改变你的年级”
“你可以人网”
.“你可以改变你的年级”
得到的这个论证是有效论证，但是因为其中一个前提，即第一个前担，为假，所以不能得出结论
为实(有很大可能，这个结论为假) 。

在讨论中，为分析一个论证，用命题变量代替命题。这将一个论证改变为一个论证形式。我
们发现，一个论证的有效性取决于这个论证形式的有效性。用这些关键概念的定义来总结用于讨
论论证有效性的术语。

ER 命题逻辑中的一个论证是一连串的命题。除了论证中最后一个命题外都叫前提，最
后那个命题叫结论。当它的所有前提为真意昧着结论为真时，一个论证是有效的。

命题逻辑中的论证形式是涉及命题变元的一连串复合命题。当在前提中无论哪个特定命题被
转换为命题变元，当前提都为真时结论都为真，称为论证形式有效。

从有效论证形式的定义，当(户人户入…人户) -9是永真式时，论证形式的前提 户，户，…，户
以及结论 9 有效。

表示命题过辑论证有效的关键是表示出它的论证形式有效。因此，我们想要表明论证形式有
效的技术。现在我们将拓展完成这一任务的方法。

1.5.3 命题逻辑的推理规则

可以总是用一个真值表来表示一个论证形式有效。我们用无论何时只要前提为真，结论也就
肯定为真来表明做到这一点。然而，这会是完长乏味的方法。例如，当论证形式涉及 10 个不同变
量，用真值表表示这个论证形式有效需要 2一1024 行。幸运的是，我们不必求助于真值表。取而
代之，我们可以先建立一些比较简单的有效论证形式，称为推理规则。这些推理规则可以作为模
块来构造更多复杂的有效论证形式。现在我们将介绍命题逻辑中最重要的推理规则 。

永真式(刀人(一9)) 一9 是一个被称为假言推理或分离规则的推理规则的基础。(在拉丁文中
假言推断是指模式确认。)这个永真式导致了以下有效论证形式，即在我们开头论证的讨论中已经
看到的。(与前一样，这里符号…表示“所以”。)

户
之一9
0
用这个概念， 将前提写在一列，随之是一横线，它是以因此符号开头以结论结尾的一行。特别地，
假言推断告诉我们如果一个条件语句以及它的前提都为真，那么结论肯定为真。例 1 说明了假言
推断的应用。

例1 假设条件语句“若今天下雪，那么我们将滑雪”以及它的前提*今天正在下雪”为真。那

么.根据假言推断，条件语句的结论“我们将滑雪?为真。                        国

 



--- 第 59 页 ---
第1章 基础: 逻辑和证明 "41

就像前面提到的，当一个或更多前提为假时，一个有效论证可以导致错误的结论。 在例 2 中
将再次说明。

例2 决定如下给定的论证是否有效，并且决定由论证的有效性它的结论是否一定为真。

“如果V2二3/2，那么(V2):二(3/2): 。我们知道V2 盖3/2，因此 (V2)?一2盖(3/2)2一9/4。”

解 令旋为命题“<V2二3/2"”，令9为(V2)盖(3/2)。论证的前提 如-~上qg 和，g 是结论。这个
论证是有效的，因为是用假言推断这个有效论证形式来构造的。 然而， 其中的前提V2 盖372 为假。
因此不能得出结论为真。此外，注意这个论证的结论为假，因为 2一9/4。              画

表1-25 列出了最重要的命题逻辑推理规则。1. 2 节练习5 和8 要求证明这些推理规则为有效
论证形式。现在给出用这些推理规则论证的例子。在每一论证中，首先用命题变量表达论证中的
命题。那么所得出的论证结果是表 1-25 中的推理规则。

表 1-25 推理规则
声
声一@       fpA(记一0]一q          假言推理
9
mg
疡一     [DeA (户一9)] 一D轧       到拒式
了轧
恩一9
Q 一     [(z一9)A(ge一r)] 一(户-=方     假言三段论
四 一六
力V9
2I襄               [CPPVg)ADP]一9                     析取三段论
,9
户
v户V9   7
己人了
已      (户人9) 一户         化简
因
9 _     [CA(9)]一(PPAG)       合取
v访人9
记V9g
2户V-     [pvVe)ACnpVr)]--(qVr)     消解
QQVr

例3 说出哪个推理规则是下列论证的基础:“现在气温在冰点以下。因此，要么现在气温在
冰点以下，要么现在下雨。"
解 设尹是命题"现在气温在冰点以下”，而 4 是命题“现在正在下雨>。那么这个论证形如

.六V9
这是使用附加规则的论证。                                                  国
例4 说出哪个推理规则是下列论证的基础:“现在气温在冰点以下并且现在下雨。因此，现
在气温在冰点以下。”
解 设户是命厦“现在气温在冰点以下"，而 9 是命题“现在正在下雨”。这个论证形如
忆A人3
.办
这个论证使用化简规则。                                                    国



--- 第 60 页 ---
42。第1童 基础: 逻辑和证明

例5 说出在下列论证里使用哪个推理规则 :
若今天下雨，则我们今天将不野餐。若我们今天不野餐，则我们明天将野餐。因此，若今天
下雨，则我们明天将野餐。
解 设户是命题“今天下雨"，设 g 是命题“我们今天将不野餐”，而设 ~ 是命题“我们明天将野
扰”。则这个论证形如
户一9
Q一二
态一三

因此，这个论证是假言三段论。                                                     国

1.5.4 用推理规则建立论证

当有许多前提时，为了证明一个论证是有效的，常常需要多个推理规则。对此通过例 6 和例 7
来说明。在这些例子中每一步论证显示为不同的行，并明确地写出每步的理由。这些例子也说明
如何使用推理规则来分析用自然语言表述的论证。

例6 证明: 前提”今天下午没有出太阳并且今天比昨天冷*,“只有今天下午出太阳，我们才
去游泳",“若我们不去游泳，则我们将乘独木舟游览"”，以及*若我们乘独木舟游览，则我们将在
黄昏时回家”，导臻结论“我们将在黄昏时回家”。

E  解 设户是命题“今天下午出太阳”，9q 是命题“今天比昨天冷"，r 是命题“我们将去游

泳”"，s 是命题“我们将乘独木舟游览”，而上是命题“我们将在黄昏时回家”。则这些前提

成为]户Ag，r一户， mr一5，5一!。结论是 上。我们需要用假设]户Ag，r->户,Dr一5，以及一上 和
结论上 给出有效论证。

如下构造一个论证来证明这些前提得出需要的结论 。

步骤         理由

1.户人9      前提引人

2.-户        化简，用步骤 1

3.r一轧       前提引人

4. 六         取拒式，用步骤2和3
5.mr一5      前提引入

6. 5          假言推理，用步骤4和5
7. 5一>上       前提引入

8.

t         假言推理，用步骤6和?7

注意，可以用真值表表示无论何时，当4个前提为真，那么结论也为真。然而，因为用5 个变
元 、9、r、s 和+来操作，这样的真值表需要 32 行                    驾

例7 证明: 前提"“若你发给我电子邮件消息， 则我将完成编写程序"， “若你不发给我电子邮
件消息，则我将早早地去睡觉”，以及“若我早早地去睡觉，则我将感觉精力充沛地醒来"，导致结
论“若我不完成编写程序，则我将感觉精力充沛地醒来”。

解 设是命题“你发给我电子邮件消息”，9 是命题“我将完成编写程序"，r 是命题“我将早
早地去路党”，而 * 是命题“我将感觉精力充沛地醒来"”。则这些前提是 户-一q9，Dp-~r，r~>s。需要
的结论是"4一*。我们需要用假设 关一g，Dzbn一r，以及r一* 和结论9一:给出有效论证。

下列论证证明这些前提得出需要的结论 。

步骤           理由

1.户一9         前提引入

2. 9一站旋        步骤 1 和逆否命题
3. 门户一7        前提引人

4.9一六        假言三段论，用步骤2和3



--- 第 61 页 ---
第1章 基础: 逻辑和证明，43

5 产一了           前提引入
人.站 一3        假言三段论，用步骤4和5                                    加
1.5.5 消解

.3 已经开发出自动执行推理和证明定理任务的计算机程序。许多这类程序利用称为消解
一”resolution)的推理规则。这个推理规则基于永真式:
((pV9IACDphVvVnm)一VD
消解规则最后的析取 9Vr称为消解式(resolvent)。当在此永真式中令 g9=r时，可得(pVg)A(-pP
V9) 一9。而且，当令 一时，可得(V9)A(5p) 一9(因为9VEF=9)，这是永真式，析取三段论
规则便基于此式。
例8 使用消解证明假设“Jasmine 在滑雪或没有下雪”和”下雪了或 Bart 在打曲棍球”芍含结论
“Jasmine 在滑雪或 Bart 在打上曲棍球。”
- 解 令刀为命题“下雪了”，9 为命题“Jasmine 在滑雪”，r 为命题“Bart 在打曲棍球”。
我们可以将假设分别表示为ppV9g和zVr。使用消解，命题 gVr成立。         国
消解在基于逻辑规则的编程语言中扮演着重要的角色，如在 Prolog 中(其中用到了量化语句的
消解规则)。而且，可以用消解来构建自动定理证明系统。要使用消解来构造命题逐辑中的证明，
假设和结论必须被表示为子名，子句是变量的析取或这些变量的否定。我们可以将命题逻辑中非
子句的语句用一个或多个等价的是子句的语句替换。例如，假定有一个形如 庆V(qeAr)的语句。因
为mV(qAnm=(六Vg)A(CpVr)，便可以用两个子句庆Vg 和户Vr来代替请V(qAr)。我们可以用
语句”7户和59来代蔡形如npVag)的语句，因为德摩根律表明](pVg9)拓1pAD9。也可以用等价的
析取ziV9来代替列含户一q。
例9 证明假设(Ad) Vr和-~~s获含结论Vs。
解”可以将假设(记A9)Vr重写为两个子句娟Vr和qyVr。也可以将 r->s 替换为等价的子句
nrVs。使用子句 训Vr 和nrVs，通过消解便可得出 pVs。                            困

1.5.6 廖误

几种常见的衣误都来源于不正确的论证。这些廖误看上去像是推理规则，但是它们是基于偶
然事件而不是永真式。在这里讨论这些雇误，是为了说明在正确与不正确的推理之间的区别。
和5 命怕[(p一9) 入]一不是永真式，因为当户为假而9 为真时，它为假。不过，存在许

“多把它当做永真式的不正确论证。换句话说，对于前担 户-9 和9 及结论 户不是有效论
证。这种类型的不正确推理称为肯定结论记误。

例 10 下列论证是否有效?

若你做本书的每一道练习，则你将学习离散数学。你学习过离散数学。

因此，你做过本书的每一道练习。

解 设少是命题“你做过本书的每一道练习"。设 9 是命题“你学习过离散数学"。这个论证形
如 若 P-~9 并且9，则 户。这是使用肯定结论这误的不正确推理的例子。事实上，你可能通过其
他某种方式学习离散数学而没有做本书的每一道练习。(你可能通过阅读、听讲座、做本书的一些
但不是全部练习等方式来学习离散数学.)                        加

命题 |(户一9) AP] 一)户不是永真式，因为当 为假而9 为真时，它为假。许多不正确的论
证都不正确地把它当作了推理规则。这种类型的不正确推理称为否定假设亩误。

例11 设户和9 如同例 10 那样。若条件语句 P-~9 为真，并且-为真，则得出1p 为真这是
否正确? 换名话说，如果假定，若你做本书里每一道练习，则你将学习离散数学，那么假定;车
你没有做过本书里每一道练习，则你没有学习离散数学，这是否正确?

解 即使你没有做过本书里每一道练习，你也可能学过离散数学。这个不正确的论证具有形
式: 一9 和-轧莉含9，这是否定假设雇误的例子。                  国



--- 第 62 页 ---
44 "第1章 基础: 逻辑和证了明

1.5.7 带量词命题的推理规则

已经讨论了命题的推理规则。现在将要描述包含量词的命题的一些重要的推理规则。在数学
论证里大量地使用这些推理规则，通常都没有明确地指出来。

全称例示 用它从前提 YzrP(z)得出 P(c)为真，其中是论域里的具体成员。当从命题“所有
女人都聪明”得出“丽沙聪明”时，就使用了全称例示，其中丽沙是论域所有女人中的一员。

全称生成”它说明在对论域里所有元素来说P(c)都为真的前担下 ，YzP(z)为真。当通过从
论域里拿出一个任意元素 c 并证明 P(c)为真来证明 YrzP(z)为真时，就使用了全称生成。所选择的
元素 c 必须是论域里一个任意的元素，而不是特定的元素。也就是说，当从 Yrzp(z)断言论域中的
每一个元素<c，而没有控制 c，但不能得出任何其他关于 c 的假设，除非c 属于论域中。在许多数学
证明里都隐含的使用全称量词的引入，而很少明确地指出来。然而，当应用全称生成时，在错误
的推理中增加关于任意元素c 莫须有的假设是屡见不鲜的。

存在例示 在允许从已经 3zP(z)为真，得出在论域里存在一个使得 P(c)为真的元素 c。在这
里不能选择一个任意值的c，而必须是使得 P(c)为真的那个 <。通常不知道 c 是什么，仅仅知道它
存在。因为它存在，所以可以给它一个名称(c)而继续论证。

存在生成”用它在已知使 P(c)为真的一个具体的<时，得出 3zP(z)为真。即若知道论域里一
个使 PCc)为真的元素c，则知道 3zP(z)为真。

这些推理规则总结在表 1-26 里。下面的例子将要说明如何使用带量词的命题的推理规则。

表 1-26 带量词的命题的推理规则

    
    
   
    
                                                                                                                                                                                                                                                                 

推理 规则

VYrP(z)

PP(c)                                                                    全称例示

Pf(c)，任意

VPCZ)                                                           全称生成

3了rP(Czr)
小P(c)，对某个元素 c

P(c)，对某个元素 <
*… 了xzP(z)

存在例示

存在生成

  
 

例 12 证明前提”*在本离散数学课堂的每一个人学过一门计算机课程"和"*玛拉是本课堂的学

生"芍含结论“玛拉学过一门计算机课程”。
到  解 ”设D(z)表示“z在本离散数学课堂*，并且设 C(z)表示“z 学过一门计算机课程”。
则前提是 Vz(CD(z) 一C(z))和 D(玛拉)，结论是 C(玛拉) 。下列步又可以用来从前提证

明结论 。
步骤                         理由
1. Vzr(CD(z) 一CCz))           前提引人
2. D(玛拉) 一C(玛拉)        全称例示，用步骤 1
3. D(玛拉)                    前提引人
4. C(玛拉)                假言推理，用步骤2和3                      |

例13 证明前提"*在这个班上的某个学生没有读过书”和*班上的每个人都通过了第一门考试
荀含结论“通过考试的某个人没有读过书”。

解 令C(z)表示“z在这个班中"，B(z)表示“z 读过书了”，P(z)为“z 通过了第一门考试"。
则前提是 3z(C(Cz) AnB(Cz))和Yzr(CCz) 一PCz))，结论是3z(P(z)A人AnnB(Czr))。下列步骤可以用来
从前提证明结论 。



--- 第 63 页 ---
第1章 基础: 运辑和证明 "+45

步骤                         理由

1. 3zr(CCCz) 人BCz))          前提引人

2. CC(a) 人DB(Ca)            存在例示，用步骤 1

3. C(a)                      化简，用步骤 2

4.VzrCC(r) 一已(Cz))           前提引人

5. C(a) -> P(a)                全称例示，用步骤 4

6. P(a)                  假言推理，用步骤3和5

7.一BCa)                    化简，用步骤 2

8. P(a) 人DB(a)            合取，用步骤6 和?7

9. 3zr(CP(z) 人DB(Czr))          存在生成，用步骤8                           国

1.5.8 命题推理和量化语句推理规则的结合
我们已经学习了命题推理规则和量化语句的推理规则。注意，在例12 和13 中的论证既用了全
称例示(量化语句推理规则?也用了假言推理(命题推理规则)。我们常常需要对推理规则结合使用。
由于全称例示和假言推理结合使用如此广泛，这个规则的结合有时称作全称假言推理。这个规则
告诉我们: 如果 Yzr(P(z) 一QCz))为真，且如果 P(a)对在论域中的一个特定元素 a 为真，那么 Q
(a)也肯定为真。为便于理解，注意用全称例示，P(a) 一Q(a)为真。那么，用人很言推理，Q(a)也
肯定为真。可以将假言推理描述如下 ，
VzCPCz) 一QCz))
P(a) ,其中< 是论域中一个特定的元素
"QQ(Ca)
全称假言推理常常用于数学论证中。这将在例 14 中说明 。
例14 假定“对所有正整数 nn，如果?比4大,那么和到小于2"?为真。用全称假言推理证明
1002一2 。
解 令 PC表示"nm>42，Q(m)表示“*于一2语句“对所有正整数ma，如果?比4大,那么至小
于 2""可以表示为 (PC ~~Q(Ca))，其中论域为所有正整数。假设 wm(P(n 一Q(Cn) )为真。注意
P(100)为真，因为 100定4。接着用全称假言推理，Q(m) 为真，即 100:一2 。            画
另一个重要的命题逻辑推理规则和量化语句的推理规则的结合是全称取拒式。全称取拒式结
合了全称例示和取拒式，可以用如下方式表达: -
Vz(CP(z) -> QCz))
= Q(Ca) ,其中是论域中一个特定的元素
了(a)
将全称取拒式的证明留给读者(见练习 13) 。

练习
1. 给出下列论证的论证形式化，并决定是否有效。如果前提为真，能断定结论为真吗?
如果苏格拉底是人，那么苏格拉底是会死的。
苏格拉底是人
…苏格拉底是会死的
2. 在下列每个论证里使用了什么推理规则?
a)爱丽丝主修数学。因此，爱丽丝主修数学或计算机科学。
b)杰瑞主修数学和计算机科学。因此，杰瑞主修数学 。
c)若天气下雨，则游泳池将关闭。天气下雨。因此，游泳池关闭。
d)若今天下雪，则大学将关闭 。今天大学没有关闭。因此，今天没有下雪。
e)若我去游泳 ，则我将在太阳下停留过久。若我在太阳下停留过久，则我将有晒班。因此，若我去游泳 ，
则我将有了晒斑。



--- 第 64 页 ---
46 "第1章 基础: 逻辑和证了明

3. 使用推理规则证明前提”*兰迪努力地工作”",“若兰迪努力地工作，则他是一个繁孩子"，和“”*若兰迪是一个
繁孩子，则他将得不到这个工作"蕴含着结论*兰迪将得不到这个工作”。
. 在下面的著名论证里使用了什么推理规则?“所有的人都是要死的。苏格拉底是人。因此，苏格拉底是要
死的”。
. 对下列的每组前提，可以得出什么样的相关结论或一组结论? 解释从前提获得每个结论所使用的推理
规则 。
a)若我在某一天休息，则那天下十或下雪”。“我在周二休息或在周四休息".。“周二出太阳”。.“周四未
下雪”。
b)“若我吃了状的食物，则我做奇怪的梦".“若当我睡觉时有雷声，则我做奇怪的梦?。“我没有做奇怪
的梦”。
c) 我聪明或幸运"。“我不幸运"。“若我幸运，则我将赢得抽奖”。
d)* 每个主修计算机科学的人都有个人电脑"。 “拉和尔夫没有个人电脑”.“安妮有个人电脑”。
e)对公司有利的就对美国有利".。“对美国有利的就对你有利”。“对公司有利的就是你购买许多东西"。
人"所有的路齿类动物都哨它们的食物".“老鼠是哮齿类动物"。“野兔不哺它们的食物"。 “蝙蝠不是哮齿
类动物”。
6. 证明如果论证形式由前提 户，户，…，因，9及结论> 有效，则论证形式由前提 户，思s，…，加 及结论
qd一r 有效。
. 对下列每个论证，解释对每个步骤使用了哪条推理规则。
a) 本班学生道格知道如何用 Java 写程序。知道如何用 Java 写程序的每个人都可以得到高薪的工作。 因
此，本班的某个人可以得到高薪的工作。”
b) ”本班的某个人喜欢观察生鱼。每个喜欢观察鲸鱼的人都关心海洋污染。因此，本班里有某个人关心海
c) 本班的 93 个学生每人拥有一台个人电脑。拥有个人电脑的每个人都能使用字处理软件。因此，本班学
生泽克能使用字处理软件.”
d) “新泽西的每个人都生活在距离海洋 50 英里之内。  新泽西的某个人从来没有见过海洋 ，  因此，生活在距
离海洋 50 英里之内的某个人从来没有见过海洋.”
. 判断下列论证是否正确并解释原因。
a)班上的所有学生都理解逻辑 。Xavier 是这个班上的学生，因此，Xavier 理解逻辑。
b)每个计算机专业的学生都要学离散数学。Natasha 在学离散数学，因此，Natasha 是计算机专业的。
c)所有网囊都喜欢水果。我养的乌不是鹦鸥，因此，我养的鸟不喜欢水果。
d)每天吃麦片的人都很健康。Linda 不健康，因此，Linda 没有每天吃麦片。
9. 如下论证错在哪里? 令 瑟(z)为“z 很开心”。给定前提 3z刀(zx) ，我们得出 瑟(Lola) 。因此，LoLa 很开心 。
10. 判定下列每个论证是否有效。若论证是正确的，则使用了什么  失理规则? 若它不正确，则发生了什么
订误?
a)若半是使盖1 的实数，则 宕这1。假定姑之1。于是 x僵1。
b)若?是使二3 的实数，则 严宇9。假定下近9，于是 "委3。
c)若半是使这2 的实数，则 喷症4。假定 mx委2，于是 妈委4。
11. 哪些推理规则被用来证明在 1. 3 节例 26 里所描述的卡洛尔(Lewis CarrolD)论证的结论?
12. 指出如下由“3zP(z)A 3zQ(zr)为真，那么 3z(CP(z)AQGCz))为真"的论证有哪些错误。

心

cn

~

Co

1) 3zP(z)A 3zQ(Cz)        前提引人

2) 3zP(z)             化简，用步骤 1
3)P(c)               存在例示，用步骤 2
4) 3zQ(z)     .        化简，用步骤 1
5)QCc)                存在例示，用步骤4
6)P(Cc) AQGCc)              合取，用步骤3和5
7) 3z(CP(Cz)AQCzr))       存在生成

13. 通过证明前提 wz(CP(z) 一Q(z))和”Q(a)，其中是对论域中某个特定元素 e，推出-P(e)，来证明全称取
拒式。



--- 第 65 页 ---
第1章 基础: 还辑和证明 "47

14, 用推理规则证明: 若 Vr(CP(r)一(QGCrz)ASGCz)))和Vr(CP(zr)AR(Czr))为真，则 YzrCR(Cr)ASCz))为真。

15, 用推理规则证明: 若 Yzr(P(z)VQCr))和Yr(CnQ(z)VSCz))，wr(RC) 一SG)和3rnPCz)为真，则
3znR(zr)为真。

16. 使用消解法证明前提”*天上没有下雨或 Yvette带雨伞了”、“Yvette 没有带雨伴或她没有被淋湿”和“天上下
雨了或 Yvette 没有被淋湿"芍含“Yvette 没有被淋湿”。

17. 用消解法证明复合命题(ppV9)A(npvVg)A(CpVne)A(npVn9q)不是可满足的。

xl18. 判定下列论证(来自Kalish and Montague[LKaMo64])是否有效:

假如超人能够并愿意防止邪恶，则他将这样做。假如超人不能够防止那恶，则他将是无能的; 假如

超人不愿意防止邪恶，则他将是恶意的。 超人没有防止邪恶。苦超人存在，则他是无能的或恶意的。因
此，超人不存在。

1.6 证明导论

1.6.1 引言

本节介绍证明的概念，以及描述构造证明的方法。证明是建立在数学语句真实性基础上的有
效论证。证明可以用定理(如果有的话)，假设为真的公理以及之前已经证明的定理的假设。用这
些组成部分以及推理规则，证明的最后一步是建立被证明命题的真实性。

在我们的讨论中，从形式化定理证明转向非形式化证明。在 1.5 节介绍的涉及命题和量化语
句为真的论证是形式化证明，其中提供了所有步又，以及给出论证中每一步的所有规则。然而，
有用的定理形式化证明会很长且极难给出。实际上，人们使用设计的定理证明几乎都是非形式化
证明，其中许多推理规则用于每一步，其中的许多步骤被省略，没有明确列出其中的假设公理和
用到的推理规则。非形式化证明常常向人们解释定理为什么为真，虽然计算机很愿意用自动推理
系统产生形式化证明。

本节讨论的证明方法很重要，不仅因为它们用于证明数学定理，而且由于它们中的许多应用在
计算机科学中。这些应用包括证明计算机程序是正确的，建立安全的操作系统，用人工智能做推理，
表明系统说明是一致的，等等。因此，在数学和计算机科学中理解用于证明的技术都非常关键。

1.6.2 一些专用术语
正式地，一个定理是一个能够表明是真的语句。在数学的描述中,定理通常是用来表

”未被认为至少有些重要的语句。有时把不大重要的定理称为命题(定理也作为事实或结
论被提到) 。一个定理可以是带一个或多个前提的条件语句及一个结论全称量化。然而它可以是其
他类型的逻辑语句。本节后面有一个例子，示范一个带有证明的定理是真的。当建立了定理的真
实性时，一个证明就是个有效论证。用在证明中的语句包括公理(或假设)，假设这些语句是真的，
如果有的话，定理的前提和以前已经证明的定理。公理用不要求定义的原始术语陈述，而在定理
和证明中所用的其他所有术语都必须定义。推理的规则和术语的定义一起用于从其他的断言推出
结论，并详列出证明的步又。实际上,证明的最后一步通常丛是定理的结论。然而，为清晰起见，
在证明的最后一步，通常重述定理的结论 。

在其他结果证明中很有帮助的不大重要的定理称为引理(复数引理)。复杂证明用一系列引理
来证明通常比较容易理解，这里每一个引理都被独立证明。推论是从定理直接建立被证明的定理。
猜想是被提出为真的命题，通常是在一些依据的基础上，启发式论证，或是专家的一个直觉。当
找到了一个猜想的证明时，猜想就变成了定理。许多猜想表明是错误的，因此它们不是定理。

1.6.3 定理陈述的理解
在介绍证明定理的方法之前，我们需要理解有多少数学定理被陈述。许多定理断言一个性质
对论域(比如整数或实数)中的所有元素都成立。虽然这些定理的准确陈述需要包含全称量词，但
是数学里的标准约定是省略全称量词。比如，语句
“如果 z>y，其中和> 是正实数，那么 蒂之六。



--- 第 66 页 ---
48*第1章 基础: 逻辑和证明

其实意味着

“对所有正实数 zx 和y，如果z>>y，那么妆二风。
此外，当证明这种类型的定理时，常常使用全称例示规则而不明确地指出来。证明的第一步通常
涉及选择论域里的一个一般元素。随后的步骤是证明这个元索具有所考虑的性质。最后，全称生
成蕴含着对论域里所有元素来说定理都成立。

1.6.4 证明定理的方法
ws 现在将注意力转向数学定理的证明上。证明定理会很难。需要所有能帮助我们证明不

    同结果的“弹药(方法) 。现在介绍一系列不同证明方法。这些方法应该成为你证明定
理的部分“拿手戏"。

为证明形如 yzr(P(z)一QCz))的定理,我们的目标是表示出 P(c) 一Q(c)为真，其中ec 是论域
中的任意一元素，然后应用全称生成。在这个证明中，需要表示出条件语句为真。回忆 请~9 为
真，除非 户为真且9 为假。注意当证明语句 PP一g 时，只需要证明如果 户为真则4 为真。下面的讨
论将给出条件语句最常见的证明方法。之后，将讨论证明其他类型语句的方法。在 1.7 节，将介
绍许多不同的可用于证明多种定理的证明技术。

当读到证明时，你将常常会发现词语“显然”或者"清楚的”。这些词意味着许多步骤已经省略
并希望读者有能力补上。遗憾的是，这个假设往往无法保证，读者根本不确定怎么补上这些省略
的步骤。我们将努力避免用这些词，并努力避免省略太多步骤。然而，如果包括了证明中所有的
步又，我们的证明将会非常宛长 。

1.6.5 直接证了明

构造一个条件语句 户-一4 的直接证明，第一步假设 训 为真;接下来的步骤是用推理规则构造
的，最后一步推出 9 也肯定为真。直接证明用于推出如果 户为真，那么 g 也肯定为真，以致 为
真、49 为假的情况不会发生的方法表示出条件语句请-4 为真。在直接证明中假定 户为真，并且用
公理、定义和前面证明过的定理以及推理规则，来证明出 g 也肯定为真。你将发现许多结果的直
接证明相当直接，它是用一连串显然的步骤从假设隐含到结论。然而，直接证明有时要求特殊的
洞察力并且可能会是需要技巧的。这里呈现的第一个直接证明相当直接; 之后，你会看到一些不
那么显而易见的证明。

我们将提供几个不同的直接证明。在给出第一个例子前，需要一个定义。

 整数了是偶数，如果存在一个整数上使得一2k; 整数交是奇数，如果存在一个整数
&使得n一2k十1。(注意，一个整数或为偶数或为奇数。)

例1 给出定理“若z是奇数，则 于 是奇数”的直接证明。     ，

到 解 注意，这个定理表明 w(P(n) 一Q(a)，这里 P(m)是“是奇数"，Q(z) 是“呈 是奇
   数”。正如已经说过的，我们将遵循数学证明中通常的惯例,证明 P(n)意味着 Qnr)，

而不用全称例示。为开始这个定理的直接证明，假设这个条件语句的前提为真，即假设”是奇数。
由奇整数的定义，有 一2十1，其中&是某个整数。想证明始 也是奇数。把等式 n= 2k十1 两边平
方，这样做得出愉一(24十I)一4外十4十1一2(2外十24)十1。由奇数定义，得到结论既是奇数(它
是一个整数的 2 倍再加 1) 。因此，证明了若 ”是奇数，则冯 是奇数。                 国

例2 给出一个直接证明: 如果靖和?都是完全平方数，那么 nm 也是一个完全平方数。(著
有一个整数5，使得 a一站，则整数 “ 是一个完全平方数。)

解 ”为产生出这个定理的一个直接证明，假定这个条件语句的假设为真。即假定mm 和)都是
完全平方数。用完全平方数的定义，则有整数* 和:+ 使得六=站，x一刀。证明的目的是表示出 mm
也是完全平方数。向前看到的，将两个等式 mm=? 和"一己 乘起来证明。这就得到 mn一%z，也就
是 mn一(xs "(用乘法交换律和结合律)。由完全平方数的定义，mn 也是一个完全平方数，因为它
是st 的平方，而 st 为整数。这就证明了如果 m 和 都是完全平方数，那么 nm 也是一个完全平
方数。                                                        国



--- 第 67 页 ---
第1章 基础: 逻辑和证阴。49

1.6.6 反证法

直接证明从定理的假设推出结论。 它们从前提开始，继续一连串的推演，最终结束于结论。
然而，我们将发现直接证明方法常常行不通。我们需要形如 Yr(CP(Cz) ~Q(Cz))的定理的其他证明
方法。这种类型的定理证明不是直接证明，也就是说，不从假设开始，以结论结束，这叫做间接
证明。

一个非常有用的间接证明的类型叫做反证。反证用条件语句 训一g 等价于它的倒置ng ->5记的
事实。这意味着条件语句 户一g 可以用它的倒置上g一5户来证明。在用 训一gd 的反证中，将9 作为
假设，胃公理、定义和前面证明过的定理，以及推理规则，之后证明”za。我们将用两个例子解释
反证。这些例子表明当不容易找到直接证明时用反证会很有效。

例3 给出定理“若 3十2 是奇数，则 ”是奇数”的证明。

za- ，解首先，试图用直接证明。为构建直接证明，首先假设 3十2 是奇整数。这意味着
对某个整数 &，37?十2一2&十1。我们能由此证明)”是奇数吗? 看到 3十1一2k，但不能
用任何直接的方式得出”是奇数的结论。由于直接证明的想法失败，下面尝试反证法。

反证法的第一步是假设条件语句“若 3十2 是奇数，则”是奇数”的结论是假的; 也就是说，假
设”是偶数。于是由偶数定义，对某个整数上有?一2kK。把浆用2代入，得到3n十2一3(2&) 十2一
6A十2一2(3A十1) ，这告诉我们 3z十2 是偶数(因为它是 2 的倍数) ，因此不是奇数。这是定理前提
的否定。因为对这个条件语句结论的否定蕴含着前提为假，所以原来的条件语句为真。反证法成
功，证明了定理“若 3"十2 是奇数，则 是奇数"。                              男

例4 证明: 如果z一ap，其中 和0 是正整数，那么 evz 或者5<<vV。

解 ”因为没有明显的方法从等式 "一ap(其中 和 是正整数)直接证明 ao且yz或者5过和，所

反证法第一步是假定条件语名"如果 一a，其中 a 和六是正整数，那么 ec过vVz或者5去V7”的
结论为假。也就是说，假定(e和yz) V (6过Vn ) 为假。用析取和德摩根律，发现这表明(a<委v兢) 和
(Co<vnm)都为假。 可以将不等式乘起来(用的事实是如果 0<-:且 0二uv，那么 sw<t)得到 ab全VA yx
wm 一?z。这表明了 ab天z，这与命题 ”一o了矛盾。

因为条件语名结论的否定意味着前提为假，原来的条件语句为真。反证成功，这就证明了如
果 一a0，其中a 和0 是正整数，那么 as过vr或者5去Vn 。                         显

空证明和平凡证明 当我们知道 户为假时，能够很快证明条件语句 训~>g 为真，因为当畏为假
时户一9 一定为真。结果，如果能证明出 如为假，那么就得到一个 p->q 的证明方法，叫做空证明。
空证明常用于证明一些定理的特殊情况，这些定理说:对所有正整数来说，一个条件语句为真(即
形如 WP()的定理，其中 PCx)是命题丽数) 。

例5 证明命题 P(0)为真，其中 P(m是“若 z宇1，则 妈富，论域是所有整数。

解 ”注意命题 P(0)是条件语句*若 0>1，则 0:盖0"”。因为前提 0>1 为假，所以 P(0) 自动地
为真。                                                          |

注意”条件语句的结论 }二0 为假这个事实，与条件语多的真值无关，因为前提为假的条

件语句保证为真。

如果我们知道结论 9 为真，很快就能证明条件语句 户g。通过证明 9 为真，紧接着得出 户->
`定为真。用 9 为真的事实来证明户-9 的方法叫做乎凡证明。当证明定理的特殊情形(见 1.7 节
分情形证明的讨论)时，以及在数学归纳法中，平凡证明常常是重要的。

例6 设 P(m)是"若 a 和避是满足na之?的正整数，则 必伺”，其中论域是所有整数。证明命
题 P(0)为真。

解 ”命题 P(0)是“若 <之2，则 四关久"。因为四=名王1，条件语名“车 ec5，则 @伍部”的结论



--- 第 68 页 ---
50U "第1章 基础: 逻辑和证明

为真。从而条件语句 P(0)为真。这是平凡证明法的一个例子。注意在这个证明里不需要前担，它
是语句“a壹妇。                                                    国
证明的小策略”我们已经介绍了证明形如 Yr(P(z) -一Q(Cz))这类定理的两种重要方法: 直接
证明和反证法。我们还给出了示例说明如何使用每种方法。然而，当面临证明形如 Vz(PCz) 一
Q(z))定理时，要使用娜一种方法呢? 这里将提供一些拇指法则，1. 7 节将更详细讨论证明策略。当
我们想要证明形如 wz(CP(Cz) ~Q(Cz))的语句时，首先，快速评估一下直接证明是否可行。这通过扩展
前提中的定义开始，然后使用它们(以及公理和可用的定理)进行推理。如果直接证明看来没什么希
望，做同样的步骤试一下反证。回顾在反证中，要假设条件语句的结论为假，并使用直接证明法表
明这意味着前提必为假。例7 和例 8 演示了这种策略。在给出示例前，先介绍一个有用的定义。
ER罗 若存在整数训和4(9q天0)使得 r=一罗/9g，实数 >是有理数。不是有理数的实数称为无

 

理数。

例7 证明两个有理数的和是有理数。(注意，如果这里包括隐含量词，这个定理我们想证明 :
“对于任意的实数>和*，如果-和:是有理数，则 r十*是有理数。)

解 ”首先尝试直接证明。假设~和:* 是有理数。 由有理数的定义，可知存在整数户和9

(9天0)使得 -= 训/qg，存在整数 和xz(x天0)使得 :=上/uv。我们能用这个信息证明 *十* 是
有理数吗? 很显然，下一步是相加 r=一刀/g 和一tx，得到

r十二记二工一如十@
9   到     QU

因为 9天0 且 x天0，所以 gx天0。因此，r二已经被表示为两个整数 au十gt 和9u 的比，其中
du天0。这表示 r十: 是有理数。我们已经完成了两个有理数的和是有理数的证明，直接证明成
功了。                                                              图

例8 证明: 如果)是整数且产 是奇数，则 是奇数。

解 ”首先尝试直接证明。人假设”是整数且产 是奇数。那么，存在整数&使得既一2二1。我们
能用这个信息证明 ”是奇数吗? 看来没有明显可行的方法，因为求解 上会得出等式i一士 V2A十1 ，
这没有什么用。

因为直接证明没有达到目的，下面尝试反证。我们将语句“zz不是奇数"作为前提。因为每个整
数不是奇数便是偶数，这意味着 ”为偶数。这表示存在整数上使得一24。要证明这个定理，我们
需证明这个前提和蕴含着“刀 不是奇数"的结论，即 双 是偶数。我们能用 "= 24 实现这个目标吗? 对
这个等式的两边取平方，可得 窒一4参一2(2忆) ，这表示下 也是偶数，因为刀一2t(其中一2对) 。
我们已经证明了如果是整数是六 是奇数，则 关是奇数。反证成功了。                         国

1.6.7”归廖证明

假设我们想证明 请是真的，假定可以找到矛盾式 g 使得7户一9 为真，因为 9 是假的,mp一4
为真，我们能够得出”妃必然为假，这意味着 户 为真。怎样才能找到矛盾式 9，使其帮助我们证明
户是真的?

因为无论 >是什么命题, ~Anr都是矛盾式。如果我们能够证明对一些命题 r>，5户一(rA人六
为真时，就能证明 户是真的。这种类型的证明称为归户证明。由于归订证明不能直接证明一个结
果，因此它是另一种间接证明的类型 。

下面给出几个归廖证明的例子。第一个例子是铅巢原理(将在 3. 2 节深入介绍?的应用。

例9 证明, 在任意 22 天中至少有4 天属于一个星期的同一天。
RE  解 令尹为命题“在任意 22 天中至少有4天属于一个星期的同一天”。假设户为真。

这意味着 22 天中至多有 3 天属于一个星期的同一天。因为一个星期有?7 天，所以至多

可以选择 21 天。这样得到一个与 22 天的选择矛盾的假说。也就是说，如果 - 是命题“22 天被选
择”，当知道 户是真的，那么我们能够推出bp-*(rADr)。因此,已经证明了任意 22 天中至少有4
天属于一个星期的同一天。                                             重



--- 第 69 页 ---
第1章 基础: 运辑和证明。51

例 10 通过给出归廖证明来证明: V2是无理数。

解 设户是命题“V2是无理数"”。假定-户为真。从归廖证明开始，假定上z 为真。注意”户表示
“并非V2 是无理数”，这就是说V2 是有理数。我们将要证明z为真的假设导致矛盾。

如果V2是有理数，则存在整数 ae 和4满足2=a/p，其中a 和如没有公因子(所以分数 a/5 是既
约的)(这里用到了事实: 每个有理数都能写成既约分数) 。因为VZ =一a/，所以当这个等式的两端
都平方时，就得出 2一ca/戎。因此，2姑一a 。

根据偶数的定义，则 愤 是偶数。下面应用事实: 若 地 是偶数，则 a 也一定是偶数。另外，因
为&是偶数，由偶数的定义，所以对某个整数<，有 a=2c。因此 2姑一4c: 。

等式两边除以2得: 天一2c 。

由偶数定义，这意味着六 是偶数。再应用事实; 如果一个整数的平方是偶数，那么这个数自
身也一定是偶数。因此，我们得出力也必然是偶数。

现在，已经证明假设-户导致等式/2=a/b，其中和总没有公因子，但 ec 和六都是人数，也就
是说2 整除a 和0。注意到命题V2 一a/，其中 a 和已没有公因子，实际上意味着 2 不能整除< 和2。
由于对”户的假设导致 2 整除a 和与 2 不能整除 ae 和矛盾，-户一定是假的。也就是说，命题
户:“V2 是无理数”是真的。我们完成了证明V23是无理数。                国

归廖证明能够用于证明条件语句。在这样的证明中，首先假设结论的和否定。然后应用定理前
提和结论否定得到一个矛盾式。(这样证明是有效的推理原因是依据 户->*g 和(bpADoc) ->F的逻辑等
价。为发现这些语句等价，简单注意每个在特定的一种情况下为假，即当 请为真且z 为假时。)

注意，对一个条件语句的反证可以改写成归雇证明。在请~g 的反证里，假定]9 为真而证明
-户也必然为真。为了把 户9 的间接证明改写成归雇证明，假定 p 和59 都为真。然后利用
”9一n户的证明步又，来证明”妨也必然为真。这样就得出矛盾式 人-训，由此完成归订证明。例
11 说明如何把对条件语句的反证改写成归雇证明。

例11 给出定理*若 3十2 是奇数，则 ”是奇数”的归衣证明。

解 ”假定户表示"32十2 是奇数”，q 表示“? 是奇数”。为构造归雇证明，假设 训和-cg 都为真。
也就是假设 3?十2 是奇数而” 不是奇数。因为”不是奇数，所以”是偶数。按照在例 3 解答里步骤
(归尊证明) ，可以证明若 ”为偶数则 3*十2 是偶数。首先因为偶数，存在整数于使得交一2K。这
意味着 3十2一3(2A) 十2一6&十2一2(34十1) 。由于 3n十2 是 25，这里 := 3十1，3n十2 是偶数。注
意到D户表示“3n十2 是偶数”，因为一个整数是偶数当且仅当它不是奇数。由于设 训和D户都为真，
得出一个矛盾式。这完成了一个归雇证明，证明了如果 3"十2 是奇数，则 ”是奇数。证毕。  图

注意，也能用矛盾式证明 户-9 是真的，通过假设 训和eg 都为真，来证明 g 也一定为真。这
意味着 9 和9 都为真，矛盾。这一点告诉我们，能够转变一个直接证明为归订证明。

等价性证明 为了证明一个定理是双条件的，即形如 **g 的语句，我们来证明 户->g 和q ->户
都是真的。这个方法的有效性建立在

(prq)[(D->9g) 人(9一力)]
是重言式。

例 12 证明定理“整数是奇数当上且仅当z2z: 是奇数”。

解 这个定理是形如*户当且仅当9g”，其中户是“是奇数”而 g 是“兰 是奇数"。(通常不
明确地处理为全称量化.)为了证明这个定理，需要证明 ->*g 和9 一户都为真。

已经证明了(在例 1 里)记~>d 为真且9 一户为真(在例8 里) 。

因为已经证明了 户-9 和9一户都为真，所以就已经证明了这个定理为真。       国
有时候定理说几个命题都是等价的。 这样的定理说命题 思，，jpb，…，力 都是等价的。 这
个定理可以写成

户 +>轧:>四。



--- 第 70 页 ---
52。*第1章 基础: 远辑和证明

它说所有的”个命题都具有相同的真值、因此对所有的z 和三，其中 1过i秋ma，1)和m，户 和思 是
等价的。证明这些命题互相等价的一种方式是使用永真式

[户人记念一各)人(人训一访)人…人人(p态)]
这个永真式说明，若可以证明条件语句 办 一记，岂:一四,一轧 都为真，则命题 亡 ，轧: ，
轧，…，jp, 都是等价的。

这更加充分地证明对所有的 ;i夫) ，1近过mn，1和过)之2，都有 户一户。

当要证一组命题等价时，我们可以建立一个条件语句链，只要能够证明链中任一个推出另一
个。例如，通过证明 户一户、思一户、思一如，就能够证明 六、刀、思 是等价的。

例13 对于整数 z，证明下列三个语句等价;

户: ?是偶数

六 : 7一] 是奇数

疡: : 7 是偶数

解 ”为了证明这些语句等价，证明条件语句 户一户，妨一六 和访一六 都为真。

将用直接证明来证明 名一户 为真。假定为偶数，则对某个整数上来说，有 mn一24。因此，
mn一]一24一1一2(k一1)十1。这意味着 "一1 是奇数，因为它形如 2m十1，其中m一K一1 。

仍用直接证明来证明 妨一户。现在假定 ”一1 是奇数，则对某个整数&来说，有 "一1一2&十1。
因此，z一2十2，开一(2k十2)一4如十8十4一2(2习十4人十2)。这意味着到 是整数 2马十4十2 的
2倍，所以既是偶数。

要证明 妃 一加，用反证法。也就是说，证明如果亲不是偶数，则 既 也不是偶数。这等同于证
明如果? 是奇数，那么至 是奇数，这在例 1 中已证明过了。证毕。                       图

反例 在1.3节曾提到,证明形如YVzrP(z)的语句为假，只要能找到一个反例，即存在一个例
子使 P(z)为假。当提交一个形如 yrP(z)，我们相信它是假的，或者排斥所有的企图证明，就寻
找反例。例 14 说明了反例的应用。

例14 证明语名“每个正整数都是两个整数的平方和"为假。

Re 解 ”为了证明此语句为假，我们寻找一个反例，即寻找一个特殊的整数，它不是两个
数的平方和。很快发现反例，3 不能写成两个数的平方和。为表达出这是事实，请注意

可用的不超过 3 的平方数只有 呈一0、1 一1，而0、1] 的每两项相加都得不出 3，因此证明了*每个
正整数都是两个整数的平方和”为假。                                      四

1.6.8 证明中的错误
在构造数学证明时，容易犯一些错误。这里简述其中的一些。这当中最常见的错误是算术和
基本代数方面的。甚至专门的数学家也会犯这种错误，尤其是在处理复杂的公式时。任何时候进
行这样的计算都应当尽可能仔细地检查。(你应当复习基本代数中让你头疼的方面。)
2 数学证明的每一步都应当是正确的，并且结论要从之前的步骤中逻辑地导出。许多错
    误是源于引入不是前面步骤的逻辑推导。下面的例 15一17 说明了这一点。
例15 下面这个著名的假定“证明”(即 1一2)错在哪里?
“证明"步骤如下，其中 e 和心是两个相等的正整数。

步骤                         理由

1. a一0                       给定的前提

2.a:一ab                           步骤 1 两边乘以a

3. 好一上一0一尽                   步骤 2 两边减去 忆

4,.(a一0(a十鸭一6(a一中       步骤 3 两边分解因式

5. a十0一久                步骤4 两边除以 一

6. 20一                       步骤 5 把 a 替换成2，因为 ce=总并化简
7

.2一1                   步骤6两边除以尹



--- 第 71 页 ---
第1竟 基础: 运辑和证明 "53

解 除了步骤 5 两边除以(a一久之外，每个步骤都有效，错误在于 a一等于零; 一个等式两
边用同一个数相除只有在除数不是零时才是有效的。                            如

例16 下面这个“证明”错在哪里?

“定理”: 若到 是正数，则”是正数。

“证明”: 假定到 是正数。因为条件命题“若是正数，则巡 是正数?为真，所以可以得出*是正数。

解 令 P(7)为“7是正数"，Q(n)为"天 是正数"”。则前提是 QCz) 。命题“如果? 是正数，则 于
是正数"也就是 w(CP(Cz) 一Q(C))。从前提 QGmD 和 WP(n) 一Q(Cz))不能得出 P(n*)，因为没有使用
有效的推理规则。相反，这是一个断言结论的订误的示例。一个反例是当 = 一1 时，好一1为正
数，但)却是负的。                                                 四

例17 下面的证明?错在哪里?

“定理": 如果?交不是正数，则 六 不是正数。

“证明”: 假定站不是正数。因为条件语句*如果)是正数，则着 是正数?为真，所以可得到 不
是正数。

解 ”如例 16那样设定 P(D和 QCz) 。则前提是PC) ，语名“如果半 是正数，则 到 是正数”即
是VPC 一QGD))。从前担PCD 和 WPCn) 一Q(nz) )不能得出0QGCz) ，因为没有使用有效的推
理规则。相反、这是一个否定前提的恋误示例。如例 16 那样，x一一1 即为反例。          三

最后，简要讨论一种比较难应付的错误。许多不正确的论证都基于一种称为偷用论题的廖误。
当证明的一个或多个步骤基于待证明命题的正确性时，会发生这样的订误。换句话说，当命题使
用自身或等价于自身的命题来进行证明时会产生这种雇误。所以这种廖误也称为循环论证。

例18 下面的论证是否正确?

假定到 是偶数，则存在某个整数上使下一2K。令存在某个整数 ! 使得 x*王2!。这证明了 ”是偶数。

解 ”这个论证不正确。证明中没有给出论证说明 可以写为 22，! 为某整数。这是一个循环论证，
因为这个命题等价于待证的命题(即 ”是偶数) 。当然，结果本身是正确的，只是证明方法不对。 国

在证明中犯错是学习过程的一部分。当你犯了某个错误并被别人发现时，应该仔细分析哪里
出了错误并确保不再犯司样的错误。

1.6.9 仅仅是开始

现在已经开发了一个基本的证明方法库。在下一节将介绍其他重要的证明方法。在第 3 章将
介绍组合证明的概念。

本节介绍了几个形如 YrCP(z) ~~Q(Cz))的定理证明方法，包括直接证明和反证法。存在着许
多定理，通过直接利用前提和定理里的名词的定义，就容易找出其证明。不过，通常要是不借助
于灵活地利用反证一妇请证明，或一些其他的证明技术，就难以证明一个定理。在 1.7 节中，将
讲述证明策略。我们将描述当直接方法行不通时的各种可以用于证明的方法。构造证明是一种只
能通过经验学习的艺术，包括写证明，让他人评论你的证明，以及读和分析其他证明。

练习

1. 用直接证法证明: 两个奇数之和是偶数。

2. 用直接证法证明: 偶数的平方是偶数。

3. 证明: 如果 mm十 和?十户都是倡数，其中加 和户都是整数，那委 六十户也是偶数。你用的是什女证明
方法?

用直接证法证明: 每个奇数都不同于 2 的平方。

证明: 一个无理数与一个有理数之和是无理数，使用归浆证明。

- 证明或反驳:， 两个无理数之积是无理数。

,证明: 若工是无理数，则 LI/zr 是无理数。

. 使用归雇证明: 如果 z十y2，这里 x、y 是实数，那么 xz三1， 或者 y1。
` 证明: 车”是整数而且呈十5 是奇数，则 ”是偶数，使用

中

演了 0



--- 第 72 页 ---
54"第1章 基础: 运辑和证明

a)反证法证明         b)归廖证明

10. 证明命题 P(00)，其中 P(m)是命题“若是个大于 1 的正整数，则 至盖总。你使用什么类型的证明?

11. 设 P(")是命题“车 ae 各是正实数，则(a十0)"达"十加"。证明 P(1)为真。你使用什么类型的证明?

12. 证明: 在任意 64 天中至少有 10 天指向一个星期的同一天。

13. 用归雇法证明:， 没有有理数 > 使得王十r十1=0。[提示: 假设 r*=a人是一个根，这里 a, 总 是整数，a/
是既约的。通过乘以呈，得到一个整数的等式。那么看看是否 gc 和必是某一个奇数或偶数。]

14. 证明: 若是正整数，则 ”是奇数当且仅当5*十6是奇数。

15. 证明或反驱:, 若盖和?是整数使得 mm一1，则 z=1 并且 x=王1，或者 mm一一1 并且 nr=一一1。

16. 证明下面三个语句等价;，(i)3z十2 是偶数，(ii)z十5 是奇数，(iii)zz 是偶数。

17. 证明下面三个语句等价: (iDz 是无理数，(ii)3z十2 是无理数，(iii)z/2 是无理数。

18. 下列求解方程 VT十3一3一z的步骤是否正确? (1) VzT3=3一是给定的; (2)z十3一袜一6z十9，对
(1)的两边平方 (3)0一宇一7z十6，从(2)的两边都减去 zx十3! (4)0=(z一1)(z一6)，对 妇一7z十6 进
行因式分解;， (5)z一1 或zx一6，因为 ab一0 蕴含o=8或5王0，故从(4)可得到解。

19. 证明，可以通过证明条件语句 户一庙，户一记，轴一入，妨一加 和态一访 来证明命题 六，恩，加，思

和 z: 等价。

20. 证明: 在实数 ao ，a ，…，au 中至少有一个数大于或等于这些数的平均值。你使用什么类型的证明?

21. 证明: 若是整数，则下面 4 个语句等价; (Da 是偶数; (ii)n十1 是奇数; (iii)3n十1 是奇数;， (iv)372 是
偶数。

1.7 证明的方法和策略

1.7.1 引言

-cn 在1.6节介绍了各种不同的证明方法，并说明了每一种方法如何使用。在这一节，继
” 续这方面的讨论。我们将介绍几种其他重要的证明方法，包括考虑个别不同案例的证
明和具有预期性质物体的存在性证明。

在 1.6 节只简要讨论了构造证明的策略。这些策略包括选择证明方法，然后以这个方法为基
础，一步步地成功建立论据。本节在我们已经成功建立一个广泛的证明方法库之后，将研究一些
艺术和科学证明之外的方面。对于如何寻找一个定理的证明方法将提供一些忠告。我们也将描述
一些窍门，包括如何从工作背景中发现证明方法，并适应存在性证明。

对于数学家的工作，他们制定猜想，企图证明或驳斥。这里将简要描述瓦片与骨牌和其他类
型的棋盘棋子证明结果的过程。考察这种类型的瓦片，我们将能够迅速制定猜想和证明定理而不
先发展理论。

我们将通过开放问题的角色讨论得到这部分内容。特别地，要讨论一些有趣的问题，它们或
者是开发数百年后已经被解决的，或者仍然保持开放的问题。

1.7.2 穷举证明和分情形证明

有时用单一论据通过保持所有的可能情况并不能证明定理。现在介绍一种通过分别考虑不同的
情况，能够用于证明定理的方法。这个方法建立在现在要介绍的一个推理规则上。为了证明形如

(VpVvV VD加)一9

的条件语句，可以用永真式[(户V户V…V轧)-9]二[(记一9)A(记一9)人…人(加一9)]作为推理
规则。这个推理规则说明，可以通过分别证明每个条件语句 户一9(i一1，2，…，m)来证明由命题
户，妨，…，彤 的析取式组成前提的原条件语句。这种论证称为分情形证明。有时为了证明条件
语句 户~9 为真，方便的做法是用析取式 户V户V…Vzs 代替户作为条件语句的前提，其中靖与
妃， VztV…VA 等价。

穷举证明 有些定理能够通过有关的小数量例子测试来证明。这样的证明叫做穷举证明。因
为这些证明通过穷尽所有可能进行。一个穷举证明是分情形证明的特殊类型，这里每一种情形都
作为独立例子检查。现在对穷举证明给些说明。

  



--- 第 73 页 ---
第1音 基础: 过辑和证明*，55

例1 证明: 当是一个正整数，且 "入4 时，(z十1过3"。

解”用穷举让明。我们只需检验当 n=1，2，3，4 时，(*十1)3三3" 不等式。对于 "一

(nm十1和一2一8，且 3一3一3 对于一2，(m十1]一3一27，且3" 一3一9，对于
7一3，(?十1)3一4一64，且3"一3一27; 对于 mn一4，(z十1)3一5一125，且 3"一3一81。在这四种
情况的每一种情形 ，都得到(nm十1六宇3"。用穷举证明法方法证明了当) 是一个正整数，且 mn委4
时，(z十1)3全3"。                                               面

例2 证明: 在100以内， 连续的正整数是全寡数的只有 8 和 9(全寡数是指它能写成好，其中
4a 是大于 1] 的整数)。

解 ”可以通过证明在 n<100 时，只有一对连续的正整数 za，十1 它们都是全赛数来证明这个
事实，即 ”=一8 时。我们能够证明此事实，通过检验在 100 以内的正整数 >，首先检查 是否是全
稼数。如果是,检查 "十1 是否也是全老数。做这件事最快的方法是简单地看 100 以内所有的全守
数，检查是否它下一个大的整数也是全朝数。100 以内正整数的平方有1、4、9、16、25、36、49、
64、81 和 100。100 以内正整数的立方有1、8、27 和 64。100 以内正整数的4次寡有1、16 和81
100 以内正整数的 5 次寡有1 和 32，100 以内正整数的6 次守有1和864。除了1以外，100 以内设
有正整数的 6 次宕大于 6 次。观察不超过 100 的一系列全寡数，发现只有 = 8 时， 7是全寡数，
而 *十1 也是全少数。即 2 一8，3:一9，是 100 以内唯一两个连续全寡数。证毕。          国

当只需要检查有关的小数量命题例子的时候，人们可以进行穷举证明。当要求计算机检查非
常庞大的命题例子时，它不会抱怨，但它们仍然有局限性。注意，当不能列出所有要检查的例子
时，计算机甚至不能检查所有的例子。

分情形证明 ”分情形证明一定要覆盖定理中出现的所有可能情况。我们用一组例子分情形说
明，在每一个例子中，我们应该检查所有覆盖的可能性。

例3 证明:， 当z为整数时，有 到伍mn。

解 ”对每一个正整数，通过考虑 a=0，"人1 和nn委一1 三种情况来证明 空三zx。分解证明为三
种情况: 因为通过考虑 0，正整数和负整数可以直接证明这个结果。

可直  情况(ji ) 当"=0时，因为0一0，从而0:关0。这表明在这种情况下，妈全交是真的。
         情况() 当 ”1 时，把不等式 "伺1 两边同时乘以正整数 ，得到.三xz。1。
这表明对 *字1，有 到宇m。

情况(证) 当?”委一1时，然而玉兰0，因而有 只全mr

因为在所有的三种情况中，有不等式 刀三mn，能够得出结论: 当) 为整数时，有 内三nm。   国

例4 用分情形证明法证明 | xy| = |zily|l，其中zx和yy是实数。(|a|是a的绝对值，
当a>0时，la|1=ai 当o和0时，|al一一ao)

解 ”在这个定理的证明中，用事实; 当a>>0时，| al1= ai 当a<0时，|a|=一<c，消除
绝对值。由于|z| 和| y | 两个在公式中，将需要分成四种情况: ( j )z 和y 都非负(iji)z非
负，y 是负的; 〈和证)z 是负的，y非负: (iv )z是负的，y 是负的。

(注意: 我们通过每一种情况的恰当的符号选择去掉绝对值符号。)

情况(ji ) 我们看到 户一9，因为当z>0 且 y>0时 zy二0，因此| zy| =xzy= |z1ly|，

情况(ii) 要证明 户一9，注意若 zx关0 且 ><0，则 zy委0，因此 | zy | =一zy一z(一妇一
1z1iyl1。(因为 y<0，我们有| y | 一一y。)

情况(证) 要证明 户一9g，可遵循前一种情形的推理过程，只需将 zx 和 y 的角色互换。

情况(iv ) 要证明 加-9，注意当z<0 上且 y<0 时， zy>0。因此 | zy | 一zy一(一了) (一切一
[zllyl。

因为已经完成了所有的四项，  这些情况包含了所有的可能情况。  能够得出结论当 = 和 是实
数时，| zy|=|zlly|l。                            国

利用分情形证明 已经给出的说明分情形证明的例子提供了一些何时应用这种证明方法的启 .
发。特别地，当同时考虑所有的证明情况不可能时，应该考虑分情形证明。何时应该应用这种证



--- 第 74 页 ---
56 "第1章 基础: 运辑和证明

明方法呢? 一般地，当没有明显的思路开始证明，而每一种情况的额外信息又能推进证明，这时
寻求分情形证明。例 5 说明了如何有效地应用分情形证明。

例5 对于十进制数字，一个整数的平方的最末位数字，给出一个猜想，并证明你的结论 。

解 ”最小的完全平方数分别是1、4、9、16、25、36、49、64、81、100、121、144、169、
196、225，等等。注意到，完全平方数的最末位数字是: 0、1、4、5、6 和9, 而2、3、7、8 从来
不出现在完全平方数的最末位数字。猜想这样的结论: 一个完全平方数的最末位数字是: 0、1、
4、5、6 或9。如何证明这个结论呢?

首先注意到，把整数”表示为 10a十5，这里 ec 和5是正整数，2 是0、1、2、3、4、5、6、7、
8或9。这里oa是从?中分解出 10 的倍数，从此抽取出的十位数获得的整数。其次，(10ca十巡 =
1004 十20a6十下二10(10导十2ab)十姑，因而，半的十进制最末位数字与六 的十进制最末位数字相
同。进一步，尽 的最未位十进制数字与(10一b5王100一202十灵 相同。因此，把证明缩减为以下6
种情况 :

情况( i ) ?的最末尾数字是 1或9，这样产的最后十进制数字是了一1，或一81，即为 1。

情况(这i) zz的最未尾数字是 2 或8，这样到的最后十进制数字是2=4，或中一64，即为4。

情况(ii) zz 的最末尾数字是 3 或7，这样叶的最后十进制数字是 3一9，或7一49，即为9。

情况(iVy) >”的最末尾数字是4或6，这样壮的最后十进制数字是 笃王16，或竺一36，即为 6。

情况(V) j 的十进制最末尾数字是5，这样交的十进制最后数字是殖一25，即为 5。

情况CVi) ?的最末尾数字是0，这样 到 的十进制最后数字是 0 =0，即为 0。

因为考虑了所有的 6 种情况，能够得出: 当)是整数，姑 的十进制最后数字是0、1、4、5、6
或9。                                                          于

在分情形证明中，有时能估计所有的，但有很少的几个例子。例 6 就是如此。

例6 证明:， 对于整数zx、y，盖十3关一8 没有解。

解 由于当|z|全3时，必>8，同时当 | | 三2时，3交>8。因此能够很快缩减证明，只检
查几种简单的情况。这样只剩下 工取值一2、一1、0、1、2，而y取值一1、0、1 的情况，我们就能
给出一个全面的证明。对于保留的情况，注意到， 的可能取值是0、1、4，3yY 的可能取值是0 和
3，, 世与3yY 可能取值的最大和是7。因此，当zx、 是整数时，字十3交=8 是不可能的。       加

不失一般性 在例4 的证明中，除掉情形(证)z<0，y亿0，因为它与情形(jj )z0，y<0 的
zx和>y 角色互换后相同。为了简短证明，不失一般性，我们可以通过假设，把情形(ii和(证?的
证明合在一起为 zx过0，?<0。这意味着，我们通过情形 zx0，y<0 来完成情形 zx<0，y二0，道
理如上，但要有明显的变化。一般地，术语“不失一般性?用在证明中(缩写为 wWLOG)?时，我们得
到如果没有另外的证据要求证明其他指定的情形，可通过证明定理的其中一种情况。也就是说，
其他的一系列情况通过简单的变化来论证，或者添加到一些简单的初始步骤中。当然，这个原理
的不正确应用会导致不幸的错误发生。有时假设会导致失去一般性。一些假设使得忽略一个情况
可以是非常不同于其他情形。这样会导致不完整及不可挽救的证明。事实上, 许多著名定理的不
正确证明原来依赖于应用"不失一般性”的想法，来论证不能很快从简单情形证明而建立的情形 。

现在我们来说明有效应用不失一般性的证明。

例7 证明: (z十3一习十。这里 zx、y 是正实数，r 是 0二-一1 的实数。

解 ”不失一般性，假设 zx十y=一1。 [注意: 假设对于zx二y=1已经证明了定理。设 *十y一/，
那么 z/t十Wi一1，这意味着(zx人+一(zx十(y/D7。最后式子两边乘以上,证得(zx十y)"一
zx十y。]

假设 rz二xy=1，因为zx、y 都为正，所以 0一z生1，0一>和1。因为 0一rr一1，因此，0一1一r一
1，故二 “二1，y 一1。这意味着 z一关，3?<y。因此，关十y二z十yy一1。从而(xz十y) 一1一
z十YY。这样对于 r+y=1证明了定理。

因为不失一般性我们假设 zx十y一1，得到(z十3y)<一垃十了 这里 zx、y 是正实数，~ 是 0一
r<<1 的实数。                                                     国



--- 第 75 页 ---
第1章 基础: 逻辑和证明*57

穷举证明和分情形证明的常见错误”推理的一种常见错误是从例子中得出不正确结论。不管
考虑多少不同的例子，除非每一种可能情况都覆盖了，和否则不能从例子证明定理。证明定理的问
题类似于要证明计算机程序总能输出所期望的。除非所有的输入值都测试了，和否则无论测试多少
输入值，也不能得到程序总能有正确的输出。

例8 语句"每个正整数都是 18 个四次方整数之和”是否为真?

解 要判断?是否可写为 18 个四次方整数的和，我们先从最小的正整数开始考察。因为整数
的四次方分别是0，1，16，81，…，如果能从这些数中选择 18 个项后相加得 >，则命题得证。可
以证明，从1到78 的所有正整数都可以写成 18 个四次方整数的和(细节留给读者证明)。然而，如
果认为这就检查够了，那就会得出错误的结论，因为 79 并不是 18 个四次方整数的和(读者请自行
验证) 。所以，题设语句不为真。                         力

另一个常见错误是由于未考虑到所有情形，导致不正确的证明，央而做出无根据的假设。如
例 9 所示。

例9 下面的*证明?错在哪里?

“定理":， 如果并是实数，则 是正实数。

“证明": 令户为"z是正数"，户 为"xz 是负数"，9 为"安 是正数"。要证明 户一go，注意，当z
是正数时，z 为正数，因为两个正数 zx 和~ 的积肯定为正。要证明 包-=qg，注意当z是负数时，忆
是正数，因为 普 是两个负数的积。证毕。

解 ”上面的证明存在的问题是忘了考虑 zx=0 的情形。当z=0时，必一0非正，因此假设的定
理为假。如果 户是“z是实数"，那我们可以分三种情形 户、思 和 户 来证明结果，其中 户 是“z 是
正数”，户 是“是负数"，户 是“z一0”，因为 说力V记VDp。                              国

1.7.3， 存在性证明

许多定理都断言存在特定类型的对象。这种类型的定理是形如 3zP(z)的命题，其中也是谓
词。对形如 3zP(z)的命题的证明称为存在性证明。有多种方式来证明这种类型的定理。有时通
过找出一个使得 P(a)为真的元素w 来给出 3zP(z)的存在性证明。这样的存在性证明称为构造性
的。给出非构造性的证明也是可能的; 即不是找出使 Pa)为真的元素“，而是以某种其他方式来
证明 3zP(z)为真。给出非构造性证明的一种普通方法是使用归廖证明，证明该存在量词化的否
定式荀含着矛盾。下列例 10 说明构造性的存在性证明的概念。例 11 说明非构造性的存在性证明
的概念。

例 10 构造性的存在性证明 证明存在某个正整数，可以用两种不同的方式将其表示为正束
数的立方和。

gu 。 解 ”经过大量的计算(如使用计算机搜索)可找到

1729一103 十9一123十1:

因为 1729 满足题设要求，所以得证。                                        图

例 11 非构造性的存在性证明 证明存在无理数 x 和 y 使得 r* 是有理数。

解 由1.6节例10 可知/2是无理数，考虑数V2”。如果它是有理数，那就存在两个无理数x
和2》 且z* 是有理数，即 xz一VZ ，y=VZ。另一方面，如果V2/ 是无理数，那么可以令 xz一V24日y=
VZ，因此 六一(VE20 DA一/下一2。

这是一个非构造性存在性证明的例子，即我们并没有找出无理数 x 和 y 使得 过 是有理数。而我们
证明了或者 x=VZ，y~V5，或者 zx-V3” ，y=VZ，可能满足性质，但并不知道这两对哪一个满足。 国

非构造性存在性证明非常微妙，如例 12 所示。

5 例12 Chomp 是两个人玩的游戏。在这个游戏中，曲奇饼放在抢形格中。左上角的曲

 奇饼被毒化了。如图 1-1a 所示。两个玩家轮流移动。每一个玩家都要吃一块留下的曲

奇饼，两人都要使右边和/或它下面所有的曲奇饼都被取走(例如如图 1-1b 所示)。如果不吃毒化



--- 第 76 页 ---
58。第1章 基础: 运辑和证了明

的曲奇饼就没有选择的玩家为失败。请问: 两个玩家之一是否有获胜的策略，即其中一个玩家能
够一直移动保证其获胜。

生四四四四国电提首冰
思@Q@ 8aes
站因站忆间外因性QG
疙外居昌和@ 的昌@G关

a)左上角的曲奇饼被毒化               b)三种可能移动方式
图1-1 Chomp

解 给第一个玩家获胜策略的非构造性存在证明。也就是说，将证明第一个玩家总有获胜的
策略，但对必须怎么移动没有明确的描述。

首先，游戏结束后，不能是一个平局，因为每一步移动至少要吃一块曲奇饼，因此游戏结束
不会超过移动 mxXan步，这里初始网格是 mxXn。现假设在游戏开始，第一个玩家了吃掉了右下角的
曲奇饼，这有两种可能，一这是第一个玩家获胜策略的第一步，二或者这是第二个玩家获胜策略
的第一步。在第二种情况下，第一个玩家替代恰好要吃右下角的曲奇饼，可以采用第二个玩家获
胜策略的第一步相同的步骤(然后继续循环这个获胜策略) 。这将保证第一个玩家获胜。

注意，这里证明了获胜策略的存在性，但是没有指定具体的获胜策略。因此，这个证明是非
构造性存在性证明。事实上，没有人能够描述 Chomp 的获胜策略，适用于所有的长方形网格通过
描述第一个玩家应该遵循的移动方式。然而，获胜策略能够被描述成某种特殊的情况，比如当网
格是正方形和当网格只有两行曲奇饼时 。                        国

1.7.4 唯一性证明

一些定理断言具有特定性质的元素唯一存在。换名话说，这些定理断言恰有一个元素具有这
个性质。刘证明这类语句，需要证明有某个元素具有这个性质，且没有其他元素有此性质。唯一
性证明的两个部分如下 :

存在性: 证明存在某个元素 ~ 具有期望的性质。

叭一性: 证明若 >关z，则 >不具有期望的性质。

等价了地，我们可以证明如果x和>y 都具有期望的性质，则 zx一y。

注意 证明存在某个唯一元素工等同于证明语自 3r(P(z) A Yy(y天zx-*mP(Cy)))。

我们在例 13 中要说明唯一性证明的组成。
例13 证明; 如果a、2是实数，并且 ae天0，那么有一个唯一的~，使得 ar十5一0。
解” 首先，注意到实数-~ =一ba是ar十6=0 的一个解， 因为 e(一ba)十0一一0十0一0。因
此，对于 ar十2一0 实数 ~是存在的。这是证明的存在性部分。
其次，假设 *是os十5一0 成立的实数。因此 ar十6= us十6，这里 >一一/a。从两边减
去5，得到 ar =一as。最后式子两边同除以e，这里 a 是非零的，得到 r*=*。这意味着如
果 r关*，则 as十6和关0。这建立了证明的唯一性部分。                            国

1.7.5 证明策略

发现证明是一项挑战性的工作。当面对待证命题时，应该先用定义替换术语，再仔细分析假
设和结论的含义。这样做之后，用一种可用的证明方法去试图证明结果。一般情况下，如果语句
是条件语句，就应该首先尝试直接证明，如果这样不行，就尝试间接证明。如果这些方法都不行，
就尝试归衣证明。

  
 
 



--- 第 77 页 ---
第1章 基础: 逻辑和证明*59

前推与后推 ”无论选择什么证明方法，都需要一个起点。条件语句的直接证明就从假设开始。
利用这些假设以及公理和已知定理，用导向结论的一系列步骤来构造证明。这类推理称为前推，
是用来证明相对简单结果的一类最常见推理。同样，要开始间接证明，就从假设的否定开始，用
一系列步双来得出前提的否定。

但是，前推常常难以用来证明更复杂的结果，因为得出想要的结论所需要的推理可能相当复
杂。在这种情况下，使用后推可能会有帮助 。为了后推证明命题 9，就寻找能证明具有性质刀~g的
语句户。(注意，寻找能证明使得 g~~r的语句~ 不会有帮助 ，因为从 gr 和 得出9 为真，这种推
论是错误的.)例 14 和例 15 解释后推。

例14 给定两个正实数 zx和>y，其算术均值是(rz十y)/2，其几何均值是 Vzy。当比较成对不
同正实数的算术和几何均值时，发现算术均值总是大于几何均值。(例如，当 z==4 和 y一6时，有
5一(4十6)/2> V4。6= V24.。)能否证明这个不等式恒为真?

了 解 ”要证明当和> 是不同正实数时(z十y)/2> Vzy，可进行回潮，构造一系列等价
的不等式(请读者来证明每对相邻的不等式都是等价的) 。这些等价的不等式是:
(十y)/2 > Vzy，(zr十314 > xy
(十y六全4rzy， 好十2zy十六二4zy

7一2xzy十风二0， (7一人2 二0
由于当z天>时，(z一?)>>0，所以最后一个不等式为真。由于所有这些不等式都等价，所以当
z天y 时，(z十y)/2> Vzy 。一旦构造了这个证明 ，就能轻而易举地构造使用前推的证明。现在给
出这个证明。

假设z和>y 是两个不同实数，那么(z一)>0，因为非零实数的平方是正的。由于(zx一光:一
刀一2ry十开，这意味着 己一2zy十交盖0。两边同时加 4ry，得己十2zy十交二4zy。因为 妇十
2zy十y 一(z十?六，因此(z十?)盖4rzy，两边同时除以4得，(z十罗:7/4之zy。最后，两边同时开
平方(因为不等式两边都是正的，开方有保序性)得(z十y)/2> Vzy。得到，如果 z 和 y 是两个不
同实数，那么它们的算术均值C(z十y)/2 大于它们的几何均值 Vzy 。                 国

例15 假定甲、乙两人玩游戏，轮流从最初有 15 块石头的堆中每次取1、2 或 3 块石头。取
最后一块石头的人赢得游戏。证明: 无论乙如何取，先取的甲都能赢得游戏。

解 ”为了证明甲总能赢得游戏，进行回湖。在最后一步，如果石头堆中一下1、2 或 3 块石头，
甲就能获胜。如果乙不得不从有4 块石头的堆中取石头，就迫使乙留下1、2 或 3 块石头。因此，
甲要获胜的一种方法是在倒数第二步，应该给乙留下 4 块石头。当乙不得不从 8 块石头的堆中取石
头时，此后就会留下5、6 或 7 块石头，甲再取石头后就能留下 4 块石头。因此，为使乙留下5、6
或7 块石头，甲就要在倒数第三步给乙留下 8 块石头。这意味着当轮到甲取时还有 9、10 或 11 块
石头。同样，当甲走第一步时，应该留下 12 块石头。把这个论证倒过来就证明了无论乙如何取，
甲总是有石头取，所以甲赢得游戏。这些步骤依次给乙留下 12、8 和4 块石头。           三

改造现有证明 用计证明语句方法的很好思路是利用现有的证明。一个现有的证明时常适合
于证明一个新结果。即使不是这样，这个现有证明想法的一部分也是有帮助的。因为现有证明为
新证明提供了线索，你应该去阅读和理解在学习中遇到的这些证明。例 16 对这个过程进行了
说明。

例16 在1.6节例10中证明了V2是无理数。现在推测V3是无理数。我们能够改造在 1.6 节例
10 的证明来证明V3 是无理数的吗?

BE。 解 为改造在 1.6 节例 10 的证明，开始先模仿这个证明的步骤。但要用VS代替VZ。首
先，假设V3 =c/d，这里分数 c/d 是既约的。等式的两端平方得到 3一c/吃。 因此，

3d 一后。类似在 1.6 节例 10 中由等式 ?好=好证明 2 是c 和疾的公因子的方法， 用这个等式能证
明 3 一定是<和d 的公因子吗?《〈回忆如果 ts* 是整数，则整数 * 是整数: 的因子。 一个整数二 是偶



--- 第 78 页 ---
60 "第1章 基础: 运辑和证明

数，当且仅当2 是二的因子.)这里我们仅勾画一些剩下的证明。因为3是< 的因子，它也必然是
的因子。并且，因为 3是ec的因子，9 就是c 的因子，这意味着9是3d 的因子。因此3是安的因
子，这意味着3是4的因子。因而3是c<和vd的因子，这是矛盾的。之后添加这些步骤的理由，通
过改造/2 是无理数的证明， 将能证明V3 是无理数。注意: 这个证明可以推广到Vz*是无理数，每当
! 是一个非完全平方的正整数。证毕。                         面

当你遇到要证明一个新理论时，一个好的途径是寻找现有的可以改造的证明，尤其是当新理
论与你已经证明过的理论相似时。

1.7.6 寻找反例

在1.5节，介绍了应用反例证明某些语句是错的。当面对一个推测，你一定首先试图去证明
这个猜测，如果你的尝试没有成功，你就要试图找到一个反例。如果你不能找到反例，你就一定
要再试图证明这个语句。无论如何，寻找反例都是相当重要的方法，它时常能提供对问题的领悟。
下面用一些例子说明反例的作用。

例17 在1.6节例14中,通过寻找反例证明了语句“每个正整数都是两个整数的平方和”为
假。也就是说，有正整数不能写成两个整数的平方和。尽管不能写出每一个正整数作为两个整数
平方和，也许我们能写出每一个正整数作为三个整数平方和。也就是语句"每个正整数都是三个整
数的平方和?为真为假呢?

BE。 解 因为我们知道并不是每个正整数都是两个整数的平方和，可能最初怀疑每一个正

整数作为三个整数平方和。因此，首先寻找反例。也就是说， 证明语句*每个正整数都

是三个整数的平方和"为假，如果能够找到一个特殊的整数不是三个整数的平方和。为寻找反例，
试着写出可满足语句条件的连续的正整数。可以发现 1一0:十02十1 ，2一0十1十1 ，3一12十1十
上，4一下十站十2关，5一各十下十于，6一王十十2 ，但无法找到方法将 7 写为三个整数的平方和。
要证明 7 是一个反例，请注意可用的不超过 7 的平方数只有 0、1 或 4，而三个项(每项为0、1 或4)
相加却得不出7，所以 7 是一个反例。得到结论 语句“每个正整数都是三个整数的平方和?为假。

我们已经证明了并不是每个正整数都是三个整数的平方和，下一个问题要问是不是每个正整
数都是四个整数的平方和。一些实验提供了证据，答案是对的。例如，7一1:十1:十1十22，25一
全十2十2十1 和 87一久十2十并二1。这个产生猜测:,“每个正整数都是四个整数的平方和"是真
的。对于证明参见LRo05] 。                                                      力

1.7.7 行动证明策略

仿佛数学事实是刻在石头上的，一般认为数学是这样。数学教科书(包括这本书的绝大部分)
规范地提出定理和它的证明。而在数学中的介绍不揭示发现的过程。这个过程以探讨概念和例子、
提问题 、创造猜测和企图通过证明或者通过反例解决一些猜测。这些是数学中上日常的工作。相信
或者不信，在教科书中所讲授的材料都是以这个方式原始地展开。

人们基于许多类型的可能证据创造猜想。为能够识别可能的模式 ，特殊情况下的考试能够导
致猜想。改变已知定理的假设和结论也能导致似是而非的猜测。其次，猜测也建立在直觉和结果
所持有的信念的基础上。无论怎样，猜测产生了，一旦它被明确描述，目标就是证明或者驱斥
它。当数学家确信猜测是真的，他们就会努力寻找证明;， 如果他们不能找到证明，他们就会寻找
反例。当他们不能找到反例时，他们又会转回来再次试图证明猜测。尽管许多猜测很快被解决，
而一些猜测要抵制数百年的攻击，这导致数学新内容的发展。在以后的章节中将提到几个著名的
猜想。

1.7.8 填充

ss :; 通过对棋盘填充的简要研究，能够说明证明策略的一些方面。研究棋盘的填充是快速
四  发现和证明许多不同结果的很有效方法，而这些证明用到了各种各样的证明方法.在

这个方面也几乎创造了无穷多的猜想和研究。首先，需要定义一些术语。一个棋盘是一个由水平



--- 第 79 页 ---
第1章 基础: 逻辑和证明。61

和垂直线分成同样大小方块组成的矩形。跳棋游戏是在8行和8 列的木板上进行;这个板称为标准
棋盘，如图 1-2 所示。在这一节，用术语镀旋指任意矩形大小的棋盘，而且棋盘的一部分包含删
除一个或更多个方格组成。一个示牌是一块长方形，由两个方格组成，如图 1-3 所示。当它的所
有方格由不重亚的骨牌覆盖，而没有骨牌悬垂在镰板上，我们说一个镶板由骨牌所填充。现在研
究一些有关用骨牌填充灸板的结果。

LT

 1-3 两种骨牌

 

例 18 ”我们能用骨牌填充标准棋盘吗?

解 我们找到许多用骨牌填充标准棋盘的方法。例如，可以水平放 32 块骨牌填充它，如图
1-4 所未。这样填充的存在性完成了一个构造性的存在证明。当然，做这个填充还有大量其他的方
法。可以在板上垂直放 32 块骨牌 ，或者水平地和垂直地填充它。但对于一个构造性存在证明需要
找到仅仅一个这样的填充就可以。

例 19 我们能填充从标准棋盘中去掉四个角的方格之-得到
的饼板吗?

解 ”为了回答这个问题，注意一个标准模盘有 64 个方格，去掉
一个方块这样由 63 个方格产生一个镶板。现在假设能够填充一个从
一个标准棋盘中去掉- -个角的方格的灸板。因为每个骨牌盖住两
个方格，又没有两个骨牌重登，没有骨牌悬垂在板上，所以板上一
定有偶数个方格。因此，可以用归雇证明法证明去掉一个方格的标
准棋盘不能用骨牌填充，因为这样一个板有奇数个方格。    古

现在考虑一个埋手的情况。

例 20 去掉标准棋盘中左上角和右下角方格得到的镭板，如
图 1-5 所示，能填充这个贸板吗?                 图 1-4 填充标准棋盘

解”去掉标准棋盘中两个方格得到的镶板包含64一2一62 个
方格。因为 62 是偶数，不能很快排除去掉左上角和右下角方块的
标准棋盘填充的存在性，不像例 19，排除了去掉一个方格的标准
棋盘用骨牌填充的存在性。试图构造这个镶板的填充，读者应访
企图的第一个方法一定是成功地放骨牌。然而，无论怎么试验，
都不能找到这样的填充。因为我们的努力不能产生一个填充，所
以得出一个猜测 : 填充不存在。

我们一定要试图证明填充不存在，然而证明显示，成功地在
镶板上放骨了牌已经到了穷途未路。为构造这样的证明，不得不考
虚出现的所有可能情况，就像我们做过的成功地放骨牌的所有可            |
能选择一样。例如，覆盖第一行第二栏中的方格有两种选择,而 图1-5 去掉左上角和右下角
旁边是去掉的左角项上方格。我们能用水平放置的填充或者垂直     方块的标准棋盘

 

    



--- 第 80 页 ---
62"第1章 基础: 逻辑和证了明

放置的填充。这两种选择的每一种都会导致进一步的选择，等等。对于一个人来说，这个并不要
很久，就能看到这不是卓有成效的解决计划，尽管计算机通过穷举能够完成这样的证明(练习 11
要求你完成这样的证明，不能填充一个去掉对角的4X4棋盘)。

现在需要另一个方法。或诈有一个比较容易的方法证明不存在去掉两个对角的填充。正如许
多证明，一个关键的观察能启发我们。我们给棋盘的方格涂上颜色，用来改变白和黑方格，如图
1-2 所示。观察得到，对这样镶板的填充，一个骨牌覆盖一个白方格和一个黑方格。其次注意到，
这样的镰板白色方格和黑色方格数量不等。我们能用这样的观察通过归订证明来证明: 一个去掉
两个对角的标准棋盘不能用骨牌填充。现在给出这个证明。

证 假如能用骨牌对去掉两个对角的标准棋盘填充。注意到去掉两个对角的标准棋盘包含
64一2一62 个方块。它可以用 62/2一31 个骨牌填充。在这个填充中，每个骨牌盖住一个白的和一
个黑的方格。因此，这个填充盖住 31 个白的和 31 个黑的方格。然而，当去掉两个对角方格时，或
者保留 32 块白的、30 块黑的，或者保留 30 块白的、32 块黑的。这驭斥了能用骨牌覆盖去掉两个
对角的标准棋盘的假设，完成证明 。                          国

我们还能用除骨牌之外的其他类型的块来填充。代替骨牌，研究沿着它们的边来连接构建的
全等正方形这样相同形状的块来填充。这样的块被称为是多方块。这个术语是由数学家所罗门
戈洛姆在 1953 年杜撰的,他是一本娱乐书籍的作者

[Go94]。两个多方块用同样数量的方形，如果通过旋转
和/或翻动四角之一而得到另一个，则将考虑它们相同。例
如，有两种类型的三格板(见图 1-6)，它是由三个边连接
的正方形组成的多方块。三格板的一种类型是直三格板，
它有三个水平连接的正方形;，另一个是右三格板，像字母      [|

L 的形状，如果有必要，翻动和/或旋转它。这里将研究用 ”图1-6 -一个右三格板和-一个直三格板
直三格板填充棋盘 。

例21 你能用直三格板填充标准棋盘吗?

解 ”标准棋盘含有 64 个方格，每一个三格板覆盖三个方格。因此，如果三格板填充了一个久
板，灸板的方格数量一定是 3 的倍数。因为 64 不是 3 的倍数，所以三格板不能覆盖 8x8 模乔。 下

下面的例 22，考虑了用直三格板填充去掉一个角的标准棋盘问题。

例22 我们能用直三格板填充去掉四个角的任一个角的标准棋盘吗? 一个8X8 棋盘去掉一个
角后包含 64一1一63 个方格。用直三格板填充任一个去掉一个角的棋盘其四种情况的任一种情况
都要用 63/3一21 个直三格板。然而当我们试验时，不能找到一个直三格板填充任一个去掉一个角
的四种情况的任一种情况。由穷举证明显示这个没有和希望。我们能改造例 20 的证明来证明这样的
填充不存在吗?

解”我们将给棋盘的方格涂上颜色，企图改造在例 20 给出的妇雇证明法证明: 应用骨牌填充
去掉对角的标准棋盘是不可能的。因为用直三
格板而不是骨牌，我们用三种颜色区分方格而
不是两种颜色，如图 1-7 所示。注意到在这个
着色中有 21 个灰色方格，21 个黑色方格，22
个白色方格。其次，做一个重要的观察，一个
直三格板覆盖棋盘的三个方格，它覆盖一个灰
色的、一个黑色的和一个白色的方格。然后注
意到三个颜色的每一个都出现在一个角的方格
中。于是，在一般没有去掉的时候，可以假设
轮换颜色，使去掉的方格是灰色的。因此假设
留下的板包含 20 个庆色方格，21 个黑色方格，     人
22 个白色方格。                                     图1-7 用三种颜色对删除对角的标准棋盘方格着色

 



--- 第 81 页 ---
第1章 基础: 逻辑和证明 "63

如果能用直三格板填充这块镀板，那么将用 63/3= 21 个直三格板。这些直三格板覆盖 21 个
灰色方格，21 个黑色方格，21 个白色方格。这与这个久板包含 20 个灰色方格，21 个黑色方格，
22 个白色方格矛盾。因此不能用直三格板填充这个久板。                       于

1.7.9 未解决问题的作用
在数学中,许多进展是人们在试图解决著名的但尚未解决的问题中而获得的。在过去的 20 年
中，许多未解决的问题最后被解决，比如数论中 300 多年前产生的一个猜想的证明。这个猜想断
言被称为费尔马大定理的语句为真。
费尔马大定理 只要)是满足2 的整数，方程
太十如一吧

 

就没有满足 ryz天0 的整数解、y 和=。
1 注意 方程工十多一” 有无穷多个整数解工 y 和xz。这些解称为毕达哥拉斯三元

”组9，对应于具有整数边长的直角三角形的边长。

这个问题有一段很有意思的典故。在 17 世纪，费尔马在一本技番图的著作的空白处匆匆写
道，他有了”巧妙的证明”: 当?”是大于 2 的整数时，z"十交=z 没有非平凡的整数解。但他从来没
有发表过这个证明(费尔马几乎没有发表过任何东西) ，在他死后留下的文章中也找不到任何证明。
数学家们花了 300 年寻找这个证明却没有成功，尽管许多人相信能找到相对简单的证明。(特殊情
形的证明，比如欧拉的当 一3 时情形的证明和费尔马本人的 nz一4 情形的证明，已经找到。)年复一
年，少数有声望的数学家认为他们证明了这个定理。在 19 世纪，这些失败的尝试之一导致了所谓
代数数论的数论分支的发展。直到 20 世纪 90 年代，当安德鲁. 怀尔斯(Adrew Wiles)采用从所谓
椭圆曲线论的深奥数论领域中最近发展的思想来证明费尔马大定理时，才找到了几百页长的高等
数学的正确证明。从公共电视台 Nova 系列的节目中可以看出，利用这个强有力的理论来寻找费尔
马大定理的证明 ，怀尔斯找了将近 10 年! (感兴趣的读者可以查阅[Ro05]来了解关于费尔马大定
理的更多信息和关于这个问题及其解决的其他参考资料。)

下面我们给出一个未解决问题，这个问题描述很简单，但却很难求解。
1 例23 3x十1 猜想 设 f(z)是把偶数 工转换成 ~/2、把奇数 zx 转换成 3z十1 的变换。

“” “有个著名的猜想(有时称为 3z十1 猜想)说: 对所有正整数 zx来说，当反复地应用变换

工时，最终会得到整数 1。例如，从z一13 开始，发现 T(13)=3 . 13十1一40，T(40)一40/2一20，
T(20)一20/2一10，T(10)一10/2=5，T(5) =一3 .5十1一16，T(I6)一8，T(08)一4，T(04) 一2，
T(2)王1。对于直到 5.6。1023的所有整数都验证了 3z十1 猜想。

3z十1 猜想具有有趣的历史，从 20 世纪 50 年代以来就吸引了数学家们的注意力。这个猜想被
多次提出，具有许多其他名称，包括: Collatz 问题、Hasse 算法、Ulam 问题、Syracuse 问题以及
Kakutani 问题等。许多数学家抛开原有工作来花时间解决这个猜想。这引起一则笑话，说这个问
题是旨在减缓美国数学研究的阴谋的一部分。参见 Jeffrey Lagaris 的文章[La85]来了解对这个问题
有意思的讨论以及试图解决这个问题的数学家们所发现的结果。                     国

1.7.10 其他证明方法

本章介绍了证明中使用的基本方法，也描述了如何利用这些方法来证明各种结果。 在第 2 章，
将用这些证明方法证明有关集合、函数、算法和数论的结果。在这些定理中， 将证明著名的停机
定理，即存在不能用任何过程来解决的问题。 但除了这些讨论过的方法之外还有许多重要的证明
方法。2. 4 节会介绍康托尔对角化方法，用来证明关于无穷集大小的结果 。 第 3 章介绍组合证明的
概念，用来证明采用计数论证的结果。 读者应当注意已经有相关书籍专门描述本节讨论的内容，
包括乔治, 波利亚(George Polya)的许多优秀著作([Po61]，[Po71]，[Po9o]) 。

龟 也叫做勾股数组 。一一译者注



--- 第 82 页 ---
64 。

第1章 基础: 运辑和证明

最后，请注意: 本书没有给出在数学中能够用于证明定理的步骤。这是一个不存在这样步骤

的深奥的数理逻辑定理。

练习
1. 证明: 当”是 1魏mS4 的正整数时，有到十1之2" 。

2.

人中中

#<12.
13.

14.
- 证明: 方程 蕊十见一625 没有整数解 x 和>y。

- 改造 1.6 节例4 的证明，证明: 如果a、0、c 是正整数，*一abc，则 ua过汽，5过沪或者c去沪。

: 证明: 任两个有理数之间都有一个无理数。

. 设 S=症za加十十ro其忠rm， xz 和yym，…，是排序的两个不同正实数序列，

19-.
20，

21.
22.

23.

x24.。

证明: 若x和>都是实数，则 max(z，y)十min(z，y)一zx十y。[提示: 使用分情形证明，两种情形分别
对应于 z之和xz一y。]

: 证明三角不等式: 若x 和>y 都是实数， 则1z1二1?1伍1z+y1(其中|zl表示工的绝对值，若 zx三0

则它等于z，若 zx<0 则它等于一z) 。

. 证明: 存在 100 个连续的不是完全平方的正整数。你的证明是构造性的还是非构造性的?
. 证明: 存在一对连续的整数，其中一个整数是完全平方的，另一个是完全立方的。

证明或驭斥: 存在有理数 x 和无理数>，使得 z 是无理数。

- 证明下列每一个命题均可用于表达这样的事实: 存在一个唯一的元素 zx 使得 P(z)为真。(注意，这等同于

命题3! zP(zr)。)
a) 了3rVy(P(y)rx一y)                        b) 3zP(z)A Yrzyy(P(Cz)AP(Cy) 一一y)
c) 3zr(P(Cz)A Vy(P(y) -一y))

. 假定 e 和妨是奇数且a关pb。证明: 存在唯一的整数 <满足| ae一ec| 一15-c | 。
. 证明: 若是奇数，则存在唯一的整数上A，使得# 是上一2 和十3之和。
- 证明: 给定实数 rx，存在唯一的数 上 和*# 使得rz一nm一se，7 是整数且 0和es一1 。

:两个整数工各? 的调和均值是:> 。 通过计算不同成对正整数的调和均值和几何均值，形成关于这两种

均值相对大小的猜想并证明之。

在黑板上写数字 1，2，…，2n，其中是奇数，从中挑出两个数 /和上 ，在黑板上写 | j一上| 并氛掉 ) 和
*。继续这个过程，直到黑板上只写一个整数为止。证明: 这个整数必为奇数。

已知如下有关十进制数问题的一个猜想: 一个整数 4 次方的十进制最后位数字。用分情形方法证明你的
猜想。

证明: 不存在正整数”使得对十中一100。

各自有半个元素。

a)证明: 在这两个序列的所有排序当中，当两个序列都排序(使得每个序列中的元素都以非降序排列?时，
S取最大值。

b)证明: 在这两个序列的所有排序当中，当一个序列排成非降顺序，另一个序列排成非升顺序时，S 取
最小值，

对下列这些整数验证 3z十1 猜想 ，

a)6            b)7           c)17          d)21

证明或驳斥;你能用骨牌填充去掉两个相邻角(也就是说不是对角)的标准棋盘。

证明: 你能用骨牌填充带有偶数个方格的长方形棋盘。

通过穷举法证明: 用骨牌填充去掉两个对角的 4X4 棋盘是不存在的。[提示: 首先证明假设去掉左上角

和右下角的方格。模盘原始方格是 1 到 16，从第一行开始，在这一行向右移动，然后在第 2 行最左边的

方格开始向右移动，等等。去掉方块 和 16。开始证明时，注意到 2 或者被一个水平放置的骨牌覆盖，

这个骨牌覆盖 2 和 3，或者这个骨牌垂直地覆盖 2 和6。分别考虑每一种情况，证明产生的所有子情况。]

证明: 从一个8X8 的棋盘去掉两块白的和两块黑的方格(颜色如教材所示)，用骨牌填充棋盘留下的方格

是不可能的。

a)画五种不同的格板，每一个格板都是由四个角的四个格组成的。

b)证明或驳斥，用五种格板中的每种不同格板，可填充标准棋盘。



--- 第 83 页 ---
第1章 基础: 逻辑和证明。65

关键术语和结果

术语

命题: 一个或为真或为假的语句。

命题变元: 代表一个命题的变量。

真值，真或假。

bp(户的否定): 与户的真值相反的命题。

遥辑运算符: 用于组合命题的运算符。

复合命题: 用逻辑运算符组合命题构造出的命题。

真值表: 显示命题真值的表 。

pVg(户和9 的析取): 除非户和9 均为假，否则为真的命题。

户人9(户和4 的合取); 只有在户和9 均为真时才为真的命题。

户昌9(P 和gd 的异或): 当户和9 中恰有一个为真时才为真的命题。

户一q(旋蕴含g9): 只有在 户为真而9 为假时才为假的命题。

户一4 的逆昔含: 条件语句9一户。

户一qd的倒置冀含: 条件语名9一D户。

户一9 的反共含: 条件语句户一9g。

户**9g(双蓝含): 只有上户和9 真值相同时才为真的命题。

字位: 0或1。

布尔变量: 以0或1 为值的变量。

字位运算: 一个或多个字位上的运算 。

位串: 一串字位。

按位运算: 位串上的运算，对一个位串的字位和另一位串的对应字位作运算 。

永真式: 永远为真的复合命题。

矛盾: 永远为假的复合命题。

可能式: 有时成真有时为假的复合命题。

一致复合命题: 为变量赋真值，使所有这些命题为真的复合命题。

复合命题的还辑等价; 总有同样真值的复合命题。

谓词: 句子中代表主语属性的那部分。

命题函数: 包含一个或多个变量的语句，当每一个变量被指派或被量词约束时，就变成命题。
论域: 命题函数中变量可能取到的所有值。

3zP(Cz)(CP(zr)的存在量化): 当且仅当在论域中存在一个zx使 P(z)为真时才为真的命题。
VYrP(z)(CPCz)的全称量化) : 当上且仅当论域中的所有 z值 PCz)均为真时才为真的命题。
有远辑等价表达式: 无论应用什么样的命题函数和论域，真值都相同的表达式。
自由变量,命题函数中未绑定的变量。

绑定变量: 被量化的变量。

量词的作用域: 语句中量词所绑定变量的那部分。

论证:一连串的命题。

论证形式: 包含命题变量的一连串的复合命题。

前提: 论证或论证形式中最后命题以外的命题。

结论: 论证或论证形式中最后的命题。

有效论证形式: 包含命题变量的一连串的复合命题，它的所有前提为真芍含结论为真。
有效论证: 具有有效论证形式的论证。

推理规则: 用于示范论证有效的有效论证形式。

译误: 作为一个推理规则，人常常(有时或者更一般)用于不正确推理的无效论证形式。
循环论证或偷用论题: 一步或多个步骤基于待证明命题的正确性的推理。

定理: 可以证明为真的数学断言。

猜想: 真值未知的数学断言 。



--- 第 84 页 ---
66 "第1章 基础: 逻辑和证明

证明: 对定理为真的说明。

公理; 常作为证明定理的基础，并假设为真的命题。

引理: 用来证明其他定理的简单定理。

推论: 可以作为刚刚证明的定理的后果而被证明的命题。

空证明: 基于 户为假的事实而对蕴含式 户一9 的证明。

平凡证明: 基于 9 为真的事实而对蕴含式 户一9 的证明。

直接证明: 通过证明当 请为真时9 必然为真而进行的对蕴含式记一4 的证明。

反证法: 通过证明当9 是假时 请 一定是假，来证明 户一9 为真。

归亩证明: 基于蕴含式?一9 的真值(其中 9 是矛盾式)而对命题 户为真的证明。

穷举证明: 通过检查一系列的所有情况所建立的结果得到的证明。

分情形证明: 把情况分解为覆盖所有可能的单独情况的证明。

不失一般性: 假定一个证明可以通过减少需要证明的情况来证明的一个法则。

反例， 使得 P(z)为假的元素 x。

构造性的存在性证明: 证明具有特定性质的元素存在，通过显式的方式来寻找这样的元素。
非构造性的存在性证明: 证明具有特定性质的元素存在，但不是显式地寻找这样的元素。
有理数;可以表示为两个整数 请和9(其中9天0)之比的数。

唯一性证明: 证明具有特定性质的元素唯一地存在。

结果

1.2节表1-15、表1-16、表1-17 给出的逻辑等价关系。
德摩根定律

命题演算的推理规则

带量词命题的推理规则

复习题
. a)定义命题的否定。
b)这是一门烦人的课程的否定是什么?
-. a)(用真值表)定义命题户和9 的析取、合取、异或、蕴含和双区含。
b》今晚我去看电影”和“我将完成离散数学作业"的析取、合取、异或、芍含和双荀含是什么?
- a)给出至少五种用汉语表达条件语句 问一g 的方式。
b)定义条件句的逆列含和倒置 。
c六如果明天阳光明媚，我将到林中散步。 ”给出此条件语句的逆蕴含和倒悟 。
, a)两个命题逻辑等价的含义是什么?
b)描述证明两个复合命题逻辑等价的不同方法 。
c)至少用两种方法证明pV (Cr一0)和npV-n9Vnr等价。
-〈依赖于 1. 2 节的练习)
a)给出一个真值表，解释怎样用析取范式构造一个复合命题使其真值表就是你给出的真值表。
b)解释为什么 a)说明运算符人 ，V 和-是功能完全的。
c)是否有一个运算符使得只含这个运算符的集合是功能完全的?
. 什么是谓词 P(z)的全称和存在量化? 什么是它们的否定?
. a)量化语句 3z yyP(z，思和YYy3zP(z，y)的区别何在? 其中 P(z，y)为谓词 。
b)给出谓词 PCz，y)的一个实例,使 3z YyyP(z，y)和 Yy 3zP(Cz，y)有不同的真值。
8. 描述在命题逻辑中，有效论证是什么意思，并且证明:“如果地球是平的，那你就能行驶到地球边缘?”;
“你不能行驶到地球边缘”，因此,“地球不是平的?是有效论证。
9. 用推理规则证明: 如果前提"*所有的斑马都有条纹”,“马克是一匹班马?是真的，那么结论“马克有条纹”是
真的。
10. a)描述一下条件语句 娟一g 的直接证明、反证法和归衣证明分别是什么意思。
b)分别给出语句:“若是偶数，则 十4 是偶数"的直接证明 、反证法和归廖证明。

普，

fs

《

必

KE

下 中



--- 第 85 页 ---
13.

14-
15.
16.

第1章 基础: 还辑和证明。67

. a)描述证明双条件语句 pP**9 的一种方式。

b)证明命题:“整数 3十2 是奇数当且仅当整数 9十5 是偶数，其中二是整数"。

.为了证明语句 如，z ，加 和 思 都是等价的,证明条件语句 户一因，轴一四 和如一加 都是有效的，这

样做是否充分? 若不充分，则给出可用来证明这四个语句都是等价的另外一组条件语句。
a)假定形如 几P(z)的条件语句为假。如何可以证明它为假?

b)证明语名“对每个正整数 ”来说，到全2为假。

构造性与非构造性存在性证明之间的差异是什么?” 对这两种证明分别举一个例子。

证明，存在唯一的元素 使得 忆(z)为真(其中 P(z)是命题函数) 。这种证明的基础是什么?
阐释如何用分情形证明以下绝对值的结果， 对所有实数 和，有zy|一|zlly|。

补充练习

1，

4

必

避

13.

14.

相

令 记为命题"我将完成本书中的每一道练习"，4 为命题“这门课程我将得“A”"。将下列各项表示为户和9
的组合。

a)只有完成本书中的每道练习，这门课程我才能得A'。

b)这门课程我将得"A7"，而且我将完成本书中每一道练习。

c)或者这门课程我将得“A'*，或者我不完成本书中的每一道练习 。

d)这门课程我得“A"*的充分必要条件是我完成本书中每一道练习。

, 求复合命题(pVa)一(户人Dr)的真值表。
- 证明下列命题为水真式。

a) (9人(户一4) ) 一一户                        b)((记Vad)A人ADp)一g

- 给出下列条件语句的逆蕴含、反蕴含和倒置 。

a)如果今天下雨，我就开车上班。
b)如果|zx|1=z， 那么zx0。
c)若nz大于3，那么到大于9。

. 给出条件语句 请一9 的逆的反蕴含、反的反蕴含、倒置 。
, 给出条件语句 户一9 的逆的逆列含、反的逆列含、倒置的逆蕴含。
. 用命题变量 户，9，~ 和:* 构造一个复合命题，使它在这些命题变量中恰有三个为真时取真值，其他情况下

为假。

. 证明下列语句是不一致的:“如果 Sergei 拿到工作签证，那他将获得签约奖金“如果 Sergei 拿到工作签

证，那他将拿到高薪.“如果 Sergei 拿到签约奖金，那他将拿不到高薪.”*Sergei 拿到了工作签证。”

. 证明下列语句是不一致的:“如果 Miranda 没有修过离散数学课程，那她将不能毕业。"%如果 Miranda 不能

毕业，那她将不能胜任那份工作.光如果 Miranda 读了这本书，那她将能胜任那份工作 .”"“Miranda 没有修
过离散数学课程，但她读过这本书。”

: 假定你在 1. 1 节例 18 中描述的“武士和流让"共居的岛上遇见三个人4、B 和C。如果 A 说“我是流吝，B

是骑士"且 虽说“我们三人中怡有一人是骑士"，那么 A、电和C 分别是哪种人?

(摘自[Sm78])假定在一个岛上住着三类人: 武士、流总和普通人。武士总是说真话，流谍总是说谎话，

普通人有时说谎话有时说真话。侦探为了找出罪犯，询问了岛上的三个人 Amy、Brenda 和 Claire。 侦探
知道三人中有一人犯罪了，但不知是哪个人。他们也知道罪犯是一个骑士，另两个人不是骑士。 此外，
侦探还记录了如下供述。Amy 说:“我是清白的."Brenda 说:“Amy 说的是真的"Claire 说: “Brenda 不
是普通人.?经过分析，侦探找到了罪犯他是谁?

: 证明: 如果 S是一个命题，这里 S 是条件命题:“若 S 是真的，则独角兽是存在的”，那么“独角兽是存在

的"是真的。 证明 S 不能是一个命题(这是著名的罗素悖论) 。

证明:， 假设"牙齿仙女是真人”,“真理仙女就不是真人”，结论*你能在彩虹尽头找到金子*是有效论证。
能证明结论是真的吗?

令 P(z)为语句"学生工会微积分"，Q(y)为“> 班上有个学生会微积分”。用 P(z)和Q(y)的量化表示下列
各项。

al)某个学生会微积分。                 b)不是每个学生都会微积分。

c)每个班上都有一个学生会微积分。        d)每个班上的每个学生都会微积分。



--- 第 86 页 ---
68 "第1章 基础: 逻辑和证明

21.

22.
23.
24.
25.
26.

27.
28.
29.

30.

31.

32.

33，
34.
35.
36.
37-
38.
39.

40，

e)至少有一个班没有学生会微积分。

- 令 P(m，7m)为语句"mm 除尽ma”，其中变量 mm 和? 的论域均为正整数集合。给出下列命题的真值。

a)PC4，5)          b)P(2，4)          c) Vma yiP(m，mn)
d) 3 VnzP(Cm，m)      e) 了nz VPCm，7m)      f) VPC1，7m)

。 确定量词的论域，使语句 3z 3y(z天y) 人 Ye((z尖zx) 人(z天y)为真。

. 确定量词的论域，使语句 3z 3y(z天>y)A w((z=一zx)A(z一y)为假。

- 用量词表达语句“没人有多于三个的祖母"，使用命题函数 CCz，y)，它表示“z 是y 的祖母。”

. 用基词表达语句“每个人恰有两个亲生父母"，使用命题函数 P(z，y)，它表示“xz 是 y 的亲生父母。”

. 基词 3, 表示“有准确的交，因此了,zP(z)意思是在论域中存在准确的m值，使 P(zr)为真。由所有实数

组成论域，决定以下命题的真值:

a) 本,zf(zz一一1)        b)3zCizl=0)        c) sxr(z:一2)        d)习:zz一|工| )
用存在量词 、全称量词和命题逻辑表示以下每一个命题，这里 了3。 如练习 20 定义:
a) 习uzrP(Cz)                 b) 3让zPCzr)                  c)了yzrP(Czr)              d) 习:zP(Czr)

令 P(z，y?y)为命题函数。证明荀含关系 3z yy P(z，y) 一 Yy3zrP(rz，y)为永真式。

令 PCz)和 Q(Cz)为命题函数。求证 3z(P(z) 一QCz))和YrP(z) -= 3zQCz)有同样的真值。

如果 yy 3zP(z，切为真，3zyyP(rz，妇是否必定也为真?

如果 Vr 3yP(z，y)为真，3z yyP(z，y)是否必定也为真?

找出下列语句的否定。

a)如果今天下雪，那么我明天去滑雪。           b)班上每个人都懂数学归纳法 。

c)班上有些学生不喜欢离散数学 。              d每堂数学课都有某个学生上着课就睡着了 。
用量词表示"*班上每个学生都选修过数学学院每个系的某门课”。

用基词表示"在美国某学院的校园里有座楼的每间屋子都潜成了白色"”。

用唯一量词表示以下每一个语句:“在这个学校里，恰有一个数学班，而本班只有一个学生”，然后再用
量词而不用唯一量词表示这个语句。

描述一个推理规则，可用它来证明论域中恰有两个元素x和y 使得 P(z)和 P(y)为真。用汉语句子表达
这个推理规则。

使用推理规则证明如果前提 Yr(P(z) ~~Q(z))、Vr(Q(Czr) ->RCr))和Ra)为真，那么结论 P(a)为真，
其中 a 在论域中。

证明: 若关是无理数，则 > 是无理数。

证明: 若是无理数上且z0，则Vz是无理数。

证明: 给定一个非负整数 >，存在一个唯一的非负整数 mm 使得mm和过n<(m十1): 。

证明: 存在一个整数 六使得关 二10'" 。你的证明是构造性的还是非构造性的?

证明存在这样的正整数: 它可以被以两种不同的方式写成正整数的立方和。使用计算机或计算器来完成。
反驳如下命题: 每个正整数均可表示为 8 个非负整数的立方和。

反静如下命题: 每个正整数均可表示为至多两个非负整数的平方与一个非负整数的立方的和。
反驭如下命题: 每个正整数均可表示为 36 个非负整数的 5 次方的和。

假设以下定理的真实性: 对任何不是完全平方数的正整数 nn，是个无理数。由此证明, VZ 十V3是无
理数。

计算机题目
按给定的输入和输出写程序。

了
2.
3.
关生，

苦吕，

已知命题训和4 的真值，求它们的合取、析取、异或、条件语句和双条件语句的真值。
已知长度为”的两个位串，求它们的按位 AND、按位 OR 及按位 XOR。

已知模糊轩辑中命题训和4 的真值，求 训和9 的析取和合取的真值(参看 1. 1 节练习 21) 。
给定正整数 六，?，交互玩 Chomp 游戏。

给出部分棋盘，用各种不同类型的四角填充，包括骨牌 、两种类型的三格板和大四角。



--- 第 87 页 ---
第1章 基础: 运辑和证明 " 69

计算和研究

使用一个计算程序或你已完成的程序做下面的练习。

. 找出这样的正整数: 它不是 9 个不同的正整数的立方和。

2, 找出大于 79 的这样的正整数: 它不是 18 个正整数的四次方的和。

3. 找出尽可能多这样的正整数, 它可以用正整数的立方和来表示。用两种不同的方式，对 1729 使用这个
性质。

“4. 试图找出不同初始设置曲奇饼的 Chomp 游戏的获胜策略。

*5，寻找棋盘和带有四角的部分棋盘的填充。

写作题目

用课本以外的资料，按下列要求写成短文。

1. 讨论如下逻辑悖论: 克里特人 Epimenides 的悖论(又叫说谎者悖论) 、Jourdain 的纸牌悖论以及理发师悖
论。说明如何解决它们。

2. 描述模糊逻辑怎样用于实际应用。参考为一般读者写的一本或几本最近出版的模糊逻辑书。

3, 描述由 Layman Allen 提出的“WEFF'N PROOF，The Game of Modern Logic”的基本规则。给出 WFF'N
PROGOF 中包含的一些博弈示例。

. 读一些卡风尔(Lewis Carroll)关于符号逻辑的作品。详细描述他用于表示逻辑论证和推理规则的一些模型 。

. 扩展 1. 3 节对 Prolog 的讨论，进一步解释 Prolog 如何使用消解。

. 讨论在计算逻辑中使用的一些技术，包括 Skolem 的规则 。

-“自动定理证明"是使用计算机来机械地证明定理的任务。讨论自动定理证明的目标和应用，以及在开发自
动定理证明器上取得的进步。

8. 讨论如何使用 DNA 计算来求解可满性问题的示例。

9. 讨论有关 Chomp 游戏已知的获胜策略 。

10. 搞述在乔治波利亚有关推理的著作中讨论的各种证明策略，包括LPo62]、[Po71]和[Po90]。

11. 举例说明在[Go94]和[Ma91]中描述的几个有关四角棋盘的填充问题和结果。

hm

中

~ on



--- 第 88 页 ---
第2章 |

Discrete Mathematics and Its Applications，6E

基本结构: 集合、国数、数列与求和

离散数学的许多内容用以表示离散对象，研究离散结构。许多重要的离散结构是由所谓的对
象集构建的集合。用联接词构建集合之间的离散结构，这些无序的对象集被广泛地用于计数;关
系，代表着对象之间联系的有序对集合。图， 是节点集和连接节点的边的集合; 有限状态机用于
模型计算机。这些是后续章节研究的一些主题。

函数的概念在离散数学中是非常重要的。函数把集合中的每一个元素准确地指派给集合的一
个元素。郴数对整个离散数学起着重要的作用，用以表示算法的计算复杂人性，研究的集合的大小，
计算对象的数量，以及无数其他的应用方式。排序和字符串是特殊类型的函数。

2.1 集合
2.1.1 引言
我们将在这一部分学习基本的离散结构，以及由此而得到的各种各样的离散结构，换言之，
集合。集合用于把对象组合在一起。通常在一个集合中的对象都有相似的性质。例如，你们学校
中目前在册的所有学生可以组成一个集合。同样，任何学校正选修一门离散数学课的学生可以组
成一个集合。此外，你们学校在册学生中正选修一门离散数学课的所有学生组成一个集合，这个
集合可以从上述两个集合中取共同的元素得到。像集合那样，集合语言是以构造的方式来研究的
工具。现在提供集合的一种定义。这是一种直观的定义，不属于正规的集合定义。
定义  全合是一组无序的对象 。
5 注意，我们并没有说明对象是什么就已经使用这个术语了。以对象的直观概念为基础
”把集合描述为一组对象， 这是德国数学家康托尔 1895 年首先给出的。从集合的这一直
观定义得到的理论导出悖论，即逻辑上的不一致性。这是英国哲学家罗素 1902 年提出的。以称为
, 公理的基本假设为起点建立集合理论可以避免逻辑上的不一致。我们将不展开集合理
论的公理描述，而是使用康托尔的称为朴素集合理论的原始描述，这是因为本书中考
虑的所有集合均可用康托尔的原始理论处理而无不一致性。
汪有人 集合中的对象也称为该集合的元素，或成员。也说集合包含它的元素 。
现在介绍用于描述集合成员的方法。我们记 aeEA，也就是表示 au 是集合A 中一个元素。而
a红A就表示a 不是集合4A 中的一个元素。注意，小写字母通常用于表示集合中的元素。
有了几种方式描述集合，一种方式是在可能的情况下一一列出集合中的元素。我们采用在花括
号之间列出所有元素的方法。例如，{a，5，c，吃表示含 4个元素ae、6、c 和 的集合。
例1 英语字母中所有元音字母的集合 V 可以表示为V={a，e，i，o，跨。           国
例2 小于10 的正奇数集合 O 可以表示为O={1，3，5，7，9)} 。                 于
例3 尽管集合常用来表示一组具有共同性质的元素，但有的集合中的元素表面上看起来毫不
相干。例如，集合{ ae，2，Fred，New Jerseg }包含了 4 个元素，a、2、Fred 和 New Jerseg。   国
有时用花括号表示集合但并不列出它的所有元素。先列出集合中的某些元素，然后当元素的
一般形式很明显时就用省略号(…)表示 。
到党。 例4 小于100 的正整数集合可以表示为11，2，3，…，99} 。              轿
描述集合的另一种方式是使用集合的构造符号。我们给出作为集合的成员必须具
有的性质，以此来刻画集合的所有元素。例如，小于 10 的所有奇数的集合 O 可以写成

 

 



--- 第 89 页 ---
第2章 基本结构: 集合、函数、数列与求和"71

= {z|z是小于 10的正奇数}
或者，指定正整数集合的一个范围，如
O={E zz为奇数,rz一10}
当无法给出集合所有元素时常用这一类方法来描述集合。例如，所有正有理数集合，可以被写成
C=一(zzERIz=zp/q, pq为正整数}
这些集合用黑体表示，它们在离散数学中发挥着重要的作用 :

N=(0，1，2，3，…}，自然数集
Z={…，一2，一1，0，1，2，…})，整数集
Z+- 一(1，2，3，…}，正整数集
Q=(pdqlpE2Z，9EZ，和9天0}，有理数集
R，实数集
(注意，一些人认为0不是自然数成员，所以当你阅读其他书籍的时候要检查自然数成员的术

语是怎样用的。)

集合可以包含其他的集合，以例 5 为例说明。

例5 集合IN，Z，Q，R)}包含了4 个元素，其中每一个都是集合。这 4 个元素是: N，自然数
集; Z，整数集; Q，有理数集，以及 及，实数集。                            国

注意 计算机科学中的数据类型或类型的概念建立在集合这一概念之上。数据类型或类
型是集合的一个称号，它是连同对集合中的对象实施操作的集合。例如，布尔是集各
{0，1)}的一个称号，连同其上一个或多个元素实施运算，像并有全、或者和非。

由于许多数学语句需要断定两组以不同方式描述的对象实际上是同一个集合，我们需要理解
两个集合相等的含义。

两个集合相等当且仅当它们有同样的元素。也就是说，若集合 A 和集合也 是相等的，
当且仅当w(CzEAeezEB)。 如果A 和如是相等的集合，记为 4一B。

例6 集合(1，3，5}和(3，5，1)}相等，因为它们有同样的元素。注意集合中元素的顺序不起
作用，还要注意同一个元素被列出来不止一次也没关系。所以{1，3，3，3，5，5，5，5}和{1，
3，5}是同一个集合，因为它们有同样的元素。                     图

还可以用文氏图形象地表示集合。文氏图(或称维恩图)是以英国数学家 John Venn 的名字命名
的，他在 1881 年介绍了这种图的使用。我们所考虑的所有对象的集合 U，称为全集。在文氏图中
全集用长方形表示。在长方形内部，圆或其他也何图形用于表示集合，有时用点来表示集合中特
定的元素。文氏图常用于表示集合之间的关系。我们用下面的例子解释怎样使用文氏图。

例7 画一个表示英语字母中元音字母集合Y 的文氏图。

解 ”画一个长方形表示全集 加，也就是 26 个英文字母的集合。在长方形中画一个圆表示集合
Y，在圆中用点表示集合 V 的元素(见图 2-1) 。

有一个不含任何元素的特殊集合，称为空全，用好表示。
空集也可以用付表示(这是用花括号内列出所有元素的方式表示
集合) 。经常具有一定性质的元素组成的集合其实就是空集。例
如，大于自身的平方的所有正整数的集合是空集。只有一个元
.素的集合叫做单元素集合。

通常的错误是把空集条与单元素集合{弛)}摘混。集合{纪)
的唯一元素是空集本身! 记住这个区别的一个形象比喻是考虑
计算机文件系统中的文件夹。空集可以比做一个空的文件夹，  图 2-1 元音字母集合的文氏图
包含一个空集合的集合可以比作一个文件夹里只有一个空的文
件夹文件。

 

 

 

集合 A 是集合纪 的子集当且仅当A 的每个元素也是如 的元素。我们用记号 ASB表



--- 第 90 页 ---
72 "第2章 基本结构: 集合、函数、数列与求和

示4是已的子集。
我们看到，ASE中当且仅当量化诸句
VYz(zEA一EBDB)
为真。

例8 小于 10 的所有正奇数的集合，是小于 10 的所有正整数的集合的子集。有理数集是实数
集的一个子集。你们学校主修计算机科学的学生的集合是你们学校全体学生集合的子集。集合{全
体中国人民}是{全体中国人民}的子集(也就是说，它本身) 。                       国

定理 1 表明，每个非空集合 S 都至少有两个子集，一个是空集，一个是集合 S 本身，即好ES
和SSS。

 对于任意集合S，(D CES 和(iDSCGS。

证 这里证明(i) ，(ibD 留作练习。

令 S 为一个集合。为了证明凶SS，必须证明 Yz(zE 忆-一zxES)为真。因为空集没有元素，所
以zxE 何总是假。因此 zxE世一rzrES总是真，因为其假设为假，并且具有假的假设的条件语句为
真。即 vz(zE节一rES)为真。这完成了(i)的证明。这是空证明的示例。               口

如果我们要强调集合 A 是集合如 的子集，但 A关B，就写成4ACB，并说A是B 的真子集。若
ACB 是真的，则必有 ASB，且必有 妃 的某个元素z 不属于A，即如果

VzGzEA一ZEB)A3rzEEBAzgA)
为真. 那么4是如 的真子集。文氏图可以用来表示集合 A 是集合日 的子集。我们把全集 U 画成长
方形。在这长方形中画一表示号的圆。由于A是召的子集，我们在代表也的圆内画表示A 的圆。
图 2-2 所示就是这一关系。

证明两个集合具有相同元素的一个方法是证明它们互                      也
为另一个的子集。换言之，可以证明，如果A 和理均为集
合, 是ASB和BSA，则 4A=B。实践表明，这是证明集       (

合相等的一种有用的方式。也就是说，4=呈，其中4A 和有如                 2
是集合，当且仅当 Yzr(zEA-~zEB)和YVr(CzEB-zEA);
或者A和日等价，当且仅当 Vr(zEA-zEB)。

集合可以以其他集合作为它的成员。例如，下面列出

的就是这样的集合:                    图2-2 表示A是B的子集的文氏图
一(gtay, (pta ty，B= (zz是集合ta,b) 的子集》
注意，这两个集合相等，即 4王B。同时注意fay)EA，但是ac&A。

集合广泛用于计数问题。这类问题需要讨论集合的大小。

人 令 S 为集合。若 S 中怡有7 个不同的元素，z 是非负整数，就说 S是有限集合，而，
是S 的基数。S 的基数用 | S | 表示。

 

 

例9 令 A 为小于 10 的正奇数集合, 则 | A | =5。                 目
例10 令 S 为英语字母集，那么 | S | 一26。                    恒
例 11 由于空集没有元素，所以 | 好 | =0。                     目
我们对不是有限的集合也有兴趣。

”如果一个集合不是有限的，就说它是无限的。
例 12正整数集合是无限的。                           上

到吧，。 无限集合的基数将在 2. 4 节讨论。

2.1.2 圭集合
许多问题都需要检查一个集合的元素所有可能的组合，看它们是否具有某种性质。为了考虑
集合 S 中元素所有可能的组合，我们构造一个新集合，它以 S 的所有子集作为它的元素。



--- 第 91 页 ---
第2章 基本结构: 集合、函数、数列与求和。 73

避    已知集合S，S 的办集合是集合 S 所有子集的集合。S 的寡集合用 P(S)表示 。
例13 集合{0，1，2)的寡集合是什么?
解”守集合 P({0，1，2))是{40，1，2}所有子集的集合。因此
PC{0,1,2)) 一{杂,{0) ,11) 12) ,10,1}) ,10,2) ,11,2), 10,1,2)》
注意 空集和(0，1，2}自身都是这个子集集合的成员。                         国
例14 空集的守集合是什么? 集合{好}的寡集合是什么?
解 空集只有一个子集，这就是它自己。因此

 

忆(和) 一 (好)
集合{忆;有两个子集，即儿和集合{杂}自身。于是
({玫站 一{杂,(厅洲                        国

如果一个集合有 个元素，那么它的寡集合有 2" 个元素。我们将在本书以后的几节中以不同
的方式证明这一事实。

2.1.3 笛卡儿积
一组元素中元素的次序往往是重要的。由于集合是无序的，必须用不同的结构来表示有序的
一组元素，  这个结构由有序守元组来提供。
县汪有序 ”元组(cc ，a ，…，a)是以 ai 为第 1 个元素，a: 为第 2 个元素，…，a, 为第n
个元素的有序组。

 

只有在两个有序 元组每一对对应的元素都相等时，它们才相等。换言之，(a ，w ，…，a,)一
(bi ， Po ， 0 pb )当上且仅当对于 i一  1， 2， "1 ai一已 io 二元组特称为有序偶。 有序偶(a， 8) 和

(c，dqd)相等当且仅当 a=c 和0一d。注意，除非 一05，否则(ae，25) 和(5，a)不相等。

在随后几章中将要学习的许多离散结构均以 Reng Descartes 命名的集合的符卡儿积的概念为基
础。我们先定义两个集合的笛卡儿积。
    令A和旦为集合。A 和哩的攻卡儿积用AX忆表示，是所有有序偶(ae，5的集合，
其中caE4而6E呈。于是

 

4XB= (ap laEAADEB)
例15 令 4为某大学所有学生的集合，召表示该大学开设的所有课程的集合。A 和旦的笛卡
儿积4X瑟是什么?
Cs  解 笛卡儿积AX刀由形为Ca，幻的所有有序偶组成，其中 e 是学生，而 是该校开的
一门课。 集合AX吕可以用来表示该校学生选课的所有可能情况。             国
例16 4={1，2)}和吾=(ae，0，c)的笛卡儿积是什么?
解 笛卡儿积AX如是
入X中一{(l,a),(1,5) (1c), (2a), (2,0) (2,c))               国
笛卡儿积 4X互的子集尺 称为从集合4 到集合巨 的关系。尺的元素是有序偶，其中第一个元
素属于4A，第二个元素属于 B。例如，R= ((a，0)，(a，1)，(a，3)，(0，1)，(8，2)，(c，0)，
(c，3)}是从集合{fe，5，c}到集合(10，1，2，3}的关系。我们将在第 5 章详细研究关系。
除非 4一和或 5一人纪(这样 AX如一节)或除非 4一吾，否则4XB和吾XA不相等。这在下例中
说明。
例17 证明稍卡儿积BxA和AX3B不相等，其中A和旦为例 16 中的集合。
解 笛卡儿积召XA是
也XA= (Ga,1),(a,2),(o,1),(6,2),(c,1),(c,2))》
.这不等于例 16 中得到的4XB。                                          国
Ra 上的集合也了以定义科卡儿积。
二回 集合4，4，…，A4, 的笠卡儿积用4,XA,Xx…XA,表示，这是有序 ”元组

 



--- 第 92 页 ---
74 "第2章 基本结构: 集合、函数、数列与求和

(a，a ，…，a)的集合，其中对于 ;=1，2，…，n，wEA。换言之，
AXAX…XA,一(aa wa) laE Ai一1 2 ,7)》
例18 第卡儿积AXBxC是什么,其中A=(10，1)，B=(11，2)》，C王(0，1，2}?
解 ”这一笛卡儿积由所有有序三元组(ae，6，c)组成，其中aEA，p6EB，cEC。因此，
4XxBxC=((0,1,0),(0,1,1),(0,1,2),(0,2,0),(0,2,1),(0,2,2)，
(1,1,0),(1,1,1),(1,1,2),(1,2,0),(1,2,1),(1,2,2)}         国

2.1.4 使用带量词的集合符号

有时我们在符号中显式说明语句的论域。特别地，YrE SCP(z))表示 P(z)的全称量化，其中
论域是集合 S。换名话说，VYrE SCP(z))是wzr(zES一PCzr))的简写。类似地，3zrE SCP(z))表示
P(z)的存在量化，论域是 S。也就是说，3zESCP(Cz))是3XCzESAP(zr))的简写 。

例19 语句YzER(关三0)和3zEZ(z一1)的含义是什么?

解 ”语句VrER(z过0)声称对任意实数 zx，王0。这个语句可以表达为“任意实数的平方是
非负的”。这是真语句。

语句 3zEZ(疡一1)声称存在一个整数 z 使得z:王1。这个语句可以表达为“有某个整数，其平
方是 1”。这个语句也是真语句，因为 zx=1 就是这样一个整数(一1 也是) 。              国

2.1.5 量词的真值集合

我们把集合理论和谓词逻辑的概念结合在一起。给定谓词 P 和论域D，定义 P 的真值集合，
刀 中元素z使 P(z)为真的元素组成的集合。P(z)的真值集合记为{ zxE了1 PCz))。

例20 谓词 P(z)、Q(Cz)、R(z)的真值集合都是什么?其中论域是整数集合，P(z) 是
“| zjl=1”，Q(Cr)是“z一2”，RCz)是“| 并| 一z>。

解 P的真值集合(zEZ1|z 1一1)是满足| z1=1的整数集合。因为当z=1或zx=一1 时，
| z 1三1，而没有其他的整数。P 的真值集合是{一1，1) 。

@的真值集合{zEZ | 盖=2)}是满足袜一2 的整数集合。因为没有整数 zx 满足xz:一2，所以这

是个空集。
及的真值集合{(zEZ11z 1一z)是满足| x| =工的整数集合。因为当且仅当 zx>0时，| z | =
并， 所以尺的真值集合是 N， 非负整数集合。                                男

注意，在域O 上 YzP(z)为真当且仅当尸的真值集合是集合U。同样，域 U 上 3zP(z)为真，
当且仅当 的真值集合非空。

练习
1. 列出下述集合的成员 。
a){z|并是使得z一1 的实数}                b){z |妆是小于 12 的正整数}
c){z |并是某个整数的平方上且z一100》          d){z |是整数且关:一2}
. 判断下面每对集合是否相等 。
a)(t1，3，3，3，5，5，5，5，5}，{5，3，1》   b)fftl)， (1，{1)》      c)?忆，{好)}
. 对下面的每个集合，判断 2 是否为它的元素。
a){zERiz是大于1I的整数}        b){zER[z是某整数的平方}        c){(2，{2)}
d){{t2，{(2}))             e){f{t21，{(2，{2)            f11t2)》》
, 判断下列语句是真还是假。
a)06E 所           b)帮E{10}           c){0 CC好           d)人好所(0)}
e){fOE{0}        f{0OC{10}          g){人好)三{好)}
- 判断下列语句是真还是假。
a)zE{z}          b){tz}S{z)          c){z)Efz)
d)tziE(tz))      e)好(7z}           名多Efz)

SS

《2

避

nm



--- 第 93 页 ---
第2章 基本结构: 集合、函数、数列与求和。75

. 用文氏图说明在一年所有的月份集合中不包含字母 尺 的所有月份的集合。
. 用文氏图说明集合关系 4AC下和有CC。
. 假定4A、刀和C 为集合，且 ASB，BEC。 证明 ASC。
. 下列各集合的基数是什么?
a){fa}            b){fa》          c)fae，{a}》        d){ta，{ay，{(a，{a)}
10. 找出下列各集合的寡集合。
a){a}            byta，z)}          c) (说，{和人
下列各集合各有多少个元束?
a)P((a， pp， fa bj bPCZ，a，(ta，({fa))    c)P(CP(人好))
12. 令4=({a，5。，c，d)，B一{y，z})。求
a)AX吕           b)BXxA
13. 什么是笛卡儿积 AXBxC，其中A 是所有航线的集合，已和C 都是所有美国城市的集合。
14. 令 A 为集合，求证已XA=AX好=区。
15. 如果 A 有mm 个元素，刀有) 个元素，AX刀有多少个元素?
16. 解释为什么AXBXxC和(AXxB)XC不同。
17. 将下列量化表达式翻译成汉语句子并确定其真值。

避 gm 习 中

11.

一

a) VzrER(Czz天一1)      b) 3zEZ(z一2)          c) VzEZ(z:一0)           d) 3zER(Cz:一z)
18. 给出以下各个谓词的真值集合，这里域是整数集合。
a)P(z):， “zz一3?    b)QGz): “2     c)RCz): “2z十1一0”

*19, 证明: 如果有序偶(ae，b可以用集合术语定义为{{tae)，{ae，b)}，那么(a，b)一(c，d)当且仅当a=c且
4一d。[提示: 首先证明{{ta)，ta，b} 一(fcj，{c，d)当且仅当a=c<且0=d。]
*20. 给出可以列出有限集合所有子集的步骤 。

2.2 集合运算
2.2.1 引言
汪隔5 两个集合可以以许多不同的方式结合在一起。例如，从学校主修数学课的集合和主修
“” “计算机科学课的集合人手，可以构成主修数学或计算机科学的学生集合，既主修数学
又主修计算机科学的学生集合，不主修数学的学生集合，等等。

二 令A和中为集合。A和电的并集用AUB表示，这是A或孔中或同时在A 和忆 中的
元素组成的集合。

元素工属于A 和旦的并集当且仅当z 属于A 或zx 属于召。这说明

4UB=(zlzrzEAVrzrEB)

图 2-3 中的文氏图表示集合A 和避的并集。代表
集合 4 的圆圈内和代表B 的圆圈内的阴影区域表示 A
和昌 的并集。

我们将给出集合并集的例子。

例1 集合(1L，3，5}和集合{1，2，3}的并集是集
合{1，2，3，5}，即

 

{1,3,5》 U {1,2,3》 一 {1,2,3,5}       国
例2 学校主修计算机科学的学生集合与主修数学            105太而开区
AN                       、
的学生集合的并集，是或主修数学或主修计算机科学   图 2-3 表示信和有并集的文氏图

或同时主修这两门课的学生的集合。       图
和 邻人和昌为集合。A 和马的交全用A站B 表示，这是既在 A 中又在B 中的那些元素

 

的集合。
元素工属于集合A 和日 的交集当且仅当z 属于A 而且xz 属于马。这说明
4mB={(zlzEAArEB



--- 第 94 页 ---
76“第2章 基本结构: 集合、函数、数列与求和

 2-4 中的文氏图表示集合A和的交集。同时在代表 A 和召 的两个圆之内的阴影区域表示
A 和避的交集。

我们给出交集的几个例子。                                         了

例3 集合{L，3，5)和{1，2，3}的交集是{1，3)}，

即{11，、3，5}和站11，2，3}一(1，3}             图
例4 学校所有主修计算机科学的学生集合与所有
主修数学的学生集合，是所有既主修计算机科学又主
修数学的学生的集合，                     国

ER 如果两个集合的交集为空集，就说它们
不相交。                                         AmB为阴影区

例5 令A=(1，3，5，7，9)}而如=({(2，4，6，8，    图2-4 表示A和B交集的文氏图
0}。因为 A站8=区，所以A和电不相交。      轩

还有其他组合集合的重要方式。

区    令4A和电为集合。A 和刀的差全用4一已表示，这是包含只属于 A 而不属于吾的所
有元素的集合。A 和忆 的差集也称为召对于A 的补集。

元素属于A 和电的差集当且仅当zEA且z人中，这说明

4一B=一(zlzEAANAzgB)

图 2-5 中的文氏图表示集合A 和电 的差集。既在表示集合 A 的圆圈内部也在表示集合日的贺

图外部的阴影区域表示A一忆。

 

 

让我们举几个差集的例子。

例6 集合(1，3，5}和{1，2，3)}的差集是{5};，即{1，3，5}一人1，2，3}王(5)。这不同于
{1，2，3}和{1，3，5}的差集{2)} 。                                        图

例7 学校主修计算机科学的学生集合和主修数学的学生集合的差集是学校主修计算机科学但
不主修数学的学生集合。                                             上

一旦指定了全集 吕， 就可以定义集合的补集。
ER 令U为全集。集合 A 的补集用奈 表示，这是 A 对于 U 的补集。集合 A 的补集

 

是LU一4A。
元素属于A 当且仅当z和对A。这说明
A 一(zlzEA}
 2-6 中代表集合 4 的圆圈外面的阴影区域表示A。

 

A-有为阴影区                        4 为阴影区
图2-5 A和电的差集的文氏图         图 2-6 集合A 的补集的文氏图
我们举几个补集的例子。
例8  令 4={a， eziy Dy zx) (全集为英语字母集) 。 那么
A-== {pycyady太g六JR 轧,qgrysytiyuUyroOy yz)}                 |

例9 令A为大于10 的正整数的集合(全集为正整数集合) 。那么`
A ={1,2,3,4,5,6,7,8,9,10)}                         加



--- 第 95 页 ---
第2章 基本结构: 集合、画数、数列与求和，77

2.2.2 集合恒等式

表 2-1 列出了最重要的集合恒等式。本节将用三种不同的方法证明其中的几个。介绍这些方
法是想说明，对一个问题的解往往有不同的途径。表中未证明的恒等式留给读者练习。读者应该
注意这些集合恒等式和 1. 2 节讨论的逻辑等价的相似之处。事实 上，这里给出的集合恒等式可以
直接由对应的多辑等价证明 。不仅如此，而且这两者都是布尔代数中成立的恒等式的特殊情况 。

表 2-1 集合恒等式

 

等 式                      名 称
AN                           ms
Angra                                     要
和                           rr
(CD一A                                                                       补集律
2人                          oa

AUCBUC=(AUB)UC
AnC8nc=(4AnB)mC
Amn(BUC=(C4AnB)UCAnC)
AU(CBnc)=(4AUB)mCAUC)
AU一志门巨

A4门B=AU巨

AU(CAPmB)王和
AnmCAUB)=信

4UA=U

A门4一放

德摩根定律
吸收律

补律

证明集合相等的一种方法是证明两者中任何一个都是另一个的子集。为了证明一个集合是另
一个集合的子集，可以通过证明一个元素如果属于第一个集合，必定属于第二个集合。也就是用
直接的方法证明 。我们将以确立德摩根第二定律为例说明这一方法。

例10 证明A站B=去U巨。

BR 解 为了证明4人6一和AU巨，我们需要证明A几BSAU互和及UECAFE。

首先，证明A由BEAU。假定xEAnmB， 根据补的定义，z人APB，由交的定义，
nmCCzEA)ACzEB))为真，(由逻辑)用德摩根定律可得5(zEA)或(zEB)。因此，根据否定
的定义，有 z& 4 或代日。再由补的定义，zrE互或zxE巨;再由并，zE亏U巨，因此，得证
AmBSEAU巨。

然后，证明 AUEBSEA站B。现假设 rxE及U巨,由并的定义，zE瓦或zeE互,用补的定义，zc
4或z人Bi 所以，CzE4)V(zEB)为真。(由逻辑)用德摩根定律可得， mrEA)A(CzrEEB)为
真。由交的定义，nCzEAnmB)成立; 由补的定义，由 zxE人及月巨，这表明到UBCXAPE。 由于已证
明这两个集合中，一个是另一个的子集，所以，这两个集合相等，即得证恒等。       [

另一个更简洁的方法是使用集合构造符，如例 11 所示。



--- 第 96 页 ---
78 "第2章 基本结构: 和集合、函数、数列与求和

例 11 用集合构造符和逻辑等价证明A门B=AU。
解 下列一串等式提供了这一恒等关系的证明:

APB={tzlze&AnmB}                根据补的定义
一(zzE(A4PB)))}       根据不属于符号的含义
一人z|-mCGzEAAzEB)}      根据交的定义
={(z1nGrEA)VnCrEEB)}    根据逻辑等价式的德摩根第一定律
一{Z| 工人4AVzE了B)         根据不属于符号的含义
一{zlzxzEAVxE巨         根据补的定义
一{| zEAU吾}           根据并的定义
一AUB                  根据集合表示的含义
注意，除了补、并、集合成员、集合表示的定义，这个证明还用到了逻辑等价式的德摩根第
一定律 。                                                               国
要证明涉及两个以上集合的集合恒等，可以证明便等式的每一边是另一边的子集，这我们可
用例 12 来说明。

例12 证明表2-1中的第一个分配律: 对任意集合A，B 和C，证明
4nCBUC=(4nmB)UCAnC)

解 ”我们将通过说明等式的每一边是另一边的子集来证明这个恒等式。

假定zxE4Am(BUC)， 那么zEA且zEBUC。根据集合并的定义，可得 zxEA且rEB或
ZEC; 因此，zEA且zE8B或xzE4且zEC。根据交的定义，可知 zxE4mB或xzE4AmcCc; 使用
并的定义，可得出xzE(4AnB)UCAnmcCc)， 由此4AnCBUCECAnB)UCAnmC) 。

现在假定rzE(4mnB)UCAmnC)，那么,由并的定义，zEAmnB或xE4mCc; 由交的定义，可
得zEA且zEB或zrEA4且rzEC; 由此可知，zEA，zE电或zxECi 因此，由并的定义可知，
zEA且zEBUC。而且，由交的定义，可得xzEAm(BUC);， 最终得出(4AnB)UCAnmCISEAn(CB
UC)。这便完成了恒等式的证明。                                          国

还可以用成员表来证明集合便等式。我们考虑一个元素可能属于的集合的每一种组合，并证
明在同样的集合组合中的元素属于恒等式两边的集合。用 1 表示元素属于一个集合，用 0 表示元素
不属于一个集合(读者应注意成员表和真值表的相似之处) 。

例 13 用成员表证明 4mn(CBUC)=(4PmB)UCAmC)。

解 表2-2给出了这些集合组合的成员表。这表格有 8 行。由于对应于Am(CBUC)和(An站B)
U(CAPnC)的两列相同，恒等式有效。                                      国

表 2-2 分配性质的成员表

5

1
1
1
0
0
0
0
0

用我们已经证明的这些集合恒等式可以证明其他的集合恒等式。考虑下面的例子。

  

(AnB)UCAnC)

日

  

   

司吕吕盖划 一

1
1
0
0
0
0
0
0

局
忆 有一一 盖呈一 一
己 一口号 一
尼 一一一 口 一一一
局

    



--- 第 97 页 ---
第2章 基本结构: 集合、函数、数列与求和。 7?

例14 令A，B，C 为集合。证明
4AUCBnc=(CUE5)DmA
解 ”我们有
AUCGBnG=-aAnCnC)      由德摩根第一律
一人站CEUC)      由德摩根第二律
=(BEUC)PmA      由交集的交换律
=(CUE)PmA      由并集的交换律                     国

2.2.3 扩展的并集和交集

由于集合的并集和交集满足结合律，所以只要 4A、妃、C 为集合， AUBUC和AmnBnc均有
定义。也就是说，这样表示的含义都是很明确的。我们不需要用括号来指明哪个运算在前，因为
4AUCBUCI=(AUB)IUC及AnCBnC=(C4nB)mCc。 注意AUBUC包含那些至少属于A、B、
C 中一个集合的元素, 而4站BC包含那些属于A、B、C 全部三个集合的元素。三个集合4A、B、
C的这两种组合如图 2-7 所示。

 

a) 阴影区为4AUBUC                 b) 阴影区为An BncC
图2-7 集合4A、互、C 的并集和交集

例15 令4={0，2，4，6，8}，B= 10,，1，2，3，4}，C=({0，3，6,，9}。AUBUC和AnmBn
C是什么集合?
解 AUBUC包括那些至少属于A，B，C之一的元素。所以
AUBUC=(0,1,2,3,4,6,8,9}
集合AnBmncC包括那些属于全部三个集合的元素。因此
4nBnc=1{0)             国
可以考虑任意多个集合的并集和交集。我们采用下面的定义。
 一组集合的并集是包含那些至少是这组集合中一个集合成员的元素的集合。
用记号

AU4U…U4=UA

表示集合 4 ， 4 ，…，A， 的并集。
本 一组集合的交集是包含那些属于这组集合中所有成员集合的元素的集合。

 

本

4nan…na,=门4

表示集合 A，4, ，…，A, 的交集。
我们用例 16 说明扩展的并集和交集。



--- 第 98 页 ---
80。第2章 基本结构: 集合、函数、数列与求和

例16 令A一(ii十1，i十2，…}。那么
UUA=U iT十2一人1123，)

站4-站人itra+2 .一fan十1十2          国
我们可以扩展已经介绍的并集和交集到类似的集合。尤其可以使用公式
AUAU…UA4A.U-… 一UA4
去表示集合 A, ，4; ，…，A,…的并集。类似地， 这些集合的交集可以表示为
Anancnanc =站4

大体上,公式门 。A, 和[LU 。,A, 分别用于表示对于iE工集合A, 的并集和交集。注意，我们这样
使用

LA一人zl VerE AD))
和
=人13er(zE AD))
例17 对于i=1，2，3，…. 集合4 ={11，2，3，…，姥。那么，
UUA = UL2.3,省= 0123一下
和
ma- 站2人=
可以看到， 这些集合的并集是正整数集， 每一个正整数至少属于一个集合，因为整数 ”属于
A,={1，2，…，?}，并集中的每一 个元素者是正避致。注音到属于所有的集合的元素只有1，即
这些集合的交集。 也就是说， Ai一{1}， 而且 1EA,(C一1， 2， …)。                  下

2.2.4 计算机表示集合的方式

计算机表示集合的方式多种多样。一种办法是把集合的元素无序地存储起来。可是如果这样
做，在做集合的并集、交集或差集等运算时会浪费时间，因为这些运算将需要大量的元素检索。
我们将要介绍一种利用全集元素的一个任意排序存放元素以表示集合的方法。集合的这种表示法

使我们很容易计算集合的组合。
假定全集 避 是有限的(而且大小合适，使 U 的元素个数不超过计算机能使用的内存量)。首先
为 U 的元素任意规定一个顺序，例如 a ，a: ，…，a*。于是可以用长度为二的位串表示 LU 的子集

A: 如果w 属于4A，则位串中第;位是1; 如果w 不属于A，则位串中第;位是0。下面的例子阐明
了这一方法。
例18 令U={(1，2, 3，4，5，6，7，8，9，10}，而且 U 的元素从小到大排序，即 c, = ,。
表示 U 中所有奇数的子集、所有偶数的子集和不超过 5 的整数的子集的位串是什么?
解”表示U 中所有奇数的子集即{1，3，5，7，9}的位第，其第1、3、5、7、9 位为1，其他
位为0，即
10 1010 1010
(我们已把长度为 10 的位串分成长度为4的片段组合以便阅读，因为长位串不易读)。类似地，U
中所有偶数的子集即12，4，6，8，10}，由位串
01 0101 0101



--- 第 99 页 ---
第2童 基本结构: 集合、范数、数列与求和“* 81

表示。LU 中不超过 5 的所有整数的集合即{1，2，3，4，5}，由位趾
11 1110 0000                         里
表示。

用位串表示集合便于计算集合的补集、并集、交集和差集。要从表示集合的位串计算它的补
集的位串，只需简单地把每个 1 改为0，每个0 改为1]，因为 zEA 当且仅当z人AAA。注意，当把每
个字位看成是真值时，上述运算对应于取每个字位的非，因为 1 表示真，0 表示假。

例 19 我们已经知道集合{1，3，5，7，9}的位串(全集为{1，2，3. 4，5，6，7，8，9，10))是

10 1010 1010
它的补集的位串是什么?
解 用0取代1，用1取代0，即可得到此集合的补集的位串
01 0101 0101
这对应着集合{2，4，6，8，101} 。                                        国

要得到两个集合的并集和交集的位串，我们可以对表示这两个集合的位串按位做布尔运算。
只要两个位串的第;字位有一个是 1，则并集的位串的第守位是1，当两个字位都是0 时为0。因
此，并集的位串是两个集合位串的按位或(bitwise OR) 。当两个位串的第i字位均为1时，交集的
位串第;位为1，和否则为0。因此交集的位串是两个集合位串的按位与(bitwise AND) 。

例20 集合(1，2，3，4，5}和(1， 3，5，?7，9}的位串分别是 11 1110 0000 和 10 1010 1010。
用位串找出它们的并集和交集。

解 ”这两个集合的并集的位趾是

11 1110 0000 V 10 1010 1010 = 11 1110 1010
它表示的集合是{1，2，3，4，5，7，9}。这两个集合的交集的位串是
11 1110 0000 A 10 1010 1010 = 10 1010 0000
它表示的集合是{1，3，5) 。                              四

练习
1. 令 4 为住在离学校一英里以内的所有学生的集合，中 是走路上学的所有学生的集合。描述一下下列各集合
中的学生:

a)A门如          b)AUB          c)A一召          d)另一入
2. 令A={(1，2，3. 4，5}，有=一(0，3，6}。求
a)A山吾          b)A站如          c)A一召          d)吾一及

在练习 3一5 中,假定 4 是某个未知全集 U 的子集。

. 证明表 2-1 中的补集律: A=A。

4. 证明表 2-1 中的支配律 :

a)AUDU=U      b)A站条=好

- 证明表 2-1 中的交换律 ,

a)AU有=局         b)APnA=妇

. 已知A和电为两个集合，试证明表 2-1 中的交换律:

al)4UB=BUA      b)A4门召=瑟门4

. 证明表 2-1 中的第二个吸收律: 如果A 和日为两个集合,那么Ai(4AUB)=A。

8. 通过以下两种方式证明表 2-1 中的第一个德摩根律: 如果 A 和日 为两个集合，那么 AUB=去站五。
a)证明两边互为子集 ”b)使用成员表

9. 设4A,虽，C 为集合。 证明AmBnc=AUEUC。

a)用证明等式两边互为子集的办法      b)用成员表

10. 如果A和理为集合, 证明 A一B一An门巨。

11, 证明表 2-1 中的第一个结合律， 如果 4A，有中，C 均为集合，那么AU(CBUC) = (AUB)UC。

12. 证明表 2-1 中的第二个分配律: 如果A，B，C 均为集合,那么AU(BnC)=(AUB) CAUC)，

居  CD

<

~



--- 第 100 页 ---
82。

13

14.

15.

20.
#21.
22.
#23、

24.

25.

26.

27.
28.

29.

无
重

数
差

若
忆

各
30

第2章 基本结构: 集合、函数、数列与求和

. 令A={(0，2，4，、6，8，10)，B一{0、1，2，3，4，5. 6}，C=(4，5，6，7，8，9，10}) 。求

a4nBnC       b4UBUC        cC4UB)mC      d)C4nB)UC
画出以下集合4，B，C， 的各个组合的文氏图:

a)A站(CB一C)      banB)UCAnc eu4nB)UCAnC)

如果有关集合 4 与召的下列性质为真，你能就 4 和日 说些什么?

a)4AUB一A       b)APnB=A        c)A一旭一A

dAnB=BnA    e)A一B一了一A

- 令4和日为全集 U 的子集。证明 ASB 当且仅当5SA。

集合4A 和忆的对称差，用 A引B表示，是属于 A 或属于吾 但不同时属于A 与日的元素组成的集合。
. 求某校主修计算机科学的学生集合与主修数学的学生集合的对称差。
. 证明 4@引B=(4UB)一(AmnB)。
. 证明: 若A是全集U 的子集，则
a)A四4A=区       b)4昌和艺=A        c)A个U=下        d)4咎A=U
如果 4由8B=4，你能就集合 4 和甩 说些什么?
假定A，B，C 为集合，使得 4个C= B申C。 是否必定有 A王B?
若A，B，C，DD 为集合，(4A由B)申(C息D)= (4企D)由(8B候C)是否成立?

令 4一(1，2，3，…，1，i一1，2，3，…。求

s) 4A         b 仆A，

令A, 为所有长度不超过* 的非空位串(即长度至少为 1)的集合。求
a) Ua         bf ]A

试求吕关:A 和站三:A,，如果对于任一正整数 i，

a)A,一{一1，一1i1，…，一1，0，、1，…，i一1，计

b)A,一!一1，疾

c)A,一[一和 襄，即满足一泛z和:的实数 z 的集合

d)A,一[i，ce]j，即满足 zx3i 的实数z 的集合

使用上题中的同一个全集 ，求下列位串各自代表的集合。

a)11 1100 1111       b)01 0111 1000        c)10 0000 0001

对应于两个集合之差的位串是什么?

邻 A一(ta，pb，c，d，ej ，B一19，c，d，g，p，t，u)，C一(ec，e，i， o，k，z， 3 zl，了= (d，e，六，
it，m，o，t，u，Y，y?} 。说明怎样用位串的按位运算求下列集合，

a)AUB         b)A站3B         caAUD)PmCBUC)         d)4UBUCUDD

集合 4 的后继是AU{A};。求下列集合的后继。

a){1，2，3}      b)允           c){何}                 d)(丰，(杂上

有时一个元素在一个无序集中出现的次数也有意义。当同一个元素作为成员可以出现不止一次时，这个
序元素集就是多重集。符号(ma ，al ，mz 。 az，…，7zr，ar表示的是 a 出现 mm 次， az 出现 ms 次等的多
集。 整数 mm, 称为a, 的重数，i一1，2，…，r。

令P和Q 为多重集，多重集 P和Q 的并集是个多重集，其中每个元素的重数是该元素在 P 和Q 中的重
的最大值。P 和@Q 的交集是个多重集，其中每个元素的重数是该元素在 P 和Q 中重数的最小值。忆和Q 的
和集是个多重集 ，其中每个元素的重数是该元索在 P 中的重数减去它在 Q 中的重数，当然这不能是个负数，
是负数就以 0 作重数。已和Q 的和集是个多重集，其中每个元素的重数是该元素在 P 和Q 中的重数的和，
和人 的并集、交集和差集分别用 PUQ、PPQ 和已一Q 表示(不要混请这些运算和集合上的类似运算)。忆
Q 的和集用P十Q 表示。

.令A和忆分别为多重集{3。a.、 2 .58，1.c)和{2。a，3 .5，4 。d)。求
a)A岂       b)A六吾       c) 4一召      d)吾一入      e)4十吾



--- 第 101 页 ---
第2章 基本结构: 集合、函数、数列与求和"83

2 人工智能中使用模糊集合。全集 D 中每个元素在模糊集合S 中都有个成员度，即0 和1 之间(包括0 和
1)的实数。模糊集合 S 的表示法是列出其元素及成员度(成员度为 0 的元素不列)。例如，用{0.6

Alice，0.9 Brian，0.4 Fred，0. 1 Oscar，0. 5 Rita}表示名人集合 下，说明下 Alice 的成员度为 0.6，Brian

为0.9，Fred 为 0.4，Oscar 为0.1，而 Rita 为 0.5(因此这些人里面 Brian 最出名而 Oscar 最不出名)。再假定

及是语人集合，尺={10. 4 Alice，0. 8 Brian ，0. 2 Fred，0. 9 Oscar，0.7 Rira} 。

31. 模糊集合 S 的补是集合S，元素在 S 中的成员度等于 1 减去该元素在 S 中的成员度。求 下(不出名者的模
糊集合) 和 S(不富裕者的模糊集合) 。

32, 模糊集合S和了的交集是模糊集合S门T，其中每个元素的成员度是该元素在S和T中的成员度的最小
值。求既出名又富裕者的模糊集合 门尺。

2.3 函数

2.3.1 引言

在许多情况下我们都会为一个集合的每个元素指派另一个集合(可以就是第一个集合)的一个
特定元素。例如，假定对离散数学课的每个学生从{14，B，C，D，F}中选一个字母作为他的得
分。再假定 Adams 的得分是 A，Chou 的得分是 C，Goodfriend 的得分是 B，Rodriguez 的得分是
A，而 Stevens 的得分是 下。这一打分如图 2-8 所示。

这种打分就是一个郴数。离散数学中本数的概念分外重要。在定义像序列和字符串这样的离
散结构时用到函数。函数还用于表示解决一定规模的问题需要的计算机机时。许多计算机程序和
子程序被设计用来计算郴数值 。借助自身定义的函数称为递归函数。

人 邻A和中为非空集合。从A到下的函数也是对元素的一种指派，对 A 的每个元素恰
好指派 召的一个元素。如果 了指派给A 中元素a 的唯一的也 中元素是上，就写成 F(a) =-5。如果 厂
是从A到召的函数，就写成 : 4一旦。

注意 函数有时也被称作上映射或者变换。

-和ee 有许多描述函数的方式。有时明确说明指派关系(如图 2-8 所示)，但常用的方式是给
”出指派公式来定义函数，如 F(z) = rz十1。有时也用计算机程序来描述函数。
函数 /: A-~~B 也能由从A 到忆 的关系来定义。见 2. 1 节，A 到忆的关系就是集合AX忆的子
集。对于A到忆的关系，对每一个aE A 的元素都有且仅有一个有序对Ca，的，则定义了A到在
的函数了 。这个丽数通过 ja)一5来定义。在这个以 e 为第一个元素的关系中，(a，b是唯一的有

 

 

?       如果 /是从A 到忆的函数，就说A是了的定义域，而蛋是太的伴域。如果 Fa)一5，
就说0 是a 的像而a 是5 的原像。A 中元素的所有像元素的集合称为上的值域。若 是从A 到日的
函数，有时也说成了把A 映射到忆。

图2-9表示A到日的函数。

 

 

 

Adams                           4
Chou                          有
Goodfriend                          ecC
Rodriguez @                  @ D
Stevens 。 @                          e
图 2-8 离散数学课成绩                          图2-9 画数了把A 映射到召

当定义一个函数的时候，我们需要指定它的定义域、伴域、元素定义域到伴域的映射。当有
相同的定义域、伴域，相同的映射关系时，我们说这两个函数是相等的。注意，如果改变函数的



--- 第 102 页 ---
84 "第2章 基本结构: 集合、函数、数列与求和

定义域或伴域，那么我们将得到一个不辣的函数。如果改变元素的映射关系，也会得到一个不同
的陋数。

例 1一5 提供函数的例子。在每个例子中，我们都描述了定义域、伴域、值域和法则。

例1 引用本节开头的例子，给学生打分来描述什么是函数的定义域、伴域、值域。

解 令CG为函数，表示在离散数学课上一个学生的得分，例如 G(Adams) =一A。则 G 的定义域
是集合{Adams，Chou，Goodfriend，Rodriguez，Stevens}，伴域是集合{4A，B，C，D，F)。G的
值域是(4A，中，C，开}) ，因为没有学生得 卫。                                国

例2 令民为包含有序对(Abdul，22)，(Brenda，24)，(Carla，21)，(Desire，22)，(Eddie，
24)和(Felicia，22)的一个关系，每一对表示一个学生的得分及其年龄。那么，该关系尺确定的函
数是什么?

解 ”这个关系定义了函数 f，有 FAbdul) 一22，F(Brenda)王24，Carla) 一21，(Desire)一22，
大Eddie)一24，FCFelicia) 一22。在这里，定义域是{Abdul，Brenda，Carla，Desire，Eddie，Felicia} 。
为了定义函数 太，需要指定一个伴域，我们可以把正整数作为伴域以确保包含每一个学生可能的年
龄(注意，可以选择小一点的伴域，但是这会改变函数) ，最终值域是集合{21，22，24} 。     玫

…例3 令 7为函数，指派两个长度或者更大的位串的最后两位。例如，F(11010)=10。
那么，j了的定义域就是所有两个长度或者更大的位串的集合。而伴域和值域都是集合
{00，01，10，11)                                               用

例4 令7了为从Z到Z的函数，它指派给每个整数的是该整数的平方。于是 f(z)=忆，而了
的定义域是所有整数的集合，j的伴域可以从所有整数的集合中选择，太的值域是所有非负整数中
那些完全平方的集合，即{40，1，4，9，…}。                               醒

例 5 函数的定义域和伴域往往以程序语言描述。 例如 Java 语句

int floor(float real)){…》}
和 Pascal 语句
function /oor(z:real) :integer
都说的是，floor 函数的定义域是实数集合，而它的伴域是整数集合。                国
具有相同定义域的两个实数值函数可以相加和相乘。
3 邻记和六是从A到入的函数,那么 户十户和太记也是从A到有的函数，其定

 

(所十PCz)王万(z)十户(z)
(所户)(Cz)一万(Cz)廊(Cz)
注意 六十户和态户的定义是利用六和上户在zx的值计算它们在zx 的值。
例6 令几和户是从R到R的函数， 且 放(z)一也而户(z)一xz一王。 函数 几十户和上凡户是
什么?
解 从函数的和与积的定义知
(矿士记)Cz)一HGz)十户(z) 一娃十(一好) 一工
(万廊)(z)一全(7一天) 一一                      国
兰 7 是从集合人 到集合召的函数，则可以定义 4 的子集的像。
人人令 7为从集合4A 到集合日的函数，S 为4 的一个子集。S 的像是由 S 中元素的像组
成的下 的子集。我们用 AS)表示 S 的像，于是
JS)=一43sESt 一Ac))}
我们也用简写{F(s) | sE S}来表示这个集合。
注意，S 的像是具有潜在不明确性的。这里，帮(S)表示一个集合，不是集合 S 的值域。
例7 令A={a， pb，c，d，ec}而了一(1，2，3，4)， 且 Fa)一2，J(5)一1，Fc)一4，
1d)一1及Fe)一1。子集 S$=一41，c，d)的像是集合 F(CS)一11，4) 。                  国

 



--- 第 103 页 ---
第2章 基本结构: 集合、函数、数列与求和"85

2.3.2 一对一函数身上郴数

有些函数在它们的定义域的不同成员上有不同的像。这种函数称为一对一的。

ER 两数 /称为一对一的或单射的，当且仅当对于了的定义域中的所有a 各，
= (60)列含着 a一2。一对一的函数称为单射。

注意 函数了是一对一的，当且仅当只要 au天训就及(Ca)天jp)。这种表达 三为一对一函
数的方式是对定义中的蕴含倒置而来。我们可以用量词，如如WCGa)一6) -一a一D)或
等价地加We天0一Fo)天0))，来表达 三是一对一的，其中论域是函数的定义域。

我们通过一对一的琐数和不是一对一的珊数示例来说明这个概念。

-ass 例8 判断从te，25，c，d}到(1，2，3，4，5}的函数 了是否为一对一的，丰 的定义是
:    (da一4，F(0)王5，Fc)一1而/(d)=3。

Etra   解 了是一对一的，因为 了在它定义域的四个元素上取不同的值。图 2-10 说明了这

  

Ja)

Rsxarnples  _圳                                                 国

例9 判断从整数集合到整数集合的函数 F(z)一忆 是否为对 ，。              。
一的。

解 ”两数 F(z)一心不是一对一的，因为,例如 FF-D= 5。              。

1，但 1天一1。                                    C @              e@3

注意，若定义域限制为 Z  ，函数 F(z)=愤就是一对一的。

(技术上说，当限定一个函数的定义域的时候，我们得到了一个新  “
的函数，被限制的元素的值域与原来是相同的，而被限制的定义域                 e5
以外的原来定义域的元素就不被限制的函数定义了。)     加  图 2-10 ”一个一对一函数
例 10 判断函数 F(Cz)=z+1 是否为实数集合到它自身的一对
一函数。
解”郴数 F(z)=.r十1 是一对一的。要证明这一点，只需注意在 zx天y时十1夭y十1。    [|

现在我们给出保证函数为一对一的某些条件。

区汪汪 定义域和伴域都是实数集子集的函数 三称为递增的，如果对 大的定义域中的x 和>y，
只要 zx<y就及z)生FAy)(若对于z<y，恒有 FGz)一roy)，则称函数 太为严格递增的) 。类似
地，j是递减的，如果对了的定义域中的x 和y，只要 zx<y就及(z)三Fy)(若对于zx<y>，恒有
Fr)全大y)，称丽数了为严格递减的)(定义中严格一词意味着严格不等式) 。

注意”如果Vryy(r<y一(0z)s窒(y))，则函数 厂是递增的; 如果 Vryy(r<<y玫0z)二

A(y))，则函数了是严格递增的。如果 Vr yy(z< yy一(Cr) 三 JCy))，则函数 三就是递减

的 如果Wwy(T<y一rz)二yy))，则函数三就是严格递减的。 这里论域均为函数捕的

定义域。

从上述定义可知，只要函数是严格递增的或者严格递减的，它必定是一对一的。但是，如果
一个函数不是严格意义上的递增或递减，就不必然一对一了。

有些丽数的值域和伴域相等，也就是说，伴域中的每个成员都是定义域中某个元素的像。具
有这一性质的晒数称为歇上冰数。
 从4到吾的函数y矿称为映上的或满射的，当且仅当对每个6E B，有元素aEA 使得
六a)二0。如果明数 上是映上的，就说它是满射函数。

注意 如果VYy3z(F(r)一y)，函数 三就是映上的，其中工的论域是函数的定义域，y 的
论域是函数的伴域。

我们现在举几个映上函数和非映上摧数的例子。

例11 令 7为从fa，6，c，d吃到{1，2，3}的函数，其定义为 fa)=3，帮(0一2，F(c) 一1及

 

 



--- 第 104 页 ---
86 .第2章 基本结构: 集合、函数、数列与求和

Gd)一3。了是映上郑数吗?
ie。 解 由于伴域中所有 3 个元素均为定义域中元素的像，了是映上的。图 2-11 说明了这

 

一上点。注意， 若伴域是(1，2，3，4}》，太就不是映上的。            图
例 12 从整数集到整数集的函数 f(z)一袜 是映上的吗?               L
解 不是映上的，因此，比如说没有>使产一一1。         国  8         辣
例13 从整数集到整数集的函数 F(z)一z十1 是映上的吗?
解 ”这个函数是映上的，因为对每个整数 >，都有一个整数 >使Frz) ce      日2
二?。为看出这一点，只要注意 fF(z)王?的充分必要条件是z十1一yy，而  1         3
这只要令 zx一y一1 就成立。                               国

 若函数 既是一对一的，又是映上的，就说它是一一对应或“图2-11 一个映上函数
双射的。

下面的例 14 和例 15 阐述双射的概念。

例14 令 三为从ta，5，c，d到{1，2，3，4}的函数，其定义为 F(a)一4，F(b)一2，F(c)=1
及jd)=3。厂是双射吗?

解 ”函数了是一对一的和映上的。它是一对一的，是因为函数值都不同，它是映上的，是因
为伴域中的所有 4 个元素，均为定义域的元素的像。于是 了是双射。                  国

图2-12给出了4个天数: 其中第 1 个是一对一的，但不是映上的; 第 2 个是映上的，但不是
一对一的; 第 3 个，既是一对一的，又是映上的; 第 4个既不是一对一的，也不是映上的。
图 2-12 中的第 5 个对应关系不是函数，因为它把一个元素传递给两个不同的元素。

直] 0二         4二       二| 0和@
口生                       二|
看了 <  屹检        硬2 力国
和3 “一一   C @        昌3 〔(富
C生                       @@3                             C@@
二4 二四          二甸        委4 可@        全4           生生
a)一对一，非映上   b)映上 ，非一对一      c)一对一，映上   d)既非一对一，也非映上   e)不是范数
 2-12 不同类型的对应关系的例子
假定 了是从集合A 到它自己的函数。如果 4 是有限的，那么 了是一对一的当且仅当它是映上
的。当 A 为无限集时，这一结论不一定成立(参看 2.4节) 。
例15 令 4为集合。4 上的恒等函数是函数 : 4一A，其中
LA《工) 一 工

对所有 zEA。换言之，恒等函数必 是这样的函数，它赋给每个元素的是这个元素自身。函数必 是
一对一的和映上的，所以是双射。                                        力

2.3.3 反函数和函数组合
现在考虑从集合 4 到集合日的一一对应 /。由于 /是映上的函数，B 的每个元素都是A 中某
元素的像。又由于 了还是一对一的函数，B 的每个元素都是A 中唯一的一个元素的像。于是我们
可以定义一个从 召到A 的新函数，把 了给出的对应关系丰倒过来。
和 令 7了为从集合4 到集合妃的一一对应，厂的反函数是这样的函数，它指派给 日中元
素 的是4 中使得 F(a)一吕唯一元素a。太的反函数用 三:表示，于是在 Ca)一5时三(Co)一a。
注意 切勿将函数 广:与 1/厂混淆，后者表示定义域中每个元素工对应函数值为 1/F(z)
的一个通数，而且仅当 jz)为非0实数时有意义，二者是不同的。

图 2-13 给出了反函数概念的说明。

人|           全上
口二

@2           本了
记曙

量了           国3

NAW

 



--- 第 105 页 ---
第2章 基本结构; 集合、函数、数列与求和"87

图2-13 函数 广:是函数了的反函数

如果函数 广不是一一对应，就无法定义反函数。若 不是一一对应，那么它或者不是一对一
的，或者不是映上的;如果 不是一对一的，则伴域中的某元素避是定义域中多个元素的像。如
果 三不是映上的，那么伴域中某个元素不是定义域中任何元素的像，即定义域中不存在元素a 使
Fo)一5。总之，如果 三不是一一对应，就不能为伴域中每个元素都指派定义域中唯一的元素a，
使 F(a)一以因为对某个或者有多个这样的a，或者没有这样的 a) 。

一一对应关系称为可逆的，因为作为函数可以定义它的反本数。如果数不是一一对应关系，
就说它是不可北的，因为这样的函数没有反琐数。

例16 令了为从(a，b8，c}到{1，2，3)}的函数，使 Fa)=2，Fb)一3 及 Fc)王1。厂可逆吗?
如果可道，其反函数是什么?

解 了是可首的，因为它是一个一对一的对应关系。其反函数 广:颠倒了给出的对应关系，所
以 广:(1)一c<，广!(2)一cz而(3)一5。                        图

例17 令 FF Z-~Z，使得 FCz)一z十1。卫可道吗? 如果可道，其反函数是什么?

解 了可逆，因为前面已证明它是一一对应关系。要其倒对应关系，设 >是的像，即 >一
十1。从而 z=y一1。即 ?一1是Z的唯一元素，在 了之下与 对应，于是 广'(y)=y一1。  国

例18 令j是从及到及的范数，使 F(z)一。卫可逆吗?

解 ”由于 /一2)一FA(2)一4，了不是一对一的，要想定义反末数，就得为4指派两个元素。因
此 卫是不可逆的。                                 国

有时，可以限制函数的定义域或者伴域，或者两者都设限，得到一个可逆的函数，正如例 19。

例 19 如果我们限制例 18 中的函数 Az)=妆 的定义域是非负数，那么 了就是可逆的。

解”因为被限制在非负数范围内，所以 了是一对一的。比如说，如果 F(z)=A(y)， 那么
昱。所以 玫一天一(z十y)(z一)一0。也就是说，z十y一0或者 zx一?一0，则 xz一 或者z二一y。
因为x和> 都是非负的，那就只可能 zx一y。因此，这个函数是一对一的。同时，当伴域是非负数
时，对于 Az)一字 是映上的。因为每一个非负数只有一个正平方根。当 > 是非负数时，刚好 zx一
Vy，也就是她一>y。因此，函数 疙zz)一空 在非负数上是一对一和上映上的，它的反函数为 广:(y)一
国

ER加 令s 为从集合A 到集合如 的郴数，乒是从集合哩到集合C 的函数，函数 上和8& 的组

合用 7og 表示，定义为

 

(rog)(a) =一 FCg(Ca))
换名话说，函数 Fog 指派给A 的元素a 的就是了指派给g(a)的。注意，如果 8 的值域不是太的定
义域的子集，就无法定义 Fog, 图2-14 解释了函数组合的概念 。

例20 令8为从fa，6，c}到它自己的函数，使 sg(a)一5，8g(b一c，而g&(c)一a。令 了为从{a，
8，c)}到{1，2，3)}的函数，使 Ka)一3，帮0)一2，而 Ac)一1。上和8& 的组合是什么? g 和的组
合是什么?

解”Fg的定义是(Fog)(o)=Fg(o))=王bo)一2，(Fog)(归一Cg(b)一ec)一1，而(万四(co一
TOg(Cc))一Fa)一3。



--- 第 106 页 ---
88。第2章 基本结构: 集合、函数、数列与求和

(上8HG)

8(a))

 

了9 8
图2-14 函数了和8 的组合

注意 gs了是没有定义的，因为 了的值域不是g 的定义域的一部分。                       国
例21 令和8g& 为从整数集到整数集的数，其定义为 F(z)=2z十3 和SCz)一3z十2。厂和8
的组合是什么? gg 和上的组合是什么?
解 Fg和8&g=均有定义，即
(Fag)(z) = (Cg(z)) = Fr(3z十2) 一2(3z十2)十3一6z十7

(8=门(z) 一gzr))一82zr十3) 一3(2z十3)十2一6z十11             力

注意 尽管例 21 中对函数三和中而言Fog和8go丰均有定义，Fog和8&ce三并不相等。换
言之，对函数组合而言交换律不成立。

在构造函数和它的反顶数的组合时，不论以什么次序组合，得到的都是恒等画数。要看清这
一点，假定 了是从集合A 到集合日的一一对应关系，那么存在反顶数 广:，而且 广:是从局到A
的一一对应关系。反枯数把原函数的对应关系颠倒过来，所以当 ja)一6时大:(o)一ae，当
三(5)一aa时，F(a)一5。因此，

(六>站Ca)一广(FGa)) 一广(5) 一a
及

(Fa广D)(b) = F广(0)) 一Fa) 一忆
从而太一wa，而juo广=c，其中心和ec分别是集合4A 和吕上的恒等丽数。这就是说
(广1)一一

2.3.4 函数的图像
从4到翌的每个函数都对应着AX电中的一个有序偶集合，这个序偶集合称为该函数的图像，
并且往往用图来表示以帮助理解函数的行为。
国 令 /为从集合A 到集合日的函数，函数了的图像是序偶集合{((a，6) | <E A

 

且J广(a)一六 。

根据定义，从 A到如的函数的图像是4AX召的子集， 这个子集包含的序偶中第二项等于 中中
由了指派给第一项的那个元素。

例22 图示从整数集到整数集的函数 /一2*十1 的图像 。

解 了的图像是形为(*，2z十1)的序偶的集合，其中 ”为整数。图 2-15 是其图像显示。   四

例23 图示整数集到整数集的函数 六xz)一安。

解 了的图像是形为(z，F(z))=(z，2)的序偶的集合，其中 zx 为整数。图2-16 是其图像
显示 。                                                        时



--- 第 107 页 ---
第2章 基本结构: 集合、函数、数列与求和"89

  

图2-15 从Z到工的函数 Fi)一2z十1 的图像     图2-16 从Z到Z的Frz)一关 的图像

2.3.5 几个重要的函数

下面介绍离散数学中两个重要的函数，即下取整函数和上取整函数。令 z 为实数。下取整函
数把工下伟人到小于或等于z 又最接近xz 的整数，而上取整函数则把 x 上含人到大于或等于又
最接近 z 的整数。在统计对象个数时常使用这两个函数。在分析解一定规模的问题的计算机过程
使用的步数时，这两个函数起着重要的作用。

ER殉 下取整孟娄指派给实数 r 的是小于或等于的最大整数。下取整函数在工的值用Lzj
表示。上取整函数指派给实数 z 的是大于或等于z的最小整数。上取整函数在 x 的值用[| zx 1]表示。

注意”下取整函数也常称为最大整数函数，这时往往用[zj]表示。

例24 下面是下取整函数和上取整本数的若干值:
LV/2=0，    [1/2|1=1，    [一1/2|=一1，    [一17/2]=0，
13. 1|=3，   「3. 1一4，   17上二7，       「7 一7              国
四 图 2-17 显示的是下取整函数和上取整本数的图像。在图 2-17a 中，显示下取整本数
“”，  ， Lz 这个函数在[z，z*十1)区间取同样的值 wx，然后，当 z=z十1 时，取值跳到 ”十1。
在图 2-17b 中，显示上取整函数| rz ]。这个函数在(”，z*十1]区间取同样的值 z十1，然后，当 z 取
略大于"十1 时，取值跳到 ”十2。

 

  

a) = lx                         b) y = [
图 2-17 a)下取整函数图像，b)上取整函数图像

下取整郴数和上取整函数有广泛的应用，包括用于数据存储和数据传输。考虑例 25 和例 26，
这是研究数据库和数据通信问题时要完成的典型的基本计算 。



--- 第 108 页 ---
%0 "第2章 基本结构: 集合、画数、数列与求和

例25 存在计算机磁盘上的数据或数据网络上传输的数据通常表示为字节串。每个字节由 8
个字位组成，要表示 100 字位的数据需要多少字节?

解”要决定需要的字节数，就要找出最小的整数，它至少要与 100 除以 8 的商一样大，8 是每
个字节的字位数。于是，需要的字节数是100/8]=门2: 5]一13。               国

例26 异步传输模式(ATM)(用于骨干网络上的通信协议)下，数据按 53 个字节分组，每组
称为一个信元。以速率每秒 500 千字位传输数据的连接上一分钟能传输多少个 ATM 信元?

解 ”一分钟内这一连接能传输 500 000X60= 30 000 000 字位。每个 ATM 信元长度是 53 字
节，也就是53X8=424 字位。要计算一分钟能传输多少信元，需计算不超过30 000 000除以 424
的最大整数。于是在每秒 500 千字位的连接上一分钟能传输的 ATM 信和元数是

|30 000 000/424|=70 754                                  国

以z代表实数的表 2-3 给出了下取整函
数和上取整函数的若干简单但重要的性质。 .表2-3 上取整函数和下取整函数的有用性质(" 为整数)
由于这两个函数在离散数学中出现得十分频          (la) [zj 当且仅当nsz<n十1
繁，看一看表中的恒等式是有益的。表中的        CIbifz = 当且仅当n 一1<r<m
条人可以用下了还娄和上了台数
的定义来建立。人性质(la)，(1lb)，(1lc) 和        -

(1d)可以直接由定义得出。例如，(1a)说的       (人27 1I<LzJSzSTKz+l
是[xz扩盖当且仅当*” 小于或等于而”十1         (3a) |一zx一[z]

大于 zx。这恰恰就是”为不超过xz 的最大整         (3b)[z王一Lz>j

数的含义，也就是| zj=m 的定义。 性质       (4a) Lz+aj=LzjHan

(lb)、(lc)和(1d)可以类似地建立起来。我        (DTz+i-Tzitn

们使用直接证明法来证明(4a)是成立的。

证 假定Lzj=关，其中六为整数。由(la)知，mm委xz<<m十1。在这一不等式中加上 ”得
王十PS十?sm十2十1。再次利用(la) ，可知 |z十zj=m十2一|z2，这正是我们要证明的。其
他性质的证明推迟到练习中去做。                                       口

除了表 2-3 列出的性质，上取整函数和下取整函数还有许多其他有用的性质。也有许多关于
这些函数的语句看似正确，实则不然。我们将在例 27 和例 28 中考虑与上取整函数和下取整函数有
关的语句。

在考虑下取整函数相关的语句时，一个有用的方法是令 zx=m+e，其中 xn= |是一个整数，e
是z的分数部分，满足不等式 0委e王1。类似地，考虑上取整函数时，通常写 zx=m一es，其中
mn一| z 上且0过es一1 。

例27 证明: 若z是一个实数,则| 2z |= |z二 让

 

SR。 解 要证明这个语句，令 zx一n+e，其中中是正整数且 0<e<1。 依据e 是否小于寺，
有两种情况要考虑。(选择这两种情况的原因见下面的证明。)
首先考虑 0<e<<六的情况。此时，2z一2n十2e 且|2z| 2n，因为0<<2e<1。 类似地，z+寺一

n+十(却+e)， 使得|z+去| 因为 0<<六十e<1。 因此
L2z |一22且|z| 二， 十?二27

接下来，考虑斑<<e<1 的情况.此时，2z一2n十38一(2n十1)十(2一1)。由于0<2e一1一1，



--- 第 109 页 ---
第2章 基本结构: 集合、函数、数列与求和"21

可得 2z|王2n十1。因为 |二二 |一(公+9上- [re 纪)旧 o<e一于<1，  可得 |

nm十1。因此,| 2x 上|=2z十1 且 Lz|+ |定二上o+o+D=2nt1l 证毕。                      国
例 28 对全体实数 zx和>，证明或否定[zy]=[「zl+Ty |。
解 ”尽管这个语句看似合理，但它其实是假的。一个反例就是令 z=也且 ?=亏， 此时

Fz+ >二+二 11=-1，但rz]+f "|H计 1+1=2。                                        国

有几类函数是本课本一直要用到的，其中包括多项式、对数和指数函数。本书中用记号 logr
表示z 以2为基的对数，因为 2 是我们将经常使用的对数基数。我们用 logs zx 表示以2 为基的对
数，其忠是大于 1 的任意实数。用 lnz 表示自然对数。

另一个我们将在本书中使用的函数是阶乘函数 f: N一Z” ，表示为 X四一m4。帮Ga一al 的值
是前几个正整数的积，因此 Fm一1。2…(n一1)。nLFO)=一0!1 一1]。

例29 我们有(1)=1! =1，F(2)一2! 王1。2一2，丰(6)=6!1 =1.2.3.4.5.。6一720，
20)=-1. 2.3.4.5.6.7.8.9.10.11.12.13。14。15 .16.17 .18。19。20一
2 432 902 008 176 640 000。                                                                    男

例 29 表明阶乘函数随着的增加面迅速递增。通过斯特林公式，阶乘函数的递增更加清楚，
由高等数学可知，z! 一 VZrmz(n/e)"。我们用 Fa一g(a)这样的表示法，意思是随着 ”的无限递
增，帮zz)Vg(2)趋近于 1(即lim /aeg(C2) 一1)。符号一读作"近似于"”。斯特林公式以 18 世纪的苏

格兰数学家钴姆斯， 斯特林命名。

练习
1. 为什么下列几问中的了不是从有到入的函数?

a) F(z)一17Vz               b) F(z)一VT               c) Fr(z)一士 VCz十1)
2. 判断 了是否为从所有位串的集合到整数集合的函数 :

a)帮(S)是 S 中某个0字位的位置。

b)F(S)是 S中1字位的个数。
c) CS)是最小整数:使S 中的第; 字位为1，当 SS是不含字位的空串时 JS) =一0。
- 求下列郴数的定义域和值域。(注意:为求得函数定义域，只需确定被该函数指派了值的元素集合。)
a)函数在每个位串的值是串中 1 字位个数与 0 字位个数之差。
b)函数在每个位串的值是串中 0 字位个数的 2 倍。
c)函数在每个位串的值是把串分成字节(8 个字位为一字节)时不够一个字节的字位数。
d)函数在每个正整数的值是不超过此整数的最大完全平方。
4. 求下列函数的定义域和值域。
a)范数在每对正整数的值是这两个整数中的最大的整数。
b) 机数在每个正整数的值是0，1，2，3，4，5，6，7，8，9 中未在整数数位中出现的数。
c)函数在一个位串的值是串中块 11 出现的次数。
d)函数在一个位串的值是串中第一个 1 的数值位置，若位串为全0，就赋值 0。

《7

5. 求下列各值:

a)「3741        b)| 7/8       c)[一3/41       d)[一7/8]

e)「 3               D| 一1 ]             g)| 172十[372]]        hb)| 1/2。|5/2|j
6. 判断在下列情况下函数 /， ZXZ-~Z是否是映上的?

a) jz，7m)一mm十7                     b) F(m，z) 一ma 十me

c) Fa，7m) 一m                          d) jz，nm)一171|

e) 三，7) 一了一天



--- 第 110 页 ---
92 ，

9.

10.
11.

12.

关]4.。
. 求证: 从及到R的函数 六z)一az十5是可道的，其中 和必 为常数且a天0。找出和了的反函数。

第2章 基本结构: 集合、函数、数列与求和

. 给出从整数集合到正整数集合的函数的明确公式，使得:

a)一对一但非映上 。                          b)了上映上但非一对一。
c)既上映上又一对一。                          d)既不映上又不一对一。
. 判断下列各函数是和否是从及到民的双射。
a)F(z)一2z十1                      b) F(z)一必十1
c) FPCz)一妇                 d) jz)一(zz十1)/(zz十2)

令 F, R-~R且 F(z)>0。证明: F(z)严格递减当且仅当函数 gE(z)=1/7F(z)严格递增。

试给出一个定义域与伴域均为实数集的递减而非一对一的函数实例。

证明:， 从实数集到非负实数集的函数 f(z)= | zx |不是可逆的，而若将其定义域限制到非负实数集，则
所得函数为可道的。

令 F(z)一[|空/3。 求F(CS)，如果

a)S一{一2，一1 0，1，2，3}            b)S={0，1，2，3，4，5}

c)S一{1，5，7，11}                 d)S一{2，6，10，14}

' 假定&是从A到忆的画数，三是从如到C 的函数。

a)证明: 如果了和8 均为一对一函数，那么 f=g 也是一对一函数。
b)证明: 如果乒和8 均为到上映上函数，那么 fcg 也是映上冰数。
如果卫入cg都是映上的，能和否得出结论 也是映上的? 说明理由。

令 了为从集合4 到集合忆的函数，S 为下 的子集。S 的弟像定义为A 的子集，该子集包含 S 的所有元素

的原像。我们用 广:(S)表示 S 的北像，于是 广:(S)一faEA | Ga)ES)。(警告; 符号 广:有两种不同的使
用方式。不要将这里引入的符号与可道函数 上在 处的逆 大(7)混清。还要注意 广:(S)表示集合 S 的道像，
对所有函数 /都有意义，而不仅仅是可逆函数 太。)

16.

17.
18.

19.
20.

21.
22.

23.
24，

25.

26.
27.
28，

29.

令g(z)一[zj。求

a)g 1I({O0))           bg一1，0，1))    cg (zi 0<z<1})

令丰为从A到日的函数，5S 为日的子集。求证 广:(S)一广!(S) 。

证明: [z一1/3是最接近 z 的整数，除非 =恰为两个(相邻)整数的中间数，此时，它为这两个整数中较小
的一个。

证明: 对实数 z，xz一1二|z 长zx过[zx二rz十1。

若 z为实数，* 为整数，求证

a)z< 当目仅当|z上|二nr。                         b)n<一z 当且仅当”<「 zx]。

证明: 车”为整数，则当 ”为偶数时[naV2|一na/2，n 为奇数时 | ny72|=(n一1)72。

有些计算器上有个 INT 函数，当 z 为非负实数时 INTCz)一Lzj，当为负实数时 INT(z)=[「z]。求证这
一函数 INT 满足等式 INT(一z)一一INT(z) 。

令a和的实数，且 a一5，用下取整函数及/或上取整函数表示使 e<<n<b 的整数的数目。

含个字位的数据需要用几个字节编码? 其中”为

a)7                  b)17                  c)1001                d)28800

数据在某以太网上以 1500 个 8 位字节为信息块传输。下面的数据基在这个以太网上各需要多少个信息块
传输(注意字节就是 8 位字节)?

a)150 千字节的数据。                        b)384 千字节约数据。

c)1.544 兆字节的数据。                      d)45. 3 兆字节的数据。

画出从R到的函数 FGz)王| 2z |的图像。

画出从R到R的郴数 FCz)一[Lz|+[Lz/2的图像。

画出下列各函数的图像 ;
a) Fr)一|z十172|                  b) FCz)一|2z十吉                  c) F(z)一[rz/ 3]
d) FCz)一[1yz]                    e) FCz)一[z一2十Lz十2          BFCz)=一[2zjF/习

g) jz)一[Lz一1/2|+172 |]
求 fz)一十1 的反函数。



--- 第 111 页 ---
第2章 基本结构: 集合、函数、数列与求和。93

30. 令 S 为全集 过的子集。S 的特征函数 js 是从 LU 到集合{0，1}的画数，使得若工属于S则 Fs(z)王1，若
z不属于S, 则 产(z)=一0。令A，B 为集合。求证
a) Fnn(z)一(CCz)。，F(Cz)        b) FAua(z)一六(zz)十 Far)一广(z)。FeCzr)
c)床(z)一1一户(z)            d) FasskCz)一六(人(z)十Fa(z)一2AACz)Feo(z)
31. 证明或否定下列关于上了到整上数和下取整本数的语句。
a)对任意实数 x, [|zj|= Lz|。
b)只要 zx 是实数, | 2zj=21zj。
c)只要x和>y 是实数,「zl+[yl-「z十yl]=0或1。
d)对任意实数 x 和yy， 「 zy ]=「[zl[y]。

e)对任意实数 >， [直- 时
32. 证明: 车工是正实数，则

aLwWLzj上= Lvzj                  bfVFzTl=Mz]

用来计算函数值的程序也许不能给出该函数在其所有元素上的正确值。例如程序可能因无限循环或内存
溢出而不能给出某个正确值。类似地，在抽象数学中，我们常常要讨论仅在实数子集上定义的函数，如 1/z，
vx和arcsin(z)。另外， 我们可能还会用到“最小孩子"函数(此函数对没有孩子的夫妇没有定义)和*日出时
间?数(此函数对北极圈没有定义) 。

为研究这种情况 ，我们用到部分函数的概念。从集合 A 到集合日的部分函数 太是为A 的一个子集的每
个元素4 指定日中唯一值上 的指派。A 的这个子集称为 扩的定义区域。集合A 和有 分别称为三的定义域和件
域。我们说 了在 4 中不属于定义区域的元素上未定义。我们用 上: 4 一硬表示厂是从4 到已的部分函数(这
个符号与表示函数的符号一样。符号的上下文将决定 太究竟是部分函数还是全函数) 。当 三的定义区域等于
A时，就说 是全函教。

33. 对下列各个部分函数求它的定义域、伴域、定义区域及其未定义的值的集合。另外判断它是否为全函数。

a) 了Z一R，FOmD一1/n               b)F: 也-一己，太Cn)一[my21

c) 护卫X了一Q，Fmr，7z)一ma] 7           d)太也X也一也， 大7) 一?7

e)厂: 也XZ一了，太mm，m)一六一2，如果 m二天

534，a)证明: 若 S 为基数为zm 的集合,mm 为正整数，则在集合 S 与集合{1，2，…，m}之间存在一个一一
对应。

b)证明: 若 S，工均为基数为 的集合，m 为正整数，则在集合 S 与集合T 之间存在一个一一对应。

x35. 证明函数 f: Z- XZ-一Z- 是一对一且是映上的，其中 Fom， 好) 一(7十了一2)(mm十一1)72十mr

2.4 序列与求和
2.4.1 引言

序列是一系列有序的元素。在离散数学中用许多方式使用序列。第 4 章将介绍用序列表示某
些计数问题的解。在计算机科学中序列也是重要的数据结构。本节包括用来表示序列及序列项之
和的记号的阐述。

当可以列举无穷集合的元素时，这个集合称为可数的。本节末尾讨论可数和不可数集合,证
明有理数集合是可数的而实数集合是不可数的。

2.4.2 序列

序列是用来表示有序表的离散结构。例如1，2，3，5，8 是一个含有五项的序列，而1，3，
9，27，81，…，30,，…是一个无穷序列。
序列是从整数集合的子集(通常是10，1，2，…}或{1，2，3，…))到集合 S 的函数。
用记号 ao, 表示整数” 的像。称 a, 为序列的一个项。

用记号{a,}描述序列。(注意 a. 表示序列{a,}的个别项。 还要注意序列记号{a。}与集合记号有
冲突，但使用这个记号的上下文总是分得清楚何时在处理序列而何时在处理集合。还要注意字母 v

 



--- 第 112 页 ---
94。第2章 基本结构: 集合、函数、数列与求和

的选择是任意的。)
描述序列是通过按照下标升序来列举序列项。
例1 考虑序列{a.}，其中
au 一]1/m
从 wa 开始的这个序列项的表，即
QiyGCz QQ
开头是:
1 ,二
,王，
几何序列是如下形式的序列

Qyar ,ar 9

1 1
7 4                               [

 

其中初项 ac 和公比>都是实数。
注意 ”几何序列是指数函数 jz)=一ar 的离散对应物。

例2 满足久=(一1D)"、c王2。5" 和du。=6。(1/3)" 的序列{&)》、{c,) 和{1d,)都是几何序列，
初项和公比分别等于1 和一1，2 和5以及6和1/3。表名,，己，玉，久，避，…的开头是:
1.一1,1,一1,1,…
表 cc ，cl，c  ，cl ，cy ，…的开头是:
2,10,50,250,1250,…-
表心,d，d:，吃，d，…的开头是:
6,2,2/3,2/9,2727 ,…                        四
等差序列是如下形式的序列
aa十da十2d pa十md

 

其中初项 c 和公差d 都是实数。
注意 等差序列是线性函教 F(z)一dz十a的离散对应物。

例3 满足%一一1十42 和如一7一3 的序列{s}和{坊}都是等差序列，初项和公差分别等于
一1 和4以及7和一3。从 "一0 这项开始的表 3S09 3 3 3533 …的开头是:
一1,3,7,11,…
表，b ta如，…的开头是:
7,4,1,一2,…                          国
在计算机科学中经常使用形如 al ，a ，…，a 的序列。这些有穷序列也称为串。这个串也记
作 aa …a,。(回忆一下，位串是比特位的有限序列，在 1. 1 节介绍)。串 S 的长度是这个串中的项
数。空串是没有任何项的串，记作。空串长度为 0。
例4 串 abcd 是长新为4的串。                         国

2.4.3 特殊的整数序列

离散数学中的常见问题是找出构造序列项的公式或一般规则。有时候只知道解决问题的序列
的一部分项，目标是确定序列。尽管序列的初始项不能确定整个序列(毕竟存在无穷多个从任何有
穷初始项集合开始的序列)，但知道前几项仍有助于形成关于序列本身的合理猜想。一旦形成猜
想，就可以尝试验证找到了正确序列。

当试图从初始项推导序列项的可能公式或规则时，尝试一下找出这些项中的模式，再观察一
下能否确定如何从前项产生后项。有许多问题可问，但某些较有用的问题是:

*。 是否有相同值连续出现?

* 是否给前项加上常量或与序列中位置有关的量就得出后项?

。 是否给前项乘以特定量就得出后项?



--- 第 113 页 ---
第2章 基本结构: 集合、函数、数列与求和“95

。 是否按照某种方式组合前项就得出后项?

。 是否在各项之间存在循环?

例5 求具有下列前 5 项的序列公式:

(a)1，1/2，1/4，1/8，1/16 (bl)1，3，5，7，9 (ec1，一1，1，一1，!1

ER. 解 〈a)可以看出分母都是 2 的寡。满足 w,=1/2"的序列是候选解序列。这个候选序列
是几何序列，满足 e王1 和 r一1/2。

(b)注意每一项都是对前一项加 2 而得到的。满足 a.一2z十1 的序列是候选解序列。这个候选
序列是等差序列，满足 c=1 和 d一2。

(c)各项轮流取值 1 和一1。满足 ao,= (一1)"的序列是候选解序列。这个候选序列是几何序列，
满足a&王1和 r一一1。                                                 本

例 6 和例7 说明如何通过分析序列来发现构造项。

例6 如果前 10 项是1，2，2，3，3，3，4，4，4，4，则如何产生序列项?

解 ”注意整数1出现1次,整数2出现2次,整数3出现3次,整数4出现4次。产生这个序
列的合理规则是整数半恰好出现关次，所以序列的下 5 项可能都是5，随后 6 项可能都是6，等等。
这种方式产生的序列是候选解序列。                                       国

例7 ”如果前 10 项是5，11，17，23，29，35，41，47，53，59，则如何产生序列项?

解 ”注意这个序列第一项之后的前 10 项每项都是给前项加6 得到的(从相邻项之差为 6 就看出
这一点)。因此从 5 开始总共加(z一1)次 6 就产生第 项，合理猜测第 ”项为5十6(z*一1) 一6n一1
(这是个等差序列，满足 ae一5 和 d=6。)                                    口

另一种求序列项生成规则的有用技术是对比所求的序列项与熟知的整数序列项，比如等差序
列项、几何序列项、完全平方、完全立方，等等。表 2-4 显示若干应当记住的序列的前 10 项。

表2-4 若干有用序列

  

前 10 项
，4，9，16，25，36，、49，64，81，100，…
8，27，64，125，216，343，512，729，、1000，,…
，16，81，256，625，1296，2401，4096，6561，10 000，…
2，4，8，16，32，64，128，256，512，1024 ，…:
3，9，27，81，243，729，2187，6561，19 683，59 049，…-
，2，6，24，120，720，5040，40 320，362 880，3 628 800，….

 
  

 

 
 
    
  
 

王 一 一

  

例8 如果序列{a,}的前 10 项为1，7，25，79，241，727，2185，6559，19 681，59 047，试
猜想 ao, 的简单公式。

解 ”要解决这个问题，先查看相邻项的差，但没有看出模式。当计算相邻项的比来查看每项
是否为前项的倍数时，发现这个比虽然不是常数却接近于 3。所以有理由怀疑与 3 有关的公式产
生了这个序列的各项。比较这些项与序列{3"}的对应项，注意到第 ”项要比对应的 3 的圭少2。看
到对于 1委”委10 来说 o.=3"一2，因而猜想对所有 ”来说，这个公式成立。              国

贯穿本书，可以看到整数序列广泛出现在离散数学中。已经遇到或即将遇到的序列包括，素
数序列、排序 ”个离散对象的方式数(第 3 章) 、解决著名的 个盘子汉诺塔智力题需要的步数(第
4章)以及在个月后岛上的兔子数(第 4章)等。

局卫5 整数序列还出现在离散数学以外的十分广泛的专题领域中，包括生物学、工程、化学、
”物理学以及智力题等。数学家内尔。斯朗(Neil Sloane)在 20 世纪 60 年代构造了超过
100 000 个五花八门妙趣横生的整数序列，这些序列可以在 1995 年出版的《整数序列百科全书》
(COmline Enmcyclopedia of JImteger Seguences)([SIPl95])中找到。 经过扩充的序列表出现在网络上，
定期地加入新序列。还有通过网络访问的程序， 用来从百科全书中查找给定初始项的解序列 。



--- 第 114 页 ---
96“。第2章 基本结构: 集合、函数、数列与求和

2.4.4 求和
下一步介绍求和记号。首先描述用来表达序列{a,} 中
CosyQoH ye yan

这些项之和的记号。用记号

>  ai  或  Za，
表示
au 十Qi十…十au
此处变量7 称为求和下标，字母 了 是任意选择作为变量的; 换名话说，可以使用任何其他字母，比
如ii或必。或者用记号写成
六ww=盖=。
此处求和下标依次等于从下限几开始到上限n 为止的所有整数。用大写希腊字母屋表示求和。通
常的算术定律也适用于求和。例如，当 a 和刀均为实数时，有
2 (ar十区)一2十2 yy
这里，z ，zz，…， Zn 及yi， 2 和 均为实数(此处我们不给出该恒等式的正式证明) 。
下面给出求和记号的若于例子。
,于约。 例9 表示序列fa.}前 100 项之和，对 mn一1，2，3，…，a,一1/n。
解”求和下标下限为1，上限为 100。把这个和写成
工                                  国
7
例 10 》' 产的值是什么?
解 我们有
 天一开十中十时十至十吾

一1十4十9十16十25
一55                      加

例11 > '(一1) 的值是什么?
二一站
解 我们有
2 (一1一(一1十(一1十(一1和十(一1D)7十(一1

一1十(一1)十1十(一1)十1
一1                                                国
有时候平移一下和中的求和下标会有用处。通常这样做是当两个和需要相加而求和下标却不
一致时。当平移求和下标时，重要的是适当地修改对应求和项。下面的例子解释这一点。
例12 假定有和

但是希望求和下标在 0 和4之间(而不是在1 和5 之间)依次取值。为此令 &一j一1。于是新的求和
下标从 0 到4 依次取值，项六 变成(十1)7 。因此

关=- 六CD:
才一中

je

容易验证两个和都是 1十4十9十16十25一55 。                                      图



--- 第 115 页 ---
第2章 基本结构: 集合、函数、数列与求和。97

几何序列各项之和经常出现(这种和称为几何级数) 。定理 1 给出几何序列各项之和的公式。
 若a 和-都是实数且天0，则

mAl1
。   1 若r关1
> ，ar' 一  广一1

(mn十1l)a 车rr一1

证 设
S 一 六 ar
要计算 S，先给等式两边同乘 ~>，然后如下变换得出的和:
rg9 一 ry， Cr                   用求和公式代替 S
= or        分配律
=- 六ur:            转换求和下标, 令&= j)十1
= (和or )+(or 一wm 去除上一nm十1项, 添加= 0项
一S十(ar和一a)             用 S 代替求和公式
从这些等式看出

rS 一S十(ar一a)
解出 S$ 就证明了若 ~"天1，则

十1

 

SS二2 一Q
广一1
若 r一1，则显然这个和等于(十1)a。                                    口
例13 很多情况下要求双重求和(比如在计算机程序中蔡套循环的分析中)。双重求和的例子是
呈习，

要计算双重求和，先展开内层求和，再继续计算外层求和:
六六-Ci+2i+3D一6
一6十12十18十24一60                   醒

还用求和记号把丽数的所有值相加，或把指标集的各项加起来，其中求和下标依次等于集合
中的所有值。换名话说，用
> (5)

表示对 S$ 中所有元素s* 的值 F(s)求和。
例14 >，s的值是什么?

5E 02.4)

解 ”由于 3 * 表示对集合{0,2,4} 中所有元素* 的值求和,所以
>)， 一0十2十4一6                       玫

5E 102.41

某些求和在离散数学中反复出现。掌握这种求和的一组公式会有用处，所以表 2-5 为常见求
和提供袖珍公式表。

定理 1] 推导了表中的第一个公式。接下来三个公式给出了前”个正整数的求和、平方求和以及
立方求和。可用许多不同方式推导这三个公式(例如，参见本节末练习 11) 。表中最后两个公式与
无穷级数有关，很快就会讨论到 。



--- 第 116 页 ---
98 " 第2章 基本结构: 集合、函数、数列与求和

表2-5 若于有用的求和公式

  
                                                                            
                                                                                                                                                                                                                                                                 

 
   

                                                                                                                                                                                                    

“一了 色                               和 有3

凿一】

> ， artCr 关 0)                    ws天1

0
>
k= 1
1

大一1

                                                                                                                                                                                                                                                                   
  

  

 

2       和二,zl<1l

下一人站

    

   

mm十1)(2n十1)       忆
中           krt-iy |工|一1

                                                                                                                                                                                                                                                                  

例 15 解释了表 2-5 中的公式是如何使用的。

100

例1S 求>)马。
一5
100

解 首先注意由于> 名 = 之) 妨十 2， 外,所以有

不一50
1的      309      433
习
业一50      业司1     本mm
利用表 2-5 的公式 > 已 = nn十1)(22十1)/6,看出
者一]

六所一100 :191201 -和50.99 - 338350 -40425 = 297925        本

若于无穷级数 ”尽管本书中大多数求和都是有穷求和，但在离散数学某些部分中无穷级数却
是重要的。通常在微积分课程中研究无穷级数，甚至这些级数的定义也需要使用微积分，但有时
它们也会出现在离散数学中，因为离散数学也可以处理无穷离散对象集。尤其是将来在离散数学

的研究中，我们将会发现例 16 和例 17 中无穷级数的闭形式非常有用。
例 16 〈本例要求微积分知识)设 x 是实数满足1 zx |一I。求 > zx。

 

了 解 根据定理1，令一1 和r一z就看出 2 z 一工-二1 .由于1z1<1，所以当A
趋于无穷时，z?趋于0。所以

mr 一1 1
2 z一1 xz一1 1一>              丽

对已有公式进行微分或积分就产生新的求和公式。

例 17 《本例要求微积分知识?对下列方程两边微分

 

 

1
2 一>
根据例 16 就发现
二于和和  1
各 (1一总)
(根据关于无穷级数的定理，对 | z | 一1 这个微分有效。)                        看
2.4.5 基数

回忆一下，2. 1 节把有限集的基数定义成集合中的元素个数。换句话说，有限集合的基数告诉
我们何时两个有限集大小相同，何时一个比另一个大。那么我们是否可以将这种思想推广到无穷
集合呢? 回忆一下 2. 3 节的练习 34: 任何两个相同大小的有限集之间必然存在一个一一对应。这
个发现使得我们可将基数概念推广到所有集合，包括有限集和无限集(详见定义 4) 。

    集合 A 和集合已有相同的基数，当且仅当存在从人A到翌的一一对应。

现在把无限集分为两组，一组与自然数集合基数相同 ，另一组基数不同。

 



--- 第 117 页 ---
第2章 基本结构: 集合、函数、数列与求和，。99

ES有限集或与自然数集基数相同的集合都称为可数的。不是可数的集合称为不可数的。

如果一个无穷集合 S 是可数的，我们用符号Si 来表示集合 S 的基数(从是希伯来语，希伯来字
母表的第一个字母)。记15S 1一S，且说 S有基数“希伯来零”。

现在给出可数集合与不可数集合的例子。

例18 证明: 正奇数集合是可数集合。

解 ”要证明正奇数集合是可数的，就说明这个集合与正整数集合之间的一一对应。考虑从 2
到正奇数集合的函数

 

ah) 一2一]
证明 了既是单的又是满的，即证明 汪是一一对应的。为了看出 /是单的，假定 f(z) = F(zm)。于是
2n一1 一2m一1 ,所以?一靖。为了看出 了是满的，假定上是正奇数。于是上比偶数 次少1，其中上
是自然数。因此:一2一1一(A)。图2-18 显示这个一一对应。              国

1 2 3
1 3 5   9 1 13 15    21 23 ...
图2-18 在Z*和正奇数集合之间的一一对应

无限集是可数的，当且仅当可以把集合中的元素列成序列(下标是正整数)。这是因为从正整
数集合到集合 S 的一一对应三可表示成序列al ，as ，…，a,，…，其中四一Fl1)，a 一F2)，…，
au一na)，…例如，奇数集合列成序列 wa ，al ，…，a,，…，其中oa一2n一1。

我们可以通过列举其所包含元素来证明所有整数的集合是可数的。

例 19 证明所有整数的集合是可数的。

证 我们可用以0开头，正负整数交替出现的序列来列出所有整数: 0，1，一1，2，一2，…
这样，可以确定正整数集与整数集之间的一一对应(证明函数 Fnz) =x/2(Cn 为偶数)， 及 jn)一
一(人?一1)/2(? 为奇数)即为满足条件的一个函数，具体过程留给读者完成) 。据此，所有整数的集
合是可数的。                                                   轿

奇数集与整数集均为可数集合并不令人感到意外，但许多人对于有理数集也是可数集合的结
果颇为惊讶，详见例 20 的证明。

例 20 证明: 正有理数集合是可数的。

解”正有理数集合是可数的，这似乎令人和惊讶、但下面说明如何把正有理数列成序列 上 ，疡，…
r，…首先，注意每个正有理数都是两个正整数之商 /go。这样排列正有理数,在第 1 行列出分母
4一1 的有理数，在第 2 行列出分母 9=2 的有理数，等等，如图 2-19 所示。

把有理数列成序列的关键是: 沿着图 2-19 所示路线，
先列出满足 十g一2 的正有理数 /o，再列出满足 p十g一3
的正有理数，然后列出满足 如十g=4的正有理数，等等。
每当遇到已经列出过的数 ayg，就不再次列出了。例如，当
遇到 2/2一1 时就不列出了，因为已经列出过 171=1。所构
造的正有理数表的初始项是 1，1/2，2，3，1/3，1/4，2/3，
3/2，4，5，等等。由于所有有理数都只列出一次(读者可

iii

9 1I0 1 12...
3

 

以验证它)，所以已经证明了有理数集合是可数的。 。 国
:5语 我们已经看到有理数集也是可数集合，那么是
“” “和理有候选的不可数集合呢? 对此，第一个需关      3

+ An
nhl

注的集合就是实数集。在例 21 中，我们使用乔治。康托尔
于 1879 年引入的所谓康托尔对角化论证的重要证明方法来
证明实数集合是不可数的。在数理逻辑和计算理论中大量      图 2-19 正有理数是可数的



--- 第 118 页 ---
100。第2章 基本结构: 集合、函数、数列与求和

地使用这个证明方法。
例21 证明: 实数集合是不可数集合。
解 ”要证明实数集合是不可数的，就假定实数集合是可数的并得出矛盾。于是，所有
落在0 和1 之间的实数所成的子集合也是可数的(因为可数集合的所有子集合都是可数
的)。在此假设下,在0和1之间的实数按照某种顺序列出，比如说 m，疡，关，…，设这些实数
的十进制表示为
ri 一0.ddisdiici…
ra 一 0. da dazsadazd…
7 一 0. da dazcdasca
mm 一0.dcdasdiad…

其中心Et0，1，2，3，4，5，6，7，8，9}。(例如，如果 疡一0.237 941 02…，就有 du = 2，
da一3，d一7,等等.)于是，构造新的实数具有十进制展开式 r=一0. ddadsd,…，其中用下列规则
确定十进制数字 :
二 {  若d 和关4
5 车d,=14
(〈例如，假定六=0.237 941 02…，产一0. 445 901 38… ，六一0.091 187 64… ，r, 一0.805 539 00…，
等等， 于是 r一0. di dascdsd…一0.4544…， 其中因为 au夫4，d一4; 因为cs一4， ad:一5; 因为
das天4，吃一4; 因为 di夫4，d 一4; 等等。)
每个实数都有唯一的十进制展开式(展开式结尾全部由数字 9 组成的可能性除外)。于是，实
数 -不等于一，产， …中的任何一个，因为对每个z来说，r 的十进制展开式与 r, 的十进制展开式
在小数点右边第; 位是不同的。
由于存在着不在列表中而在0 和 1 之间的实数 ~，所以可以列出在0 和1之间所有实数的假设
就必定为假。因此，不能列出在0 和1 之间的所有实数,在0 和1 之间的实数集合是不可数的。任
何含有不可数子集合的集合都是不可数的(参见本节末练习 19) 。因此实数集合是不可数的。    轿

练习
1. 求序列{a,}的下列各项，其中 au.=2 (一3)"十5"。
a)ano                  by)a                  ch)as                  d)ais
2. 序列{a,}的项 ce ，a ，az 和 us 是什么? 其中 av 等于
a)2"十1               b)(n十1)"+1            c)l zy2|                d)lzmV2]二[zy21]

Co

. 列出下列各序列的前 10 项。
a)从 2 开始，每个后续项都比前一项多 3 的序列。      b)按升序把每个正整数列出 3 次的序列。
c)按升序把每个正奇数列出 2 次的序列。               d)第”项是”! 一2" 的序列。
e)从 3 开始，每个后续项都是前一项的 2 倍的序列。
f前两项都是 1，每个后续项都是前两项之和的序列。(这是著名的斐波那契序列，后文有述。)
g)第 ”项是数”的二进制展开式的位数的序列。
h)第 ”项是第 ” 个英文单词中包含的字母数的序列。

- 求至少 3 个不同的序列，初始项都是1，2，4，用简单的公式或规则产生各项。

必

5 对于下列每个整数表，给出简单的公式或规则，以产生从给定的表开始的整数序列项。假定你给出的公式
或规则是正确的，据此写出相应序列的后续三项。
a)1，0，1，1，0，0，1，1，1，0，0，0，1，…    b)1，2，2，3，4，4，5，6，6，7，8，8，…
c)1，0，2，0，4，0，8，0，16，0，…          d)3，6，12，24，48，96，192，…
e)15，8，1，一6，一13，一20，一27，…        fD3，5，8，12，17，23，30，38，47，:…
g)2，16，54，128，250，432，686，…         h22，3，7，25，121，721，5041，40 321，…

**6. 证明， 如果 a。 表示不是完全平方的第 "个正整数，则a,="十{Va) ，其中{z}表示最接近于实数 rz 的整数，



--- 第 119 页 ---
第2章 基本结构: 集合、函数、数列与求和"101

,下列各和的值是什么?

2 w+         四密 一2          os             一2
. 下列每个几何序列这些项之和的值是什么?

ay 3 .2           b 2             oa          d六2 . (一3)
， 计算下列各双重和。       加               和               攻

袜阅G+       by 2if+3      wy yi           u忆2

19.
20.

#亲2
#22.
、#23。

#24，

2 1                 1人1 ji                iT1 jim0                 i= j一1

.证明:  w 一 Qi- 1) 一an一co， 其中 Co Qi ”an 是实数序列。  这种类型的和称为迭进。
。 从A=1 到k一， 对恒等式忆 一(一1)一2一1 两边求和，并且利用练习 10，求:

ay (CA一1) 的公式(前 个奇自然数之和)       b yA 的公式
天一开                                    表赋

. 用表 2-5求 》\A。

生一上0

. 当六是正整数时，求 六 LVE 的公式。

对于乘积也有一个特殊记号。aw ，uo+:，…，w 的乘积表示为 [[ , 。

于一则

,下列乘积的值是什么?

10                            上                             100                             10
a) [[:             b)              c) [一D;          d[[2
FL

im5                                im上                                 im

回忆一下，价乘函数在正整数上上的值(表示成 "1)是从 1 到?的正整数之积。另外规定 0! 一1。

. 求 人让
. 确定下列各集合尾否可数或不可数。 对可数的集合，说明在自然数集合和该集合之间的一一对应。

a)负整数           b)假数             c)0 和 172 之间的实数   d)7 的整倍数

确定下列各集合是否可数或不可数。对可数的集合，说明在自然数集合和该集合之间的一一对应。

a)不包含位 0 的全部位串

b)表示成两整数之商时分母不小于4 的全部正有理数
c)十进制表示形式不包含 0 的实数

d)十进制表示形式包含有限个 1 的实数

. 如果 4A 是不可数集合而召 是可数集合，那么 4一中一定不可数吗?

假设 4A，好是集合,证明: 如果 4A 是不可数集合并且ASB,，则 吕是不可数的。

证明: 若A和旦是具有相同基数的两个集合，C 和呈 是具有相同基数的两个集合，则 AXC 与有已XD具
有相同基数。

证明: 可数的多个可数集合的并集是可数的。

证明: 所有有限位串的集合是可数的。

证明: 用具体的程序设计语言编写的所有计算机程序的集合是可数的。[提示: 可以认为用程序设计语言
编写的计算机程序是有穷字母表上的符号串。]

如果存在着求函数值的计算机程序，就说这个函数是可计算的。用练习 23 证明:, 存在着不可计算的函数。

关键术语和结果

术语

集合: 一组互不相同的对象。
公理: 理论的一个基本假设。



--- 第 120 页 ---
102，。第2章 基本结构: 集合、函数、数列与求和

悖论; 还辑上的不一致性。

集合的元素、成员: 集合中的一个对象 。

好(空集): 没有成员的集合。

全集: 包含考虑中的所有对象的集合。

文氏图: 一个或多个集合的一种图形表示 。

S一T(集合相等)， S 和T 有相同的元素。

SCT(S是了的子集): S的每个元素也是工 的元素。

SCT(S是工的真子集); S是工的子集，且 S天T。

有限集: 含?个元素的集合，其中是非负整数。

无限集: 不是有限集的集合。

1S1(S的基数): S 中元素的个数。

P(S)(S 的辕集合) ， S 的所有子集的集合。

AUB(A 和昌的并集): 包含那些至少属于A 和昌之一的元素的集合。
A站B(A和归的交集): 包含那些既属于A 又属于吾 的元素的集合。
A一B(A和呈的差集): 包含那些只属于A 而不属于召 的元素的集合。
A(4A 的补集): 全集中不属于 A 的元素的集合。

4旨B(A 和吾的对称差): 包含恰属于A 和昌之一的那些元素的集合。
成员表:， 显示集合中元素的成员关系的表格 。

从A到吾的函数: 一种指派，为 A 中每个元素指派台中恰好一个元素。
了的定义域: 指集合4, 若了是从A到吾的函数。

了的伴域: 指集合 B,若了是从A到吾的函数。

6是厂之下a的像:8= Fa) 。

Qa是了之下局的原像， Ca)一。

了的值域: 了的像的集合。

映上函数，满射: 从A到呈的函数,使 中的每个元素都是A 中某元素的像 。
一对一函数，内射: 定义域中每个元素的像都不相同的函数。

一一对应，双射: 既是一对一又是映上的函数。

了的北:〈当了是双射时)颠倒由 了给出的对应关系的函数。

-8(厂和8& 的组合): 为工指派 FCg(z))的函数。

Lzj(下取整函数) : 不超过xz的最大整数。

「z 1(上取整函数) : 大于或等于z 的最小整数。

序列: 以整数集合的子集合作为定义域的函数。

几何序列: 形如a，ar，a，…的序列，其中ac 和r 都是实数。

等差序列: 形如a，a二d，a十2d，…的序列，其中c 和d 都是实数。
串; 有穷序列。

空串; 长度为0 的串。

二ai: 和ai十as十…十a。

Ia : 积aas…av。

可数集， 有穷集或可与正整数集合一一对应的集合。

不可数集: 不是可数的集合。

康托汞对角化论证: 可用来证明实数集合是不可数的证明技术。

结果
2.2节表 2-1给出诸多集合恒等式。
2.4节表 2-5 给出求和公式。



--- 第 121 页 ---
第2章 基本结构: 集合、函数、数列与求和"103

有理数集是可数的。
实数集是不可数的。

复习题
. 解释一个集合是另一个集合子集的含义，如何证明一个集合是另一个集合的子集?
. 空集表示什么? 证明空集是任何集合的子集。
. aa)定义 | S|1 (集合 S 的基数)。
b)给出|AUB | 的公式，其中A，吕均为集合。
4. a)定义集合 S 的苦集。
b)何时空集包含在集合 S 的寡集中?
c)包含 ”个元素的集合S，其寡集含有多少个元素?
5. a)定义两个集合的并集、交集、差集以及对称差。
b)正整数集与奇数集的并集、交集 、差集及对称差分别是什么?
6. a)解释两集合相等的含义。
b)描述尽可能多的方法以证明两集合相等 。
c)用至少两种不同的方法证明 4一(BmncC)与(4一B)U(A一C)是相等的。
， 解释逻辑等价与集合便等之间的关系。
. a)定义一个函数的定义域、伴域及值域。
b)令 A站一天十1 为从整数集到整数集的一个函数，则其定义域、伴域、值域分别是什么?
、a)解释从正整数集到正整数集的一对一本数的含义。
b)解释从正整数集到正整数集的映上画数的含义。
c)列举一个从正整数集到正整数集的既一对一又映上的函数。
d)列举一个从正整数集到正整数集的一对一而非映上的函数。
e)列举一个从正整数集到正整数集的非一对一但映上的函数。
1列举一个从正整数集到正整数集的既非一对一又非映上的函数。
10. a)定义一个函数的逆函数。
b)何时一个函数存在逆函数?
c)从整数集合到整数集合的函数 F(z) =10一”是否有逆函数? 若有，其道函数是什么?
11. a)定义从实数集到整数集的下取整函数和上取整函数。
b)对于哪些 r 而言, | zj|=「z]?
12. 以8，14，32，86，248 开头的序列之项推测一个表达式，并据此求出该序列后续三项。
13. 当 r夫1时，几何序列各项之和: a十ar十…十ar 是什么?
14. 证明: 奇数集合是不可数的。
15. 给一个不可数集合的例子。

补充练习

1. 令 4为包含字母 r 的英文单词集合，有8 为包含字母 9 的英文单词集合。试表示下列 4，忆组合而得的
集合:

a)不包含字母 的英文单词集合          b)不包含字母 x 和9 的英文单词集合

c)包含字母 x 而不包含字母4 的英文单词集合    d)不包含字母 zx或g 的英文单词集合

e)包含z或9但不同时包含二者的英文单词集合

- 证明: 若A是日的子集，则 A 的寡集是日 的宪集的子集。

' 假定4和了均为集合且满足A 的寡集是 的寒集的子集，则 A 一定是忆 的子集吗?

: 令正表示偶数集合，O 表示奇数集合，Z 一如往常表示整数集合。判断下列每个集合所代表的含义，
a)EUO           b)EPO           c)Z一下           d)Z一DO

5. 证明: 若A和电均为集合，则 A一(4一B)一4A门B。

6. 令A和昌为两个集合， 证明: ASB 当且仅当A门B=A。

7. 令A，虽，C 为三个集合,证明: (4一B)一C 不一定等于4一(B一C)。

6i 呈

oO

xD

心 ci



--- 第 122 页 ---
104 "第2童 基本结构: 集合、本数、数列与求和

8.
9.

I0.
1 1.

14.
15.

关] 和

17.

18.
19.
20.
21,
22.
23.
24.
25.

26.

#27.
#28，

29.

#30.
<#31.

#32.

假定 A 和如 均为集合,证明或否定: (4一B)一C=一(4一C)一B。

假定4A，B，C 和了 均为集合，证明或否定: (4一B)一(C一D)=(4A一C)一(BB一D) 。
证明: 若4A和忆均为有限集合, 则 1 4B8近14UB 1并判断何时等号成立。
令A4A和召为有限全集 U 的两个子集，按照递增顺序列举出下列各项:
a)4，|A4UB1，14nBl，IUI，|1 好|

b) 1 4一Bl ，14@B1，I4I+181，l|AUBI，1好1

.令A和中为有限全集 U 的两个子集，证明: | An下I=1IUI一141一181+1A4nB|。
13.

令乒和8 分别为从1{11，2，3，4}到{a，6，c，d和从{a，6，c，d到{1，2，3，4}的两个函数，且满足
8(1)一dd，8(2)一c，F3)一a，F4)一5和8(a)一2，&g(们王1，g(c)一3，g(d)一2。则

a)厂是一对一函数吗? 5 呢?

b)三是映上函数吗? g 呢?

c)丰或5 是否有道函数? 若有，求出其逆函数。

令了是从集合A 到集合吾 的一对一函数，S，T均为A 的子集。证明: fCSmnT)= FSs)mn FT)。

举例证明: 对于非一对一函数 /，练习 14 中的等式不一定成立。

假定了是从A 到吾的一个函数。我们按照如下规则定义从 P(4)到 P(B)的函数 S，对于 A 的每个子集
X，有Sr(X)=FX)。类似地，我们定义从 P(B)到 P(4)的函数 S-: (按照如下规则: 对于及的每个子集
Y,，有Si- OO)=广(Y))。并且，将使用 2. 3 节的定义4 以及集合逆像的定义。

a)证明: 若上是从A到忆的一对一函数，则 S/是从 P(4A)到 P(B)的一对一函数。

b)证明: 若了是从A到归的映上画数，则 S/是从 P(A)到 P(CB)的映上函数。

c)证明: 若了是从A到日的映上函数，则 S,-,是从 P(B)到 P(A)的一对一函数。

d)证明: 若卫是从A 到日的一对一函数，则 S/ 1是从 P(B)到 P(A)的映上本数。

e)利用 a)并通过 d)得出结论: 若了是从A 到日的一一对应，则 Sr是从PP(A)到 P(B)的一一对应且 S )

是从 P(B) 到 P(4)的一一对应 。

证明:, 车了和8均为从A 到时的函数且满足 Sr = Sx(使用练习 16 前言中的定义)，则对于所有 rzEA必

有jz)一gE(r)。

证明: 若世是整数. 则 nm一 [zy2十|2|。

对于哪些实数 *，y 而言，Lz十车一Lzj十[yj成立?

对于哪些实数 zx，y 而言，「 rz十y]=「z]十「 >]成立?

对于哪些实数 x，>y 而言, [zx十y]=「z]十[yj成立?

证明: 对于任一整数ma，[Lny2]fny2= [nzy/4|成立。

证明: 若普是整数而zx 非整数， 则[zj二 Lm一z|=m一1，若zx也是整数，则等于mm。

证明, 若工是实数，则| Lz/2j」/2 |=Lz/4 |] 。

证明: 若是奇数，则| 姑人41]一(2十3)/4。

证明，若 m，"均为正整数， 为实数，则| -4荆2| ~ |二| 。

证明: 若普是正整数，z 是实数， 则Lmzj=Lzj+|z+二|+|z+二|+…+|z+2!|.

下面我们来定义乌拉姆数并规定: ui=1，vus一2。深入一步， 在判断了小于?的整数是否是乌拉姆数之
后，若 可以被唯一地记作两个不同乌拉姆数之和，则令 ”等于下一个乌拉姆数。注意， xj一3，w, 一4，
&s一6， zx一8。

a)求前 20 个乌拉姆数。

b)证明存在无穷多个乌拉姆数。

求 T[, ,和 的值(此处所使用的乘积符号在 2.4 节练习 14 前言有过定义) 。

试给出一个规则以产生以 1，3，4，8，15，27，50，92…开头的序列项， 并据此求出该序列的后续四项。
试给出一个规则以产生以2，3，3，5，10，13，39，43，172，177，885，891…开头的序列项， 并据此
求出该序列的后续四项。

证明: 若A，日均为可数集合，则 AX电也为可数集合。



--- 第 123 页 ---
第2章 基本结构: 集合、函数、数列与求和。105

计算机题目
按给定的输入和输出写程序。

1.
2.

中 区和

给出含有?个元素的集合的两个子集A，B，利用位串求出4A，AUB，A4PmB，A4一B，4中B。
给出来自同一全集的两个多重集合 4A，B，试求AUB，A4PB，A一日以及A十有(参见 2.2 节练习 30
前言) 。

. 给出模糊集合 A，刀，试求A&，AUB以及A门B(参见 2.2 节练习 31 前言) 。

给出一个从{1，2，…，中到整数集合的函数 A，判断 了是否是一对一函数。

- 给出一个从{1，2，…，}到其自身的函数 ，判断 了上是否是映上函数。
- 给出一个从11，2，…，好到其自身的双射 六,， 求 广:。

计算和研究
使用一个计算程序或你已完成的程序做下面的练习。

1.
2，
3.
全

#5。

给出两个有限集，试列出这两个集合笛卡儿积中的所有元素。

给出一个有限集，试列出其赛集中的所有元素。

计算从集合 S 到集合了 的一对一函数的个数，其中 S，T均为任意大小的有限集。你能否给出这样的郴数
总个数的一个公式? (我们将在第 3 章给出该公式。)

计算从集合 S到集合工的映上函数的个数，其中 S，工均为任意大小的有限集。你能否给出这样的函数总
个数的一个公式? (我们将在第 4 章给出该公式。)

对用以产生序列项的不同规则，随机选取这些规则中的一个，并使用该规则产生特定序列的程序进行汇
总。利用提示序列后续项的交互式程序部分判断解答是否是预期的后续项。

写作题目
用课本以外的资料，按下列要求写成短文。

一

. 讨论一套公理化集合理论是如何避免罗素悖论而形成的?

. 调查函数概念最早出现在包，试描述当时这种思想是如何被运用的。

 解释发现《整数序列百科全书?》巨大作用的不同方式，并描述几个非比寻常的序列以及它们是如何出现的。
.定义最新提出的 EKG 序列并描述它的某些性质以及有关它的一些未解问题。

' 查阅超越数的定义。解释如何证明这样的数存在以及这些数是如何被构造出来的。考虑哪些典型数可以作

为超越数，而哪些典型数是否是超越数至今仍未可知。

. 讨论无穷基数及连续统假设。



--- 第 124 页 ---
第3章 |

Discrete Mathematics and lts Applications，6E
计 数

组合数学这一研究个体安排的学科，是离散数学的重要部分。早在 17 世纪就开始了这类课题
的研究，当时在赌博游戏的研究中出现了组合问题。枚举，具有确定性质的个体的计数，是组合
数学的一个重萎的部分。我们必须对个体计数来求解许多不同类型的问题。例如，用计数确定算
法的复杂性。计数也用于确定是否存在着能够充分满足需求的电话号码或因特网地址。此外，计
数技术也广泛用于计算事件的概率。

3. 1 节将要研究的基本计数规则可以求解各种各样的问题。例如，可以用这些规则来计数美国
各种不同可能的电话号码，计算机系统中允许使用的密码，以及在比赛结束时赛跑运动员的不同
的名次。另一个重要的组合工具是铝梨原理，将放在 3. 2 节研究。这个原理指出，当把物体放在
盒子里时，若物体比盒子多，那么存在一个盒子包含着至少两个物体。例如，我们可以用这个原
理证明在 15 个或者更多的学生中至少有 3 人出生在相同的星期几。

我们可以用集合中个体的有序或无序安排来描述许多计数问题。这些安排称作排列和组合，在
许多的计数问题中都会用到它们。例如，在 2000 个学生参加的考试竞赛中最终将有 100 个获胜者被
邀请赴癸。我们可以枚举将被邀请的 100 个学生的可能的组合，以及最终 10 名获奖者的产生方式。

组合数学的另一个问题涉及生成某个特定类型的所有排列。这在计算机模拟中通常是很重要
的。我们将设计算法来生成各种类型的排列。

3.1 计数基础

3.1.1 引言

一个计算机系统的密码由6、7 或 8 个字符组成。每个字符必须是数字或字母表中的字母。每
个密码必须至少包含一位数字。问有多少个这样的密码? 本节将介绍回答这个问题及各种各样的
其他计数问题所需要的技术。

数学和计算机科学中存在着计数问题。例如，我们必须为成功的实验结果和所有可能的实验
结果计数，以确定离散事件的概率。我们需要对某个算法用到的操作数计数，以便研究它的时间
复杂性。

本节将介绍基本的计数方法。这些方法是几乎所有计数技术的基础。

3. 1.2 ”基本的计数原则

2 我们将提出两个基本的计数原则，乘积法则和求和法则。然后将说明怎样用它们来求
解许多不同的计数问题。

当一个过程由独立的任务组成时使用乘积法则。

生积法则 假定一个过程可以被分解成两个任务。如果完成第一个任务有 ma 种方式，在第一
个任务完成之后有 z. 种方式完成第二个任务，那么完成这个过程有mm 种方式。

0  例 1 至例 10 显示怎样使用乘积法则。

     例1 一个新建公司中只有两个雇员 Sanchez 和 Patel，公司租用了一个大楼的底层，共
12 个办公室。有多少种方法为这两个雇员分配办公室?

解 ”对这两个雇员分配办公室的过程是这样的: 为 Sanchez 分配办公室，有 12 种方法，为
Patel 分配一个不同的办公室，有 11 种方法。根据科法规则，为这两个雇员分配办公室共有
12。11王132 种方法。                                                    曙

 



--- 第 125 页 ---
第3章 计   数。107

例 2 用一个字母和一个不超过 100 的正整数给礼堂的座位编号。那么不同编号的座位最多有
多少?

解 ”给一个座位编号的过程由两个任务组成，即从 26 个字母中先选择一个字母分配给这个座
位，然后再从 100 个正整数中选择一个整数分配给它。乘积法则表明一个座位可以有 26。100==

2600 种不同的编号方式。因此，不同编号的座位数至多是 2600 。                    因
例3 某个计算机中心有 32 台微机，每台微机有 24 个端口。问在这个中心里有多少个不同的
单机端口?

解 ”选择一个端口的过程由两个任务组成。首先挑一台微机，然后在这人台微机上挑一个端口 。
因为有 32 种方式选择微机，而不管选择了哪台微机，又有 24 种方式选择端口，由乘积法则存在

32。24一768 个端口 。                                                      国
经常会用到推广的乘积法则。假定一个过程由执行任务 Ti ，厂 ，…，T。 来完成。如果在完成
任务之后用 z” 种方式来完成荆，那么完成这个过程有mm 。普。…。mn 种方式。可以由两个任务的

乘积法则通过数学归纳法证明推广的乘积法则。

例4 有多少个不同的7 位二进制串?

解 每位有两种选择方式，可以是 0 或1。因此，乘积法则表明总共有 2 一128 个不同的7 位
二进制串。                                                                国

例S 如果每个车牌由 3 个字母后跟 3 个数字的序列构成(任何字母的序列都允许)，那么有多
少个不同的有效的车牌?

解 对3个字母中的每个字母有 26 种选择，对 3 个数字中的每个数字有 10 种选择。因此，由
乘积法则总共有 26。26。26。10. 10. 10==17 576 000 个可能的车牌。                          [
和
每个字母有26种选择 每个数字有10种选择

例6 计数函数 从一个半元集到一个普元集存在多少个函数?

解”一个函数对于定义域中 记个元素中的每个元素都要选择陪域中”个元素中的一个元素来
对应。因此，由乘积法则存在 za。，mz …，… "nm一ze 个从立元集到” 元集的函数。例如，从一个 3 元
集到一个 5 元集存在 5 个不同的函数。                                     国

例7 计数一对一函数 从一个m元集到一个 元集存在多少个一对一函数?

解 首先注意到当 mm>? 时没有从靖 元集到”元集的一对一函数。现在令 m委”假设定义域
中的元素是 al ，a ，…，as。有了种方式选择丽数在 wa 的值。因为函数是一对一的，可以有xz一1
种方式选择函数在 ax 的值(因为 w 用过的值不能再用) 。一般地，有 "一&十1 种方式选择函数在 w，
的值。由乘积法则，从一个空元集到一个 元集存在着交(xn一1)(z一2)…(n一闪十1)个一对一函
数。例如，从一个 3 元集到一个 5 元集存在5. 4. 3一60 个一对一函数。                国
2 例8 电话编号计划 在北美，电话号码的格式是由一个编号计划规定的。一个电话号

”” ”和码由10个数字组成，这些数字由一个 3 位的地区代码、一个 3 位的局代码以及一个4
位的话机代码组成。出于信号的考虑，在一些数字上有某种限制。为了规定允许的格式，令X表
示可以在0到9之间任意选取的数字，N 表示可以在2到9 之间选取的数字，而站表示必须取0 或
1 的数字。下面讨论两个编号计划，分别称为老计划和新计划(老计划是 20 世纪 60 年代使用的，
已经被新计划代替了，但目前对新号码需求的迅速增长甚至使得这个新计划也将显得落伍了)。正
如将要证明的，新计划允许使用更多的号码。

在老计划中，地区代码、局代码和话机代码的格式分别为 NYX、NNX 和 XXXX，因而电话号
码形式为 NYXCNNX-XXXX。在新计划中，这些代码的格式分别为 NXX、NXX 和XXXX，因而电
话号码形式为 NXXNXX-XXXX。在老计划和新计划下分别可能有多少个不同的北美电话号码?

解 ”由乘积法则，格式为 NYX 的地区代码有 8 .2，10一160 个，格式为 NXX 的地区代码有
8 " 10 10一800个。类似地，由乘积法则，存在 8。8. 10=640 个格式为 NNX 的局代码。乘积



--- 第 126 页 ---
108。第3章 计   数

法则也表明存在着 10，10。10，10一10 000 个格式为 XXXX 的话机代码。
因此，再次使用乘积法则，结果在老计划下存在
160。640。10 000一1 024 000 000
个不同的北美有效的电话号码。在新计划下存在
800。800。10 000一6 400 000 000
个不同的电话号码。                                                               四
例9 执行下面的代码以后上的值是什么?

玉 :一0
for zi :一1 to zi

for i :一1 to m

for 1 :一1 to nm。
玉 :一玉十1

 

解 &的初值是0。这个霸套的循环每执行一次,就加1。令 T 表示执行第; 个循环的任务，

那么循环执行的次数就是完成任务 T ，T ，…，T.。 的方法数。因为对每个整数亡，1<i委m， 第
Jj 个循环都执行一次，执行任务 了人一1，2，…，zm)的方法数就是六。由乘积法则，这个符套的
循环执行了mm…nw 次。因此和最后的值是mras …ms 。                               国

例 10 计数有穷集的子集 用乘积法则证明一个有穷集 S 的不同的子集数是21s' 。

解 设S是有穷集。按任意的顺序将 S 的元素列成一个表。考虑到在 S 的子集和长为| S|
的二进制串之间存在着一对一的对应，即如果表的第;个元素在这个子集里，则该子集对应的二
进制串的第守位为1，否则这位为0。由乘积法则，存在着 2*' 个长为| S |的二进制惠。因此
] P(S) | 一2 。                                                力

乘积法则也常用集合的语言表述如下: 如果A, ，4, ，…，A。 是有穷集，那么在这些集合的笛
卡儿积中的元素数是每个集合的元素数之积。为把这种表述与乘积法则联系起来，注意到在笛卡
儿积 A,XA4:X…XA。 中选一个元素的任务是通过在 4, 中选一个元素，4, 中选一个元素，.…,A.，
中选一个元素来完成的。由乘积法则得到

14XAX…XxA4。|=|4 .1A 1. .|A。 |

现在引信求和法则。

求和法则”如果完成第一项任务有 a 种方式，完成第二项任务有 种方式，并且这些任务不
能同时完成，那么完成第一或第二项任务有 za 十m 种方式。

例 11 说明怎样使用求和法则。

例11 假定要选一位数学学院的教师或数学专业的学生作为校委会的代表。如果有 37 位数学
学院的教师和 83 位数学专业的学生，那么这个代表有多少种不同的选择?

解 ”完成第一项任务，选一位数学学院的教师，可以有 37 种方式。完成第二项任务，选一位
数学专业的学生，有 83 种方式。根据求和法则，结果有 37十83=120 种可能的方式来挑选这个
代表。                                                            四

可以把求和法则推广到多于两项任务的情况。假定任务 夏 ，九，…，T,。 分别有m ，到，…，
mn- 种完成的方式，并且任何两项任务都不能同时做，那么完成其中一项任务的方式数是内十
环十…十mm。正如例 12 和例 13 所示，这个推广的求和法则在计数问题中常常用到。这个求和法则
可以从两个集合的求和法则使用数学归纳法加以证明(见本节后的练习 30) 。

例 12 ”一个学生可以从三个表中的一个表选择一个计算机课题。这三个表分别包含 23、15 和
19 个可能的课题。那么课题的选择可能有多少种?

解 ”这个学生有 23 种方式从第一个表中选择课题，有 15 种方式从第二个表中选择课题， 有



--- 第 127 页 ---
第3章 计   数，109

19 种方式从第三个表中选择课题。因此，共有 23十15十19一57 种选择课题的方式。        国
例13 在下面的代码执行后上的值是什么?

& :一0

for :一1 to mi
 :一有十1

for zz :一1] to mn:
太 :一R十1

for z。， :一1] to m。
& :一&十1

 

解 《的初值是0。这个代码块由xm个不同的循环构成。循环中的每次执行上都要加 1。令工
是执行第;个循环的任务。因为第 ;个循环被执行mn; 次，所以任务 工 可以用mw 种方式完成。由于

任何两个任务不能同时执行，求和法则证明&的最后值，即完成任务 T(i一1，2，…，m)的方式
数是 思十冯十…十mv。                                                          图

求和法则可以用集合的语言表述: 如果 A, ，A: ，…，A。 是不交的集合，那么在其并集中的元
素数是每个集合的元素数之和。为把这种表述与求和法则联系起来，令 工 是从A,(i王1，2，…，

m)中选取一个元素的任务。有 | A, | 种方式做 工。由于任何两个任务不可能同时做，根据求和法
则，从其中某个集合选择一个元素的方式数，即在并集中的元素数是
14UAU…UA。1I=1A I++|A, |十…十| 4。|
这个等式仅适用于问题中的集合是不相交的情况。当这些集合含有公共元素时，情况要复杂
得多。本节的后面将对这种情况进行简要的讨论，更深入的讨论放在第4章。

3.1.3 比较复杂的计数问题

许多计数问题不能仅仅使用求和法则或者乘积法则来求解。但是，许多复杂的计数问题可以
使用这两个法则来求解。

了ie。 例14 在计算机语言 BASIC 的某个版本中，变量的名字是含有一个或两个字符的符号

串，其中的大写和小写字母是不加区分的(一个字符或者取自 26 个英文字母，或者取

自 10 个数字)。此外，变量名必须以字母作为开始，并且必须和由两个字符构成的用于程序设计
的 5 个保留字相区别。在 BASIC 的这个版本中有多少个不同的变量名?

解 令Y 等于在这个 BASIC 版本中的不同的变量名个数，W, 是单字符的变量名个数，V, 是
两个字符的变量名个数。那么由求和法则，V一W 十V; 。由于单字符变量名必须是字母，故 w 一26。
又根据乘积法则存在 26， 36 个以字母打头以字母数字结尾的 2 位字符串。但是其中 5 个不包含在
内，因此 V:王26，36一5一931。从而在这个 BASIC 版本中存在 V一W十V:王26十931一957 个不同
的变量名 。                                           ，                        于

例15 计算机系统的每个用户有一个 6一8 个字符构成的密码 ，其中每个字符是一个大写字母
或者数字，且每个密码必须至少包含一个数字。有多少可能的密码?

解 设己是可能的密码总数，且 P, 、P, 、P, 分别表示 6、7 或 8 位的可能的密码数。由求和
法则，P= Pe十P;,十Ps。我们现在找 P, 、P, 和 P, 。直接找 P, 是困难的。而找 6 个大写字母和数
字构成的字符串数是容易的，其中包含那些没有数字的串在内，然后从中减去没有数字的串数就
得到 Ps 。由乘积法则 ，6 个字符的串数是 36: ，而没有数字的字符串数是 265 。因此，

P, 一36一26'一2176782336一308915776 一1867 866 560
类似地得到
忆 一36 一26" 一78364164096一8031810 176 = 70 332 353 920



--- 第 128 页 ---
110。第3章 计  数

和
P, 一36: 一268 一2821 109 907 456 一208 827 064 576 一 2 612 282 842 880
从而
PP= P,十P;十P, 一2684483063360                国
1 例16 计数因特网网址 在由计算机的物理网络互连而构成的因特网中，每台计算机
““'，” (或者更精确地说是计算机的每个网络连接?被分配一个因特网地址。目前正在使用的
因特网协议版本 4(IPv4)中，一个地址是一个 32 位的二进制串。它以网络标识Cnetid)开始，后面
跟随着主机标识(hostid) ，该标识把一个计算机认定为某个指定网络的成员 。
根据网络标识和主机标识位数的不同，使用 3 种地址形式。用于最大网络的4类地址，由0
后跟 ?7 位的网络标识和 24 位的主机标识构成。用于中等规模网络的也类地址,由 10 后跟 14 位的
网络标识和 16 位的主机标识构成。用于最小网络的C 类地址，由 110 后跟 21 位的网络标识和8 位
的主机标识构成。由于特定用途，对地址有着某些限制: 1111111 在A类网络的网络标识中是无效
的，全0 和全 1组成的主机标识对任何网络都是无效的。因特网上的一台计算机有一个A类、B
类或C 类地址。(除了A类、引类和C 类地址外，还有万类地址和瑟 类地址。类地址在多台计
算机同时编址时用于多路广播，它由 1110 后跟 28 位组成。瑟类地址保留为将来应用，由 11110 后
跟 27 位组成。 类和瑟类地址不会分配给因特网中的一台计算机作为 IP 地址.)图 3-1 显示了 IPv4
的编址。(A 类和了3 类网络标识的数量限制已经使得 IPv4 编址不够用了; 将代替 IPv4 的 IPv6 使用
128 位地址来解决这个问题。)

位数               0 1 2 3 4

 

 四 3-1 因特网地址(IPv4)

对因特网上的计算机有多少不同的有效 ITPv4 地址?
解 令工是因特网上计算机的有效地址数，z4、zs 和zc 分别表示A 类、中类和C 类的有效
地址数。由求和法则，z一zi十za十zc。

为了找到 xs，由于 1111111 是无效的，故存在2一1=127个A类的网络标识。对于每个网络
标识，存在2一2三16777 214 个主机标识，这是由于全0 和全1组成的主机标识是无效的。因此，
za一127。16 777 214一2 130 706 178

为了找到 ze 和xzc，首先注意到存在 24一16 384 个旦类网络标识和22一2 097 152 个 C类网络
标识。对每个 如类网络标识存在着 2 一2一65 534 个主机标识，而对每个C类网络标识存在着
2 一2一254 个主机标识，这也是考虑到全 0 和全工组成的主机标识是无效的。因而，

zs一1073 709 056，xzc一532 676 608
我们可以断言 IPv4 有效地址的总数是
Z一za十zs十zc一2 130 706 178十1 073 709 056十532 676 608一3 737 091 842          国

3.1.4 容斥原理

当同时做两个任务时，我们不能使用求和法则来计数完成其中一个任务的方式。把对每个任务
的方式数加起来将导致计数结果的增大，因为同时完成两个任务的那些方式被计数了两次。为了正
确地计数完成其中一个任务的方式，我们先把完成每个任务的方式数加起来，然后再减去同时完成



--- 第 129 页 ---
第3童 计   数。111

两个任务的方式数。这个技术叫做容斥原理。例 17 显示了怎样用这个原理来求解计数问题。
到呈。。 例17 以1 开始或者以 00 结束的8 位二进制符号串有多少个?
解 “第一个任务，构造以 1 开始的 8 位二进制字符串，完成它有 27 一128 种方式，这是
由乘积法则得到的。因为第一位只有-种选择方式，而其他 7 位中的每位有两种选择方式。
第二个任务，构造以 00 结束的 8 位二进制字符串，完成它有 25=64  ，
种方式，这也是由乘积法则得到的。因为前 6 位的每位有两种选择方式， ”二一一一一
而最后两位只有一种选择方式。                       2 一128
同时完成两个任务，构造以 1 开始以 00 结束的 8 位二进制符号串， 完。” =一一一一-2
成它有2:一32 种方式。这里也使用了乘积法则，因为第一位只有-种先   2一64

法，从第二位到第六位每位可以有两种选法，最后两位也只有一种选法。 10.0
因而，以 1 开始或者以 00 结束的 8 位二进制符号串个数，即完成第一或第      2一32
二个任务的方式数，等于 128十64一32一160。                 国

我们可以用集合的语言表述这一计数原理。令 4, 和 4;, 是集合，Ti 是从 A, 选择一个元素的
任务，T: 是从 4A, 选择一个元素的任务。完成 Ti 有 | A,， | 种方式，完成 站 有 | 4，| 种方式。完
成工 或 也 的方式数是完成 工 的方式数与完成 T, 的方式数之和减去同时完成 工 、并 两个任务的
方式数。因为存在 | A,UA, | 种方式完成 T, 或 三，|1 A,门A, | 种方式完成 下 和T ，我们有

| A， U 4， [=王| A， |十| A， |一| A， 站 A, |
这就是在 2. 2 节给出的计数两个集合并集中元素的公式。

我们给出一个例子说明如何使用容斥原理的公式求解计数问题。

例18 某计算机公司收到了 350 份计算机毕业生设计一组新网络服务器工作的工作申请书。
假如这些申请人中有 220 人主修的是计算机科学专业，有 147 人主修的是商务专业，有 51 人既主
修了计算机科学专业又主修了商务专业。那么，有多少个申请人既没有主修计算机科学专业又没
有主修商务专业?

解 为了求出既没有主修计算机科学专业又没有主修商务专业的申请人的个数，可以从总的
申请人数中减去主修计算机科学专业的人数，或减去主修商务专业的人数(或碱去二者人数之和) 。
设 A, 是主修计算机科学专业学生的集合，A, 是主修商务专业学生的集合，那么 A, UA, 是主修计
算机科学专业或主修商务专业学生的集合，A, 门A, 是既主修计算机科学专业又主修商务专业学生
的集合。根据容斥原理，主修计算机科学专业或主修商务专业(或二者都主修)学生的人数为

| AU A， [=一| A， |十| A，)一| A， 门A, |=220十147一51 一316
因此得到结论: 有 350一316一34 个申请人既没有主修计算机科学专业又没有主修商务专业。 “”国

容斥原理可以推广来求完成个不同任务中的一个任务的方式数，换句话说，就是找盖个集合
的并集中的元素数，其中是正整数。我们将在第 4 章研究容斥原理和它的某些广泛应用。
3.1.5 树图

可以使用树图求解计数问题。一棵树由根、从根出发的许多分支以及可能从其他分支端点出

发的新的分支构成。(我们将在第 7 章详细地研究树。)为了在计数中使
用树，我们用一个分支表示每个可能的选择，用树叶表示可能的结果。

这些树叶是某些分支的端点，从这些端点不再进一步分支。       第!位有。 0
注意，当用树图求解计数问题时，为到达一片树叶所作的选择个数 第2位 Ao 和 yo
可能是不同的(作为例子，见例 20) 。                   第3位 和 入0 9091 和0
例 19 有多少不含连续两个 1 的4 位二进制串?          第4位
解 图3-2 的树图给出了所有不含连续两个 1 的4 位二进制串。我    2-&z8cze
们看出存在 8 个不含连续两个 1 的4 位二进制串。           国      88

例20 在两个队(队 1 和队 2)之间的决赛至多由 5 次比赛构成。先 图3.2 不含连续两个 1 的
胜 3 次的队赢得决赛。决赛可能出现多少种不同的方式?                4位二进制串



--- 第 130 页 ---
112 "第3章 计  数

解 ”在图3-3 的树图中，以每次比赛的得胜者给出了决赛可能进行的所有方式。我们看到有

20 种不同的决赛的方式。                                                转
灰色表示得胜
2                                                                      队1
隐                                                                                                第1场
2                               队1
队2                                队1                                队                                          第2场
1          2                       1              2                   队1        队2

队         队                      队             队                                                    第3场

瓜2                                                                                          似1
队1           队1     队2                           队1 队2           队2                     第4场

以2                以                                   让1          也了                                    居1                惧1

第5场

了2 队) 了陵2 挫1革3 取!    队2 队1陵?3 了共 了队2 惧1
图 3-3 5 次决赛胜 3 次

例21 假设“我爱新泽西?T人好衫有 5 种不同的规格: S、M、L、XL 和XXL。又知道 XL 规格
只有三种颜色，红色、绿色和黑色，XXL 规格只有绿色和黑色。除此之外，其他规格有四种颜色，
和白色、红色、绿色和黑色。如果每种规格和颜色的工恤衫至少一件，一个纪念品商店必须库存多
少件不同的工恤衫?

解 图3-4的树图给出了所有规格和颜色的配对。从中可知这个纪念品商店老板必须库存 17
件不同的工地衫。                                                             于

W=白色, R=红色. G=绿色. B=黑色

 

WwWRGBWRGBWRGBRGBGB
图 3-4 计数不同的工恤衫

练习

1 一个学院有 18 个数学专业和 325 个计算机科学专业的学生。
a)选两个代表，使得一个是数学专业的且另一个是计算机科学专业的，有多少种方式?
b)选一个数学专业或计算机科学专业的代表又有多少种方式?

2. 一次多项选择考试包含 10 个问题。每个问题有 4 个可能的答案 。
a)在这次考试中如果每个问题都要回答，一个学生回答这些问题可能有多少种方式?
b)在这次考试中如果人允许某些答案空缺，一个学生回答这些问题可能有多少种方式?

- 从纽约到丹佛有 6 条不同的航线，而从丹佛到提金山有 7 条。如果选一个到丹佛的航班，接着选一个到旧
金山的航班，那么从纽约经丹佛到旧金山的旅行有多少种不同的可能性?

:如果用 3 个字母作为姓名的缩写，人们可以有多少种不同的选择?

- 如果这3 个字母以A 开始，人们又可以有多少种不同的选择?

5

< 心



--- 第 131 页 ---
第3章 计 数*113

6. 首尾都是 1 的 10 位二进制串有允少个?
7. 位数不超过?上且全由 1组成的二进制串有多少个? 这里的二是正整数。
8. 位数不超过4 且由小写字母构成的串有多少个?
9. 由5个 ASCII 码构成且至少(在符号位)包含一个@字符的串有多少个?〈注: 有 128 个不同的 ASCII码。)
10. 在 50 到 100 之间有多少个正整数
a)能被 7 整除? 这些整数是什么?     b)能被 11 整除? 这些整数是什么?
c)能被7 和 11 同时整除? 这些整数是什么?
11. 在 100 到 999 之间包含多少个正整数

a)被 7 整除?                           b)是奇数?
c)有相同的 3 个十进制数字?       d)不被 4 整除?
e)被3或4整除?            全不被 3 也不被 4 整除?
g)被 3 整除但不被4整除?        h)被3和4整除?
12,， 有多少个串含有 3 个十进制数字且
a)同一数字不能出现 3 次?        b)以奇数字开始?

c)恰有 2 个数字是 4?
13, 一个委员会由 50 个州构成，每个州可从州长或两个参议员中选一个参加，有多少种不同的方式?
14. 用 2 个字母后跟 4 个数字或者 2 个数字后跟《 个字母可构成多少种车牌?
15, 用 2 个或 3 个字母后跟 2 个或 3 个数字可构成多少种车牌?
16, 由 8 个英语字母可构成多少个事?
a)如果字母可以重复且不包含元音字和母
b)如果字母不能重复且不包含元音字母
c)如果字母可以重复且以元音字母开始
d)如果字母不能重复且以元音字母开始
e)如果字母可以重复且包含至少一个元音字母
人如果字母可以重复且包含恰好一个元音字母
g)如果字母可以重复且以 X 开始并至少包含一个元音字母
h)如果字母可以重复且以 X开始和结束并至少包含一个元音字母
17. 从 5 元素集合到含有下述元素数的集合有多少一对一的函数?
a)4 b)5 c)6d)7
18. 从集合{1，2，…，才到集合{0，1}有多少个满足下列条件的函数?” 这里的 ， 是正整数。
a)是一对一的                       b)对 1 和寻赋值为0
c)对恰好一个小于z” 的正整数赋值为 1
19， 从闫元素集合到 =” 元素集合有多少个部分函数(见 2. 3 节的练习 33)? 这里的mm 和) 是正整数。
20. 如果一个字符串反转后所得结果与原来的字符串一样，就称它是一个回文。有多少个长为盖的二进制串

是回文?

21. 在一个婚礼上摄影师安排 6 个人在一排拍照，包含新娘和新郎在内，如果满足下述条件，有多少种安排
方式?
a)新娘必须在新郎旁边             b)新娘不在新郎旁边

c)新娘在新郎左边的某个位置
22. 有多少个 10 位二进制串以 3 个 0 开始或以2个0结束?
*#23。有多少个 8 位二进制品包含 3 个连续的 0 或者 4 个连续的 1?
24，有多少个不超过 100 的正整数能被 4或6 整除?
25. 假定一个计算机系统的口令最少有 8 个、最多有 12 个字符，其中口令中的每个字符可以是小写英文字
母、大写英文字母、数字、或 6 个特殊字符* 、>、一、!、十、一中的一个。
a)该计算机系统可有多少个不同的口令?
b)有多少个口令含有 6 个特殊字符中的一个?
c)如果一个黑客核对每个可能的口令需要 1 纳秒时间，他要核对完所有可能的口令需要多和有时间?
26. 假定在将来的某个时间世界上的每部电话将被分配一个号码，这个号码包含一个 1 到 3 位数字的形如XX、



--- 第 132 页 ---
114 "第3章 计   数

XX 或XXX 的国家代码，后面跟随着一个 10 位数字的形如 NXX-NXX-XXXX 的电话号码(如例 7 所撒
述的) 。在这个编码计划中，全世界将有多少个不同的有效电话号码?
27. 有多少种不同的方式排列字母 as、2、c 和dd ，使得5不紧跟在a 的后边?
28. 使用树图确定{3，7，9，11，24}的子集数，使得子集中的元素之和小于 28。
29, a)假设运动鞋的流行式样对男女都适用。女鞋的大小号码是6，7，8，9，男鞋的大小号码是8，9，10，
11 和 12。男鞋有白色和黑色， 而女鞋是白色、红色和黑色。如果一个商店各种大小和颜色的男、女运
动鞋必须至少存一双，用树图确定所需的鞋的数目。
b)使用计数原理回答(a)中的问题。
30. 从两个任务的求和法则使用数学归纳法证明关于 个任务的求和法则。
31. 具有半条边的凸多边形有多少条对角线? (如果在多边形内或边界的每两个顶点的连线完全在这个集合之
内，则称为凸多边形。)

3.2 鸟梨原理

3.2.1 引言

有 20 只鸽子要飞往 19 个铝巢栖息。由于有 20 只鸽子，而只有 19 个鲍梨，所以这 19
   ”个铀巢中至少有 1 个鸽巢里最少栖息着 2 只角子。为了说明这个结论是真的，注意: 如

果每个鸽巢中最多栖息着 1 只铅子的话，那么最多只有 19 只鸽子有住处，其中每只铝子一个巢。

这个例子阐述了一个一般原理，叫做够巢原理，该原理断言: 如果铝子数比名梨数多,那么一定

有一个铝提里至少有 2 只鸽子(见图 3-5)。当然，这个原理除了铝子和合集外也可以用于其他

对象。

  

al)                                 b)                                c)
 3-5 铅子比鲍偶多

5国胃后巢原理 如果^A十1 个或更多的物体放人个盒子，那么至少有一个盒子包含了 2
个或更多的物体。

证 假定4个盒子中没有一个盒子包含的物体多于 1 个,那么物体总数至多是上，这与至少有
&十1 个物体了矛盾。                                                    口

铝巢原理也叫做狭利克雷抽层原理，以 19 世纪的德国数学家狄利克雷命名，他经常在工作中
使用这个原理。下面的例子说明了怎样使用合集原理。

例1 在一组 367 个人中一定至少有 2 个人有相同的生日，这是由于只有 366 个可能的生日。

加
例2? 在27个英文单词中一定至少有 2 个单词以同一个字母开始，因为英文字母表中只有 26
个字母 。                                                                        国

例3 如果考试给分是从 0 到 100，班上必须有多少个学生才能保证在这次期未考试中至少有
2 个学生得到相同的分数?
解 ”期末考试有 101 个分数。铝集原理证明在 102 个学生中一定至少有 2 个学生具有相同的



--- 第 133 页 ---
第3章 计 数，

分数。                                                          力
铝介原理在许多证明中都是有用的工具，有些证明结果是令人意外的，正如例4所给出的。

例4 证明: 对每个整数 mn，存在一个数是半的倍数，且在它的十进制表示中只出现0和1。
Re 解 ”令交是正整数。考虑) 个整数1，11，111，…，11…1(在这个数表中，最后一个
整数的十进制表示中具有 xz十1个 1) 。注意到当一个整数被 z整除时存在”个可能的余
数。因为这个数表中有 zx十1 个整数，由铝巢原理必有两个整数在除以zz时有相同的余数。这两个
整数之差的十进制表示中只含有0 和 1， 且它能被 ”整除 。   国

3.2.2 广义鸽梨原理

铝巢原理指出当物体比盒子多时一定至少有 2 个物体在同一个盒子里。但是当物体数超过仿
子数的倍数时可以得出更多的结果。例如，在任意 21 个十进制数字中一定有 3 个是相同的。这是
由于 21 个物体被分配到 10 个盒子里，那么某个盒子的物体一定多于 2 个。

 广义合集原理 ”如果 六个物体放人大个盒子，那么至少有一个合子包含了至少[N/A
个物体。

证 假定没有盒子包含了比| NA一1 多的物体，那么物体总数至多是

4人 六|- 一A((全+1)-1)= N
这里用到不等式[N/A<一CN/十1。这与存在有总数 N 个物体矛盾。                       口

一类普遍的问题是，把一些物体分到&个盒子中要使得某个盒子至少含有>r 个物体，求这些物
体的最少个数。当有 N 个物体时，广义鲍巢原理告诉我们，只要PNVRI三一定有>r 个物体在同一
个盒子里。满足 NA r一1 的最小正整数，即 N=A(Cr一1)十1，是满足不等式PN/REr的最小正
整数。还可能有更小的 N 值吗? 答案是没有。原因是如果我们有 &(r一1)个物体，我们可以在&个
盒子中的每个盒子放 r一1 个物体，因此没有一个盒子至少有 -个物体。

当思考这种问题时下面的想法是有用的，就是在不断地放物体时怎样避免一个盒子至少有 r
个物体出现。为避免把第 "个物体加到任何一个盒子里，每个盒子最终将以具有 r一1 个物体结束。
如果不允许放第 ~个物体到一个盒子里，就没有办法增加下一个物体。

例5至例8 说明了怎样使用广义够梨原理。

例5 在100个人中至少有[00/12]=9 个人生在同一个月。                        国

115

例6 如果有5个可能的成绩A、B、C、 和玉，那么在一个离散数学班里最少要多人少.

个学生才能保证至少 6 个学生得到相同的分数?

解 ”为保证至少 6 个学生得到相同的分数，所需的最少学生数是使得[IN/5l=6 的最小整数 N。
这样的最小整数是 六=5，5十1一26。如果只有 25 个学生，可能是每 5 个学生得到同样的分数，而
没有 6 个学生得到同样的分数。于是，26 是保证至少 6 个学生得到相同的分数所需的最少学生数。

图

例7 a)从一副标准的 52 张牌中必须选多少张牌才能保证选出的牌中至少有 3 张是同样的花色?

b)必须选多少张牌才能保证选出的牌中至少有 3 张是红心?

解 a)假设存在四个盒子保存四种花色的牌，选中的牌放在同种花色的盒子里。使用广义钢
巢原理，如果选了 六张牌，那么至少有一个盒子含有至少JNV4]张牌。因此如果JN/4j3，我们知
道至少选了 3 张同种花色的牌。使得LN/V4]>3 的最小的整数太是N一2 .4+1=9，所以 9 张牌就
足够了。注意到，如果选 8 张牌，可能每种花色 2 张牌。因而必须选 9 张牌才能保证选出的牌中至
少3张是同样的花色。想到这一点的一个好方法就是注意到在选了 8 张牌以后没有办法避免出现 3
张同样花色的牌。

b)我们不用广义鲍巢原理回答这个问题，因为我们要保证存在 3 张红心而不仅仅是 3 张同样
花色的牌。注意到在最坏情况下，选一张红心以前可能选了所有的黑桃、方块、梅花，总共 39 张
牌，下面选的 3 张牌将都是红心。因此为得到 3 张红心，可能需要选 42 张牌。               国



--- 第 134 页 ---
116 "第3音 计  数

例8 为保证一个州的 2500 万个电话有不同的 10 位电话号码，所需地区代码的最小数是多
少? (假定电话号码是 NXXNXX-XXXX 形式，其中前 3 位是地区代码，N 表示从2到9包含的
十进制数字，X 表示任何十进制数字) 。

解 ”有800 万个形如 NXXXXXX 的不同的电话号码(如 3. 1 节的例 8 所示)。因此，由广义
鲍梨原理，在 2500 万个电话号码中，一定至少有| 25 000 000/8 000 000 个同样的电话号码。因而
至少需要 4 个地区代码来保证所有的 10 位号码是不同的。                         国

例 9 尽管没有用到广义铝巢原理，也用到了类似的原理。

例9 假设计算机科学实验室有 15 台工作站和 10 台服务器。可以用一条电缆直接把工作站连
到服务器。同一时刻只有一条到服务器的直接连接是有效的。我们想保证在任何时刻任何一组不
超过 10 个工作站可以通过直接连接同时访问不同的服务器。尽管我们可以通过将每台工作站直接
连接到每台服务器(使用 150 条连线)来做到这一点，达到这个目标所需要的最少直接连线的数目
是多少?

解 ”将工作站标记为 W,，克: ，…，Wu，服务器标记为 S'，S,，…，Su。假设对于&一1，
2，…，10， 我们连接 瑟， 到.S,， 并且 uv， 克，， 且，， 琴必和 克5中的每个工作站都连接到所有的
10 个服务器。总共 60 条直接连线。很清楚，在任何时刻任何一组不超过 10 个工作站可以通过直
接连接同时访问不同的服务器。为看到这一点只要注意到下述事实: 如果这个组包含工作站
W) (0过)和10)，那么 W, 可以访问服务器 S,。对于组里的每个工作站 砚,(&三11)，一定存在不在
组里的工作站 琴) (1委j委10)与之对应，因此 凡, 可以访问服务器 S,(这是由于存在多少个不在组里
的工作站 夯,，1委j)委10，至少存在同样多的服务器 S 可以被其他工作站访问) 。

现在假设在工作站和服务器之间直接连线少于 60 条。那么某个服务器将至多连接159/10|=5
工作站。(如果所有的服务器连接到至少 6 个工作站，那么将存在至少6. 10=60 条直接连线。)这
意味着剩下的 9 个服务器对于其他 10 个工作站同时访问不同的服务器就不够用了。因此，至少需
要 60 条直接连线，从而得到答案是 60 。                                    国

3.2.3 巧妙使用鲁巢原理

在鸽巢原理的许多有趣应用中，必须用某种巧妙的方式选择放人盒子的物体。下面将描述这
样的一些应用。

例10 在30天的一个月里，某棒球队一天至少打一场比赛，但至多打 45 场。证明一定有连
续的若干天内这个队恰好打了 14 场。

解 令ow是在这个月的第/天或第) 天之前所打的场数，则 wa ，a ，…，auw是不同正整数的
一个递增序列，其中 1]委w委45。从而 as 十14，a 十14，…，a十14 也是不同正整数的一个递增
序列，其中 15委ww 十14委59。

60 个正整数 ao ，a ，…，aa，aw十14，a十14，…，aus十14 全都小于等于 59。因此，由鲍巢
原理有两个正整数相等。因为整数 w ，Jj一1，2，…，30 都不相同，并且 w 十14，j 一1，2，，…,30
也不相同，一定存在下标 和/满足a,=w十14。这意味着从第 j十1 天到第;天恰好打了 14 场
比赛。                                                          国

例11 证明在不超过 2” 的任意 ”十1 个正整数中一定存在一个正整数被另一个正整数整除。

解 把"十1个整数a，o ，…，a, 中的每一个都写成 2 的圭与一个奇数的乘积。换句话说，
令四一2 9i，J一1，2，…，71十1，其中 卡) 是非负整数9， 是奇数。整数 qi，9g，…，9g,+l都是小于
22 的正奇数。因为只存在”个小于 2 的正奇数，由铝梨原理，q ，9; ，…， qt中必有两个相等。
于是，存在整数;和7 使得9一g%。令 9,与g% 的公共值是vg，那么w=249g，a 一2*9g。因而，若
入二后，则 a; 整除aj; 若太二二，则 ww 整除a,。                               可

巧妙地应用钢梨原理证明了在不同整数的序列中存在着确定长度的递增或递减子序列。 在给
出这个应用之前先回顾某些定义。假定 w ，a ，…，aw 是实数序列。它的一个子序列是形为 an ，
ary，…，aam的序列，其中 1<i<ia<…<z委N。因此一个子序列是从初始序列得到的序列， 按



--- 第 135 页 ---
第3章 计 数，

照原来的顺序选取初始序列的某些项， 也许要排除其他的项。如果这个序列的每一项都大于它前
面的项，就称为严格递增的，如果每一项都小于它前面的项，就称为严格递减的。
每个由妆十1 个不同实数构成的序列都包含一个长为 "十1 的严格递增子序列或严格

 

递减子序列。

在证明定理 3 之前先给出一个例子。

例12 序列8，11，9，1，4，6，12，10，5，7 包含 10 项。注意到 10一3十1，存在四个长
为4的递增子序列，即1，4，6，12; 1，4，6，?7; 1，4，6，10 和1，4，5，7。也存在一个长为4
的递减子序列，即 11，9，6，5。                           加

现在给出定理的证明。

证 令 ao， az，…，ane+il是 形十1 个不同实数的序列。 和序列中的每一项 有 联系着一个有序
对，即(2 ，叹)，其中必 是从ak 开始的最长的递增子序列的长度，且帮 是从ak 开始的最长的递减
子序列的长度。

假定没有长为 "十1 的递增或递减子序列。那么六 和ds 都是小于或等于”的正整数，&=1，
2，…， 允十1。因此，由乘积法则关于(，d)存在 到 个可能的有序对。根据鸽集原理，开十1 个
有序对中必有两个相等。换名话说，存在项 c, 和a,，s<t，使得站=i 和vd,=届。我们将证明这是

不可能的。由于序列的项是不同的，不是 ,一a, 就是a,>a。如果 ww<a，那么由于宗一二，那么
把 加到从,开始的递增子序列前面就构造出一个从a, 开始的长为志十1 的递增子序列。从而产
生秘盾。类似地，如果 a,>a ，可以证明 地 一定大于d, ，从而也产生了矛盾。              口

:3砚呈1 最后的例了说明了怎样把广义鸽生原理用于组合学的重要部分拉坦齐理论，它是以英
”     国数学家拉姆齐而命名的。一般地说，拉姆赛理论可用于处理集合元素的子集分配
问题。

例13 假定一组有6 个人，任两个人或者是朋友或者是敌人。证明在这组人中或存在 3 个人
彼此都是朋友 ，或存在 3 个人彼此都是敌人。

解 令A是6个人中的一人，组里其他 5 个人中至少有 3 个人是A 的朋友，或至少有 3 个人
是4的敌人。这可从广义铝梨原理得出，因为当 5 个物体分成两个集合时，其中的一个集合至少
有[「 5/21一3 个元素。若是前一种情况，假定 B、C 和刀是4A 的朋友。 如果这 3 个人中有 2 个人也
是朋友，那么这 2个人和人构成彼此是朋友的 3 人组。否则，B、C 和 构成彼此为敌人的3 人
组。对于后一种情况的证明，当 4 存在 3 个或更多的敌人时可以用类似的方法处理。        国

拉姆齐数 RCm，?z)(其中盖和是大于或等于 2 的正整数)表示: 假设晚会上每两个人是朋友
或者是敌人，那么在一个晚会上使得或者有 个人两两都是朋友，或者有个人两两都是敌人所
需要的最少人数。例 13 显示 RG3，3)委6。在一组 5 个人中，其中每两个人是朋友或是敌人，可能
没有 3 个人两两是朋友，也没有 3 个人两两是敌人，因此我们断言 R(3，3) 一6。

可以证明某些关于拉姆齐数的有用的性质，但是对于大多数拉姆齐数找到精确的值是困难的。
根据对称性可以证明 R(m，7?m) 一Ra，z) 。对于每个正整数 "2 我们也有R(2，z 一x(见练习
14)。只知道 9 个拉姆齐数 Rom，z(3生ms思的精确值，其中包括 R(4，4)一18。对许多其他的
拉姆齐数只知道界，包括 R5，5)在内，已知它满足 43和R(5，5)生49。有兴趣了解更多有关拉姆
齐数知识的读者可以参考[MiRo91]或LGrRoSp90] 。

练习
1 假定周末不排课，证明: 在任一组 6 门课中一定有 2 门课安排在同一天上课。
2. 抽层里有一打棕色的短袜和一打黑色的短袜，全都没有配好对。一个人在黑暗中随机取出一些袜子。
a)必须取多少只袜子才能保证至少有 2 只袜子是同色的?
b)必须取多少只袜子才能保证至少有 2 只袜子是黑色的?
3. 证明: 在任意 5 个整数中(不一定是连续的)有 2 个整数被 4 除的余数相等。
4. 设二是正整数。证明: 在任意一组 ”个连续的正整数中恰好有 工个被 ”整除。
5 在一个大学里每个学生来自 50 个州中的一个州，那么必须有多少个学生注册才能保证至少有 100 个学生

117



--- 第 136 页 ---
118。第3音 计  数

来自同一个州?
*6. 设(z，w，z)(i=1，2，3，4，5，6，7，8，9)是 rzyx 空间中一组具有整数坐标的 9 个不同的点。 证明:
至少有一对点的连线中点的坐标是整数。
. a)如果从前 8 个正整数中选 5个整数一定存在一对整数其和等于 9。
b)如果不是选 5 个而是选 4 个整数，a)的结论还为真吗?
. 从集合{L，2，3，4，5，6}中必须选多少个数才能保证其中至少有一对数之和等于7?
. 一个公司在仓库储存产品。仓库中的存储柜由它们的通道、在通道中的位置和货架来指定。整个仓库有 50
个通道，每个通道 85 个水平位置，每个位置 5 个货架。公司产品数至少是多少才能使得在同一个存储柜
中至少有 2 个产品?
10. 在 25 个学生的离散数学班中，学生有一年级的、二年级的或者三年级的。
a)证明:， 这个班至少有 9 个是一年级的，或至少有 9 个是二年级的，或至少有 9 个是三年级的。
b)证明: 这个班至少有 3 个是一年级的，或至少有 19 个是二年级的，或至少有 5 个是三年级的。
11. 构造 16 个正整数的序列，使得它没有 5 项的递增或递减子序列。
*12. 用伪码描述一个算法产生一个不同整数序列的最大递增或递减子序列。
13. 证明: 在任一组 10 个人中(其中任两个人或者是朋友或者是敌人)或存在 3 个人彼此都是朋友，或存在 4
个人彼此都是敌人; 并且存在 3 个人彼此是敌人，或存在4个人彼此是朋友 。
14. 证明: 如果是正整数，zr三2，那么拉姆齐数 R2，门等于 m。
15. 证明: 在加利福尼亚州(人口 3600 万)至少有 6 个人姓名的 3 个缩写字母相同并且他们生在一年的同一天
《但不一定是同一年) 。
16. 一个大学有 38 个不同的时间段来安排课程，如果有 677 门不同的课程，那么需要多少个不同的教室?
17. 一个计算机网络由 6 台计算机组成。每台计算机直接连接到零台或者更多的其他计算机。证明: 网络中
至少有两台计算机直接连接相同数目的其他计算机。
18. 把 100 台计算机连接到 20 台打印机上 ，为保证 20 台计算机可以直接访问 20 台不同的打印机，找出至少
需要多少条缆线。证明你的答案。
19. 一个摔跤选手是 75 小时之内的冠军。该选手一小时至少赛一场，但总共不超过 125 场。证明: 存在着连
续的若干个小时使得该选手恰好进行了 24 场比赛。
20. 如果了是从S 到了的函数，其中S和T是有穷集，并且和=「| S171了TI 那么证明至少存在 S的mm个
元素映射到 工的同一个值。即存在 S 中的元素5  ，9 ，… ，sn 使得fs)一sa)一…一sn)。
*21. 设工是无理数。证明: 对于某个不超过?的正整数j，在 jz 和到 jz 最近的整数之间的差的绝对值小于 1/m。
*22. 在这个问题中概述了基于广义钢梨原理的定理 3 的证明，使用的记号与教科书中的证明一样。
a)假定 关委mn，一1，2，…，严十1。使用广义铝梨原理证明: 存在 十1 个项 au ，ao ，…，an:; 满足
动| 一加 一人一，其中1过让天台二……一人+ 。
b证明: ab >au-;，7一1，2，…，n。[提示: 假定as 一au ,，证明这将推出 z 盖z.， 的矛盾。]
c)使用(a)和(b)证明， 如果没有长为 "十1 的递增子序列，那么一定有同样长的递减子序列 。

3.3 排列与组合

3.3.1 引言

许多计数问题都可以通过找到特定大小的集合中不同元素排列的不同方法数来得以解决，其
中这些元素的次序是有限制的。许多其他计数问题也可以通过从特定大小的集合元素中选择特定
数量元素的方法数来得以解决，其中这些元素的次序是不受限制的。例如，从 5 个学生中选出 3 个
学生站成一行照相，有多少种选择方法? 从4 个学生中选出 3 个学生组成一个委员会 ，有多少种选
择方法? 本节将开发一些方法来解决此类问题。
3.3.2 排列

先通过解决引言中提出的第一个问题以及一些其他相关问题开始本节内容。

例1 从5个学生中选出 3 个学生站成一行照相，有多少种选择方法? 让所有 5 个学生站成一
行照相，有多少种排列方法?

]

DC



--- 第 137 页 ---
第3章 计 数"119

可 解 ”首先注意: 选择学生时次序是有限制的。从 5 个学生中选择第一个学生站在一行

的第一个位置有 5 种方法。一旦这个学生被选定之后，则有 4 种方法选择第二个学生站

在一行的第二个位置。当第一和第二个学生都被选定之后，则有 3 种方法选择第三个学生站在一

行的第三个位置。根据科法原理，共有5，4。3=60 种方法从 5 个学生中选出 3 个学生站成一行来
照相。

为了排列所有 5 个学生站成一行来照相，选择第一个学生时有 5 种方法，选择第二个学生时有
4种方法，第三个学生时有 3 种方法，第四个学生时有 2 种方法，第五个学生时有 1 种方法。因
此，共有5，4。3。2，1=120 种方法让所有 5 个学生站成一行来照相。           力

例 1 阐述了不同个体有次序的排列是如何计数的。这也引出了几个术语。

集合中不同元素的排列，是对这些元素一种有序的安排。我们也对集合中某些元素的有序安
排感兴趣。 对一个集合中 ~个元素的有序安排称为一个r 排列 。

5 不同个体集合的一个排列是这些个体的一种有序安排。我们也对集合的某些元素的有
序安排感兴趣 。一个集合的-个元素的有序安排叫做r 排列。

例2 设S=({1，2，3}。3，1，2 是 S 的一个排列，3，2 是 S 的一个 2 排列。      于

一个元集的r 排列数记为 P(n，r) 。我们可以使用乘积法则求出 P(z，r) 。

例3 设S=(1，2，3}。S的2排列有如下有序安排，a, bj ay ci bp, ai b, ci cy ai 和c,8。因
此，具有 3 个元素的这个集合共有 6 个 2 排列。为了说明所有具有 3 个元素的集合都有6个 2排
列，注意到: 有 3 种方法选择排列中的第一个元素，有 2 种方法选择排列中的第二个元素，这是因
为第二个元素必须不同于第一个元素。根据乘法规则，有 P(3，2)一3 . 2一6。        国

下面利用乘法规则找出求 P(n，的一个公式，其中由和> 都是任意正整数，量 1过rr和nm。

三到硬 具有,个不同元素的集合的 - 排列数是

PPpyzr) 一2人(2一1)(2一2)…(2一>十1)

证 选择这个排列的第一个元素可以有? 种方法，因为集合中有 个元素。选择排列的第二个
元素有?一1 种方法，由于在使用了为第一个位置挑出的元素之后集合里还留下了 "一1 个元素。类
似地，选择第三个元素有 ”一2 种方法，依此类推，直到选择第 > 个元素恰好有”一(>一1) 一"一
r十] 种方法。因此，由乘积法则，存在

Mt一1])(人7一2)…和(7一rr十1)
个集合的-排列。                                  口

注意 只要7是一个非负整数，就有 P(n，0)一1，这是因为恰好有一种方法来排列 0 个
元素，也就是说，恰好有一个排列中没有元素，即空排列。

下面给出定理 1 的一个有用的推论。

 如果 和-都是整数，且 0受过”，则

       

证

?2

王(7 ，7r) 一 一一一一
GD
证 当z”和rr是整数，且1所r受时，由定理 1 有
Pnr) = nn一1)0n 一2)(n rr十1D一如

《天一六
-~           一_叫   二
因为只要 ”是非负整数，就有[2 一全一1，我们知道公式 PCn， 门= TI当r一0时也

成立。                                      口
由定理 1 知道，如果 ?是一个正整数的话，则有 PCz，z) =xl。用一些例子来说明这个结论。
例4 在进入竞赛的 100 个不同的人中有多少种方法选出一个一等奖得主、一个二等奖得主和

一个三等奖得主?

解 ”不管郧个人得哪个奖，选取 3 个得奖人的方法数是从 100 个元素的集合中有序选择 3 个元

素的方法数，即 100 个元素的集合的 3 排列数。因此，答案是



--- 第 138 页 ---
120 "第3章 计  数

P(100,3) 一 100。99。98 = 970 200                             国

例5 假定有8个赛跑运动员。第一名得到一枚金牌，第二名得到一枚银牌，第三名得到一枚
铜牌。如果比赛可能出现所有可能的结果，有多少种不同的颁奖方式?

解 ”颁奖方式就是 8 元素的集合的 3 排列数。因此存在 P(8，3)王8。7。6王336 种可能的颂
奖方式。                                     画

例6 假定一个女推销员要访问 8 个不同的城市。她的访问必须从某个指定的城市开始，但对
其他 7 个城市的访问可以按照任何次序进行。当访问这些城市时，这个女推销员可以有多少种可
能的次序?

解 ”由于第一个城市是确定的，而其他 7 个城市可以是任意的顺序，故城市之间可能的路径
数是 7 个元素的排列数。因此，这个女推销员有 7!1 一7。6.5。4。3。2.。1一5040 种方式选择她
的旅行。比如说，如果这个女推销员想要在城市中找出具有最短距离的路径，并且她对每一条可
能的路径计算总距离，那么她必须考虑 5040 条路径。                  面

例7 字母ABCDEFG瓦有多少种排列包含串ABC?

解 ”由于字母 ABC 必须成组出现，我们可以通过找 6 个对象，即组 ABC 和单个字母 D 、巨、
F、G和五的排列数得到答案。由于这 6 个对象可以按任何次序出现，因此，存在 6! =720 种

4BCDEFG万字母的排列，其中ABC 成组出现。                   里
3.3.3 组合

现在把注意力转到无序选择个体的计数上来。我们先通过解决本章引言中提出的第二个问题
开始本节内容。

例8 从4个学生中选出 3 个学生组成一个委员会，有多少种选择方法?

解 ”为了回答这个问题，只需从含有4 个学生的集合中找到具有 3 个元素的子集的个数。我们
知道，一共有4 个这样的子集，每个子集中都有一个不同的学生，因为选择 4 个学生等价于从 4 个
学生中选出一个人离开这个集合。这就意味着有 4 种方法选择 3 个学生组成一个委员会 ，其中这些
被学生的次序是无关紧要的。                             硬

例 8 阐明了这样一个事实: 许多计数问题都可以通过从具有 = 个元素的集合中求得特定大小
的子集的个数来得以解决， 其中二是一个正整数。

5 集合元素的一个~组合是从这个集合无序选取的 ~ 个元素。于是，简单地说，一个 ~组
“ 合是这个集合的一 一个-个元素的子集。
例9 设S是集合(1，2，3，4}，那么(1，3，4}是 S 的一个 3 组合。                国

具有个不同元素集合的> 组合数记为 CCn，m)。注意 CCn，思也记作(")}并且称为二项式系

数。在 3.4节我们将学习这个记号。

例10 因为fg，b，c，d的2组合是te，分，{a，c}，{a，d，{9，c) ，{5，d中和{c，d)6个
子集，有 C(4，2)=6。                                              图

可以用关于集合的 -排列数的公式确定半元素的集合的>组合数。为此只需注意到集合的>排
列可以按下述方法得到: 首先构成集合的组合，接着排列这些组合中的元素。下面的定理给出了
CCz，站的值，它的证明就是基于这个观察。

定   设 ”是正整数，~是满足0委r委* 的整数，z 元素的集合的> 组合数等于

7
CCnayr) 一    FT

证  可以如下得到这个集合的 r排列。先构成集合的 CCz，r)个 >组合，然后以 PCz，r)种方
式排序每个~组合中的元素，这可以用 P(r，)种方式来做。因此，
卫(myr) 一 CCrr) 。PCryr)

  

怎、

 

2 人

 

这就推出



--- 第 139 页 ---
第3童 计  数。，121

，     1一1!      好|
Cn 一 到2全 轩 了 ”ri一站1                    品

尽管定理 2 中的公式很清楚，但对很大的2和r而言，这个公式并没有什么用处。其原因是:
在实际计算中，只能对较小的整数才能求得阶乘的准确值，而且当用浮点数来计算时，从定理 2
的公式中得到的结果可能并不是一个整数值。因此，当计算 C(a，r)时，首先注意到: 如果从定理
2 的 CCz，)计算公式的分子和分母中都消去(一”)! 后，可以得到

Con,r) 二    72!    _ 一1)》(一和十1)
rn一关!         7

因此，为了计算 CCz，r) ，可以从分子和分母中消去分母中所有较大的因式，再把分子中所有
没有消去的项相乘 ，然后再除以分母中较小的因式。[如果是用手而不是用机器计算的话，有必要
再在 (一1)…("一r十1)和 r! 中消去公因数。]注意: 许多计算器中都有一个关于计算 CCn*，r)内
置函数，这些函数可以对相对较小的上 和r求得结果，许多计算机程序也可以用来求 CCz，r)的
值。[这些函数可能会称为 chose(n, &)或 binoma(ry R) 。]

例 11 说明了当&相对于"” 较小时，以及当& 接近于 时，如何计算 CCz*，r) 。该例子也给出了
组合数 Cn，)的一个关键的恒等式。

例11 从一副 52 张标准扑克牌中选出 5 张，共有多少种不同方法? 从一副 52 张标准扑克牌
中选出 47 张，又有多少种不同方法?

解 ”因为从52张牌中选出5张,这5张牌的次序不受限制，所以不同的选择方法数共有

_ 521
C(52,5) 一 547T

为了计算 C(52，5) ，首先在分子和分母中都消去 471，得

_ 52。51。50。49 。48
C(52,5) 一一

上述表达式还可以化简: 首先将分子中的 50 除以分母中的因子 5，则在分子中得到因子 10，
然后将分子中的 48 除以分母中的因子4，则在分子中得到因子 12，再将分子中的 51 除以分母中的
因子 3，则在分子中得到因子 17，最后，将分子中的 52 除以分母中的因子 2，在分子中得到因子
26 。于是得到

C(52,5) 一26 .17 .10.。49。12一2598960

因此，从一副 52 张标准扑克牌中选出 5 张，共有 2 598 960 种不同方法。

注意: 从一副 52 张标准扑克牌中选出 47 张 ，不同选择方法数为
521
4715!

不用再计算这个值了，因为 C052，57)=C(52，5) 。(因为在计算它们的公式中，只有分母中
5! 和471! 的次序是不同的.)因此有:， 从一副 52 张标准扑克牌中选出 47 张，共有 2 598 960 种不
同方法。                                           、             国

在例 11 中，我们看到 C(52，5) 一C(52，47) 。这是引理 2 中关于 ~组合数一个有用的人恒等式
的一个特例。

 设上”和 是满足r委”的非负整数，那么 Ca，m)一CCz，n一六)。

证 由定理 2 得到

C(52,47) 一

一    1
CCnyr) 一 FT

7              !
Cn一站一 (一ri[z一(一 CT
因此，C(z，7)王CCOz，mn一r)。                                          口
通过证明在推论 1 的等式两边使用了不同的理由对同样的个体进行计数，  也可以证明推论 1 。
我们在定义 1 描述了这种重要的证明类型。



--- 第 140 页 ---
122 "第3章 计  数

 组合证明是一种证明，在这个证明中使用计数的论述而不使用某些其他的方法如代
数技巧来证明一个定理。

可以使用组合证明证出许多涉及二项式系数的恒等式。如果可以显示一个恒等式两边通过不
同的方法计数了同样的元素，那么对这个恒等式就可以使用组合证明。现在提供一个推论 1 的组
合证明。

证 设S是”个元素的集合。S 的每个具有 -~ 个元素的子集 4 对应于一个具有7一*个元素的
子集，即有，因此 CC(mn，门王CCn，m一r)。                                口
例 12 有多少种方式从 10 个选手的网球队中选择 5 个选手外出参加在另一个学校的比赛?

四  解 ”答案由 10 元素集合的 5 组合数给出。根据定理 2，这个组合数是

10!
C(10,5) 一 57 一 252                      时

例13 一组 30 个人被培训作为宇航员去完成首次登陆火星的任务。有多少种方式选出6 个人
的小组来完成这个任务(假设所有的小组成员有同样的工作)?

解 ”因为不考虑这些人被选的次序，从 30 个人中选 6 个人的小组的方式数是 30 元素集合的6
组合数。根据定理 2，这种组合数是

1    日  和  w  。  s。 25
C(30,6) 一 一 下2 2 25 一 593775                国

例14 有多少个长为m的二进制串恰好包含~个 1?

解 在长为”的二进制串中-~个 1 的位置构成了集合(1I，2，…，丰的>组合。因此，有
CCn，门个长为的二进制串恰好包含r 个 1。                                              国

例15 为开发学校的离散数学课程要选出一个委员会。如果数学系有 9 个教师，计算机科学
系有 11 个教师。而这个委员会要由 3 个数学系的教师和 4 个计算机科学系的教师组成,那么有多
少种选择方式?

解 由乘积法则，答案是 9 元素集合的 3 组合数与 11 元素集合的4组合数之积。根据定理 2，
选择这个委员会的方式数是

! 11

9      !
C(9,3) "Cl1,4) 一5017一84 330一27720               面

练习
1. 列出fae，6，c}的所有排列。
2. {a，b，c，d，e，厂，g}有多少个排列以 a 结尾?
3. 求出下面的每个值

a)P(6，3)         bP(6，5)         c)P(8，1)

d)P(8，5)         e)P(8，8)         人P(10，9)
. 求出 9 元素集合的 5 排列数。
- 在一场 12 匹马的赛马中，如果所有的比赛结果都是可能的，对于第-一名、第二名和第三名有多少种可

cn 心

能性?
6. 多少个 10 位二进制串包含
a)恰好4个1?       b)至多4个1?       c)至少4个1?     d)0 的个数和 1 的个数相等?

7. 一个组有?个务士和?个女士。如果把他们男女相间地排成一排，有多少种方式?
8. 有多少种不同的方式从英语字母表中选择 5 个字母?
9. 一个 100 个元素的集合有多少个子集包含的元素多于 2 个?
10. 一个硬币被邱 10 次，每次可能出现头像或者非头像。有多少种可能的结果
a)包含各种不同的情况?                    b)包含恰好 2 个头像?
c)至多有 3 个不是头像?                    d)头像和非头像的数目相等?
11. 字母 ABCDEFG 有多少个排列包含
a)串 BCD?             b)串 CFGA?            c)种 BA和GF?      d)串 ABC 和DEFE?



--- 第 141 页 ---
第3章 计   数。123

e)串ABC 和CDE? 串CBA和BED?
12. 有多少种方式使得 8 个男士和 5 个女士站成一排并且没有两个女士彼此相邻? [提示，先放男士，然后考 、
虑女士可能的位置.]

13. 把编号为 1，2，…，100 的 100 张票卖给 100 个不同的人来抽奖。有 4 项不同的奖，包括1 项大奖(到塔
希提岛旅游) 。如果满足下面的条件，有多少种不同的抽奖方式?
a)没有限制。

b)拿 47 号票的人赢了大奖。
c)拿 47 号票的人赢了一项奖。
d)拿 47 号票的人没赢奖。
e)拿 19 和 47 号票的人都赢了奖。
f拿 19、47 和 73 号票的人都赢了奖。
8g)拿 19、47、?73 和 97 号票的人都赢了奖。
hb)拿19、47、73 和 97 号票的人都没赢奖。
iD拿 19、47、73 或 97 号票的人赢了大奖。
j)拿 19 和 47 号票的人赢了奖，但拿 73 和 97 号票的人没高奖。

14. 一个俱乐部有 25 个成员。
a)有多少种方式从中选择 4 个人作为董事会成员。
b)有多少种方式从中选出俱乐部的主席、副主席、书记和司库?         ，

*15, 用不超过 100 的正整数构成 4 排列，其中有多少个排列包含 3 个连续的整数 k，k十1，、k十2?

a)这里的连续指按照整数通常的顺序， 并且这些连续整数可能被排列中的其他整数分开。
b)这里的连续不但指整数是连续的，而且它们在排列中的位置也是连续的。

16, 英语字母表中包含 21 个辅音和 5 个元音。由英语字母表的6 个小写字母可构成多少字符串使得它们包含
a)恰好 1 个元音?    b)怡好 2 个元音?     c)至少 I 个元音?   d)至少 2 个元音?

17. 假定某个系包含 10 名男士和15 名女士。有多少种方式组成一个6 人委员会旦使得它含有相同数量的男
士和女士?

18. 有多少个二进制串恰好包含 8 个0 和 10 个 1，如果每个0 后面紧跟着 1个 1?

19. 有多少个 10 位二进制串包含至少 3 个1 和至少3个0?

20. 有多少种方式用 3 个字母后眼 3 个数字组成汽车牌照并且没有字母和数字出现 2 次?

21. 如果允许出现并列名次，3 匹马参加马赛有多少种结果?(注，  可以 2匹或 3 匹马并列。)

“22. 有 6 名运动员参加百米赛跑。如果人允许并列名次， 有多少种方式授予 3 块奖牌? 〈跑得最快的运动员得金

牌，恰好只被一个运动员超过的运动员得银牌，丛好被 2 个运动员超过的运动员得铜牌 。)

3.4 二项式系数

正如在 3 3 节谈到的，具有个元素的集合的~ 组合数带常记作{") ，由于这些数出现在二项

式的宪(e十6)" 的展开式中作为系数，因此这些数叫做二项式系数。 我们将讨论二项式定理，这个
定理将二项式的寡表示成与二项式系数有关的项之和。 我们将用组合证明来证明这个定理。我们
也将显示怎样用组合证明来建立某些人恒等式， 它们是表示二项式系数之间关系的许多不同全等式
中的一部分。

3.4.1 二项式定理
1 一项式定理给出了二项式才的展开式的系数。一个二项式只不过是两项的和，例如
站 (这些项可以是常数与变量的积， 但这里先不考虑。)例 工说明了为什么这个定理
成立 。
例1 《〈《z十y); 的展开式可以使用组合推理而不是用三个项的乘法得到。 当(z十y)3一(z十y)
(z十y)(z十y)被展开时， 把所有由第一个和的一项、 第二个和的一项与第三个和的一项产生的乘
积加起来。从而出现了形如 产、xzzy、 zy 和y 的项。为得到形如 zm 的项， 在每个和里必须选择



--- 第 142 页 ---
124 "第3章 计 数

一个zx，只有一种方式能做到这一点。因此，乘积中 二 项的系数是 1。为得到形如二>y 的项，必须
从三个和中的两个和里选 z(而因此在另一个和里选 7) 。于是，这种项的个数是三个个体的 2组合

数， 即(?): 类似地，形如 zy 项的个数是三个和中选一个来提供 z 的方式数(而另两个和中都要

选)，有(] )种方式能够做到这一点。最后，得到 y 的唯一方式是三个和的每一个都选择 y，愉

好有一种方式能够做到这一点。因此得到
(十?7一(z十y)(z十JJ)(z十们一(rr十zy十十罗)Cz十轨
一 TZZT十Zry十2ZyT十zyy十yz十yy十yyz十yy
一己十3zy十3zyz 十六                               国
现在叙述二项式定理。
 二项式定理 设z和>是变量，”是非负整数，那么
/7
(十 y) 一    “1
并十了y   ()  了
入  月   拉  用一1    婚  门一2 ，2       闪    严一】   允  [
(jz人(jz ja人
证 这里给出定理的组合证明。当乘积被展开时其中的项都是下述形式,zy (ji一0，1，
2，…，7) 。为计数形如 zy 的项数，观察到必须从个和中选n一/ 个zx(从而乘积中其他的 ;)

个项都是>)才能得到这种项。因此，z" 2" 的系数是(，”) ) ，它等于( ") ，定理得证。      口

一7
例 2一例 4 说明了二项式定理的应用。
例2 (z二yy) 的展开式是什么?
可玖，，解”由二项式定理得到
                      4
(工十 细 一    人
罗0

JA昌

4     4      4       4      4

=- (ojz+(0jzey+人(jzy+(ja+()y

一忆十4z3y十6妇史十4zy3 十注                           国
例3 在(z十?和关的展开式中 z22的系数是什么?
解”由二项式定理得到这个系数是
(各)=  251
13)/ ”131121
例4 在(2z一3?)的展开式中 xz2 因的系数是什么?
解 ”首先注意到这个表达式等于(2z十(一3y))2。由二项式定理，我们有

(2z十(一32)2 一 》) (7 )eoec 3

4一0

因此，当;7一13 时得到展开式中 z荆六的系数，即
(于)22 (一35)9 =一-258 2n3n                 国
13           131121

我们可以用二项式定理证明某些有用的恒等式。正如推论1]、2 和 3 所示。

入二有 设 ”为非负整数，那么

一5200 300                                       国

 

 

号OO)-*

二一0

证 用二项式定理，令 z=1 和 y=1，我们有



--- 第 143 页 ---
第3章 计   数。125

2" 一(1十1)” 一 (2 全

这正是所需要的结果。                                                口
推论 1 也有一个好的组合证明，我们现在给出这个证明。
证 一个”元素集合有 2" 个不同的子集。每个子集有 0 个元素，1 个元素，2 个元素，…，?

个元素。具有 0 个元素的子集有(0 )}个，1 个元素的子集有(1 )个，2 个元素的子集有(2个，…，

个元素的子集有(")个。于是

计数了 元素集合的子集总数。这证明了

设 是正整数，那么

 

立一(= 0
证 由二项式定理得出
0一0" = ((一D)二1) = 袜()c 1)*1 一 (一 1
从而证明了推论 。                                                         口
注意 推论2 推出
(oj+ (zj+ (+一= (+(s)+(3)+…

设 ”是非负整数，那么

 

c  二 天 __  理
 2 (= 3
证 注意到这个公式的左边是二项式定理提供的对(1十2)" 的展开式。因此，由二项式定理可
以看出

G+2) = 六 (= 袜()>

二一人                    二一0

因此
咏0)-*

3. 4.2 帕斯卡恒等式和三角形
二项式系数满足许多不同的恒等式。现在我们介绍其中最重要的一些恒等式。
王到到 查斯卡恒等式 设”和是满足z&的正整数，那么有

()(人人
证 假定工是包含”十1 个元素的集合。令a 是工的一个元素且S=T一{a} 。注意到工的包含

4个元素的子集有({”， )个。然而了的含4 个元素的子集或者包含 和 S 中的人-1 个元素，或者

不包含 。 但包含 S 中的4 个元素。由于 S 的一1 元子集有{(，”| )个，故了含a 在内的人元子集有



--- 第 144 页 ---
126 "第3章 计   数

(2 )个。又由于 S 的和元子集有(，}个，故工的不含“ 的上元子集有(，}个。从而得到
()-(人人                  D

注意”这里给出了帕斯卡恒等式的一个组合证明。也可以从关于(“)的公式通过代数推导
来证明这个恒等式(见节末的练习 10) 。

注意”对所有整数mn，可以用帖斯卡恒等式和初始条件(" 一 ("}一1 适归地定义二项式
系数。这些递归定义用于计算二项式系数，因为使用这些递归定义只需要整数加法。
帕斯卡恒等式是二项式系数以三角形表示的几何排列的基础，如图 3-6 所示。

(9)
(GD 0)          |
(G) (G) G)    本    aa
GD DO
(人 (DG (G) (9)        |
GO) G)G) 0) 0)       sio5
(GD (9 (0 (9 (0009 (9      6
GD) GOG)G) GOD GO)     aa
GCCGOGOCGOCGCGO CD) (GD   6
a)               b)

图 3-6 ”帕斯卡三角形
这个三角形的第对行由二项式系数
(oa
下

组成。这个三角形叫做帕斯卡三角形。帕斯卡恒等式证明，当这个三角形中两个相邻的二项式系
数相加时，就产生了下一行在这两个系数之间的二项式系数。

3.4.3 其他的二项式系数恒等式
我们从众多二项式系数恒等式中选两个恒等式，用它们的组合证明来作为本节的结束。
 范德蒙德恒等式 设、n 和-是非负整数，其中~不超过z 或mw，那么

2 十郊   772   了2
人)=袜( (4
注意 这个恒等式是由 18 世纪的数学家亚历山大-舍费尔。范德蒙德发现的。

证 假定在第一集合中有 记个项，第二集合中有?个项。从这两个集合的并集中取 ~ 个元素

的方式数是(”，”) 。从并集中取 个元素的另一种方式是先从第一个集合中取上个元素，接着从



--- 第 145 页 ---
第3章 计 数"127

第二个集合中取 r一上个元素，其中大是满足 0入k<r 的整数。由乘积法则,这可以用
(2 ) (，”，)种方式完成。所以，从这个并集中选取 -个元素的总方式数等于

只
=)
这就证明了范德昆德恒等式。                             口
推论 4 来自范德蒙德恒等式。
BE 如果 ,是一个非负整数，那么
2  ，
(OO)=立(人
证“在范德蒙德恒等式中令 m一一”得到
(站=-立(。 (=袜()
最后一步的相等是使用了恒等式{.)一(，”,)。                      口
我们可以通过计数具有不同性质的二进制串来证明组合恒等式，如定理4 的证明所示。
5E弹外 设 和，是非负整数，和zx，那么
+1\ = 1
(= (-)
元十1
r十1

2

2

证“我们使用组合证明。由 3. 3 节例 14，左边{

进制串。

我们证明，在具有 r十1个 1 的二进制串中，通过考虑与最后一个 1 可能位置的相关情况，等
式右边计数了同样的对象。这最后一个 1 一定出现在位置 "十1，r十2，…，或者 an十1。此外，如
果最后一个 1 出现在第位，那么一定有个 1 出现在前&一1 位。因此，根据 3. 3 节例 14，这样

的二进制昌有({”，，)}个，对所有的4求和，其中 r十1<A<n+1，我们发现有

之( ，)-阅

个?位二进制串恰含有-十1个 1。(注意，最后一步是改变变量 )=A一1 的结果.。)由于左边和右边
计数了同样的对象，因此相等。这就完成了证明。                            口

练习
. 求(z十?) 的展开式
a)使用组合理由，如例 1 所示。                b)使用二项式定理。
. 求(z十3) 的展开式。
. 在(z十y)9的展开式中有多少个项?
. 在(2一z)中字的系数是什么?
. 在(2z一3y)2中 zi ye的系数是什么?
.给出一个关于(疡一1/z)i的展开式中 己系数的公式，其中& 是一个整数。

7. 内斯卡三角形中包含二项式系数( ，] (0<k<9)的行是什么?

)计数了 n十1 位长包含了 r十1个工的二

im

nn 和 Co Co

贰

Cn

8. 证明，对一切正整数，和A(0<A<m)， (中<2。

539. 证明， 如果上和 是整数，其中14<n，那么(，]<<o/20 。



--- 第 146 页 ---
128。第3章 计 数

10.

5 1，

关14.

#15，

*20.

使用关于|{ ”] 的公式证明帕斯卡恒等式。
一1
证明，如果， 和A 是整数，1<t<n, 那么t(,)} -za(， 1)。
a)使用组合证明。[提示: 证明恒等式两边计数了从一个 元素集合中选上个元素，然后从这个子集中再
选 1 个元素的方法.]

b)使用基于 3. 3 节定理 2 给出的{ …)公式的代数证明。

. 证明。 如果，和上 是正整数，那么(”， )} = Cn+D(，”，)A。

使用这个恒等式构造一个二项式系数的归纳的定义。

. 设， 是正整数， 证明{ 2 )+()=( /2，

好       7十1

证明 六 (” = (7 ) .其中和是正整数。

二本全

a)用组合论证                        b)用帕斯卡恒等式
给出关于 >人(四)= n2e-1 的组合证明。[提示;， 以两种方法计数选择一个委员会然后选择这个委员会令

到一上

导的方式数。]

. 证明: 一个非空集合具有奇数个元素的子集数与具有偶数个元素的子集数相等。
,. 在这个练习里，我们将要计数 zy 平面上在原点和(mm，m)点之间的路径数。这些路径由一系列步构成，

其中每一步是向右或者向上移动一个单位(不允许向左或向下移动)。下图给出了两条这种从(0，0)到
(5，3)的路径(用粗线标识) 。
(5.3)                         (5.3)

革E生二

{0.0)                        (0.0)
a)证明上述每条这种类型的路径可以用由六个0 和) 个 1 组成的二进制串表示，其中 0 表示向右移动一
个单位，1 表示向上移动一个单位。

b)从 中)推晰存在着( ”，”)条所求类理的路径。

于

.使用练习 17 证明定理 4。[提示: 计数练习 17 所描述的那种 ”步路径数。每条路径必须在一个(一上，A)

点结束，其中人=0，1，2，…，m。]

. 使用练习 17 证明练习 14 中的恒等式。[提示: 首先观察到从(0，0)到(nm十1，r)的路径数等于

。其次，按照开始向上恰好走个单位分别计数每一类路径，其中 上一0，1，2，…，r，然后

对结果求和。]

如果一个序列的前若干项如下列出，对于它的第 ”项确定一个与二项式系数有关的公式。[提示: 对帕斯
卡三角形的观察有助于问题的求解。虽然以这一组给定的项作为开始的序列有无数多个，但下面列出的
每个序列都是所求的那种序列的开始.]

a)1，3，6，10，15，21，28，36，45，55， 66，…

b)1，4，10，20，35，56，84，120，165，220，…

c)1，2，6，20，70，252，924，3432，12 870，48 620，…

d)1，1，2，3，6，10，20，35，70，126 ，…

e)1]，1，1、3，1，5，15，35，1，9，

D1，3，15，84、495， 3003，18 564、116 280，735 471，4 686 825，…

7十1十和
( ，))



--- 第 147 页 ---
第3章 计 数*129

3.5 排列与组合的推广

3.5.1 引言
5: 在许多计数问题里元素可以被重复使用。例如，一个字母或一个数字可以在一个车牌

”中多次使用。当选一打多纳圈时，每种可以被重复地选择。这与本章前面讨论的计数
问题形成对照，因为在那里我们只考虑每个项至多可以使用一次的排列和组合。在这一节我们将
介绍怎样求解元素可以多次使用的计数问题。

还有，某些计数问题涉及不可区别的元素。例如，为计数单词 SUCCESS 的字母可能被重新
排列的方式数，必须考虑相同字母的放置。这又与前面讨论的所有元素都被认为是不同的计数问
题大相径庭。在这一节，我们将描述怎样求解某些元素是不可区别的计数问题。

此外，这一节也将解释怎样求解另一类重要的计数问题，即计数把不同的元素放人盒子的方
法数的问题。这种问题的一个例子是把扑克牌发给 4 个玩牌人的不同的方式数。

把在本章前面描述的方法与这一节引入的方法一起考虑，就构成一个求解广泛的计数问题的
有用的工具箱。当把第 4 章讨论的新方法再加到这个库里，你将能够求解在广泛的研究领域中产
生的大多数计数问题。

3.5.2 有重复的排列

当元素允许重复时，使用乘积法则可以很容易地计数排列数，正如例 1 所示。

例1 用英文字母可以构成多少个~位字符串?

解 因为有26 个字母，且每个字母可以被重复使用，由乘积法则可以看出存在 26" 个 ~ 位字
符串。                                      恒

定理 1 给出了当人允许重复时一个半元素集合的~ 排列数。

  具有7个物体的集合允许重复的~ 排列数是六 。

证 当人允许重复时，在 -排列中对-个位置中的每个位置有? 种方式选择集合的元素，因为对
每个选择，所有?个物体都是有效的。因此，由乘积法则，当允许重复时存在产个>排列。  口

3.5.3 有重复的组合

考虑下面元素允许重复的组合的实例。

例2 从包含苹果、杰子和梨的碗里选 4 个水果。如果选择水果的顺序无关，且只关心水果的
类型而不管是该类型的哪一个水果， 那么当碗中每类水果至少有4 个时有多少种选法?

解 ”为了求解这个问题，我们列出选择水果的所有可能的方式。共有 15 种方式:

4个苹果          4个橙子          4 个犁

3 个苹果，1 个橙子       3 个昔果，1 个梨    3 个栖子，1 个芋果

3 个楼子，!1 个梨         3 个弄，1 个苹果         3 个犁，1 个柚子

2 个苹果，2 个橙子     2 个苹果，2 个梨      2 个梭子，2 个梨

2 个苹果，1 个栖子，1 个梨 ”2个橙子，1 个苹果，1个梨 ”2个梨，!1 个苹果，1 个橙子
这个解是从 3 个元素的集合{苹果，橙子，梨}中人允许重复的4组合数。                 国

为求解这种类型的更复杂的计数问题，我们需要计数一个 元素集合的-~组合的一般方法。在
例 3 中,我们将给出这一方法。

例3 从包含 1 美元、2 美元、5 美元、10 美元、20 美元、50 美元及 100 美元的钱袋中选 5 张
纸币，有多少种方式? 假定不管纸币被选的次序，同种币值的纸币都是不加区别的，并且至少每
种纸币有5张。

解 ”因为纸币被选的次序是无关的且 7 种不同类型的纸币都可以选 5 次,问题涉及的是计数
从?7 个元素的集合中允许重复的5 组合数。列出所有的可能性将是乏味的，因为存在许多的解。相
反，我们将给出一种方法来计数允许重复的组合数。



--- 第 148 页 ---
130。第3章 计   数

假设一个零钱盒子有 7 个隔间，每个保存一种纸币，如图 3-7 所示。这些隔间被 6 块隔板分
开，正如图中所画的。每选择 1 张纸币就在相应的隔间里放置 1 个标记。图 3-8 针对选择 5 张纸币
的 3 种不同方式给出了这种对应，其中的竖线表示 6 个隔板，星表示 5 张纸币。

100美元 ”50美元 ”20美元 “10美元 ”5美元 ”2美元 1美元
图 3-7 有?7种类型纸币的零钱盒

|    后
加   苹 10051109**

图 | :slxsllxl|

 

 

 

 

三    -~    一一

| 目 日

四 局 局蚁 *||lx**ll*lx
]   ES

上   |  |   | _

图 3-8 选择 5 张纸币的方式实例

 

 

 

 

选择 5 张纸币的方法数对应了安排6 条竖线和5 颗星的方法数。因此，选择 5 张纸币的方法数
就是从 11 个可能的位置选 5 颗星位置的方法数。这对应了从含 11 个物体的集合中无序地选择 5 个
物体的方法数，可以有 C(11，5)种方式。因此存在

1
C(11,5) 一 下 一 462
种方式从有 7 类纸币的袋中选择 5 张纸币。                                     国
定理 2 将这个讨论一般化。
! 个元素的集合中允许重复的>组合有C(n十r一1，r)王CC十r一1，m一1)个。

证 ”当允许重复时 王元素集合的每个~ 组合可以用=”一1 条竖线和r颗星的表表示。这”一1条
竖线用来标记 个不同的单元。每当集合的第;个元素出现在组合中，第 ; 个单元就包含一颗星。
例如，4 元素集合的一个6组合用3 条竖线和 6 颗星来表示。这里

闪闪 | 关 || 关关亲
代表了恰包含 2 个第一元素、1 个第二元素、0 个第三元素和 3 个第四元素的组合。

正如我们已经看到的，包含 "一1 条竖线和~盯星的每一个不同的表对应了”元素集合的允许
重复的一个> 组合。这种表的个数是 C(n一1十r，r) ，因为每个表对应了从包含>晒星和z一1 条竖
线的 *一1十>个位置中取 r 个位置来放r 颗星的一种选择。这种表的个数还等于 C(n一1十r，
?一1)，因为每个表对应于取 "一1 个位置来放 ”一1 条竖线的一种选择。                         口

例4至例6 说明怎样使用定理 2。

 



--- 第 149 页 ---
第3章 计 数*"131

…， 例4 设一家甜点店有4 种不同类型的甜点，那么从中选 6 块甜点有多少种不同的方
式? 假定只关心甜点的类型 ，而不管是哪一块甜点或者选择的次序。
解 ”选择6 块甜点的方式数是具有 4 类元素集合的6组合数。由定理 2 这等于 C(4十6一1，6) 一
C(9，6) 。由于
9"8.7
2 。3
因此，选择 6 块甜点的不同方式数有 84 种。.                                 国
定理 2 也可以用于求给定线性方程的整数解的个数。这可以由例 5 来说明。
例5 方程

C(9,6) 一C(9,3) 一           84

 

Zi 十zz十zs一11
有多少个解? 其中 z、z 和六 是非负整数。
解 ”为计数解的个数，注意到一个解对应了从 3 元素集合中选 11 个元素的方式，以使得 z 选
自第一类，z* 选自第二类，zs 选自第三类。因此，解的个数等于 3 元素集合允许重复的 11 组合
数。由定理 2 存在解的个数为

C(G3+1一1,11) = CG3,11) = Cdl3,2) = 也" 12 -

1 2

当对变元加上限制时，也可以求出这个方程的解的个数。例如，当变元是满足 z 三1、z, 二2
且 za3 的整数时，也可以求出这个方程的解的个数。满足此限制的方程的解对应于 11 个项的选
择，使得项 zx, 取自第一类，项 zx 取自第二类，项 m 取自第三类，并且第一类元素至少取 1 个，
第二类元素至少取 2 个，第三类元素至少取 3 个。因此，先选 1 个第一类的元素，2 个第二类的元
素，3 个第三类的元素; 然后再多选 5 个元素。由定理2，可以用

CC二5一1,5) = C(7,5) = C(7,2) 一 - - = 21

种方式做到。于是，对给定限制的方程存在 21 个解。                           国

例 6 显示了怎样计数在确定变量值时产生的允许重复的组合数，当每次通过某一类确定的符
套循环时，这个变量的值都会增加。

例6 在下面的擅码被执行后到的值是什么?

78

 

& :一0
for ii :一1] to 7
for ;1 :一1 to hh

for i。 :一1] to ii，
R :一&十1

 

解 &的初值是0，且对于满足
1 委吕和胺四-过委站之7

的整数序列 ，并，…，zi，每次通过这个嵌套循环时&的值就加 1。这种整数序列的个数是从{1，
2，…，人好中允许重复地选择 mm个整数的方式数。(为看到这一点只需注意到一旦这个整数序列选
定以后，如果我们按非降顺序排列序列中的整数，这就唯一地确定了一组对闷，志_ ,，，…，i 的赋
值。相反，每个这样的赋值对应了一个唯一的无序集合.)所以由定理 2 得出在这个代码被执行后
&一C(z十加一1，zz) 。                                                图

从一个”元素集合中，允许重复和不允许重复地选择 >个元素，其有序或无序的选择数的公式
在表 3-1 给出。



--- 第 150 页 ---
132。第3章 计   数

甫3-1 允许和不允许重复的组合与排列

 

3.5.4 具有不可区别物体的集合的排列

在计数问题中某些元素可能是没有区别的。在这种情况下必须小心避免重复计数。考虑例 7。

Rs 例7 重新排序单词 SUCCESS 中的字母能构成多少个不同的串?

解 ”因为SUCCESS 中的某些字母是重复的，答案并不是 7 个字母的排列数。这个单词

包含3个S、2个C、1个U和1个瑟。为确定重新排序单词中的字母能构成多少个不同的串，首
先，注意到3个S可以用C(7，3)种不同的方式放在 7 个位置中，剩下 4个空位。然后可以用
C(4，2)种方式放2个C，留下 2 个空位。又可以用C(2，1)种方式放U，留下 1个空位。因此，放
已只有C(1，1)种方式。从而，由乘积法则，产生的不同的串数是

 

、        4 2 1
C(7,3)C(4,2)C(2,1)C(1,1)一 3 。 2121 。 iT 。 TI01
_ 7!
ng
一 420                       男

使用和例 7 同样的推理，能够证明定理 3。

  设类型 1 的相同的物体有 mm 个，类型 2 的相同的物体有 m 个，…，类型上的相同的
物体有m: 个，那么?个物体的不同排列数是

好1
172 1

证”为确定排列数，首先注意到可以用 CCnz，m )种方式在个位置中放类型 1 的加 个物体，
剩下 ”一郊 个空位。然后用 CC一站 ，7a )种方式放类型 2 的物体，剩下 2一于一半 个空位。继续放
类型 3 的物体， 0 类型 娄一1 的物体， 直到最后可用 CC一人一寻一光一Mi， mx种方式放类型
的物体。因此由乘积法则，不同排列的总数是

CC DC一7 772一7一光一Mo )
__    7       (7一7 )1    (一四一人一mi
7 1人一四) 21一7一ma)!        mr 101
一    721
7 1 1                                           口

3.5.5 把物体放入盒子
5: 许多计数问题都可以通过枚举把不同物体放人不同盒子的方式数来解决(这些被放人盒
” ”了竹的物体的次序是无关紧要的) 。这些物体既可以是可辨别的，即每个都是不同的，也
可以是不可辨别的，即认为每个都是相同的。可辨别的物体有时称为是有标号的，而不可辨别的
物体则称为是没有标号的。类似地，盒子也可以是可辨别的，即每个盒子都不同，也可以是不可
拓别的，即每个都相同。可辨别的盒子通常称为是有标号的，而不可辨别的盒子则称为是没有标
号的。当利用把物体放人盒子的模型来解决计数问题时，需要确定物体是不是有标号的，盒子是
不是有标号的。尽管从计数问题的内容中可以明确地做出决定，但计数问题有时是不明确的，这



--- 第 151 页 ---
第3章 计 数，

使我们很难确定究竟使用哪个模型。在这种情况下，最好的办法就是说明一下你做了什么样的假
定，并解释为什么你所选择的模型与你所做的假定是不相违背的。
tea  我们将会看到，计算把物体放人可辨别的盒子的方式数，不管物体是不是可辨别的，
这种计数问题都有封闭的计算公式;然而不幸的是，如果要计算把物体放入不可辨别
的盒子里的方式数时，不管物体是不是可辨别的，这种计数问题都没有封闭的计算公式。

可办别的物体与可准别的盒子 ”首先考虑把可辨别的物体放和人可辨别的盒子时的情况。考虑
例 8，在该例子中，物体就是扑克牌 ，盒子就是选手的手。

例8 有多少种方式把 52 张标准的扑克牌发给 4 个人使得每个人 5 张牌?

解 ”我们将使用乘积法则求解这个问题。开始，第一个人得到 5 张牌可以有 C(52，5)种方式。
第二个人得到 5 张牌可以有 C(47，5)种方式，因为只剩下 47 张牌。第三个人得到 5 张牌可以有
CC42，5)种方式。最后，第四个人得到 5 张牌可以有 C(37，5)种方式。因此,发给4个人每人5
张牌的方式总数是

C(52,5)C(47,5)C(42,5)C(37,5) = -352! 。 47! 。 421 。 37!

47151 ”42151 ”37151 ”32151
521
”51515151321              四

注意 例8的解等于52 个物体的排列数，这些物体分成 5 个不同的类，其中四类，每类

有5个相同的物体，第五类有 32 个物体。 可以通过在这种排列和给人发牌之间定义一个
一一对应来说明这个等式。为定义这个对应，首先把牌从1到52 排序。然后将发给第一
个人的牌与分配给第一类物体在排列中的位置对应。类似地， 发给第二、第三和第四个
人的牌分别与第二、第三、第四类物体所分配的位置对应。 没有发给任何人的牌与第五
类物体所分配的位置对应。 读者应该能够验证这是一个一一对应。

例 8 是涉及把不同的物体分配到不同的盒子的一个典型的问题。这些不同的物体是52 张牌，5
个不同的盒子是4 个人的手和其余的牌。可以使用下面的定理求解把不同的物体分配到不同的盒
子的计数问题。

 

ES 把个不同的物体分配到k 个不同的盒子使得mw 个物体放人盒子i(i一1，2，.…,避的
方式数等于
72!    _
7 1 1

定理 4 可以使用乘积法则证明。详细证明见本节的练习 24。 它也可以通过在定理 3 计数的排
列和定理 4 计数的放物体的方法之间建立一一对应来给出证明。

不可辨别的物体与可辨别的盒子”计算将”个不可辨别的物体放入A 个可辨别的盒子的方法数
问题，其结果等价于在允许重复计数的情况下，对具有个元素的集合计算， 组合数的问题。其原
因是: 在允许重复计数的情况下，具有个元素集合的”组合数与将 个不可辨别的球放人上个可
大别的念子的方法数之间存在一个一一对应的关系。为了建立这种对应关系，每次将一个球放人
第个盒子， 则对应于集合中的第;个元素被纳入了组合数。

例9 将10个不可辨别的球放人 8 个可辨别的桶里，共有多少种方法?

解 将10个不可辨别的球放入 8 个可辨别的桶里的方法数等于在允许重复计数的情况下，从
具有 8 个元素的集合中取出的 10 组合的个数。因此有

C(8二10一1,10) = C(d17,10) - _17!

10171
这意味着有 CCz十"一1，%一1)种方法将 ~个不可因别的球放入 ”个可辨别的盒子。
可办别的物体与不可办别的盒子”计算将”个可辨别的物体放入A 个不可辨别的盒子的方式数
问题，要比计算将物体(不管物体是不是可辨别的)放入可办别的盒子的方法数问题都困难。 我们

一 19 448                       |

133



--- 第 152 页 ---
134。第3章 计  数

将用一个例子来说明这一点。

例10 将4个不同的雇员安排在 3 间不可辨别的办公室，有多少种方式? 其中每问办公室可
以安排任意个数的雇员 。

解 ”我们将通过枚举雇员安排在办公室的所有方式来求解该问题。设 A，B，C， 分别代表
4个和雇员。首先注意: 可以把4个雇员都安排在同一间办公室; 也可以将 3 个雇员安排在同一间办
公室,第 4个雇员安排在另一间办公室; 也可以将 2 个雇员安排在同一间办公室，另外 2个雇员安
排在另一间办公室; 最后，还可以将 2个雇员安排在同一间办公室，而另外 2 个雇员各安排一间不
同的办公室。上述每一种安排方式都可以用把 4A，B，C，DD 分成不相交的子集的方式来表示 。

恰好有一种方式将所有 4 个雇员都安排在同一间办公室，用{({4，B，C，D)}}来表示。人恰好有
4 种方式将 3 个雇员安排在同一间办公室，而第 4 个雇员安排在另一间不同的办公室，用{({(4，了，
C)，{D))，{(A，B,，D)， (CA CD (3B》和(人了BC，D}，(A汶来表示。恰好
有 3 种方式将 2 个雇员安排在同一间办公室，另外 2 个雇员安排在另一间办公室，用{({1A4A，B)，
{(C，D))，{(4，C )，{ 了B，D))和{(4，D)，( B，C))来表示。最后，有 6 种方式将 2 个雇员安
排在同一间办公室，而另外 2 个雇员各安排一间不同的办公室。分别用{{(4，B)}，{C}，{D))，
(人 C)，{(B)，(D))， (AD (BC BC，(4)，(D))，((B，D)，{(A)，

C)}}和{{1C，D}，(4}，{B)}}来表示。

计算所有的可能性，得到: 共有 14 种方式将 4 个不同的雇员安排在 3 间不可辨别的办公室。
思考这个问题的另外一种方法是: 将要安排的办公室数是多少。注意: 将4个不同雇员安排在 3 间
不可辨别的办公室(没有空办公室)共有 6 种方式，将 4 个不同雇员安排在两间不可辨别的办公室
(有一间空办公室)共有 7 种方式，将4个不同雇员全安排在同一间办公室共有 1 种方式。   国

关于计算把 ”个可辨别的物体放人/7 个不可辨别的盒子的方式数问题，我们没有一个简单可用
的封闭公式。但是，却有一个相当复杂的计算公式，下面将给出这个公式，如果读者愿意，可以
忽略该公式的讨论部分。设 SCz，六表示将 交个可办别的物体放和人个不可辨别的盒子的方式数，
其中不允许有空的盒子。数 SCn，j门称为第二类斯特灵数。例如，例 10 证明了SC4，3)一6，
S(4，2)一7 和SC(4，1)=1。我们看到将 ”个可辨别的物体放人大 个不可辨别的盒子(其中非空的
盒子数等于&, 人一1，…，2，, 或1)的方式数等于

7SCn放
例如，跟踪例 10 的推理过程，将 4 个不同雇员安排在 3 间不可辨别的办公室共有
S(4,1)十SC4,2)十S(4,3) 一1十7十6一14
种方式。利用容斥原理(见 4.6 2

sc一中 工 CD (: ) 7一DD
因此，将?个不可辨别的物体放人大 个可办别的盒子的方法数等

so - 袜  二吕于1 ( ) (@一芒"

(关于第二类斯特吴数的详细信息，可以参考组合数学教材， 如[B607]j、[Br99j、[RoTe05]以
及LMiRo91]中的第6 章。)

不可办别的物体与不可辨别的盒子”有些计数问题可以通过确定将不可辩别的物体放人不可
因别的盒子的方式数而得解决。用一个例子来说明这一原理。

例11 将同一本书的 6 个副本放到 4 个相同的盒子里，其中每个盒子都能容纳 6 个副本，有
多少种不同的方式?

解 ”我们来枚举所有的放人方式。对每一种放人方式，将按照具有最多副本数的盒子的次序
依次列出每个盒子里的副本数，即列出的次序是递减的。那么，放入方式有



--- 第 153 页 ---
第3章 计 数"135

6，
5，1
4，2
4，1，1
3，3
3，2，1
3，1，1，1
2，2，2
2，2，1，1
例如，4，1, 1 表示， 有一个盒子中有 4 份副本 、第二个盒子中有 1 份副本、第三个盒子中有 1

份副本(第四个盒子是空的) 。因为已经枚举了将 6 个副本放到最多 4 个盒子里的所有方式，我们知

道

和

，共有 9 种方式来完成这项任务。                                                               国
将二个不可辨别的物体放人A 个不可办别的盒子，等价于将 写成最多上个非递增正整数的
o  如果 Qi 十as 十十ao一my  其中 QI ar Qi 都是正整数，  且 ai过az全…二ai，  那么就说 Qi

a，…，ai 是将正整数”划分成7个正整数的一个划分。可以看到，如果 户(m是将正整数划分
成最多& 个正整数的方式数的话，那么将=个不可辨别的物体放和人 个不可辨别的盒子里的方式数
就是 户(z) 。关于这个数，我们没有更简单的公式来表示它了。

练习

En 必 网忆二

局

.从一个 3 元素集合中允许重复地有序选取 5 个元素有多少种不同的方式?

. 6 个字母的字符串有多少个?

. 分配 3 种工作给 5 个雇员，如果每个雇员可以得到 1 种以上的工作,那么有多少种不同的分配方式?
.从一个 5 元素集合中允许重复地无序选取 3 个元素有多少种不同的方式?

. 一个百吉饼店有洋葱百吉饼、回粟子百吉饼、鸡蛋百吉饼、咸味百吉鲜、粗制保麦百吉饼、芝麻百吉饼、

葡萄干百吉饼和普通百吉饼，有多少种方式选择

a)6 个百吉饼?

b)12 个百吉饼?

c)24 个百吉饼?

d)12 个百吉饼，并且每类至少有1 个?

e)12 个百吉饼，并且至少有 3 个鸡蛋百吉饼和不超过 2 个感味百吉饼?

. 一个小猪储钱铅包含 100 个相同的 1 美分和 80 个相同的 5 美分硬币，从中选 8 个硬币有多少种方式?
.一个出版商有 3000 本离散数学书，如果这些书是没有区别的，那么将这些书存储在 3 个库房有多少种

方式?

. 方程 zi十zz十zs十总十zs一21 有多少个解? 其忠(ti一1，2，3，4，5)是非负整数，并且使得
a)zi之1                           bz之2，i一1，2，3，4，5
c)0和zi委10                         d)0近zi 近3，1芝zs一4，zas二15

。 有多少 10 位三进制数字(0，1 或 2)串恰含有2个0、3个1和5个2?
. 假设一个大家庭有 14 个孩子，包括 2组三胞胎、3 组双胞胎以及 2 个单胞胎。这些孩子坐在一排椅子上 ，

如果相同的三胞胎或双胞胎的孩子不能互相区分，那么有多少种方式?

, 把 6个相同的球放到 9 个不同的箱子里有多少种方法?

: 把 12 个不同的物体放到 6 个不同的盒子里并且每个盒子有 2 个物体，有多少种方法?

. 有多少个小于 1 000 000 的正整数其数字之和等于 19?

. 一次离散数学的期终考试有 10 道题。如果总分数是 100 且每道题至少 5 分，那么有多少种方式来分配这

些题的分数?

. 如果被传送的二进制串必须以 1 开始，必须有另外 3 位 1(使得传送的1 共有4位)，必须包含总共 12 位

0，必须每个 1 后面至少跟随 2 个0，那么有多少个不同的二进制串?

. 使用ABRACADABRA 中的所有字母可以构造多少个不同的串?



--- 第 154 页 ---
136，"第3章 计   数

17. 使用 ORONO 中的某些或全部字母可以构造多少个不同的串?

18. 用 EVERGREEN 中的字母可以构造多少个至少含 7 个字符的串?

19. 一个学生有 3 个芒果、2 个番木瓜和 2 个猕猴桃。如果这个学生每天吃 1 个水果，并且只考虑水果的类
型，那么有多少种不同的方式吃完这些水果?

20. 有多少种不同的方式在 xyz 空间上从原点(0，0，0)到达(4，3，5)点? 这个旅行的每一步是在z 正方向
移动一个单位，y 正方向移动一个单位，或者 = 正方向移动一个单位。(z，?，>z负方向的移动是禁止的，
即不允许回头。)

21. 把一副标准的 52 张扑克牌发给 5 个人，每个人得到 7 张牌，有多少种方式?

22. 当把一副标准的 52 张牌发给4个人时，若使得每个人有一手包含1个A的牌，这种概率是多少?

23. 浆本书放在& 个不同的书架上有多少种方式?

a)如果这些书是同一种书。
b)如果所有的书都不同，并且考虑这些书在书架上的位置。

*24. 通过先把物体放人第一个盒子，然后把物体放和人第二个盒子，…，的方法，使用乘积法则证明定理 4。
*25, 在这个练习中,我们将通过在两个集合之间建立一一对应来证明定理 2。这两个集合分别是集合
S={(1，2，…，人对的允许重复的 -组合的集合和集合T一(1，2，3，…，?十r一1}的 -组合的集合。

a)把 S 的允许重复的>组合中的元素排成一个递增序列 zi委袜受……近六。证明，对这个序列的第&项加
上一1 而构成的序列是严格递增的。断言这个序列由工的~个不同的元素构成。

b)证明 a)所描述的过程在 S 的允许重复的~组合的集合与工的>组合的集合之间定义了一一对应。[提
示: 通过把 了的满足 1过忆二了二<入na十r一1 的>组合{z，r，…，xzr，与从第上个元素减去
一1 得到的 S 的允许重复的-组合相联系，证明这个对应是可逆的.。]

c)断言存在着 C(z十r一1，z)个二元素集合的允许重复的>组合。

26. 有多少种不同的方式将 6 个可辨别的物体放和人 4 个不可辨别的盒子，使得每个盒子里至少有 1 个物体?

27. 有多少种不同的方式将 6 个临时雇员安排到4个相同的办公室，使得每个办公室中至少有 1 个临时雇员?

28. 有多少种不同的方式将 6 个不可辨别的物体放人 4 个不可辨别的盒子，使得每个盒子里至少有 1 个物体?

29,， 有多少种不同的方式将 9 张相同的 DVD 放人 3 个不可辨别的盒子，使得每个盒子里至少有 2 张 DVD?

30. 有多少种不同的方式将 5 个球放到 3 个盒子里，要求每个盒子里至少有 1 个球，如果
a)球与盒都是有标号的?                 b)球是有标号的，但盒子是没有标号的?

c)球是没有标号的，但盒子是有标号的?       d)球与盒都是没有标号的?

*31. 假如一个武器巡视员必须对五个不同场所中的每个场所巡视两次，每天巡视一个场所。巡视员可以自由
选择巡视场所的次序，但他不能连着两天都巡视 X 场所，因为X 场所是最可疑的场所。那么，该巡视员
有多少种不同的方式来巡视这些场所?

#32. 证明多项式定理: 如果 mn是正整数，则

(zl 十 za 十……十zu) 一     >，    人(Ci 9 1 )

mn27 om

其中

7
CC 7 1 一 一一一一
7 1 1

是多项式系数。
33. 求(x十y十z)吧中的 对只于 的系数。

3.6 生成排列和组合

3.6.1 引言

本章前几节已经描述了各种类型的排列和组合的计数方法，但是有时候需要生成排列和组合，
而不仅仅是计数。考虑下面三个问题。第一，假设一个销售商必须访问 6 个城市。应该按照什么
顺序访问这些城市而使得总的旅行时间最少? 一种方法就是确定 6! 一720 种不同顺序的访问时间
并且选择具有最小旅行时间的访问顺序。第二，假定 6 个数的集合中某些数的和是 100。找出这些
数的一种方法就是生成所有 2 一64 个子集并且检查它们的元素和。第三，假设一个实验室有 95 个
雇员，一个项目需要一组 12 人组成的有 25 种特定技能的雇员。(每个雇员可能有一种或多种技



--- 第 155 页 ---
第3章 计 数，

能) 。找出这组雇员的一种方法就是找出所有的 12 个和雇员的小组，然后检查他们是否有所需要的
技能。这些例子都说明为了求解问题常常需要生成排列和组合。

3.6.2 生成排列

1 任何 元素集合可以与集合{1，2，3，…，才建立一一对应。我们可以如下列出任何 n

 ”元素集合的所有排列: 生成 个最小正整数的排列，然后用对应的元素替换这些整数。
已经建立了许多不同的算法来生成这个集合的mi 个排列。我们将要描述的算法是以(1，2，3，
…，好的排列集合上的字典顺序为基础的。按照这个顺序，如果对于某个有&，1挟&委，au 一六，
@二久，罗ar-一入-并且作二和,那么排列 aa …av 在排列包记…刀的前边。换句话说，如果
在”个最小正整数集合的两个排列不等的第一位置，一个排列的数小于第二个排列的数，那么这
个排列按照字典顺序排在第二个排列的前边 。

例1 集合(1，2，3，4，5}的排列 23415 在排列 23514 的前边，因为这些排列在前两位相同 ，
但第一排列在第三位置中的数是4，小于第二排列在第三位置中的数 5。类似地，排列 41532 在排
列 52143 的前边。                                                              国

生成1，2，…，闻的排列的算法基础是从一个给定排列 aia …a, 按照字典顺序构造下一个排
列的过程。我们将说明怎样做到这一点。首先假设 a,- ,一a,，交换 ae。, 和 a, 可得到一个更大的排
列。没有其他的排列既大于原来的排列并且又小于这个通过交换 c, ,与 w, 得到的排列。例如，在
234156 后面的下一个最大的排列是 234165。另一方面，如果 ww ,二a,，那么由交换这个排列中的
最后两项不可能得到一个更大的排列。看看排列中的最后 3 个整数，如果 a, ,<一a。, ，那么可以重
新安排这后 3 个数而得到下一个最大的排列。a, ,和 av 中比较小的数大于a,，,，先把这个数放在
位置 "一2，然后把剩下的那个数和 au,按照递增的顺序放到最后的两个位置。例如，在 234165 后
面的下一个最大的排列是 234516 。

另一方面，如果 a,-:*>a,-;(且 o.->a)，那么不可能由安排在这个排列的最后三项而得到更
大的排列。基于这个观察，可以描述一个一般的方法，对于给定的排列 ca …c, 依据字典顺序来
生成下一个最大的排列。首先，找到整数 w 和a,;,使得 ww一a,;且

Cl 全QiH 全全av
即在这个排列中的最后一对相邻的整数，使得这个对的第一个整数小于第二个整数。然后，把
art axis an中大于a, 的最小的整数放到第7个位置，再按照递增顺序从位置 1十1 到?列
出a， Ci Qi+z CQn 中其余的整数， 这就得到依照字典顺序的下一个最大的排列。 容易看
出，没有其他的排列大于排列 ca …a, 而小于这个新生成的排列。(对这一事实的验证留给读者作
为练习) 。

例2 在362541 后面按照字典顺序下一个最大的排列是什么?

解 ”使得ww一ai+:的最后一对整数 w 和ai是as=2 和a王5。排列在 2 右边大于 2 的
最小整数是as 一4，因此 4 被放在第三位置。然后整数2，5 和 1 依递增顺序放到最后 3
个位置，即这个排列的最后 3 个位置是 125。于是，下一个最大排列是 364125 。           面

为生成整数 1，2，3，…， 浆的m! 个排列，按照字典顺序由最小的排列，即 123…w， 开始，连
续施用”1 一1 次生成下一个最大排列的过程，就得到 ”个最小的整数按字典顺序的所有排列。

例3 按字典顺序生成整数 1，2，3 的排列。

解 从123开始,由交换3 和2 得到下一个排列 132。下一步，因为32 和1<3，排列在132
中的 3 个整数，把 3 和 2 中较小的放到第一个位置，然后按递增顺序把 1 和 3 放到位置2和3 而得
到 213。跟着 213 的是 231，它是由交换 1 和 3 得到的，因为 1一3。下--个最大的排列把 3 放在第
一位置，后面是1 和2 按递增顺序排列，即 312。最后，交换 1 和 2 得到最后一个排列 321   国

算法 1 显示了在给定排列不是最大的排列 az一1 x一2…2 1 时，在它的后面按照字典顺序找到
下一个最大排列的过程。

137



--- 第 156 页 ---
138。第3章 计  数

 

算法 1 按字典顺序生成下一个最大排列
procedure mezt 思ermzzttation(aiaz…as: {1，2，…，?1)}的排列，不等于mn一1 …2 1)
JJ 一刀一1
While co 全ai +
7 :一7一1
人是使得ww<一ai+;的最大下标}
赤 :一天
while oa 盖ar
太 :一大一1
{ak 是在 oj 右边大于a 的最小整数}
交换 Ci 和 人和
六5一六
5一j十1
While -一>
begin
交换 a- 和a，
r :一r一]
5一5十1
end
{这把在第/位后边的排列尾部按递增顺序放置}

 

  

3.6.3 生成组合
ri 怎样可以生成一个有穷集的元素的所有组合呢? 由于一个组合仅仅就是一个子集，我
“所 们可以利用在{a ，as，…，a.} 和)位二进制串之间的对应。

如果 a 在子集中，对应的二进制串在位置上有一个 1;， 如果 ca 不在子集中，对应的二进制串
在位置上有一个0。如果可以列出所有的=位二进制串，那么通过在子集和二 进制串之间的对应就
可以列出所有的子集。

一个位二进位串也是一个在0到2"一1 之间的整数的二进制展开式 。按照它们的二进制展开
式，作为整数根据递增顺序可以列出这 2"一1个二进制串。为生成所有的?位二进制展开式，从具
有7个0的二进位串 000…00 开始。然后，继续找下一个最大的展开式，直到得到 111…11 为止。
在每一步找下一个最大的二进制展开式时，先确定从右边起第一个不是 1 的位置。然后把这个位
置右边的所有的 1 变成 0 并且将这第一个 0(从右边数)变成 1。

例4 找出在 10 0010 0111 后面的下一个最大的二进位串。

解 ”这个串从右边数不是 1 的第 1 位是从右边起的第 4 位。把这一位变成1 并且将它后面所有
的位变成 0。这就生成了下一个最大的二进位串 10 0010 1000。

生成在 2 -2 -:…&加 后面的下一个最大的二进位串的过程给出在算法 2 中。

算法2 生成下一个最大的二进位串

procedure meZzt bit String(bn -bo 有如: 不等于11…11的二进位串)
1 :一0

While 忆 一1

 



--- 第 157 页 ---
第3章 计 数，

下面将给出生成集合{1，2，3，…，寻的组合的算法。一个~组合可以表示成一个序列，这
个序列按照递增的顺序包含了这个子集中的元素。使用在这些序列上的字典顺序可以列出这些
组合。在 aa:…a, 后面的下一个组合可以按下面的方法得到: 首先，找到序列中使得 w 和"一r十:
的最后元素w, ，然后用 ww十1 代替 w ，且对于7一计1，i2，…，r用a,二7一;十1 代替ww。请读
者证明这就按字典顺序生成了下一个最大的组合。下面的例子说明了这个过程。

例5 找出集合(1，2，3，4，5，6}在{1，2，5，6}后面的下一个最大的4组合。

解 ”在具有w=1， au一2，a:王5，a一6 的项中使得 ai和6一4十i 的最后的项是a:王2。为得
到下一个最大的4组合, 把as 加1得ca=3。然后，置 ac:=王3十1一4且 oa一3十2二5。从而下一个
最大的4组合是(1，3，4，5) 。                            国

算法 3 用伪码给出了这个过程。

 

算法3 按字典顺序生成下一个 ~组合
procedunre mezt 六Com2pi7tationr ({al，az，…，ar) (1，2，…，?}的满足aa二ao二…一oa的不等于
{z一r十1，…，z)}的真子集》
EL一三
While ai; 一关一r十i

i 一;i一]
ai :一ai十1
for j :一i十1 to

二 一4十7一!

 

 

练习

1. 按照字典顺序排列下述{11，2，3，4，5)}的排列，43521，15432，45321，23451，23514，14532，21345，
45213，31452，31542。

2. 找出按照字典顺序跟在下面每一个排列后面的下一个最大的排列 。
a)1432 b)54123 c)12453 d)45231 e)6714235f31528764

. 使用算法 1 按照字典顺序生成前4 个正整数的 24 个排列。

, 使用算法 3 列出集合{L，2，3，4，5}的所有的 3组合。

. 证明: 算法 3 按字典顺序生成给定 ~组合后面的下一个最大的>组合。

, 列出{L，2，3，4，5}的所有 3 排列。

下面的练习建立了另一个算法来生成{11，2，3，…,'半的排列。这个算法是基于整数的康托尔展开。每个

小于?4! 的非负整数有一个唯一的康托尔展开式
ai 11十az 21十十ar一1)!

其中 a 是一个不超过; 的非负整数，i一1，2，…，7m一1。 整数 al，oaz ，…， av,-1叫做这个整数的康托尔
数字。

给定{1，2，…，好的一个排列。令 au-: 是排列中在上后面且小于 的整数个数,，&王2，3，…，n。例
如，在排列 43215 中，aui 是在 2 后面且小于 2 的整数个数，所以 ai一1。类似地，对这个例子 aa一2，a: 一3
且a: 一0。考虑从{11，2，3，…，z}的排列的集合到小于 ”! 的非负整数的集合的函数。这个函数把一个排列
映到一个非负整数，而这个整数把以这种方式定义的 al ，az ，…，an-i作为它的康托尔数字。
*?7. 证明: 这里描述的对应是{1，2，3，…，寻的排列的集合与小于中ji 的非负整数之间的双射。

关键术语和结果

术语

组合数学: 研究物体安排的科学 。

改举: 物体安排的计数。

树图: 由根、从根出发的分支以及从分支的某些端点出发的其他分支构成的图。

四 cn 必 C0

139



--- 第 158 页 ---
140。第3章 计  数

排列: 集合元素的一个有序的安排。

-排列:集合的 ~个元素的一个有序安排。

P(az，7): 寻元素集合的” 排列数。

r组合: 集合的 ~个元素的无序选取。

CCz，门: 元素集合的-组合数。

(7)(=贡式系数) :也是垃元素集合的~ 组合数。

组合证明: 基于计数变量的证明。

相关卡三角形。二项式系数的一种表示，其中三角形的第i行包含()) 70，1，2，…，

结果

乘积法则: 一种基本的计数技术。这个法则指出，当一个过程由两个子任务构成时，完成这个过
程的方式数是完成第一个任务的方式数和完成第一个任务之后再做第二个任务的方式数之积。

求和法则:一种基本的计数技术。这个法则指出，如果两个任务不能同时做，那么用这种或那种
方式完成任务的总方式数是完成两种任务的方式数之和。

馈本原理: 当比多的物体放到 个盒子时，一定存在一个盒子包含了至少 2 个物体。

广义饲巢原理， 当 N 个物体放人A 个金子时，一定存在一个盒子包含了至少[N/牛个物体。
好

(Cz一刀!

Cunm = (站= 于

r (7一

有(mr) 一

_  、  PR二INV_ 1 7    姑
柏斯卡恒等式: (“，) 一(7 )+(
二项式定理:(Z十y)”一 和 (oz 可
当人允许重复时，一个并元素集合有和个>排列。
当人允许重复时，一个半元素集合有 C(Cna二r一1，站个->组合。
如果类型站的不可区分的物体有mm个,ii=1，2，3，…，A&,， 那么个物体的排列有

ml Vanalnl… mk个。
生成集合{1，2，…，夺的排列的算法 。
复习题

1, 解释怎样用求和与乘积法则找出长度不超过 10 的二进位串的个数。
2. 解释怎样找出长度不超过 10 且至少有1 位 0 的二进位串的个数。
3. a)怎样用乘积法则找出从 普元素集合到 元素集合的函数个数?

b)从一个 5 元素集合到一个 10 元素集合存在多少个函数?

c)怎样用乘积法则找出从 z 元素集合到 元素集合的一对一函数的个数?

d)从一个 5元素集合到一个 10 元素集合存在多少个一对一函数?

e)从一个 5 元素集合到一个 10 元素集合存在多少个映上(注: 满射)的函数?
.如果首先赢 4个球的队就能取胜，你怎样找出两个队加赛的所有可能的结果数?
. 你怎样找出以 101 开始或以 010 结束的 10 位二进位串数?

. a)似述鸽梨原理。
b)解释怎样用合集原理证明在 11 个整数中至少 2 个整数的最后一位相同?
. a)叙述广义够巢原理。
b)解释怎样用广义鲍集原理证明在 91 个整数中有 10 个整数的最后一位数字相同?

GCT 心

~



--- 第 159 页 ---
9.

10.

11.
12.

1.

第3章 计 数"1341

. a)一个)元素集合的~ 排列和-组合的区别是什么?

b)推导一个与元素集合的> 组合数及r 排列数有关的等式。

c)有多少种方式从一班 25 个学生中选 6 个学生参加一个委员会?

d)有多少种方式从一班 25 个学生中选 6 个学生担任委员会中不同的常务委员?
a)什么是帕斯卡三角形?

b)在帕斯卡三角形中的一行是怎样从它的上一行产生的?

什么是恒等式的组合证明? 这样的证明与代数证明有什么不同?

解释怎样用组合论证证明帕斯卡恒等式。

a)叙述二项式定理。

b)解释怎样用组合论证证明二项式定理。

c)求在(2z十5y)2的展开式中 zy项的系数。

. a)解释怎样找出与从)个物体允许重复地无序选取 个物体的方法数有关的公式。

b)如果同种类型的物体是不加区分的，那么从 5 种不同类型的物体中选择 12 个物体有多少种方式?

c)从这 5 种不同类型的物体中选择 12 个物体，如果第一类物体必须至少 3 个，那么有多少种方式?

d)从这 5 种不同类型的物体中选择 12 个物体，如果第一类物体不多于4个，那么有多少种方式?

e)从这 5 种不同类型的物体中选择 12 个物体，如果第一类物体必须至少2 个，但是第二类物体不超过 3
个,那么有多少种方式?

. 9)设和r是正整数，解释为什么方程 zi 十刀十…十ze一r的解的个数等于”元素集合的允许重复的-组

合数. 这里的 zx, 是非负整数，i一1，2，3，…，7m。
b)方程 1 十Ta 十Ta 十菩一17 有多少个非负整数解?
c)b)的方程有多少个正整数解?

- a)m 个物体有 种不同的类型，其中类型 1 有ma 个无区别的物体，类型 2 有 ma 个无区别的物体，…，类

型上有 zs 个无区别的物体，推导一个与这些物体的排列数有关的公式。
b)有多少种方式来排序单词 JINDJISCREETNESS 的字母?

. 描述一个算法来生成上个最小正整数集合的所有排列。
, a)把 52 张标准的扑克牌发给 6 个人，每人 5 张牌，有多少种方式?

b)有多少种方式把个有区别的物体分配给上 个有区别的盒子旦使得第; 个盒子含有辣 个物体?

，描述一个算法来生成个最小正整数集合的所有的组合。

补充练习
从 10 个不同的项中选 6 项有多少种方式?
a)若这些项是有序选择的并且不允许重复。         b)若这些项是有序选择的并且人允许重复。
c)若这些项是无序选择的并且不允许重复。         d若这些项是无序选择的并且人允许重复。
. 从6 个不同的项中选 10 项有多少种方式?
a)若这些项是有序选择的并且不允许重复。         b)若这些项是有序选择的并且人允许重复 。
c)若这些项是无序选择的并且不允许重复。         d)若这些项是无序选择的并且人允许重复。

和

. 一个考试包含 100 个真假判断题。如果答案可以空缺，一个学生回答这些考题可能有多少种不同的方式?
。 有多少个 10 位二进制串以 000 开始或以 111 结束?

. 字母表{te，6，c}上有多少个 10 位字符串恰有 3 个a 或恰有4个83?

,一个校园电话系统的内部电话号码由 5 个数字组成，且第一个数字不等于0。在这个系统中可以分配多少

个不同的电话号码?

.一个冰激凌屋有 28 种不同味道的冰激凌、8 种不同的果汁和 12 种配料 。

a)如果每种味道的可以不止 1 勺， 并且不考虑次序，那么取 3 勺冰激疲放在一个盘中有多少种不同的
方式?

b)如果一个小圣代包含 1 勺冰激凌、!1 种果汁和 1 种配料，那么有多少种不同的小圣代?

c)如果一个大圣代包含 3 勺冰激凌、2 种果汁和 3 种配料。其中每种味道的冰激凌可以不止 1 个并且不考
虑次序，每种果汁只能用 1 次且不考虑次序，同时每种配料也只能用 1 次并且不考虑次序。那么有多少
种不同的大圣代?



--- 第 160 页 ---
142*

8.

9.

10.
. 一个幸运卡甜点公司制作 213 种不同的幸运卡。一个学生使用这个公司的幸运卡在餐馆吃饭。如果这个

11

12.
13.
TI4。

15.

#16，
闪]7.

18.
19.
20.

21.

22.

23，

24.

#25，

26.

27.

28.
29.

30.

第3章 计 数

有多少个小于 1000 的正整数

a)恰有 3 个十进制数字?                                 b有奇数个十进制数字?

c)至少有 1 个十进制数字等于 9?                    d)没有奇数个十进制数字?

e)有两个连续的十进制数字等于 5?                  妇是回文(即正读和倒读是一样的)?
当用十进制记法写出从 1 到 1000 的数时，有多少个下面的数字被用到?

a)0            b)1            c)2            d)9

有黄道十二宫，需要有多少人才能保证其中至少 6 个人在同一宫?

学生没有获得 4 张同样的幸运卡，那么他在这个餐馆吃饭最多可以吃多少次?

为保证至少 2 个人生在一周的同一天和同一个月(可以不在同一年)，那么需要多少人?

证明: 在10个不超过 50 的正整数集合中至少有 2 个不同的 5 元子集有同样的和。

一包棒球卡有 20 张。如果总共有 550 种不同的卡，那么需要买多少包卡才能保证其中的2张卡是一
样的。

a)从一副牌中需要选多少张牌才能保证至少选中2张 A?

b)从一副牌中需要选多少张牌才能保证至少选中2张A和2种点数?

c)从一副牌中需要选多少张牌才能保证至少有 2 张同样点数的牌?

d)从一副牌中需要选多少张牌才能保证至少有 2 张不同点数的牌?

证明: 在任何 z十1 个不超过 2n 的正整数中必存在 2 个数互素。

证明: 在普个整数的序列中存在若干个连续的整数其和可被mm 整除。

证明: 如果放 5 个点在边长为2 的正方形中，那么其中至少有 2 个点的距离不超过V2 。

证明: 一个有理数的十进制展开式一定从某一点出现循环。

曾经有一种计算机病毒通过感染的邮件信息感染了一台微机，该病毒在这人台微机的邮箱中向 100 个邮件
地址都发送了自身的副本。那么，当该微机将感染的邮件信息发送 5 次之后，它所感染的不同计算机的
最大数量是多少?

有多少种方式从 20 种多纳圈中选 12 个多纳图?

a)如果没有 2 个多纳圈是同种的?        b)如果所有的多纳圈都是同种的?
c)如果不加限制?               d)如果至少有 2 种多纳圈?

e)如果必须至少有 6 个蓝克馅的多纳圈?    1人如果至多有6 个蓝侮馅的多纳圈?
求 aa，如果

a)P(nz，2)一110       b)P(n，m)一5040         c)P(nz，4)一12P(m，2)

求 了ay 如果

a)C(mz，2)一45        bC(On，3)一P(n，2)       c)C(n，5)一C(m，2)

证明 如果?和zr 是非负整数且 ”三r， 则
了P(a十1，门一Pa，r)(na二1)十1一门

设 S是”元素集合，存在多少个有序对(4A，B)使得 A 和召是S 的子集上且ASB? [提示:, 证明 S 中的每
个元素属于A ，B一4或S一日。]
通过构造在集合的具有偶数个元素的子集与具有奇数个元素的子集之间的对应，给出关于 5.4 节推论 2
的组合证明。[提示: 取定集合的一个元素 ae，如下构造对应:如果 a 不在子集中就把它放到子集中; 如
果 a 在子集中就把它从子集中取出。]
设”和r 是非负整数且 ~一nz"。证明

Crr一1)一Caz十2,r十1)一2C(02 十1,r十1)十CCnr十1)

使用数学归纳法证明 》YCG,2) - Cn十1,3) ,其中由是大于1 的整数，
2
证明， 如果 ”是整数，册
  才 了 一 丁
它 (=
在这个练习中我们将推导一个关于”个最小正整数的平方和的公式。我们将用两种方式计数三元组(i，j，
已的个数，其中ii 了和 是整数且满足 0<<i<A，0<j < 1<<A<m。



--- 第 161 页 ---
#31.
32. 设

第3章 计 数"143

a) 证明:对于给定的《存在妇 个这样的三元组， 因此有 和 个这样的三元组。

b)证明: 具有 0委;一j<A 的三元组个数和 0委j一;一 的三元组个数都等于 CCnr十1，3) 。
c)证明: 具有 0和ij一& 的三元组个数等于C(n十1，2) 。
d)把 al 、b)和 c)组合起来得出

> )忆= 2CCz十1,3)十C(n十1,2)

一mn十1)(2m2十1)76
设 "人4，有多少个对位二进位串恰好 01 在其中出现两次?
集合 S 和子集族4 ，4: ，…，A,，其中每个子集含有吕个元素，d人2。如果可以把两种不同的颜色分
配给 S 的元素，每个元素一种颜色，且使得每个子集 A, 都包含了两种颜色的元素，则称这个子集族是可
2涂色的。设 m(d)是最大的正整数，使得对于每个子集族，如果子集数小于 m(d)，且每个子集含 d 个
元素，就是可 2 涂色的。
a)证明: 具有 2d一1 个元素的集合 S 的所有< 子集构成的子集族不是可 2 涂色的。
b)证明:， mm (2)一3。

**c)证明: mm(3)一7。[提示: 证明{1，3，5}，{1，2，6)}，{1，4，7}，{2,，3，4}，{(2，5，7)，{3，6，

33.

34.

35，
36.

37.

38.

39.

40.

41.
42.
43.

44，

45.
46.
关447.
站48.

7)，{4，5，6}不是可 2 涂色的。  然后证明所有具有 3 个元素的6 个集合的集合族每个都是可 2 涂
色的。]
一个教授为一次离散数学考试出了 20 道多选题，每道题可能的答案为wa，6，< 或4d。如果具有答案 xa，5，
< 和dd 的试题数分别为8，3，4 和 5，且试题可以用任意的顺序安排，那么可能有多少种不同的答案。
8 个人围圆桌就座有多少种不同的安排? 其中如果一种安排通过旋转能从另一种安排得到，那么就认为
这两种安排是一样的。
把 24 个学生分给 5 个指导教师有多少种方式?
一蒲式耳包含 20 个无区别的 Delicious 革果、20 个无区别的 Macintosh 苹果和 20 个无区别的 Granny
Smith 苹果，从其中选 12 个苹果，如果每类至少选 3 个有多少种方式?
方程 zi 十zz十ra一17 有多少个非负整数解?
a)若 zi盖1，rzrz二2，z二3                 b)若 王6，z3二5
c)著 zi一4，zre<一3，za二5
使用单词 PEPPERCORN 的所有字母构成字符串。

a)可以构成多少个不同的字符串?               b)其中有多少字符串以 P 开始和结束?
c)在多少个字符串中有 3 个连续的 P?

10 元素集合有多少个子集

a)少于 5 个元素?          b)多于 7 个元素?          c) 有奇数个元素?

一个交通逃逸事故的证人告诉警察，笔事汽车的车牌包含 3 个字母后面跟着 3 个数字，以字母 AS 开始且
包含数字 1 和 2。有多少不同的车牌符合这个描述?

有多少种方式把:个相同的物体放人六 个不同的容器而使得没有一个容器是空的?

6个男孩和8 个女孩坐在一排椅子上，如果没有两个男孩相邻，有多少种方式?

将 6 个物体放入 5 个盒子中有多少种方式，如果

a)物体与盒子都是有标号的?               b)物体是有标号的，但盒子是没有标号的?
c)物体是没有标号的，但盒子是有标号的?      d)物体与盒子都是没有标号的?

将 5 个物体放人 6 个盒子中有多少种方式，如果

a)物体与盒子都是有标号的?               b)物体是有标号的，但盒子是没有标号的?
c)物体是没有标号的，但盒子是有标号的?      d)物体与盒子都是没有标号的?

设计一个算法生成一个有穷集的所有人允许重复的 r 排列。

设计一个算法生成一个有穷集的所有人允许重复的 ~组合。

证明: 如果关,7m 为整数，m三3，x二3，那么 R(m，m委Rom，n一1)十Rom一1，m) 。

在一组 6 个人中,每两个人是朋友或者是敌人，证明在这组人中不存在 3 个人两两是朋友，也不存在4
个人两两是敌人。从而证明了 R(G3，4)7。



--- 第 162 页 ---
144，。第3章 计   数

计算机题目
按下述给定的输入和输出写程序。

康

碍名站中中

. 给定正整数 和不超过? 的非负整数，找出 元素集合的~ 排列数和-组合数。
. 给定正整数”和r，找出”元素集合的允许重复的~ 排列数和人允许重复的-组合数。
- 给定正整数序列，找出这个序列的最长的递增和递减子序列。

给定方程 rz十zz十…十xz一C，其中C 是一个常数，zri，z ，…，xzw 是非负整数，列出所有的解。

- 给定正整数 na，按字典顺序列出集合{1L，2，3，…，v}的所有的排列。

. 给定正整数 ” 和不超过 的非负整数~，按字典顺序列出集合{1，2，3，…，n} 的所有的~组合。
- 给定正整数 ” 和不超过?= 的非负整数>，按字典顺序列出集合{1，2，3，…，z?} 的所有的-排列。
. 给定正整数 2，列出集合{1，2，3，…， 好的所有的组合。

. 给定正整数和r，列出集合{1，2，3，…，zj}的允许重复的所有 ~ 排列。

10. 给定正整数上和r，列出集合{1，2，3，…，寻的允许重复的所有 -组合。

计算和研究
使用一个计算程序或你已完成的程序做下面的练习。

1.

2.

3.

4.

#5.

当两个队加时赛时，赢的队是 9 分中首先得 5 分、11 分中首先得 6 分、13 分中首先得 7 分和 15 分中首先
得 8 分的队。找出加时赛的可能的结果数。

哪些二项式系数是奇数? 你能根据数的特征给出一个猜想吗?

目前还不知道二项式系数 C(2z，7z)是否一定被一个素数的平方整除，也不知道当? 增长时在C(2m，z)的
素数分解中最大的指数是否无界增长。通过对于尽可能多的正整数”找C(2nm，m)的分解式中素数的最小
和最大的等来探索这个问题。

尽量找出更多的小于 200 的奇数 ”，使得 C(n,b/3)不能被一个素数的平方整除。根据你的证据给出一个
腌测公式。

对每个小于 100 的整数，确定 C(2n，zm)是否能被 3 整除。根据z= 的三位展开基中的数字，你能腌测一个公
式来告诉我们: 关于哪个整数 "，二项式系数 C(2>，z)能被 3 整除吗?

6. 生成 8 元素集合的所有的排列 。

7. 生成 9 元素集合的所有的 6 排列。

8.

9. 生成 7 元素集合允许重复的所有 5 组合。

生成 8 元素集合的所有的组合。

写作题目
用本书以外的资料，按下列要求写成短文。

1.
2.

3.

co ~] 中 on

xD

描述狄利克雷和其他的数学家对铀菜原理的早期应用。

讨论扩充目前电话编码计划的方式以适合对更多电话号码飞速增长的需求。(看看你是否能够找到某些来
自电信产业的建议?对你要讨论的每个新的编码计划说明怎样找到它所支持的不同电话号码的个数。

本书描述了许多组合恒等式。找一找关于这种恒等式的资料，并且描述除了本书引信之外的其他重要的组
合恒等式。给出其中某些恒等式的有代表性的证明，包括组合证明。

. 描述在统计力学中的质点分布所使用的不同的模型，包括麦克斯韦-玻尔兹曼、玻色-爱因斯坦和费米-狄

拉克(Fermi-Dirac)统计，在每种情况下描述模型中使用的计数技术 。

- 定义第一类斯特林数并且描述它们的某些性质以及所满足的恒等式。

: 定义第二类斯特林数并且描述它们的某些性质以及所满足的恒等式。

' 定义拉姆齐数，叙述和证明显示它们存在的拉姆齐定理，并且描述目前已知的有关拉姆齐数的结果。

.描述生成元素集合所有排列的其他算法，这些算法不是在 3. 6 节给出的算法。把这些算法的计算复杂性

与书上和 3. 6 节练习所描述算法的计算复杂性进行比较。

.至少描述一种方法生成一个正整数 ”的所有的剖分。



--- 第 163 页 ---
|第4章

Discerete Mathematics and Its Applications，6E

高级计数技术

许多计数问题用第 3 章讨论的方法是不容易求解的。一个问题是 有多少个位二进位串不包
含两个连续的 0? 为求解这个问题，令 wa, 是这种”位二进位串数，可以证明 oa.+ 一a.十a,-:。这个
等式叫做递推关系，它和初始条件 w王2 和 a:一3 确定了序列{a,}。此外，从这个与序列的项有关
的等式可以找到 a, 的显式公式。正如我们将要看到的，可以用一种类似的技术来求解许多不同的
计数问题。

我们也将看到，可以用形式宕级数(也叫做生成函数来求解许多计数问题，其中 z 的赛的系
数代表我们感兴趣的序列的项。除了求解计数问题，生成函数还可用于求解递推关系以及证明组
合恒等式。

许多其他类型的计数问题不能使用第 3 章所讨论的技术求解，例如: 有多少种方式把 7 项工作
分给 3 个雇员而使得每个雇员至少得到一项工作? 有多少个素数小于 1000?9 可以用计数集合并集
中的元素数来求解这两个问题 。我们将开发一种叫做容斥原理的技术来计数在集合并集中的元素
个数，并且将说明怎样用这种技术求解计数问题。

可以用本章学到的技术与第 3 章的基本技术一起求解许多计数问题。

4.1 递推关系基础

4.1.1 引言

一群细菌的数目每小时增加一倍。如果开始有 5 个细菌 ，在小时未将有和多少个细菌? 为求解
这个问题，令 o 是小时未的细菌数。因为细菌数每小时增加一倍，只要 ”是正整数，关系 w,一
2a, ,就成立。对所有的非负整数 ”，这个关系和初始条件 wm一5 一起唯一地确定了 a,。利用这一信
息可找出关于 a, 的公式。

某些计数问题不能用第 3 章给出的技术求解，但可以通过找到序列的项之间的关系，如在涉
及细菌的问题中的关系，即递推关系来求解。我们将研究各种能用递推关系构造模型的计数问题。
我们也将在本节和 4. 2 节建立一些方法，针对满足某类递推关系的序列，求出序列的项的显式
公式。

4.1.2 递推关系
-ws 一个序列的递归定义指定了一个或多个初始的项以及一个由前项确定后项的规则。可
一… 以用递归定义来求解计数问题。对于递归定义，这个从某些前项求后项的规则就叫做

  

 

递推关系。

E     关于序列{a,}的递推关系是一个等式，它把 ae, 用序列中在 a, 前面的一项或多项即
ao，a，…，a-!来表示，这里 "之m%，m 是一个非负整数。如果一个序列的项满足递推关系，这
个序列就叫做递推关系的解。

在递归和递推关系之间存在重要的联系，关于这一点我们在本章的后边再做研究。递归算法
依据较小规模的同一问题的一个或者多个实例的解得到规模为”的问题的解。因此，当我们分析
一个递归算法的复杂性时，我们得到一个递推关系，它把求解规模为的问题需要的运算次数用
求解一个或多个小规模实例的同一问题所需要的运算次数来表示。

例1 令{a.}是一个序列， 它满足递推关系 an一qu-一ar-z，m一2，3，4，…，且am王3，oa' 一
5，那么 cs 和 as 是什么?



--- 第 164 页 ---
146。*第4童 高级计数技术

解 从递推关系可以看出， d 一届一ao一5一3一2 且 ca:三aa:一0一2一5一一3。         转

例2 确定序列{a,}是否为递推关系 .一2a, -一ao-:，m一2，3，4，…，的解。这里 a,一3n，
是非负整数。对 a,=2"” 和a,=5 也回答同一个问题。

解 假设对每一个非负整数nm，a,=3n， 那么对于 n二2，可以看出 2a,-, 一a,-: 二
2[3(*一1)]一3(z一2)一3一ao。于是，{a,}是该递推关系的解，其中 a,一3n。

假设对每一个非负整数 z，a,=王2"。注意到 ao 王1，a 一2，a:一4。因为 2a 一ao一2。，2一1一
3天aw ，不难看出序列{a,}不是该递推关系的解，其中 a,一2"。

假设对每一个非负整数 mm，a,=5，那么对于 nx人2 有 a,=一2a,。 ,一ao -一2， 5一5一5一as。因
此，{a,}，a,=一5 是该递推关系的解。                                     图

序列的初始条件说明了在递推关系起作用的首项之前的那些项。例如，例 1 中的 o王3 和a'王
5 是初始条件。递推关系和初始条件唯一地确定了一个序列。这是由于一个递推关系和初始条件一
起提供了这个序列的递归定义。只要使用足够多次，序列的任何一项都可以从初始条件开始通过
递推关系求出。但是对于某些特定类型的序列，可以有更好的方法通过它的递推关系和初始条件
来计算它的项。我们将在本节和4. 2 节讨论这些方法。

4.1.3 用递推关系构造模型

我们可以使用递推关系构造各种问题的模型，例如找复利，计数岛上的兔子，确定汉诺塔难
题的移动次数，以及计数具有确定性质的二进位串。

例3 复利 假设一个人在银行的储蕾账户上存了 10 000 美元,年复利是 11% 。那么在 30 年
后账上将有多少钱?

了 解 ”为求解这个问题，令 忆, 表示?年后账上的钱数。因为=年后账上的钱等于在n”一1
年后账上的钱加上第 ”年的利息，易见序列{己,} 满足递推关系
P, = P， ,十0.11P,，， = (1.11)P，，

初始条件是 P,=10 000。

我们可以使用迭代法找到关于 一, 的公式。注意

也, 一(1. 11)P。

P, 一(1.11)P, =一(1.11)P。
P;, 一(1.11)P, 一(1.11)P。
P, 一(1.11)P 一(1.11)"P。

当代和初始条件 已王10 000，就得到公式 已,一(1.11) "10 000。我们可以使用数学归纳法验证
它的正确性。公式对 上=一0 是正确的，这是初始条件的直接结果。假定 已.一(1.11)"10000，那么由
递推关系和归纳假设，
P,， 一(1.11)P,一(1.11)(1.11)"10 000 一(1.11)"710 000
这证明了对 己, 的显式公式是正确的。
将 一30 代人公式 己,=(1. 11)"10 000 就证明了在 30 年后账上包含
Pi 一(1.11)”10 000 王 228 922. 97 美元                -        力
例 4 说明了怎样用递推关系建立关于岛上兔子数的模型。
3 例4 锡子和斐波那契数”考虑下面的问题，它是由里奥那多。底“比萨，也就是斐波
 ” 那自,于 13世纪在(算书》(Liber abaci)一书中提出来的。一对刚出生的兔子(一公一
母)被放到岛上。每对兔子出生后两个月才开始繁殖后代。如图 4-1 所示，在出生两个月以后，每
对兔子在每个月都将繁殖一对新的兔子。假定兔子不会死去，找出:个月后关于岛上兔子对数的
递推关系。
解 用扩表示? 个月后的兔子对数。我们将证明 六，zm王1，2，3，…是斐波那契序列的项。
可以用递推关系建立兔子数的模型。在第 1 个月末，岛上的兔子对数是 户王1。由于这对兔子



--- 第 165 页 ---
第4章 高级计数技术。147

新生的 |已有的 | 总对数

 

 

(玫和大)           (尼训外水 )           月 | 对数 | 对数
徐鸠
徐雹

徐旭                         徐旭                             国          .

各妇                     徐鸠 秦旭                   量          ;

徐旭机                    入鸠础给礁急 | :| : | ，| ，

徐儿机扒向妇 机妇机妇大夫 | | ，| ，| ，

秦妇 徐旭

图4-1 岛上的兔子

在第 2个月没有繁殖，因此 亡=1。为找到mn个月后的兔子对数，要把前一个月岛上的对数 太-,加
上新生的对数，而这个数等于 广-: ，因为每对两个月大的兔子都生出一对新兔子。
因此，序列{访}满足递推关系
太一扩-十扩2，7 之3
和初始条件 户=1 和 六王1。由于这个递推关系和初始条件唯一地确定了这个序列，因此 个月后
岛上的兔子对数由第”个斐波那契数给出。                                 国
Fassn 例5涉及一个著名的难题。

1 例5 ，汉诺塔“19 世纪后期由法国数学家埃德沃德，卢卡斯发明的一个流行的游戏叫
“” ”做汉谱塔，它由安装在一个板上的 3 根柱子和若干大小不同的盘子构成。开始时，这
些盘子按照大小的次序放在第一根柱子上，使得大盘子在底下(如图 4-2 所示)。游戏的规则是，
每一次把 1 个盘子从一根柱子移动到另一根柱子，但是不允许这个盘子放在比它小的盘子上面。
游戏的目标是把所有的盘子按照大小的次序都放到第二根柱子上，并且将最大的盘子放在底部。

 

柱1            柱2            柱3
图 4-2 ”汉诺塔的初始位置

令 媚, 表示解”个盘子的汉诺塔问题所需要的移动次数。建立一个关于序列{ ,} 的递推关系。
解 “开始”个盘子在柱 1。按照游戏规则我们可以用 妃,-:次移动将上边的 "一1 个盘子移到柱
3(图 4-3 说明了此刻的柱子和盘子) 。在这些移动中保留最大的盘子不动。然后，我们用一次移动
将最大的盘子移到第二根柱子上。我们可以再使用 五,-, 次移动将柱 3 上的 ”一1 个盘子移到柱 2，



--- 第 166 页 ---
148 "第4章 高级计数技术

把它们放到最大的盘子上面，这个最大的盘子一直放在柱 2 的底部。容易看出，使用更少的步数

是不可能求解这个难题的。这就证明了
五, 一 2万 ,十1

初始条件是 责 =1，因为依照规则一个盘子可以用 1 次移动从柱 1 移到柱 2。

 

  

柱2
图 4-3 汉诺塔的一个中间位置

我们可以使用迭代方法求解这个递推关系。
娓,一 2万 十1
一2(2H 十1)十1一2有-十2十1
一22(2甩-十1)十2十1一2 刀-十2十2十1

= 2全十2十2十……十2十1
一2十2十…十2十1
= 2一1
为了用序列前面的项表示 五,，我们重复地用到这个递推关系。在倒数第二个等式中用了初始
条件 互, =1。最后一个等式是基于等比序列的求和公式得出的，这个公式可以在 2.4节的定理1 中
找到 。
用迁代方法找出了具有初始条件 豆, =1 的递推关系 瑟,=2瑟,十1 的解。这个公式可以用数
学归纳法证明。证明留给读者作为节后的练习。
关于这个难题有一个古老的传说，在汉诺有一座塔，那里的僧侣按照这个游戏的规则从一个
柱子到另一个柱子移动 64 个金盘子，据说当他们结束游戏时世界就到了末日。如果这些僧侣 1 秘
钟移动 1 个盘子，这个世界将在他们开始多久以后终结?
根据这个显式公式，僧个需要
2一1一18446744073 709 551 615
次移动来搬这些盘子。每次移动需要 1 秒钟，他们将用 5000 亿年来求解这个难题，因此这个世界
的寿命应该相当长。                                                 国
2 注意 许多人研究了源自例 5 所述汉诺塔难题的各种问题。某些问题用到更多的
“ ”柱子，某些问题允许同样大小的盘子，某些问题对盘子的移动类型加以限制。一
个最古老和了最有趣的问题是雷夫难题8 ，它是 1907 年由享利。杜德尼在他的《坎特伯雷训
题》(Camterbury 已kzzle)一书中提出来的。这个难题是雷夫出的，他让一个朝圣者把一堆
各种大小的奶酷从4个药子中的一个移到另一个，移动中不允许把直径较大的奶酪放在
较小的奶酷上面。如果用柱子盘子的概念来表述雷夫难题，除了使用4根柱子之外，

怠 ”曙夫，Reve，更常见的拼写是 reeve，这个词在古代是指地方长官(governor) 。



--- 第 167 页 ---
第4章 高级计数技术”149

其他和汉诺塔的规则一样。你可能会奇怪没有人能够确定求解个盘子的雷夫难题所需
要的最少移动次数。但是，存在一个猜想，至今已经超过 50 年了。 这个猜想认为所需移
动的最少次数等于由弗雷姆(Frame)和斯图尔特(Stewart)在 1939 年发明的算法所使用的
移动次数。(更详细的信息参见节末的练习 27一30 和[St94] 。)

例 6 说明了怎样用递推关系计数具有指定长度和某种性质的二进位串。

例6 对于不含 2 个连续 0 的对位二进位串的个数找出递推关系和初始条件。有多少个这样的
5 位二进位串?

解”设ca, 表示不含 2个连续0 的zz位二进位串数。为得到一个关于{a,}的递推关系，由求和
法则，不含 2个连续0 的z位二进位串的个数等于以 0 结尾的这种二进位串数加上以 1 结尾的这种
二进位串数。我们将假定 "3，使得二进位串至少有 3 位。

精确地说，不含 2 个连续 0 并以 1 结尾的位二进位串就是在不含 2 个连续 0 的 一1 位二进
位串的尾部加上一个 1。因此存在 o,-,个这样的二进位串。

不含 2 个连续 0 并以0 结尾的位二进位串在它们的=一1 位必须是 1; 否则它们就将以2个0
结尾。因而，精确地说，不含 2 个连续0 并以0 结尾的位二 这位呈新是在不售2个连续0的
2一2 位二进位串的尾部加上 10。因此存在 <, :个这样的二进位串。

如图 4-4 所示，可以断言对于 ”盖3 有

 

 

an 一 Qi 十ao
不含2个连续0的m
位二进位串个数:
、         -       任何不含2个连续的0的
以一个/结尾:    m-!位二进位审      1     or
风     LE        任何不含2个连续的0的
以一个0结昆:           六-2位二进位绅          1 0           an _2
总共:     or三ai-1+5 2

 4-4 计数不含 2 个连续的 0 的#位二进位串

初始条件是 w 一2，因为 1 位的二进位串是0 和1，没有连续的 2个0。而as=3，因为 2 位的
二进位串中满足条件的是01，10 和 11。使用 3 次递推关系就可得到 wm
aa 一十ai一3十2一5
4一4十as一5十3一8
a 一上十ai一8十5一13                   力

注意 (co,}和斐波那契序列满足同样的递推关系。因为 ai一户且四一户，从而有
au一请 十2

例 7 说明怎样用递推关系建立编码字数的模型，这种编码字是通过确定的正确性检测所多
许的。

例7 编码字的枚举 ”一个计算机系统把一个十进制数字串作为一个编码字，如果它包含偶数
个0，就是有效的。例如，1 230 407 869 是有效的，而 120 987 045 608 不是有效的。设 w, 是有效
的”位编码字的个数。找出一个关于 w, 的递推关系。

解 ”注意到a一9，因为存在 10 个1 位十进制数字串，并且只有一个，即串 0 是无效的。通过
考虑怎样由?一1 位的数字串构成一个半位有效数字串，就可以推导出关于这个序列的递推关系。
从少 1 位数字的串构成上位有效数字串有两种方式。

第一种，在一个 *一I 位的有效数字串后面加上一个非 0 的数字就可以得到一个位的有效数
字串。加这个数字的方式有 9 种。因此用这种方法构成位有效数字串的方式有 9a，, 种。



--- 第 168 页 ---
150"第4童 高级计数技术

第二种，在一个无效的 "一1 位数字串后面加上一个0 就可以得到位有效的数字串。(这将产
生具有偶数个 0 的串，因为无效的 "一1 位数字串有奇数个 0。)这样做的方式数等于无效的 一1 位
数字串的个数。因为存在 10…:个 x一1 位数字串，其中有 a,-,个是有效的，通过在无效的一1位数
字串后面加上一个0 就得到 10" :一ao, ,个二位的有效数字串。

因为所有的二位有效数字串都用这两种方式之一产生，从而存在

an 一9a_ 十(10汪 一ai)
一8c, ,十10?”
个?位有效数字串。                                                            国

例 8 中的递推关系在许多不同的场合都可以见到。                     ，

例8 求关于 C, 的递推关系，其中 C, 是通过对zz十1个数z。，z，盖*“…和的乘积中加括
号来规定乘法的次序的方式数。例如，C;==5，因为对。盖，“逆。z有5种加括号的方式来确定
乘法的次序:

((zro zz) (zzeT))。zi (zz)。(z。Ti)
To。((zi，*z)。z) zeo*(T。(z。xzis))

解 ”为求关于 C, 的递推关系，我们注意到无论怎样在 z 。 zi。z。…。z 中插人括号总有一
个”。 "运算符留在所有括号的外边，即执行最后一次乘法的运算符。[例如，在(mm。(z。己))，冯
中的最后一个运算符，在(z。，z)。(rz。z)中的第二个运算符。]这个最后的运算符出现在 "十1
个数中的两个数之间，比如说 mx 和ri:之间。当最后的运算符出现在 zx 和zi之间时，存在
CC,-，,种方式插入括号来确定 n十1 个数被乘的次序，因为有 C, 种方式在乘积zi 、阅 。… .了
中插人括号来确定这十1 个数的乘法次序，且有 C,-，,种方式在乘积 mx， .zi 。…。zr, 中插人
括号来确定这”一A个数的乘法次序。由于这个最后的运算符可能出现在 xn十1 个数的任两个数之
间，所以

C, 一CoC,- 十CC 十… 十 C, -zzC 十 CC

= cc
注意到初始条件是 Cu一1 和 Ci一1。这个递推关系可以用生成函数的方法求解，这种方法将在 4.4
节讨论。可以证明 C,=C(2n，m/(n十1) 。(见节末的练习 20。)                     国

3汪卫5 序列{C.}是卡塔兰(Catalan)数的序列。 这个序列是除上例之外的许多不同计数问题的
”和解(细节见LMiRo91]或[Ro84a]中有关卡塔兰数的一章) 。

练习

1 求给定序列的前 5 项，每个序列由下面的递推关系和初始条件定义。
a)av一6a,-!，ao一2                     b)a.一oa: _,，，al 一2
c)av一an -1十3a。-s，du一1，a 一2           da一mras ,十ma ys，ao一1，al一1

e)an一av-i十au-i，ao一1，al一2，ar一0
. 令a=2"十5。3"，mn一0，1，2，…。
a)求oo，a，az，as 和al。
b)证明 a 一5a, 一6ao ，as 一5a; 一6ai ， ai一5ai 一6a: 。
c)证明 , 对一切整数 mn，"*二2， an一5a。 :一6a,-:。
. 序列{a,}是递推关系 av一8a。;: 一16a,_:;的解吗? 如果

fo

5

a)an一0               b)a,王1               c)a一2"                  d)a,一4"
e)anw 一Mk                fa一2 。4"十3m，4"     gg)av一(一4)"                ha一nm2z4*
4. 证明序列{a}是递推关系 ao一av, -:十2a。:十2n一9的解，如果
a)au一一?十2          ba,一5(一1)"一2十2   c)as一3(一1)7十2一mr十2 da,一7。2"一?十2

cm

用例 5 中用到的选代方法求下面每个递推关系和初始条件的解。

a)an一3a.-，ao一2   b)a,一av -十2，ao王3 cas一a。 ,十ma，ao一1     d)a。一ao.-:十2n十3，ao一4



--- 第 169 页 ---
12.

13.

14.

关15，

#16.

17.

#]19.

20.
21.

第4章 高级计数技术"151

e)a,一2a,_-;一1，ao一1]   了Da一3a, -十1，ao一1   g)as一na-~1，ao一5   hh)a,一2ra,-i，ao一1

,. 假设一群细菌的数目每小时增长为3倍。

a)建立关于?小时后细菌数的递推关系。
b)如果初始的群体有 100 个细菌，那么 10 小时后将有多少个细菌?

. 一个工厂逐月增长地定做体育赛车。在第 1 个月只做了 1 辆，在第 2个月做了 2 辆，照此下去，到第 ”个

月做了)”辆。

a)对这个工厂前=个月生产的赛车数构造一个递推关系。
b)在第一年生产了多少辆赛车?

c)求出这个工厂在前z= 个月生产赛车数的显式公式。

. 借 5000 美元，利率 7% ，如果每个月还款 100 美元，找出关于第上个月末从款余额 B(&)的递推关系。[提

示: 将BGA)用BO一1)项表示，月息是(0. 07/12)BGk一1)。]

. 用数学归纳法验证在例 5 导出的求解汉诺塔难题所需移动次数的公式。
. 一台出售邮票短的售货机只接受 1 美元硬币、1 美元纸币以及 5 美元纸币。

a)找出与放闻美元到这台售货机的方式数有关的递推关系，这里要考虑硬币和纸币放人的次序。
b)初始条件是什么?
c)一本邮票簿需 10 美元，有多少种方式付款?

, a)求与包含 2 个连续 0 的”位二进位串的个数有关的递推关系。

b)初始条件是什么?

c)包含 2个连续 0 的7 位二进位串有多少个?

a)求与不包含 3 个连续 0 的 位二进位串的个数有关的递推关系。

b)初始条件是什么?

c)不包含 3 个连续 0 的7 位二进位串有多少个?

a)一个人有怜阶梯，如果每次可以上 1或2阶,求与疏步阶梯的方式数有关的递推关系。
b)初始条件是什么?

c)这个人有巾8 步阶梯上飞机有多少种方式?

a)求与不包含 2 个连续 0 的”位三进位串的个数有关的递推关系。

b)初始条件是什么?

c)不包含 2 个连续0的6 位三进位串有多少个?

a)求与不包含 2 个连续 0 或 2 个连续 1 的 位三进位串的个数有关的递推关系。

b)初始条件是什么?

c)不包含 2 个连续0 或2个连续1的6位三进位串有多少个?

a)求与不包含连续的相同符号的”位三进位串的个数有关的递推关系。

b)初始条件是什么?

c)不包含连续的相同符号的 6 位三进位串有多少个?

信息通过信道传送要使用两个信号。一个信号的传送需要 1 微秒，而另一个信号的传送需要 2 微秒。
a)求与在=”微秒内发送的不同信息数有关的递推关系，其中信息由这两个信和号的序列构成，并且信息中
的每个信和号后面都紧跟着下一个信和号。

b)初始条件是什么?

c)用这两个信和号在 10 微秒内可以发送多少条不同的信息?

 a)如果 R, 是一个平面被” 条直线划分出的区域个数，其中没有两条直线是平行的也没有 3 条直线交于一

点，找出由 R, 满足的递推关系。

b)使用迭代求出 RR。。

a)找出由 S, 满足的递推关系，其中 S, 是三维空间被 ”个平面分成的区域数，如果每 3 个平面交于一点，
但没有4 个平面交于一点。

b)使用迭代求出 S, 。

包含偶数个0 的7 位二进位串有多少个?

a)用地砖铺一条人行道，地砖是红色、绿色或灰色的。如果没有两块红砖相邻且同色的地砖是不加区别
的，找出与用 块砖铺一条路的方式数有关的递推关系。



--- 第 170 页 ---
152*第4章 高级计数技术

b)对于(a)中的递推关系有什么初始条件?
c)用 7 块砖铺一条在(a)中所描述的路有多少种方式?
x*22. 设 SCm，7m表示从 关元素集合到 元素集合的映上本数个数。证明 SCm，zm)满足递推关系

于一
SCmyn) 一mo一>) CCnk)S(Omk)
盘一上

其中 mm三?2 且m>>1，初始条件是 Sm ，1)=1。
23. a)使用在例 8 所建立的递推关系确定 C: ，即为确定相乘的次序在 6 个数的乘积中加括号的方式数。
b)使用在例 8 的解答中所提到的关于 Cs; 的封闭公式检验你在(b)得到的结果。

二厂练习 24一26 是格雷厄姆，克努斯(Graham Knuth)和帕塔什尼克(Patashnik)在[GrKnPa94]所描述的约莫夫问
题(Josephus Problem)的一种变形。这个问题来源于历史学家弗拉维乌斯。约瑟夫的一本账。41 个犹太上叛民
在一世纪犹太-罗马战争期间被罗马人追赶逃人山洞，约瑟夫是这群人中的一个。这些叛民宁愿死也不愿被
俘。他们决定围成一个圆圈并且围着这个圆圈重复数数，每数到 3 就杀掉这个位置的人而留下其他的人。但
是约瑟夫和另一个叛民不愿意这样被杀掉。他们确定了应该站的位置是最后两个活下来的叛民的位置。我们
考虑的问题开始时有半个人，记为 1 到m，站成一个圆圈。每一步，每第 2 个仍旧活着的人将被排除，直到
只翻下一个人为止。我们把生还的人数记作 J(z) 。

24. 对每个正整数”的值，1委ns委16，确定 J(z)的值。
25. 对于 ”>1,， 证明 J(z)满足递推关系 J(22)一2J(m一1 和J(22十1)一2J(z)十1，且 J(1)=1。
26. 根据你关于 J(z)的公式确定 J(100)，J(1000)和 J(10 000) 。

练习 27一30 涉及雷夫难题，即具有 4 个柱和?个盘子的汉诺塔的变形问题。在给出这些练习之前，我们
描述一个弗雷姆-斯图尔特(Frame-Stewart)算法，它把盘子从柱 1 移到柱 4 并且没有较大的盘子放在较小的
盘子上面。给定盘子数 ”作为输入，这个算法依赖于一个整数上的选择，1生kt生n。当只有一个盘子时，把它
从柱 1 移到柱 4，然后算法停止。对于 *1，算法递归地使用下面的 3 步。首先使用所有的4 根柱递归地把
最小的 "一A个盘子从柱 1 移到柱 2。下一步使用汉诺塔问题的三根柱算法，不使用放 一上个最小盘子的柱，
把&个最大的盘子递归地从柱 1 移到柱 4。最后，使用所有 4 根柱递归地将 一上个最小的盘子移到柱 4。弗
雷姆和斯图尔特证明，使用他们的算法，为了达到最少的移动次数，应该选择上使得” 是不超过第上 个三角
形数关一A(A十1)/2 的最小的正整数，即 “<天ns*。有一个未被证实的猜想，称为澡雷姆猜想，就是不管
盘子怎样移动，该算法对于求解这个难题所需要的移动次数最少。

27. 证明: 具有4个盘子的雷夫难题最少可以使用 9 次移动求解。
28. 证明: 如果R(n)是由弗雷姆-斯图尔特算法求解具有 个盘子的雷夫难题所使用的移动次数，这里选择上

是满足mn<A(k十1)/2 的最小的整数,那么 Rn)满足递推关系 R(m) 一2RCn一上十2一1 和尺(0)一0，

RCI)一1。

二

*29. 证明: 如果A如练习28 所选，那么尽(ma) = yi一(下一妆241 。

4一上

*30. 证明: RD是OOV2v) 。

设{a*}是实数序列，这个序列的后向差分递归地定义如下 :
第一差分Va, 是
Va,一av一ar-l
从Vi4a, 得到第&十1 差分Vt+iav，即
V4ias一Via 一Vita，)
31. 证明: a。:=一ca,一2 Va十Via,。
32. 用 os，Va.，V*a, 的项表示递推关系a,=a,_ ,十ay, -，:。

4.2 求解线性递推关系
4.2.1 引言

本拓 各种各样的递推关系出现在模型里。某些递推关系可以用和迭代或者其他的特别技术求
”” ，解。但是，有一类重要的递推关系可以用一种系统的方法明确地求解。在这种递推关



--- 第 171 页 ---
第4童 高级计数技术。153

系中， 序列的项由 它的前项的线性组合来表示 。
定义    一个常系数的上阶线性齐次递推关系是形如
an 一 cian-l 十czav-s 十…十cea
的递推关系，其中cf ，c: ，…，ce 是实数，c*天0。

这个定义中的递推关系是线性的，因为它的右边是序列前项的倍数之和。这个递推关系是齐
次的，因为所出现的各项都是 w 的倍数。序列各项的系数都是常数而不是依赖于 的画数。阶为
是因为 a, 由序列前面的& 项来表示。

根据数学归纳法第二原理，满足这个定义的递推关系的序列由这个递推关系和个初始条件

ao 一 Coyal 一 Cat-l 一 Ci

 

唯一地确定。
例1 递推关系 P.=(1. 11)P,-,是1阶的线性齐次递推关系。递推关系 户=放-,十广-:是2 阶
的线性齐次递推关系。递推关系 a.=a,-:是 5 阶的线性齐次递推关系。                         年

下面是一些常系数的但不是线性齐次递推关系的例子。
例2 递推关系 ov一a.-,十a*_-:不是线性的。递推关系 刀.一2万,-,十1 不是齐次的。递推关系
也,一”B,-,不是常系数的。                                             国
研究线性齐次递推关系有两个理由。第一，在建立问题的模型时经常出现这种递推关系。第
二，它们可以用系统的方法求解。

4.2.2 求解常系数线性齐次递推关系

求解常系数线性齐次递推关系的基本方法是寻找形如 oa一 的解，其中~是常数。注意a,一m=
是递推关系a,一ca,-:十ca :十…十ca的解，当且仅当

六 一cr 十cr二十…十cor"
当等式的两边除以 一一并且从左边减去右边时，我们得到等价的方程
玫一cm一cr一效一cr一c一0

因此，序列{a,}以a,=王作为解，当且仅当>是这后一个方程的解。这个方程叫做该递推关系
的特征方程。方程的解叫做该递推关系的特征根。正如我们将要看到的，可以用这些特征根给出
这种递推关系的所有解的显式公式。

我们首先看一个 2 阶常系数线性齐次递推关系的处理结果。然后，叙述相应的阶可能大于 2 的
一般性结果。由于得到一般性结果所需要的证明比较复杂，本书不再殉述。

我们现在回到 2 阶线性齐次递推关系。首先，考虑存在两个不等的特征根的情况 。
4    设 ci 和 c: 是实数。 假设一一cr一c 一0 有两个不等的根 r 和天， 那么序列{e,)}是递
推关系 ae,一cua, -十cza,-:的解， 当且仅当 av一ai人十azr， nm一0，1，2，…，其中 和 是常数。

证 证明这个定理必须做两件事。首先，必须证明如果 和 是特征方程的根， 并且 ww 和as
是常数，那么序列ta,}(a,一awi十az却)是递推关系的解。第二，必须证明如果序列{a,}是解，那
么对某个常数 a 和az 有 an一oai症十azre。

现在我们将证明如果 as,=w刀十w二,那么序列{a,}是递推关系的解。因为 rm 和产是王一
cr一cz一0 的根，从而闪一cr十c，天一cm十cs。
从这些等式可以看出

cia,- 十caan-s 一ca六 十oa )二car十ar)

一am (ar 十cz) 十az天(cr 十cs)

 

2 2    一 2
一ar 妃十azrz 六
_    nm

一alrl 十az六

一a，

这证明了序列fa,}以 a,=一am站十aar: 作为递推关系的解。



--- 第 172 页 ---
154 "第4章 高级计数技术

为证明递推关系 a, = cta,-, 十cea-:的每一个解 {a,}都有形式 a,王wa站十a关，m2一0，1，
2，…，au 和 o 为某个常数。假设{a,}是递推关系的解，初始条件是 一Co，aw 一Ci。下面证明存
在常数 c 和 us 使得具有 a,一wmi十wz二 的序列{a,}满足同样的初始条件。这要求

ao 一Co 一al十az
al 一Ci 一al六十azrz
我们可以求解这两个关于 ww 和 ws 的方程。从第一个方程得到 =C.一a 。把它代人第二个方程得
Ci 一 am 十(Co 一oa )r:

因此，
Cl 一ar 一刀)十Cor
这说明了
(CC 一Cr)
ai 三 -一一一一
六 一六
和

(Ci 一Cor:) 一 Com 一C
方 一天        六 一六
这里关于 w 和 wo 的表达式依赖于 一关mm 的事实。(当产王六时，这个定理不成立.)因此，由于这
两个 和 ws 的值，具有 om忆十az关 的序列{ao}满足这两个初始条件。因为这个递推关系和这些初
始条件唯一地确定了这个序列，从而得出 a.一a站十cz于。                               口
常系数线性齐次递推关系的特征根可能是复数。定理 1(和本节后面的定理)在这种情况下仍旧
适用。具有复数特征根的递推关系在本书中不进行讨论。 熟悉复数的读者可以做节末的练习 20。
例 3 和例 4 说明怎样用定理 1 求解递推关系。
例3 什么是如下递推关系的解? 其中a 一2 和ww一7。
a, 一 Qi 十2a，，
1 解”可用定理 1 求解这个问题。递推关系的特征方程是一一r一2=0。它的根是 ~一2 和
本   r一一1。因此，序列{a,}是递推关系的解当且仅当
an 一ai2"十azr(一1)”

az 一 Ce 一al 一Cu 一

a 和 o 是常数。由初始条件，得
ao 一2一al十az
al 一?一ao， 2十cs。(一1)
求解这两个等式得wm王3 和三一1。因此，关于这个递推关系和初始条件的解是序列{a,}，
其中
al一3。2"一(一1)"                   图
例4 找一个关于斐波那契数的显式公式。
解”斐波那契数的序列满足递推关系 广=太-十几-: 和初始条件 六=0 及太王1。特征方程
才一r一1一0的根是六=(1十V5)/2 和产=一(1一上3)V2。因此，从定理 1 得到斐波那契数由
六-aa(王本) +e(二和)

给出，其中 wm 和 am 为常数。可用初始条件 厂=0 和 态=1 确定这些常数。我们有
矿=一ax十oa一0
，f1L+     1一5
1 -Eta(25E)-，
对这些关于 wx 和 oa 的联立方程的解是

oa 一1/V5，o =一1/V5
于是，斐波那契数由下面的式子给出 :



--- 第 173 页 ---
第4章 高级计数技术"155

 

1         ”1位一5
六-=直(苇区) -直(王和)              时
当存在二重特征根时定理 1 不再适用。如果发生这种情况，当 m 是特征方程的一个二重根时
那么 we,=一nr': 是递推关系的另一个解。定理 2 说明了怎样处理这种情况 。
  设 c 和 c* 是实数，c: 天0。假设 一一cr一cz一0 只有一个根 六。序列{a,}是递推关系
a,=一cla,_ ,十ca的解，当且仅当 ao,一ww十aanr ，m=一0，1，2，…，其中 和 是常数。
定理 2 的证明留作节末的练习。例 5 说明了这个定理的应用。
例5 具有初始条件 ao=1 和ai=6 的递推关系
an 一 6a,-: 一9a,-:
的解是什么?
解 产一6r十9=0 唯一的根是 ~*王3。因此，这个递推关系的解是:
an 一 al3"” 十az7zz3”
其中m 和 是常数。使用初始条件得
ao 一1一
al 一6一al。3十aa。3
求解这两个方程得 w =1 和oa:一1。从而，这个具有给定初始条件的递推关系的解是
au 一3"十m3"                                图
我们现在令述这个关于常系数线性齐次递推关系的解的一般性结果，这里的阶可以大于 2 且
假定特征方程有不等的根。这个结果的证明留给读者作为练习。

 

设 ce，cz，…，e 是实数。假设特征方程
于一Ci一…一cg一0
有上个不等的根m，产，…，产。那么序列{a,}是递推关系
a。 一 Clda,_l十czas-s 十以十ca
的解，当且仅当              an 一ai门十as于十十at

nm一0，1，2，…，其中wm ，om，…，ok 是常数。
我们用例 6 说明定理的使用。
例6 求出具有初始条件 =2,，a: 一5 和am一15 的递推关系
au 一 6a， 一11a, 十6a。:
的解 。
解 ”这个递推关系的特征多项式是
天一6壮十11r一6
因为一一6二十11r一6一(r一1)(Cr一2)(r一3)，所以特征根是 ~=1，r一2 和 r一3。因此，递推
关系的解的形式是
av一at。，1l 十oa。2"十ao。3"
为找到常数 mw，wuz 以及ww ，使用初始条件得
ao 一2一an十as十os
a 一5一am十ca。2十aa。3
az 一15 一al十aa。4十aa .9
当求解这三个关于 a，az 和ws 的联立方程时，得到 xm一1，a一一1且w 一2。于是， 这个递
推关系和给定初始条件的唯一解是满足
an一1一2"十2。3"
的序列{a, ) 。                                                            力
我们现在令述关于常系数线性齐次递推关系的最一般化的结果，这里允许特征方程有重根。
要点是对于特征方程的每个根 >，通解是形如 P(m)z 的项之和，其中 P(m是关一1 次多项式，而



--- 第 174 页 ---
156 "第4童 高级计数技术

妈是这个根的重数。我们把证明作为一个挑战性的练习留给读者 。
 设o，c，…，c 是实数，假设特征方程
六一cr一一尺一0
有上个不等的根r ，产，…，m， 其重数分别为 mi ，rma，…，mu， 满足 mm二1，i一1，2，…，t，
且 , 十zz 十…十zz,一上。那么序列{a,}是递推关系
an 一 Cla-l 十czan-y 十… 十chan一
的解，当且仅当
ay 一(al 十ai十十om-ian
十(aa 十az十… 十aam-umn )产
十…十(ae 十ao十…十 arm -im ) 天
mn一0，1，2，…，其中 ai是常数， 1委i适上且 0过)委加一1。
例 7 说明在特征方程有重根时怎样用定理 4求一个线性齐次递推关系的通解形式。
例7 假设线性齐次递推关系的特征方程的根是2，2，2， 5，5 和9(即有3个根，根 2 的重数
为3，根 5 的重数为2，根 9 的重数为 1) 。那么通解形式是什么?
解 ”由定理4，解的一般形式是
《ale 十oa十as)2" 十(aae十as)5" 十aao9”                         国
我们现在说明在特征方程有 3 重根时如何用定理 4求解常系数线性齐次递推关系。
例8 找出具有初始条件 ae王1，aw王一2 积 as一一1 的递推关系
an 一一 3a-l 一3a,-: 一ao-3
的解..
解 ”这个递推关系的特征方程是
姑十3天十3r十1一0
因为天十3普十3r十1一(r十1)  ，特征方程只有一个3重根 r一一1。由定理4，这个递推关系的
解是下述形式
au 一 alo(一1)" 十aa一1六十az二(一1)
为求出常数 Qil,oy oa和 Gl.2， 使用初始条件， 得到
ao 一1]一ai。
ai 一一2 一一ao一ai 一aa
aa 一一1一alo十2a ,十4a，
这 3 个方程的联立解是 wo一1，a 一3，a.一一2。于是，这个递推关系和给定初始条件的唯
一解是序列{a.} ，其中
av 一(1十37m一22)(一1)"                           辆

4.2.3 常系数线性非齐次的递推关系

我们已经知道如何求解常系数线性齐次的递推关系。是否有一种相对简单的技术来求解如像
av,一3a,-;十2 的常系数线性但是非齐次的递推关系呢? 我们将看到，仅仅对某些特定类型的递推
关系存在肯定的回答 。

递推关系 a,=3a, ,十2 是一个常系数线性非齐次递推关系，即形如

an 一 Clan-l十cza zs十…十ca十下(7
的递推关系的例子，其中c ，c: ，…，ce# 是实数，F()是只依赖于z 且不恒为0 的函数。递推关系
ai 一 Clav-l 十cza :十…十ca

叫做相伴的齐次递推关系。它在非齐次递推关系的解中起了重要的作用。

例9 递推关系 a,一a, -十2"，a,=一ai十ay十开十z十1，a,一3a。， ,十na3” 和a,一a, 十
a,-z十av-:十mn! 是常系数线性非齐次递推关系。相伴的线性齐次递推关系分别是 a,=a,-, ，a,一
au -1十av-s，a一3a -和a一a, -十ao-:*十aa。                                  时



--- 第 175 页 ---
第4章 商级计数技术。157

关于常系数线性非齐次递推关系的一个关键事实是，每个解都是一个特解与相伴的线性齐次
递推关系的一个解之和，正如定理5所述。

 如果{a,}是常系数非齐次线性递推关系

ay 一Clay十cza es 十…十ca十下(2)
的一个特解,那么每个解都是{a” 十ca }的形式，其中{a% }是相伴的齐次递推关系
an 一 cla-i 十czar ys十…十ca
的一个解。                              ，
证 由于{a2}是非齐次递推关系的特解，我们知道
Qi 一ca 十ca 十…十cac 十下(mo)
现在假设(2}是常系数非齐次递推关系的第二个解，使得
已 一 ci- 十cp十…十cp十下(2)
从第二个等式减去第一个等式得
玉一ai 一(一aa十cb一a)十十cr一ac)

从而得到{b,一a”}是相伴的线性齐次递推关系的一个解，比如说是{a} 。因此，对所有的
有4一ao十ao， 。                                                                                                        口

由定理 5，我们看到求解常系数非齐次递推关系的关键是找一个特解。然后每个解都是这个特
解与相伴的齐次递推关系的一个解之和。尽管不存在对每个函数 F(z)都有效的一般性方法来求这
种解，但有某些技术对特定的函数类型 F(z) ，例如多项式函数与常数的圭函数有效。例 10 和例
]11 就说明了这一点。

例 10 求递推关系 w,一3a,-,十2 的所有的解。具有 a, =3 的解是什么?

解 ”为求解这个常系数线性非齐次递推关系，我们需要求解与它相伴的线性齐次方程并且找
到一个关于给定非齐次方程的特解。相伴的线性齐次方程是 ,=3a,_,。它的解是 ec吃一c3"，其中
ax是常数。

我们现在找一个特解。因为 F(m)一22 是”的1次多项式，解的一个合理的尝试就是的线性
函数，比如说如一cn十4，其中<和 是常数。为确定是否存在这种形式的解，假设 户一cn十d 是
一个这样的解。 那么方程 ,一3a,-,十2n 就变成 cz十d=一3(c(n一1)十d)十22。化简和归并同类项得
《2十2c)m十(2d一3c)一0。从而，cz十4d 是一个解，当且仅当 2十2c=0 和 2d一3c=0。这说明 cn十z
是一个解当且仅当c=一1 和dd一一3/2。因而,ai 一一nr一3/2 是一个特解。

根据定理 5，所有的解都是下述形式

an 一ai 十am 一一?一3/2十ae。3"
其中是常数。

为找出具有 w 一3 的解，在得到的通解公式中令 xz一1。我们有 3一一1一3/2二3，这就推出
ca一11/6。我们要找的解是 a,王一*一3/2十(11/6)3"。                              国

例11 求出下述递推关系

:玉攻                                   as 一 5a, 一6a 十7
和     的所有的解。
解 这是一个线性非齐次递推关系。它的相伴的齐次递推关系

an 一 5 一6c,
的解是 a包一am “3"十ce。2"，其中wx 和 az 是常数。因为 F(m 一7"， 一个合理的解是ai=C 。 7"，
其中 C 是常数。把这些项代人递推关系得 C,， 7"=5C. 7:一6C .7一:十7*。提出公因式 7*-:，这
个等式变成 49C一35C一6C十49，从而推出 20C= 49 或 C一49/20。于是，at 一(49/20)7"是特解。
由定理5，所有的解都有下述形式        ，
an 一a。，3"十ao。2*十(49/20)7”                              图
在例 10 和例 11 中，我们赁经验猜想了一个特定形式的解。在两种情况下，我们都能找到特



--- 第 176 页 ---
1584。第4章 高级计数技术

解。这并不是偶然的。每当 F(z)是的多项式和一个常数的= 次守之积时，我们就能知道一个特
解恰好是什么形式，正如定理6 所述。定理 6 的证明作为一个挑战性的练习留给读者。
  假设ta, }满足线性非齐次递推关系
as 一 Cla li十cza ss 十……十cta 十下(7m)
其中c， Cz2y 9 CA 是实数， 且
下(z) 一(5十思 十…十包头十各)s"
其中加， 和 ，…，& 和s 是实数。当*不是相伴的线性齐次递推关系的特征方程的根时，存在一个
下述形式的特解
《恩7 十 访-n 十…十轴天十记)5
当s是特征方程的根且它的重数是ma 时，存在一个下述形式的特解
1 《户全十轧- 十十思m十力7

注意当*是相伴的线性齐次递推关系的特征方程的m 重根时，因式 ze 保证给出的特解不是相
伴的线性齐次递推关系的一个解。我们下面给出一个例子说明定理 6 所提供的特解形式。

例12 当下(m一3"，F(m一n3"，F(OmD一下2”" 和FE(C)一(于十1)3" 时，线性非齐次递推关系
ar一6a, ;一9a, :十Fo的特解有什么形式?

解 ”相伴的线性齐次递推关系是 o,一6a,-,一9a,_:。它的特征方程王一6r十9=(r一3): 一0 有
一个2重的单根 3。FGn) 的形式为 PCm%"，其中 PCn)是一个多项式，* 是一个常数。为应用定理
6，我们需要知道 *是否是这个特征方程的根。

由于 :一3 是重数 普一2 的根而 :一2 不是根，定理 6 告诉我们如果 Fnz) 一3"，特解的形式是
户直3"; 如果 F(COoD一n3"，特解的形式是到(in十加)3"; 如果 FCn)一灾2"，特解的形式是(户中十
思m十加)2"; 如果下(一(下十1)3"，特解的形式是 到(户妈十名z二加)3"。             而

在求解定理 6 所谈的那种类型的递推关系时，若 :=1 一定要小心处理。特别是把定理用于
下(7m)一如2 十久-0 十…十和2十加，参数*取值*=1 时(尽管项 1" 没有明确地出现)的情况。根据
这个定理，解的形式就依赖于是否 1 是相伴的线性齐次递推关系的特征方程的根。这将在例 13 中
说明，它说明了怎样用定理 6 找出前 个正整数之和的公式。

例13 设a, 是前”个正整数的和，即

Q，一 >
注意，a, 满足线性非齐次递推关系
as。 一 Qn_i 十天

(为从前 "一1个正整数的和 a,-,得到前”个正整数的和a.,，只需加上 ”即可)。注意初始条件
是ca: 一] 。

对于 a,，相伴的线性齐次递推关系是

这个齐次递推关系的解是 ae一c(1)"一c，其中<是一个常数。为找到 w=a, ,十nz的所有的
解，我们仅需要找一个特解。由定理6，由于 F(m 一n一mn(1)" 且s=1 是相伴的线性齐次递推关系
的特征方程的 1 阶根，存在一个形如 zf加z十库)一记天十各二的特解。

把它代入递推关系得到 户下十库z一户("一1):十负(一1)十ma。化简得 x2p 一D)十(记一户)一0，这
意味着 2户 一1=0 和 所一血=0，即 入王和锯王1/2。因此

0 一 于十于 一 m(C2十1)

”    2 2      2
是一个特解。所以，原递推关系 mw一a,-,十的所有的解由a,一ao十a思一c十az十1)/2 给出。由
于ww二1，我们有 1一oa一c十1。2/2一c十1，故 c=0。从而 ao,一nx(z十1)/2。(这和 2.4 节表 2-5给
出的以及前面导出的公式一样。                                            力



--- 第 177 页 ---
第4章 高级计数技术”159

练习

fo

tn 吃

6.

. 确定下面哪些是常系数线性齐次递推关系，如果是，求它们的阶。
a)a,一3a,-;十4a, -zz十5a-s                  ba一2nra, -十a,-:
c)a一av -1十av-4                           da一as-i 十2
e)a一导 |十as 3                         fa一au

g)au一an 1十

. 求解下述具有给定初始条件的递推关系。

a)a,一2a,_，，mn二1，ao一3                 b)a,王av -1 ，?之1，ao一2
c)ans一5a, -一6a。，。，7三2，ao一1，al一0       d)an一4a,-i一4av-z，71字2，ao一6，4a 一8
e)a一一4a,_ 1一4a, aa ，7 2，ao一0，ali一1      fa一4a_ ，7m二2，ao一0，ai 一4

g)a,一av -yz/4，m二2，ao一1，ali 一0

. 使用 4. 1 节练习 17 描述的两个信和号在 ”微秒内可以传送多少不同的信息?
. 使用1X2 和2X2 的块铺满一块 2Xzna 的长方形板，有多少种方式?
. 年初把一笔 100 000 美元的钱存人一个投资基金。在每年的最后一天得到两份红利。第一份红利是当年账

上钱数的 20% 。第二份红利是前一年账上钱数的 45%% 。

a)如果不允许取钱，找出一个关于{P,}的递推关系，其中 P, 是第 ” 年末账上的钱数。
b)如果不允许取钱，? 年以后账上有多少钱?

卢卡斯数满足递推关系

5                                           工。 一 二-1 十 工。-:

10.
11，

12，

13.

14，

15.
16.

17.
. 找出递推关系 as王4a。 :一3a,-*十2"十r十3 的具有 ao=1，ai 一4的解。

和初始条件 Lo=王2 和碟:一1。
a)证明 工.一所-十万+，n一2，3，…，其中 万是第”个斐波那契数。
b)求出卢卡斯数的显式公式。

. 求解 a,=7a, :十6a, :，ao一9，al一10，az一32。
. 求解 a,=2a,-,十5a. :一6a。 :，ao一7，a: 一一4，az一8 。
. 证明下述涉及斐波那旭数和二项式系数的恒等式:

矿 一Cna0)十CGO一1,1)十…十Cn一到:大)
其中z是正整数且上一[za/2]。[提示: 设 as=C(nr，0)十CCn一1，1)十…十Cr一上，) 。证明序列{fa.)和斐
波那契序列满足的递推关系和初始条件一样。]
求解递推关系 as一一3a, -一3a,-:一ao-3，ao一5，a一一9，az一15。
如果线性齐次递推关系的特征方程的根是1，1，1，1，一2，一2，一2，3，3，一4，那么它的解的一般
形式是什么?
考虑非齐次线性递推关系 a一3a, -;十2"。
a)证明 ca,一一2" :是这个递推关系的一个解。
b)使用定理 5 找出这个递推关系的所有的解 。
c)找出具有 ao一1 的解。
a)确定常数A和召的值，使得 ac,一An十召是递推关系a,=2a, ,十zx十5 的一个解。
b)使用定理 5 找出这个递推关系的所有的解。
c)找出这个递推关系具有 ao=4 的解。

什么是线性非齐次递推关系 a.=8a,-:一16a, :十F(nz)的特解的一般形式? 如果

a)严(mi) 一7           b)FCz)一(一2)”       c)F(Cn)一ma2"          d)下(m)一12 4"
e)下(一(天一2)(一2)” 人FFCOD一m42*         g)FCz)一2

a)找出递推关系 a.一2a, ;十3" 的所有的解。

b)找出Ca)中的递推关系具有初始条件 ai: 一5 的解。

找出递推关系 av,王5a.-:一6a, -:十2"十3n 的所有的解。[提示: 找形如 qn2"十加xz十思 的特解，其中 9，
思，思是常数。]

找出递推关系 ao一4a。 1一4av-:十(mn十1)2" 的所有的解。



--- 第 178 页 ---
160" 第4章 高级计数技术

19. 设 w, 是前 个三角形数的和， 即w = 症 w，其中心一人4十112。 证明{a。 }满足线性非齐次递推关系

ww一av_1十nn十1)/2 和初始条件 一  使用定理 6 求解这个递推关系以确定关于 av 的公式。
x*20. a)求线性齐次递推关系 ao, =w -的特征根。(注: 这些根包含复数。)

 

b)求Ca)的递推关系具有 ao=1，ar=0，a:一一1和=! 的解。
*21. a)用例 4 找到的关于第”个斐波那契数 六 的公式证明 F 是最接近
工(1土石)
v5\、 2
的整数。
b)确定对哪些上>”有 矿 大于
工(1士顾)
VS 2
对哪些z 有 六 小于

 

22. 假设留在岛上的每对遗传工程培育的兔子在一个月大时生出 2 对新兔子，在两个月大和以后的每个月都
生出 6 对新兔子。没有兔子死去，也没有兔子从岛上离开。
a)一对新生的兔子留在岛上，求出与个月后岛上兔子对数有关的递推关系。
b)通过求解(a)中的递推关系确定一对新生的兔子留在岛上?个月以后岛上的兔子对数。

23. 在一个充满活力的新软件公司，一个新女雇员的初始工资为 50 000 美元，公司允诺每年底她的工资将是
她前一年工资的2倍，并且她在公司的每年都将额外增加 10 000 美元。
a)构造一个与被雇用的第”年她的工资数有关的递推关系。
b)求解这个递推关系找出她被雇用的第 ”年的工资。

*#24. 证明定理 4。

25. 求解具有初始条件 T(1)=6 的递推关系 TCD) =n了(na/2)。[提示: 令m一2 ，然后做替换 a 一logT(24)以

得到一个线性非齐次的递推关系。]

4.3 分治算法和递推关系

4.3.1 引言
- 人  机台风和次第摔再广占各丰公是拉角全如在要一个一人   连续施用这种划分直
”” 到可以很快地找到这些较小问题的解。例如，在执行一个二分检索时把对一个元素在

表中的搜索归约为对该元素在长度减半的表中的搜索。 我们继续施用这种分解直到只币下一个元
素。当我们使用归并排序算法排序一个整数的数表时，我们将这个表划分成相等大小的两半并且
分别排序每一半。然后将两个排好序的半个数表归并。这种类型的递归算法的另一个例子就是整
数乘法的过程，它将两个整数相乘的问题分解成三组位数减半的整数相乘。这种分解连续施用直
到只剩下一位的整数为止。这些过程叫做分治算法。这是因为它们将一个问题划分成较小规模的
同一问题的一个或多个实例，然后用这些小问题的解来处理这个问题以找到初始问题的解，这当
中也许会需要一些额外的工作。

这一节将说明怎样用递推关系分析分治算法的计算复杂性。我们将用这些递推关系估计许多
不同的分治算法(包括我们在本节引入的算法)所使用的运算次数。

4.3.2 分治递推关系

假设一个递归算法把一个规模为的问题分成a 个子问题，其中每个子问题的规模是 /6(为
简单起见，假设 ”是总的倍数;实际上，较小的问题的规模常常是小于等于或者大于等于 n8 的最
近的整数)。此外，假设在把子问题的解组合成原来问题的解的算法处理步中需要总量为 g(z)的额
外的运算。那么，如果 灰m表示求解规模为”的问题所需的运算数，则得出 了满足递推关系



--- 第 179 页 ---
第4章 高级计数技术。161

Ca) 一 Cr(CaV/tD) 十(7z2)
这就叫做分治递推关系。

首先我们将建立一些可用于研究某些重要算法的复杂性的分治递推关系。然后将说明怎样用
这些分治递推关系估计这些算法的复杂性。

可 例1 二分搜索 当”是偶数时，二分检索算法把对某个元素在长度为”的搜索序列中

的搜索转变成对同一元素在长度为z/2 的搜索序列中的二分检索。(因此，规模为 ”的
问题已经被分解成规模为 "72 的问题。)为执行这个分解需要 2 次比较(一次是为了确定要用到表的
哪一半，另一次是为了确定表是和否还有项留下来) 。所以，如果 Ai)是在规模为的搜索序列中搜
索一个元素所需要的比较次数，那么当)是偶数时广m) = Cn/2)十2。                      国

例2 找一个序列的最大和最小”考虑下面的查找序列 w ，a ，…，a, 中最小和最大元素的算
法。如果 ”=一1，那么 wa 就是最大和最小的元素。如果 zx盖1，把这个序列分成两个序列，或者两者
有同样多的元素，或者一个集合比另一个集合多一个元素。问题就归约成查找两个较小序列的最
大和最小元素。比较两个较小集合的最大和最小元素，从而得到全体的最大和最小元素，原问题
的解就得到了 。

设 乒z是找半元素集合的最小和最大元素所需要的总的比较次数。我们已经说明了当交是偶
数时一个规模为”的问题可以归约成两个规模为zy/2 的问题，这里要使用2 次比较，一次是比较两
个集合的最小元素，而另一次是比较两个集合的最大元素。当=” 是偶数时就得到递推关系/(z) 一
2F(nz/2)十2。                                                     图

例3 归并排序 归并排序算法把一个具有 个项(其中为偶数)的待排序的表划分成两个
表，每个表 x/2 个元素，并且用少于”次的比较将两个排好序的表归并成一个排好序的表。因此，
通过归并排序算法排序 ”个元素的表用到的比较次数小于 M(z) ，其中函数Mn) 满足分治递推
关系

AM(m) 一2M(Cn/2)十m                        图

ER 例4 整数的快速乘法 ”令人惊讶的是存在许多比整数乘法的传统算法更有效的算法。

 ”这里描述的一个有效的算法就用到了分治技术。这个快速的乘法算法开始把每个 2n 位

的二进制整数分成两块，每块上位。然后，原来 2 位的二进制整数的乘法被分解成 3 个”位二进
制数的乘法，还要加上移位和加法。

假设 和疾是两个整数的 2” 位的二进制表达式(为了使得它们等长，如果需要的话，可在这些
表达式前面加上若干个0) 。令

Q一《aiazra aid)及一(六0
令

aa一2 4十4，20=2B十Bo
其中                 4 一 《as iaQv+tan)z，    Au 一 《ai alao )，

再一〈D， py，    Bu。 一 (D…pBDipo)，
快速整数乘法算法是基于恒等式

吗一(2 "十20)AB 十2"(4A 一A)(B, 一B)十(2" 十1)A,B，

关于这个恒等式的一个重要的事实就是，它证明了两个 2n 位整数的乘法可以用 3 个 ”位整数

的乘法加上加法、减法以及移位来实现。这证明了如果 /Km)是两个”位整数相乘所需的按位运算
的总数，那么

大(2m) 一 3FCn) 十 Cr

这个等式成立的理由如下: 3 次”位整数的乘法可以使用 3/(z)次按位运算实现。每次加法、减

法和移位使用的运算次数是 ”位运算的常数倍，而 Ci 表示由这些运算用到的总的按位运算数。 国

:7天训 例5 ”快速矩阵委法”使用矩阵乘法的定义进行两个 >Xn 矩阵相乘需要mm 次乘法和

”于(Cna一1)次加法。因此，按照这种方法计算两个>Xz 矩阵之积需要 OUa)次运算(乘法

和加法)。令人惊讶的是，对于两个">Xn 矩阵相乘存在更有效的分治算法。这个由 V。斯特拉森于



--- 第 180 页 ---
1602。第4章 高级计数技术

1969 年提出的算法当”是偶数时将两个zxXzmz 和气阵的相乘归约为两个(2) X (z/2)和矩阵的7 次相乘
和(nr/2) X (nz/2)和矩阵的15 次相加。(要了解这个算法的细节见[CoLeRiSt01]。)于是，如果 jz)是
用到的运算(乘法和加法?次数，那么当”是偶数时有
Cn) 一7FCn2) 十15m2274                           图
正如例 1一例 5 所示，在许多不同的情况中都出现了形如 F(m) 一ajF(nVb)十g(z)的递推关系。
可以对满足这种递推关系的画数的阶作出估计。假设 了满足这个递推关系，其中疾可被训整除。令
一欠，其中上是一个正整数。那么
大(一 ar(n/p) 十gmD)
一 az 六my/术)十ag(nVD) 十gz)
一 aa nz/术) 十az2g(m/s)十ag(r/b) 十g(m)

atFCna/扩十 > oag(Ca/t)
由于 z/巡王1，从而有
Ja 一atf()十> ug(Ca/i)

我们可以使用这个关于 帮m)的等式估计满足分治关系的函数的阶。
  设 了是满足递推关系
Cn) 一 ar(Cn/5) 十<
的增函数，其中被少整除，a过1，2是大于 1 的整数，c 是一个正实数。那么
Fn) 是 O(Cnes ) 如果a>1

O(Iognr) 如果a 一1
进一步，当 "一六 ，其中上是正整数，
Fr) 一 Cimae 十C，
其中 Ci= Fl1)二cy/(a一1)且 C:=一c/(Ca一1) 。
证 首先令 ”=一睛。由定理前面的讨论得到的关于 六思的表达式和8&g(m一c，我们有
ja =一al)二>)arc 一os) +cS fi
先考虑 a一1 的情况。那么有
Ja) 一 FI)十羽
由于 zx"一上鳃，我们有一logsm ，于是
nm) 一 Fl1) 十clogom
当z不是2 的赛时，对某个正整数上有上兰一nm一#和后。由于 厂是增加的，故 Fa)扫F+) 一
01)十c(R二1)一(FL)十c)十c妥(Fl1)十c)十clogm。因此，当a=1 时在两种情况下 rz)都是
CO(logm) 。
现在假设 ae>1。首先假定 x一欠, & 是正整数。由几何级数的求和公式得
nz) 一atr(1)十c(o一1)/(a一1)
一at[ FI1) 十c/(a一1)]一ca一1)
一Cnexe 十 C，
这是由于性一ae一mw ，其中CI一FG1)十c/(e一1)且 C:王一c/(a一1) 。
现在假设 "不是2 的宕。那么苹一nr< ，其中上是一个非负整数。由于 了是增加的，
Fn 二Fi) 一 Ciat 十C，
<妈(Ca)aee" 十C，
<(Cia)mese 十C，
这是由于 &生loginz一A十1。



--- 第 181 页 ---
第4章 高级计数技术。163

于是，Fm)是 OOmamae ) 。                                   口
例 6一9 说明怎样使用定理 1 。
例6 设m=5FGa2)十3且 FL一7，求 F(2)，其中&是一个正整数。如果 了是一个增画
数，请估计 /nm) 。
-是i， 解”从定理 1 的证明，考虑ae一5，6一2，c一3，我们看到如果 "一2 ，那么

Fn 一ot[FG1)十c/(a一1)]十[一c/(a一1)]
一5[7十(3/4)] 一3/4
一55(31/4) 一3/4
又如果 zz是增加的，定理1证明了 (mm是OOnee )一OOnmee ) 。                      力
我们可以使用定理 1 估计二分检索算法和例 2 查找序列的最小和最大元素的算法的计算复
杂性。
例7 估计二分检索使用的比较次数。
解 在例1 中证明了当交是偶数时 jm = F(m2)十2，其中 Fa)是在规模为的序列中实现一
个二分检索需要的比较次数。因此得出 Fi是 O(logn) 。                            国
例8 估计用例 2 给定的算法查找序列的最大和最小元素所使用的比较次数。
解 在例 2我们证明了当)是偶数时 Fm) 一2F(Cz/2)十2，其中了是算法需要的比较次数。于
是，由定理 1 得到 六四一OCnaoe)一On)。                                    国
我们现在叙述一个更一般、更复杂的定理，定理 1 是它的特例。这个定理(或者更强的版本)
有时称作主定理(MasterTheorem) ，因为它在分析许多重要的分治算法的复杂性中很有用 。
  主定理 设 了是满足递推关系
Fn) 一 aF(nVp) 十om
的增函数，其中 mn一久，A是一个正整数，a过1, 少是大于 1 的整数，c 和q 是实数，满足c 是正的
且恕是非负的。那么

fOCnzz )       如果a 一中
JomD) 是|0Ceiee)   如果a 一品
CO(raege )    如果a 二娩

定理 2 的证明留给读者作为本节末的练习 11一13。

例9 归并排序的复杂性 在例 3我们解释了用归并排序来排序 ”个元素的表使用的比较次数
少于M(Cm，其中 M(m一2M(CzV2)十za。根据主定理(定理 2)我们找到 MD是 O(nrlogm) 。     国

例10 估计使用例 4 描述的快速乘法算法做两个”位整数相乘所需要的按位运算次数。

解 例4证明了当?是偶数时 /=37FCn/2)二Cnz，其中 jn)是使用快速乘法算法做两个m
位整数相乘所需的按位运算次数。于是，由定理 2 得到 F(z)是 O(nee )。注意 log3一1.6。因为通
常的乘法算法使用 O( )次按位运算，所以对于足够大的整数，包括实际应用中出现的大整数，快
速乘法算法在时间复杂性方面比通常的算法有了本质的改进。                      国

例11 估计使用例 5 的矩阵乘法算法做两个zaXzn和矩阵相生所需要的乘法和加法次数。

解 令 /表示使用例 5 提到的算法做两个nzXijz 矩阵相乘所需的加法和乘法次数。当是侦
数时我们有 j(m一77F(a/2)十15/4。于是由定理 2 得到 四是 O(nee )。注意 log7一2.8。由于通
常的两个m上xz和抢阵相乘的算法要用O( )次加法和乘法，显然，对足够大的整数nan，包括出现在许
多实际应用中的大整数，这个算法比通常的算法在时间复杂性方面更加有效。            图

最接近点对问题 ”我们在结束这一节之前引信一个来自于计算几何的分治算法，计算几何是
离散数学的一部分，专注于求解几何问题的算法。

| 例12 最接近点对问题 ”平面上有?个点(zi， 2)，(z，yYm)，… (zy)的集合，
其中两点(z，y)和(zi，y)之间的距离是通常的欧几里得距离



--- 第 182 页 ---
164。第4章 高级计数技术

W (zi一郊下十(yy 一恤放

考虑确定其中最接近的点对的问题。这个问题见于许多应用中，例如确定在某航空控制中心
管理的特定高度的空间最近的一对飞机。怎样以一种有效的方式找到这个最近的点对?

解“为解决这个问题，可以首先确定每对点的距离，然后找到这些距离的最小值。但是，这
种方法需要 O(呈)次的距离计算和比较，因为存在 C(z，2) 一z(z一1)7/2 个点对。不过存在一个精
致的分治算法，对于 ”个点可以用O(Czlogz)次的臣离计算和比较求解这个最接近点对问题。我们
在这里描述的算法是归功于米凯尔。萨莫斯(见[PrSa85]) 。

为了简单起见，假设 一关，其中上是正整数。(我们避免某些当”不是2 的寡时必需的技术上
的考虑) 。当 mn王2 时，只有一对点; 在这两个点之间的距离就是最小距离 。

算法的递归部分将问题划分成两个子问题，每个涉及一半的点。第一步使用归并排序算法，
根据这些点的z坐标对点进行排序。这需要 O(nlogm)次运算。一旦根据它们的 z 坐标对这些点排
好序，我们画一条垂线Z将?个点分成两部分，左半部分和右半部分大小相等，每部分包含wy/2 个
点，如图4-5 所示。(如果有任何点落到划分线 ZL上，必要的话，我们把它们分在这两部分里。)在
后面的递归步骤我们不再需要根据 zx坐标排序，因为我们可以从所有的点中选择对应的排序子集。
这个选择是可以用 O(z)次比较完成的任务 。

帮      @@

1
上
1
1
上
         在这个图示中，在16个点的集合中找最
1 友        接近点对的问题归约成两个在8个点的集
1
1
1
上
1
上
下
1
1
1
1

1
|
1
1
1
!
1
1
1
1
1
1
1 二
1
1
1
1
1
1
上
1
1
1
1
1

各         合中找最接近点对的问题和确定中心在
对、                         宽为2d的间隙中是否存在比d-min(dr, an)
。                 更近的点的问题
本
工      @                                 民
UL
可      二

图 4-5 求解最接近点对问题的算法的递归步

最接近的点对的位置有三种可能: (1)它们两点都在左部区域工，(2)它们两点都在右部区域
R,，(3)一点在左部区域且另一点在右部区域。递归地使用这个算法计算 由 和dans，其中心 是在左
部区域的点之间的最小距离，ds 是在右部区域的点之间的最小上距离，令 d一min(d, ，cds)。为了成
功地将在原始集合找最接近点对的问题划分成在两个区域分别找最短距离的问题，我们必须处理
算法的治之部分，这要求我们考虑最接近的点处在不同的区域的情况，即一点在二中，另一点在
刃中。因为存在一对点距离为 4，或者它们都在R中,或者它们都在工中。对于分在不同区域的最
接近的点，要求其距离一定小于 ad。

如果一点在左边区域，一点在右边区域且处在小于 4 的距离内，这些点一定位于宽度 24 的以
4 作为其中心的垂直间隙中。(和否则，这些点的距离一定大于它们的 > 坐标之差，而这个臣离将超
过 d。)为了检查在这个间阶中的点，我们对它们进行排序并按照 y 坐标递增的顺序把它们列出来。
这可以使用归并排序用 O(n log 站次运算做到，并且只需在算法开始时做一次，而不是在每个递归
步做。在每个递归步，我们从已经按照其 y 坐标排好序的所有点的集合,构造在这个区域内的根
据其 > 坐标排序的点的子集，这可以用 O()次比较做到。

从间距中具有最小 y 坐标的一个点开始，我们连续地检查间辽中的每个点，计算这个点与间



--- 第 183 页 ---
第4章 高级计数技术"165

辽中所有其他具有较大 y 坐标且与这个点的距离小于d 的点之间的下离。注意到为检查点 户，我们
只需要考虑在 如和下述和矩形中的一组点之间的距离。这个和矩形的高为 4%，宽为 2d, 刀在它的底边
上，并且它的垂直边与;的距离为d。

我们可以证明在这个点集中至多存在 8 个点，其中包含 娟在内(或者在这个 24Xd 的矩形的边
上)。为了看到这一点，注意到在图 4-6 所示的8个 d/2Xd/2 的正方形中，每个正方形内部至多
可能存在一个点。这是由于在一个正方形的边上或者内部最远距离的点是对角线的长度 d/ V2 (使
用勾股定理可以得到) ，这个距离小于qd，并且每个这样的正方形是完全处在左区域或者右区域内。
这意味着在这一步我们至多只需要与4 比较 7 个距离，这些距离是在 户和和扼形内部或者边上 7 个
或者更少的其他的点之间。

包含p在内，至多8个点可能
处在中心在5的24X da的矩形内
或考边上，上因为8个(df2)X{df2)
的正方形中，每个内部或边上
至多o可能存在一个点。

 

图4-6 说明对间耻中的每个点至多需要考虑另外 7 个点

由于在宽为 2d 的间隙中的总点数不超过 飞集合中的总点数) ，至多需要与 & 比较 7 个距离以找
到点之间的最小距离。即只存在 7个距离可能小于 d。因此，一旦用归并排序按照这些点的坐标
和>坐标对它们进行排序以后，我们发现求解最接近点对问题需要的比较次数不超过满足递推关系

1) 一27C2) 十77m

的增函数 F(a)，其中 /2)王1。根据定理 2，得到 /(z)是 O(nlogz) 。用归并排序算法根据点的x
坐标和>y 坐标对点做两次排序，做每次排序用 O(nlogm)次比较，在算法的 O(logn)个步中的每一
步，这些坐标的排序子集每次可以用 O(z)次比较得到。因此，这个最接近点对问题可以用
O(Crzlogm)次比较求解。                                                 国

练习

. 在 64 个元素的集合中，做二分检索需要多少次比较?

. 使用快速乘法算法乘(1110)， 和(1010)， 。

' 确定在例 4 中的常数 C 的值，并且使用它估计用快速乘法算法做两个 64 位二进制整数相乘所需要的按位
运算次数。

4. 假设当”被 3 整除时有 rz)= ronay3)十1 和Fl)一1，求

ca 9 一

a)太(3)                       b) (27)                     c)A(729)
5 假设当”被 5 整除时有 Fm)一Fn/5)十3 和1)一4，求
a) (5)              b) /125)            c)7(3125)

6. 假设 ”个投票人为不同的候选人(可能存在多于 2 个候选人)进入某个办公室投票 ，选票作为一个序列的元
素。如果一个人得到的选票超过半数他就赢得竟选。
a)设计一个分治算法确定是否一个候选人得到半数选票，如果是，则确定这个候选人是谁。[提示: 设，
为偶数，并且将选票序列划分成两个序列，每个序列具有 ny/2 个元素。注意到如果对于两个半长序列每
一个都没有得到一半以上的选票，那么一个人就不可能得到所有选票的一半以上,]



--- 第 184 页 ---
166，

并#吕

10.

#]]。
#]12.

13.

4.
4.

 

第4章 高级计数技术

b)使用主定理估计你在(a)中设计的算法所需要的比较次数。

. 设函数 了满足递推关系 Fn) = 2f(Vna) 十1 ，其中站是大于 1 的完全平方数且 乒2)一1。

a)求 F(16) 。
b)求关于 jz的大O估计。[提示: 做替换 m一logn。]

. 这个练习涉及求 ”个实数序列的连续项的最大和问题。当所有的项都是正数时，所有项之和就给出了答

案，但是当某些项是负数时情况就比较复杂了。例如，序列一2，3，一1，6，一7，4 的连续项的最大和是
3十(一1)十6一8。(这个练习基于[Be86]) 。

a)使用伪码描述一个求解该问题的算法，这个算法依次找从第一项开始的连续项之和，从第二项开始的连
绫项之和，等等，并在算法执行时记录当前找到的最大和。

b)依照所做的计算和的次数与比较次数确定在(a)中算法的计算复杂性。

c)设计一个分治算法求解这个问题。[提示:假设序列中有偶数个项，把这个序列分成两半。解释当连续项
的最大和包含了在两个半序列的项时怎样处理这种情况。]

d)使用(c)中的算法求下面每个序列的连续项的最大和: 一2，4，一1，3，5，一6，1，2; 4，1，一3，7，
一1，一5，3，一2; 一1，6，3，一4，一5，8，一1，7。

e)对于(c)中的分治算法使用的求和次数和比较次数求一个递推关系。

们使用主定理估计这个分治算法的计算复杂性。依照计算复杂性把这个算法和(a)中的算法做比较，结果
如何?

. 使用例 12 描述的求最接近点对的算法，使用点之间的欧几里得距离，求下述点(1，2)，(1，6)，(2，4)，

(2，8)，(3，1)，(3，6)，(3，10)，(4，3)，(5，1)，(5，5)，(5，9)，(6，7)，(7，1)，(7，4)，(7，
9)，(8，6)的最接近点对。
如果两点间的距离定义是 da(CCrz，yY)，(z，太))一max( | 盖一站 | ，| 一六 | ) ,使用例 12 描述的算法
中用的那些合理的步骤并加以改变，构造一个求两点之间的最小距离的算法 。
在练习 11一13 中，假设 了是一个满足递推基系 J(m)一af(n/b十cn 的增函数，a三1，0 是大于 1 的整
数，c和是正实数。这些练习提供一个关于定理 2 的证明。
证明:， 如果 a王凡 且交是的宪， 那么 Fo一Fl)十cmdlogsn。
证明: 如果 a天名 且半是少的寡，那么 FmD一Ci 十Conows ，其中

Ci一久cy/ (8一上a)且 C: 一 FL)十ca一妈)
使用练习 12 证明: 如果 aa如，那么 Fn是 OCnlme ) 。

4 生成函数

4.1 引言                            .

天三355 表示序列的一种有效方法就是生成函数，它把序列的项作为一个形式震级数中变量 z
“” ”的震的系数。可以用生成函数求解许多类型的计数问题，例如在各种限制下选取或分

配不同种类物体的方式数，使用不同面额的硬币换一美元的方式数等。也可以用生成函数求解递
推关系。它先把关于序列的项的递推关系转换成涉及生成函数的方程，然后求解这个方程并找出
关于这个生成函数的封闭形式。从这个封闭形式可以找到生成函数的震级数的系数，从而求解了
原来的递推关系。生成函数也可以利用函数之间相对简单的关系来证明组合恒等式，由于这些关

系
用

可以转换成涉及序列的项的恒等式。生成函数是有用的工具，除了本节描述的内容以外，可以
它来研究序列的许多性质，例如建立关于序列的项的渐进公式。

我们从序列的生成郴数的定义开始。

抽  实数序列 we ，a ，…，at，…的生成函数是无穷级数

CCZ) 一 ao 十ai十…十az十… 一  > yakz'

更一日

 

注意 定义1给出的{fat}的生成函数有时岂做(at}的普通的生成函数，以和这个序列的其
他类型的生成函数相区别。



--- 第 185 页 ---
第4章 高级计数技术。1067

0 例1 序列{a)}具有内s一3，a 一&十1 和as一2 的生成函数分别是 >) 3z，

(RE十1)克>) 24z+。                                          怠
我们通过轩 an+1一0，an+tz一0， 依此下去， 把一个有限序列 Co ay人， Qn 扩充成一个无限序
列，就可以定义一个实数的有限序列的生成函数。这个无限序列{a,}的生成函数 G(z)是一个二次
多项式，因为当J7>m 时没有形如aiz: 的项出现，即
          G(z) 一ao 十ai十…十ao
例2 序列1，1，1，1，1，1 的生成函数是什么?
解 1，1，1，1，1，1 的生成函数是
1十z十对十旭十双十好
由 2.4节的定理 1 有
(z5一1)Vz一1) 一1十z十对十王十天十2
因此，G(Cz)一(切一1)/(z一1)是序列1，1，1，1，1，1 的生成函数。              国
例3 设靖是正整数。令 ww 一CGOm，有，&一0，1，2，…，m。那么序列 ae ，al ，…，an 的生
成郴数是什么?
解 ”这个序列的生成函数是
G(z) 一 C(za0) 十CGOm1)并十COmny2)z2 十… 十CCmyza)z”            国
二项式定理证明 GCC(z)一(1十z)”。

4.4.2 关于壤级数的有用事实
当用生成函数求解计数问题时，通常将它们考虑成形式因级数。这里忽略了这些级数的收敛
问题。但是为了应用某些微积分的结果，考虑朝级数对什么 收敛有时是很重要的。在我们的讨
论中将不涉及收敛性问题。熟悉微积分的读者如果想了解所涉及级数的收敛性的细节，可以参阅
有关这方面内容的教科书。
现在我们将叙述某些与无穷级数有关的重要事实，这些将在研究生成函数时用到。这些事实
的讨论和相关的结果都可以在微积分教科书中找到。
例4 琐数 F(z)=王1/(1一z)是序列1，1，1，1，…的生成函数，因为对|z|1二1有
17/(1一z) 一1十工十王十…                      图
例5 函数 F(z)=1/(1一az)是序列 1，a， ao: ，a ，…的生成函数，因为当 | az |到1或等价
地说对|zx|一1/ |a| ，a天0有
1/(1一ar)一1十ar十azrz 十…                       医
我们也需要了解两个生成函数是怎样相加和相乘的。这些结果的证明也可以在微积分教科书
中找到 。

  令 F(z) 一 2 az， gCz) 一 21 ze ，那么
二一人             一0

JF(z) 十gz) 一 > (as十太)丰

JCz)g(z) 一 立(六op )z
注意 正如本节所考虑的所有级数一样，定理 1 只有当畦级数在一个区间内收仇时才有
效。但是，生成函数的定理并不仅局限于这种级数。在级数不收歼的情况下，定理 1 中
的命题可以看成是生成函数和与积的定义。

我们将在例 6 中说明怎样使用定理 1。



--- 第 186 页 ---
168。第4章 高级计数技术

例6  设 F(z)一1/(1一z)。 用例 4 求出表达式 FTZ) 一 yaiz: 中的系数au ， Qi az o

 解 由例4看出
1/(1一z) 一1十z十妇十三十…

因此，由定理 1 有    。

UG am:= 人(1)m= 六(二Dr                国
注意”这一结果也可以通过微分从例 4 导出。从已知生成函数的恒等式产生新的恒等式的一
种有用的技术就是求导。

为了用生成函数求解许多重要的计数问题，我们需要在指数不是正整数的情况下应用二项式
定理。在叙述广义二项式定理之前，我们需要定义广义二项式系数。

设"是实数且4 是非负整数，那么广义二项式系数(，)定义为

人(涩= 人 若&二0
大   1             若上一0
例7 求广义二项式系数( )和(2人
解 在定义2 中取v= 一2 和A一3得
()= 一2)(一3)(一4) -4
3

 

)的值。

类似地取 x王1/2 和&=3 得
(全)=QL2Q42 一DOQ72一2
3           31!
一(1/2)(一1/2)(一3/2)/6
一1/16                                国
当上边的参数是负整数时，例 8 对广义二项式系数提供了一个有用的公式。我们后面的讨论
中会用到它。
例8 当上边的参数是负整数时，广义二项式系数可以用通常的二项式系数的项表示。为此只
需注意到

一PN _ (一1)(一兄一1)… (一天一”十1)          v 一        。
(人 ) =      由广义二项式系数定义

六

_ (一UDC十1) (2十7一1)        从分子的每一项中提取因子一1

|

二- (一1) (十"一1)(a十一2) 7     由乘法的交换律

三!

二(一DC十一1)1 站                  分子和分母同时乘以(一1)1
十rr一1】
-cr(         由二项式系数的定义
一(一1)7C(C2 十>一1,r)               使用另外一种二项式系数符号表示
[

我们现在令述广义二项式定理。
 广义二项式定理 设z是实数，| | 二1, “是实数，那么

G+z六=六 (2)z:

旧一日



--- 第 187 页 ---
使用例 8 所提供的关于{( ， )的简单公式得到

第4章 高级计数技术，169

可以使用麦克劳林级数的理论证明定理 2，我们将这个证明留给熟悉这部分微积分的读者完成。
注意 当x 是正整数时，广义二项式定理就归约到 3.4节提出的二项式定理，因为如果

&>>u，在这种情况下 (= 0。

例 9 说明了当指数是负整数时定理 2 的应用。
例9 当交是正整数时,使用广义二项式定理求(1十z)”和(1一z) ”的生成函数。

解 ”由广义二项式定理得

加

G+ao = 辣( jz

oo

二玫刘

(1十z一一 >) (一DC十民一1大)太

二一站

用一工代替 z 得到

〈] 一并”一

CC十有一1 达                   国

表4-1 归纳了一些经常出现的有用的生成函数。

表 4-1
CCz)

(1十zm" 一 >) CCmR)A4
到一六

一1十C(n,1)工十C(m2)zn 十… 十"

(1十ar)" 一 》) CCnk)atzt
业一个

一1十Cn 1l)azr 十Ca,2)a2tzrz 十… 十QnrTy

(1十zD)" 一 > COnak)zr
不王站

一1十Cr,1)zr十Cay2)2z2r 十… 十工"

 

]】 一

1工一工

 

rn+l

一 症太一1十xz十旭十…十a
二一人

1

1 一工

 

] 一 cr

 

一一一 2太一1十zz十于十……
hx=0

]   一 》 atrt 一TI十ar 十a2z2 十

km

i -一 >)xk 一1十zr十zar十……
开  ks

1 _ -cd+br =      十.
Cr  它人 + Dr+t 一工十2z十3zz十
1 -六     -   4
站er  它Co 工友)工

一1十C(nl)z十Cn十1,2)z2 十…
-1 _ -cot icCDu
让 之Co 不一1 )(一 1)4z

一1一CGOna1)z十CGO十1,2)z2 一…-

有用的生成函数

CC)

CC天)ak

当 /时为CCnk/r) ,否则为0

当丰和站时为 1,和否则为0

克

当 -时为1,否则为0

下十开

C(m十开一1) 一 Cn十R一1一1)

(一DACGn十一1 一(一])8CG十大一1一1)



--- 第 188 页 ---
170 "第4章 高级计数技术

(续)

   

 
  

”mm       一1,K)atrt
它Co  1                        Cn十开一1到)ax 一C(m十开一1一1)at

一1十C(n1)ar 十CCm十1,2)azzz 十…

  
 

TAR1

   
                                                                                                                                                                                                                                                                  

 

二 (一 1)t+1    2  3
In十z) = 六 近一=一本十本一王十     (一1)8+1/
二0

注: 在大多数徽积分的书中讨论标级数的部分可以找到关于最后两个生成函数的级数。

4.4.3 计数问题与生成函数

生成函数可以用于求解各种计数问题。特别地，它们可以用于计数各种类型的组合数。在第 3
章，我们开发了一些技术计数 ”元素集合的允许重复的~组合数，在这些组合中可能存在某些附加
的约束。这种问题与计数形如

el十ez十…十es一C
方程的解是等价的，其中 C 是常数，每个 e 是可能具有某些约束的非负整数。也可以用生成函数
求解这种类型的计数问题，正如例 10一例 12 所示 。

例10 求

ei 十ez十es一17
的解的个数， 其中 el ez2，e3 是非负整数， 满足 2和e 近5， 3委e 委6， 4委ea和7。
解 具有上述限制的解的个数是
(下十丰十于十嫩)(大十寻十菇十帮)(人zt十顾十丰十荆)
的展开式中 z 的系数。这是因为我们在乘积中得到等于 zx 的项是通过在第一个和中取项 ze ，在
第二个和中取项 z* ，在第三个和中取项 zs ，其中寡指数 e ，e 和 e: 满足方程 。 二e:十e:王17 和给
定的限制。

不难看出在这个乘积中的 z的系数是3。因此，存在 3 个解。(注意，计算这个系数与枚举方
程的具有给定约束的所有解几乎要做同样多的工作。但是，正如我们将看到的，这里说明的方法
常常可以用于求解各种各样的具有特殊规则的计数问题。此外，可以用计算机代数系统做这种
计算。)                                                                         图

例11 把8块相同的饼干分给 3 个不同的孩子，如果每个孩子至少接受 2 块饼干并且不超过 4
块饼王，那么有多少种不同的分配方式?

解 ”因为每个孩子至少接受 2 块饼干且不超过4 块鲜干，在关于序列{C,}的生成函数中对每
个孩子存在一个等于

(关十三十并)
的因式，其中 c, 是分配” 块饼干的方式数。因为存在 3 个孩子，这个生成函数是
(z十妇十好)

我们要求这个乘积中的 蕊 的系数。理由就是在展开式中 世 的项对应于选 3 项的方式数，其中
每个因式选 1 项且指数加起来等于8。此外， 来自第一、第二和第三个因式的项的指数分别是第
一、第二和第三个孩子接受的饼干数。通过计算说明这个系数等于6。于是存在 6 种方式分配饼于
使得每个孩子至少接受 2 块，但是不超过 4 块饼于。                                            图

例12 把价值1美元、2 美元和 5 美元的代币插入售货机为价值 ~ 美元的某种物品付款，使用
生成郴数确定在代币插人是有序的和无序的两种情况下付款的方式数。(例如为一种价值 3 美元的
物品付款，当不考虑代币播人的次序时存在 2 种方式: 插入 3个1美元的代币或1个1美元和1个
2 美元的代币。当考虑代币插入的次序时有 3 种方式: 插入 3个1美元的代币，插人1个1美元代



--- 第 189 页 ---
第4童 ”高级计数技术" 171

币然后 1 个 2 美元的代币，揪人 1个2美元代币然后 1个 1 美元代币。)

解 ”在不考虑代币插人次序的情况下，我们所关心的就是为产生 ~ 美元的总数所使用的每种
代币的数目。因为可以使用任意多个 1 美元的代币、任意多个 2 美元的代币和任意多个 5 美元的代
币，答案就是在生成函数

(1十工十王十瑟十入)人(1十妇十好十生十(1十和十z十三二和)
中的关 的系数。(这个乘积中的第一个因式表示所使用的 1 美元代币，第二个表示所使用的 2 美元
代币，第三个表示所使用的 5 美元代币。.)例如，用1美元、2 美元和 5 美元为一个价值 7 美元的物
品付款的方式数由展开式中 二 的系数给出，结果等于 6。
当考虑代币插人的次序时，插人人恰好 ”个代币产生 ~ 美元总数的方式数是在

(立十妆十闻)
中的z关 的系数，因为这半个代币中的每一个可能是 1 美元代币、2 美元代币或 5 美元代币。又由于
可以播人的代币不限数量，因此当考虑代币插入的次序时，使用 1 美元、2 美元或 5 美元代币产生
r美元的方式数是在

1十(z十了十卫) 十(z十辽十z5)2十…一    1

1一(z十天十节)
1

证
中的系数。这里我们把插入0个代币、1 个代币、2 个代币、3 个代币等方式数加起来，同时我
们使用了人恒等式 1/(1一z)一1十z十寻十…且用 z十妇十二 代替了 zx。例如，用 1 美元、2 美元和5
美元的代币为一个价值 7 美元的物品付款，当考虑使用代币的次序时，方式数是这个展开式中 妆
的系数，等于 26。[为看到这个系数等于26，要把(z十刀十三)久的展开式中xz? 的系数加起来，其
中 2委kt委?7。这项工作可以用大量的手工计算完成，也可以使用一个计算机代数系统来完成。] ”国

例 13 说明了当求解带不同假设的问题时生成函数具有的多功能人性。

例 13 假设已经建立了二项式定理，使用生成函数找出 ”元素集合的& 组合数。

解 ”集合的”个元素中的每一个元素都对生成函数 F(z) 一 袜sr 贡献了项(1十zx)。因此

Jz)是关于(as}的生成函数，其中 a 表示) 元素集合的人 组合数。   于是，
COz) 一(] 十)”

但是由二项式定理，我们有
Jz) 一 盖(jz

二一

其中
(站)= 去<-开
&) AI一A)1
于是，C(z，A) ，?2 元素集合的上 组合数是

72
有1(7m 一到)1                                  晶

注意 在3.4节我们使用了关于元素集合的r 组合数的公式证明了二项式定理。这些例
子说明也可以用数学归纳法证明二项式定理，再用二项式定理推导关于灵元素集合的 组
合数的公式。

例14 使用生成函数找出当元素允许重复时 元素集合的> 组合数公式。
解 设G(z)是关于序列{fa.)的生成函数，其中 ao, 等于”元素集合的允许重复的> 组合数，

GCnD = 冯 az” ，即当我们构成允许重复的 -组合时， 对=元素集合的元素的选择不受限制，这 ">
个元素中的每一 一个元素都对G(z)的乘积展开式贡献了(1十z十袜十妇十…)这个因式。这是由于当



--- 第 190 页 ---
172" 第4章 高级计数技术

一个~组合被构成时(要选总共 -个元素)，每个元素都可以被选择0次、1次、2次、3 次，等等。
因为集合中存在 “个元素，且每一个都对 CG(z)贡献了相同的因式，从而有
G(Cz) 一(1十工十妇十和)
只要 | z| <二1，我们就有 IT十zx十刀十…一17(1一zx) ，所以
GCTz) 一17(1一工”一(1一并“
使用广义二项式定理(定理 2) ，得到

(1一z…一(1+(一z)一一 守人 ”)一o
re

当-是正整数时，7z 元素集合的允许重复的~组合数就是这个和式中的<" 的系数。因此，使用
例 8 我们求出 a, 等于

( 六) 1 =(一DCn二rr一1,r) 。(一1)
|

一C(7十r一1,r)                            轿
注意，例 14 的结果与我们在 3.5 节定理 2 所叙述的结果一样。

例15 使用生成函数求出从半类不同的物体中选择 ~ 个物体并且每类物体至少选 1 个的方
式数。

解 ”因为我们需要每类物体至少选 1 个，这半个类中的每类物体都对序列{a.}的生成函数
C(Cz)贡献了因式(z十己十妈十…)其中o 是从?类不同的物体中选择 r 个物体并且每类物体至少选
1 个的方式数。因此，

GCCz) 一 (Z十对十耻十一交(1十区十娃十0)一/1一并)"
使用广义二项式定理和例8，有
C(z) 一7] (一工)

一Z (1一工

-z了(7)c

-xz一 1])7CGCa十一1:m(一1
一 习co+r 1 ,mx

一 2cc- ] 一 好)工/

= ycdr一lir一mr

在倒数第二个等式我们令 :一“十r 以使得当r=0时:nm且nm二r一1一:一1，从而对求和进行了
移位，然后在最后的等式中用 > 替换+ 作为和的下标而回到了初始的记号。因此，从类不同的物
体中选择 r 个物体，如果每类物体必须至少选 1 个时存在 CCr一1，r一站种方式。          加

4.4.4 使用生成函数求解递推关系

我们可以通过找相关的生成函数的显式公式来求解关于递推关系和初始条件的解。这可以用
例 16 和例 17 来说明。

例16 求解递推关系 4一3a -li，Kk一1，2，3，…且初始条件 ao一2。

了 解 设 G(z)是序列fo)的生成函数，即 G(z) = 立 ur 。首先注意到

本        ~
ZTCG(Z) 一 > ) akz4t 一 > ai
下一        二严于



--- 第 191 页 ---
第4童 高级计数技术"173

使用递推关系有
GCz) 一3xGCzr) 一 > atz' 一 3 > 7at-i

一Go 十 > (as 一 3ak 1 )玫
二上

一2
因为 ao一2 且 aw一3ak-; ，于是
G(z)一3zCGCz) 一(1一3z)GCz) 一2

求解 G(Cz)得 G(z)=2/(1一3z)。使用表 6-1 的恒等式 1/(1一az)= >，atz+ ，我们有

GCCz) 一2>)34z+ 一 272。34zt
于是，a 一2 .34。                                                  ” 国

例1I7 设一个有效的编码字是一个包含偶数个 0 的十进制数字串。令 a, 表示”位有效编码字

的个数。在 4. 1 节的例 7? 中我们证明了序列{a。}满足递推关系
ay 一8a ,十10"
且初始条件 ea一9。使用生成函数找出关于 a, 的显式公式。

解 ”为了简化关于生成函数的推导，我们通过置 wo一1 将序列扩充，当把这个值赋给 a 并且
使用递推关系就得到 w 一8十10"一8十1一9，这与初始条件一致。(由于存在一个长为 0 的编码
字一一空昌，这也是有意义的。)

用 z" 乘递推关系的两边得

 

asT” 一 8a，z" 十10? zx

设 G(Cz)一 忆 or" 是序列 ，a ，o ，，…的生成函数，从 n一1 开始对上面的等式两边求和，得到
CCz) 一1 一 or 一 忆 (8a iiz 十10" zz")
-8疡or 十 oz
-8z2e- ze十 xz也 10一zc

-8gryiaz'*+zyloz，
一8zC(Cz) 十xz/A(1一10z)
其中我们已经使用了例 5 对第二个和进行求值。因此有
GCC)一1一8zGGCz)十zl一10z)

求解 G(z)得

    1 一9z
cm 一TO一105)

把等式的右边展开成部分分式(正如在微积分中研究有理函数的积分时所做的)得到
(1 1
C(z) 一 二+)
两次使用例 5(一次设 ae=8，一次设 =10)得
GCCz) -到(忆8z + 忆10>")

_  了工，Rn  an
一之到(8"十10)z



--- 第 192 页 ---
174 "第4章 高级计数技术

于是，证明了
遇王 部(8- 十10")                                  四

4.4.5 使用生成函数证明恒等式

在第 3 章我们已经看到怎样使用组合证明方法来建立组合恒等式。这里将显示这种恒等式，
还有关于广义二项式系数的恒等式，都可以使用生成函数来证明。有时候生成函数的方法比其他
方法更简单，特别是用生成机数的封闭形式比使用序列本身更能简化证明过程。我们用例 18 说明
怎样用生成函数证明恒等式。

例18 使用生成函数证明

>7CCnA)2z 一 C(2nm)

二一们

其中是正整数。
解 ”首先注意到根据二项式定理 C(2a，妆是(1十z)2中z" 的系数。而我们也有
(1十z)2 一[(1十z)"了?
一LC(Cn;0) 十CGn,1)z十CGn,2)z2 十十CGOnyr)zr"]?
在这个展开式中zx 的系数是C(n，0)CGn，m十CGO，1)CGOz，nm一1)十CCz，2)CGz，n一2)十十

CamDC(n，0) 。因为 Cn，zn一如一C(n，信，它等于 > COny妨:由于 C(2nm) 和VC (ny有): 都

表示(1十z)”中"的系数,它们一定是相等的。                                      面
本节末的练习 22 要求用生成函数来证明帕斯卡恒等式和范德蒙德恒等式。

练习
1. 求关于有穷序列2，2，2，2，2，2 的生成函数。

在练习 2一4中，封闭形式意味着代数表达式不仅包括所列数值的和，还包括省略部分。

, 求关于下面每个序列生成函数的封闭形式。(用最明显的选择设定每个序列的通项形式。)
a)0，2，2，2，2，2，2，0，0，0，0，0，…      b)0，0，0，1，1，1，1，1，1，…
c)0，1，0，0，1，0，0，1，0，0，1，'…         d)2，4，8，16，32，64，128，256，…

0 0 Geeses

g)1，1，0，1，1，1，1，1，1，1，.….

3. 求关于序列{a.}的生成函数的封闭形式，其中
a)a一5，对所有的 nm一0，1，2…
c)a,一2，对nm=一3，4，5，…量ao王al一az一0

ou=(,)， 对所有的mn一0，1，2.….
4. 对于下面每一个生成函数给出关于它所确定序列的封闭公式。

ko

f)2，一2，2，一2，2，一2，2，一2，…

h)0，0，0，1，2，3，4，…

b)a,=3"，对所有的 mn一0，1，2…

d)a一2n十3，对所有的 mn一0，1，2，…-
十4

Da一人  )， 对所有的 mn一0，1，2….

开

a)(3六一生)3                                                     b)(Czs十1)3

c)17(1一5z)                                            d)zs/A(1十3z)

e)z十3z十7十人(17/(1一于))                           f(z/(1L一于4))一妈一荆一工一1
&)zz/(IE一工)                                                  h)2e2z

5. 求出下面每个函数的等级数中 xz的系数。
a)(1十菩十za十z5十…)3
b)(z十三十态十5十节十we)3

cz十丰十菩)(z十4十好十熙十z)(1十z十妇十三十节十…)
d) (天十于十玉十旭十)(z十末十奏十…)(z十za十zx十)
e(1十于十忒十二十旭十,…)(1十姓十碍十za十(1十要十zz十za十



--- 第 193 页 ---
第4章 高级计数技术"175

6. 求出下面每个函数的寡级数中 z阅的系数。

a)1/(1一2z)     b)17(1十)     c)17(1一区)     d)1/(1十2z)4     eztA(1一3z)

7. 把 10 个相同的球分给 4 个孩子，如果每个孩子至少得到 2 个球，使用生成函数确定不同的分法数。

8. 把 15 个相同的动物玩具分给 6 个孩子使得每个孩子至少得到 1 个但不超过 3 个，使用生成函数确定不同
的分法数。

9. 把 25 个相同的多纳圈分给 4 个警官使得每个警官至少得到 3 个但不超过 7 个，有多少种方式?

10. 求序列{cs}的生成函数，其中 ct 是使用 1 美元、2 美元、5 美元和 10 美元纸币换A美元的方法数。

11, 对(1十z十袜十三十…) 展开式中天 的系数给出组合解释。使用这个解释求出这个数。

12, a)什么是关于{os}的生成琐数? 这里的 ak 是zi十妆十Ts一 的解的个数，其中 rz ，z 和 za 是满足zi二

2，0近zz和3，2乏z委5 的整数。
b)使用(a)的答案求 as 。
13. 解释怎样使用生成函数找到用3分、4 分和 20 分的邮票在信封上贴满分邮费的方式数。
a)假设不考虑贴邮票的次序。
b)假设邮票贴成一行并且考虑贴的次序。
c)当不考虑贴邮票的次序时，使用(a)的答案确定用 3 分、4 分和 20 分的邮票在信封上贴满 46 分邮费的
方式数。(建议使用计算机代数程序。)
d)当考虑贴邮票的次序时，使用(b)的答案确定用3 分、 4分和 20 分的邮票在信封上贴满一行 46 分邮费
的方式数。(建议使用计算机代数程序。)
14. 使用生成函数(如果需要的话，也使用计算机代数程序)求出换 1 美元的方式数。
a)用 10 美分和 25 美分。                          b)用 5 美分、10 美分和 25 美分。
c)用 1 美分、10 美分和 25 美分。               d)用 1 美分、5美分、10 美分和 25 美分。
15. 使用生成画数求出换 100 美元的方式数。
a)用 10 美元、20 美元和 50 美元纸币。
b)用 5 美元、10 美元、20 美元和 50 美元纸币。
c)用 5 美元、10 美元、20 美元和 50 美元纸币，并且每种纸币至少使用1张。
d)用 5 美元、10 美元和 20 美元纸币，并且每种纸币至少使用 1 张但不超过4张。

16. 如果 G(z)是关于序列(as}的生成函数，那么关于下述每个序列的生成函数是什么?
al)0，0，0，aa，ai，ai，，…               byae，0，ar，0，az，0，…
c)0，0，0，0，ao，al，az，             d)ao，2al ，4az，8as ，16a ，…
e)ao，aiV/2，az/3，as/4，…[提示: 这里需要微积分。]
fas ，ao十ai ，ao十al十as ，ao十ai十az十aa ，…

17. 使用生成函数求解递推关系 一3ak :十2，初始条件 co一1。

18. 使用生成函数求解递推关系 a 一5at-:一6at-:*，初始条件 ao一6 和 ai 一30。

19, 使用生成函数求解递推关系 内一4a-:一4as-z十如，初始条件 ce一2 和ai一5。

20. 使用生成函数找出关于斐波那契数的显式公式。

*21. (需要微积分)设1C,}是卡特朗数的序列，即具有初值 C, - C, -1 的递推关系 C, = CC，，， 的解(见
4. 1 节例8) 。

证明: 如果 G(z)是关于卡特朗数的序列的生成函数，那么 rxG(z)2一G(z)十1=0。(使用初始条件)断定
G(z)一(1一VI二47)/(2z) 。

22. 使用生成画数证明范德紫恒等式: Com 十mm) = CCmyr一妇COnu ,其中内几和是非负整数,且，不
超过闷或。[提示: 看在(1十z)"+"一(1十z)”(1十z)" 两边的zxr 的系数。]
关于序列{a. }的指数生成函数是级数

ao tn
了1!

mm站

例如，关于序列 1，1，1，…的指数生成函数是 >， z/n! 一 e。(你将发现这个级数在下面的练习中很有

丫王和



--- 第 194 页 ---
176 "第4章 高级计数技术

用.) 注意,e" 是关于序列 1,1,172!,1/31,1/41,… 的普通生成苑数。
23. 求一个关于序列{a)}的指数生成函数的封闭形式，其中

aa 一2                  ba一(一])”              cCJanr一3"
d)av 一2十1                e)a一1/(n十1)
24. 求以下述函数为指数生成函数的序列 。
a) xz)一e              b) F(z)一3z2x             c) Fr)一ez 一3etz
d)7(Czr)一(1一冻)十e 2       e) (xzr)一e 2一(17(1一z))    iD Frz)一e 2一(1十xz)十(1一2z))
g) FCzr)一ee

25. 一个编码系统用八进制(基为 8)数字串对信息编码。一个编码字是有效的，当且仅当它包含偶数个 7。
a)求一个关于”位长有效编码字个数的线性非齐次递推关系。初始条件是什么?
b)使用 4. 2 节的定理 6 解这个递推关系。
c)用生成函数解这个递推关系。

在研究整数 ”的不同类型的前分个数时生成函数是很有用的。一个正整数的剖分是把这个整数写成正整
数之和，和中的整数允许重复并且不考虑次序。例如，5 的前分(不加限制)是1++1二1二1+T1，1二1二1+2，
1十1十3，1十2十2，1十4，2十3 和5。练习 26一28 说明了这种应用。

26. 证明:; 在1/((1一z)(1一妇)(1一悦)…)的形式赛级数展开式中 关 的系数 bm)等于于的剖分数。
27. 证明: 在(1十z)(1十)(十王)…的形式寡级数展开式中 zx 的系数 js (z)等于剖分成不相等的整数(即

把闷写成正整数之和)的方式数，其中不管这些整数的次序但不允许重复。

28. 证明: 如果壮是正整数，那么”前分成不相等的整数的方式数等于 剖分成允许重复的奇整数的方式数;

即 记(2)一因(na)。[提示: 证明关于 户(思和加(的生成函数相等。]

29.〈需要微积分?证明如果 Gx 是随机变量 X 的概率生成函数，使得 X(s)对于所有的sE S是非负整数,那么

alGx(1)一1                 b)ECX)一Gx(1)             cJVCX)一Gx(1)十Gx(1)一Gx (1):

4.5 容斥

4.5.1 引言

一个离散数学班包含 30 个女生和 50 个二年级学生。在这个班里有多少个女生或二年级学生?
如果没有更多的信息，这个问题是没法求解的。把女生数和二年级学生数加起来不一定能得出正
确的结果，因为二年级的女生可能被计数了两次。这个事实说明，在班里的女生或二年级学生数
是班里的女生数与二年级学生数之和减去二年级的女生数。在 3. 1 节曾经介绍过求解这种计数问
题的技术。这里我们将把在那一节引入的思想加以推广，以求解更为广泛的计数问题。

4.5.2 容斥原理

两个有穷集的并集中存在多少个元素? 在 2. 2 节中证明了两个集合A 和有的并集中的元素数

是这些集合的元素数之和减去其交集中的元素数，即

1AUBI=14I+lIBI-I4AnBI
正如我们在 3. 1 节证明的，这个关于两个集合并集中元素数的公式在计数问题中是很有用的。
例 1一例 3 进一步说明了这个公式的用处。

例1 一个离散数学班包含 25 个计算机科学专业的学生、13 个数学专业的学生和 8 个同时主
修数学和计算机科学两个专业的学生。如果每个学生主修数学专业、计算机科学专业或者同时主
修这两个专业，那么班里有多少个学生?

解 设人4是这个班里计算机科学专业的学生的集合，巨是这个班里数学专业的学生的集合，那
么 4站刀是班里主修数学和计算机科学两个专业的学生的集合。因为这个班的每个学生或者主修计
算机科学，或者主修数学(或者同时主修两个专业)，从而得到这个班里的学生数是 | AUB | 。于是

1IAUBI=I4I+IBI-IAmnmBI
一25十13一8
一30



--- 第 195 页 ---
第4章 高级计数技术。177

因此，这个班有 30 个学生。这个计算在图 4-?7 中说明。                                 国
例2 有多少个不超过 1000 的正整数可以被7或11 整除?
解 设4是不超过1000 且可被 7 整除的正整数的集合，刀是不超过 1000 且可被 11 整除的正整数
的集合,那么 AUB 是不超过 1000 且可被?或11 整除的正整数的集合，A门B是不超过 1000 且可
被7和11 同时整除的正整数的集合。我们知道在不超过 1000 的正整数中有|100077|个整数可被 7
整除，并且有|1000711个整数可被 11 整除。由于7 和11 是互素的, 被7和11 同时整除的整数就
是被7 .11 整除的整数。因此，有|1000/(11。?7)j个不超过 1000 的正整数可被7和11 同时整除。
于是存在
|1AUBI=lI4AI+IBI-IAmnBI

_|1000| |1000| | 1000
-| 7 上| 11 | [2 |

 

一142十90一12
一220
个正整数不超过 1000 且可被 7 或 11 整除。这个计算在图 4-8 中说明。                  国

|4u 8引=|4|+|8-|4maBl=25+13~-8=30             |4u 8=|4|+|8-|4nm8|=142+90-12=220

  

|4|=25     |4m8l=8      18=13          14j= 142     lan8l=12     18|=%0

图4-7 离散数学班的学生的集合         图 4-8 不超过 1000 的可被7或11 整除的正整数的集合

例 3 说明怎样求有穷全集中在两个集合的并集之外的元素数。

例3 假设你们学校有 1807 个新生。其中 453 人选了一门计算机科学课，567 人选了一门数
学课，299 人同时选了计算机科学课和数学课。有多少学生既没有选计算机科学课也没有选数
学课?

解 为找出既没有选数学课也没有选计算机科学课的新生数，就要从新生总数中减去选了其
中一门课的学生数。设 A 是选了一门计算机课的所有新生的集合，且肆是选了一门数学课的所有
新生的集合。于是1A | 一453，| 也| 一567,，且1A4nB1=299。选了一门计算机科学或数学课
的学生数是

1|4AUBI=l4I+BI-I4nEBI
一453十567 一299
一721
因此，存在 1807一721一1086 个新生既没有选计算机科学课也没有选数学课。              醒

在本节的后面将说明怎样求有限个集合的并集中的元素数。这个结果叫做容斥原理。设是
任意正整数，在考虑”个集合的并集之前，先推导与 3 个集合4A，B 和C 的并集中的元素数有关的
公式。为推导这个公式，首先注意到以下事实， 1 4 1十18B1十|1Ccl|对3个集合中那些人恰好在
其中 1 个集合的元素只计数了 1 次，恰好在其中 2 个集合的元素计数了 2 次，恰好在其中 3 个集合
的元素计数了 3 次。这个结果在图 4-9a 中说明。

为了去掉在多个集合中元素的重复计数，减去这 3 个集合中的每 2 个集合的交集中的元素数，
得到
14I+IBI+CI-IAnBI-IAnCcI-IBnCI



--- 第 196 页 ---
178。第4章 高级计数技术

 

a) 由|4|+j8l+jcl计至的元素  b 由|4|+|8l+lcl-lanasl-IAncl- 由Ml+lsl+lcl-lanasl=lancl-
Ismcl计数的元素                     |smcl+l4mBsmc| 计数的元岩

图4-9 求关于 3 个集合的并集中元素数的公式

这个表达式对恰好出现在其中1 个集合的元素仍旧计数 1 次。对恰好出现在其中2个集合的元
素也计数 1 次，因为 2 个集合的交集有 3 个，而这种元素只出现在其中之一。但是,那些出现在 3
个集合的元素将被这个表达式计数0 次，因为它们将会出现在所有的两两相交的 3 个交集中。这个
结果显示在图 4-9b 中。

为了纠正这个漏计，还要加上 3 个集合交集中的元素数。这个最后的表达式对每个元素计数
了1次,不管它是在 1个、2 个还是在 3 个集合里。于是

|IAUBUCI=IAI+IBI+ICI-I4AnBI-IAnCI-IBsnCI+IAnBnCI
这个公式显示在图 4-9c 中。

例4 说明了怎样使用这个公式。

例4 1232 个学生选了西班牙语课，879 个学生选了法语课，114 个学生选了俄语课。103
个学生选了西班牙语和法语课，23 个学生选了西班牙语和俄语课，14 个学生选了法语和俄语课。
如果 2092 个学生至少在西班牙语、法语和俄语课中选 1 门，有多少个学生选了所有这 3 门语
言课?

解 设S是选西班牙语课的学生集合， 下是选法语课的学生集合，尺 是选俄语课的学生集合。
那么

|1S|= 1232，   | 严|一879，   |尺I= 114
1SPmFEI=103，l1S站RI=23，IFnmRI=14

|1SUEURI一2092
把这些等式代人下面的等式
1ISUFURI=1SI+IFEI+IRI-ISnFEI-ISnmRI-IFEnmRI+ISnEmnR
得
2092 一 1232十879十114一103一23一14十SmFnmmRl
求解上式得出| SFmR | =7。因此有7 个学生同时选了西班牙语、法语和俄语课。这个结果在
图 4-10 中说明。            国
我们现在将叙述和证明容斥原理，它将告诉我们在有限个有穷集的并集中有多少个元素。
5到下 容斥原理 设4,，4,，…，4, 是有穷集。那么
IAAU4U…U4,I= > 14I一> 14n41

1所/二              1二过js

+ 2 14n4nal一+一DAnaA nn…na,l

1写ij<kSn
证”我们将通过证明并集中的每个元素在等式右边恰好被计数 1 次来证明这个公式。假设 a
恰好是A，,， A:， 机 A， 中 个集合的成员， 其中 1委r委mm。 这个元束被 | 4， | 计数了 CCr，1)



--- 第 197 页 ---
第4章 高级计数技术"179

SnmFnRl=?     nzl=1o3

 

lsuFuRj=2092

图 4-10 选了西班牙语、法语和俄语课程的学生集合

次，被过 | AnA, | 计数了 CCGr，2)次。一般说来，它被涉及普个A, 集合的求和计数了CCr，zm)
次。于是，这个元素怡好被等式右边的表达式计数了

CCr,1) 一CCr,2)十CCr,3) 一人…十(一1D) ”CC站
次。我们的目标是求出这个值。由 3. 4 节的推论 2，我们有
CCr,0) 一CCr,1)十Cr,2)一……十(一1D)7CCr mm一0
于是
1一Cr'0) 一Cr1) 一CCr2) 十光十(一1 CCrm)

因此，并集中的每个元素在等式右边的表达式中恰好被计数 1 次。这就证明了容斥原理。 口
对于每个正整数 w，容斥原理对于 ”个集合并集的元素数给出了一个公式。对于 ”个集合的集
合族的每一个非空子集的交，在这个公式中都存在一项计数了它的元素。因此在这个公式中有
2"一1]项。
例5S 对于4个集合的并集中的元素数给出一个公式
到ss。 解 容斥原理显示
| A， U 4A， UA， U A， |王| A， |十| A， |十| 4， |十| A， |
一| A， 站 A， |一| A， 门 4A， |一| A 门A， |一| A， 门 A; |一| A， 站 A， 1一| A， 人 Ai
+|AnanalI+lanana il+lananalI+la nanmnal
-4Ana4anana,l
注意，这个公式包含 15 个不同的项，对于{4A, ，4A:, ，A;, ，4,}的每个非空子集有一项。    图

练习
1. 在A,UA: 中存在多少个元素? 如果在 A, 中存在 12 个元素，在 4: 中存在 18 个元素，并且
a)A:门A:=弛        b) | AnA:, | =1     c) 1 AmnA:, 1 =6      d)4:SA，

2. 一个调查显示在美国 96%%的家庭至少有 1 台电视机，98吧的家庭有电话，95%%的家庭有电话且至少有 1 台
电视机。在美国有百分之几的家庭既没有电话也没有电视机?
3. 求人4, UA4:UA: 中的元素数，如果每个集合有 100 个元素并且
a)这些集合是两两不交的。
b)每对集合中存在 50 个公共元素并且没有元素在所有这 3 个集合里。
c)每对集合中存在 50 个公共元素并且有 25 个元素在所有这 3 个集合里。
d)这些集合是相等的。



--- 第 198 页 ---
180"。第4章 高级计数技术

4. 一个学校有 2504 个计算机科学专业的学生，其中 1876 人选修了 Pascal，999 人选修了 Fortran，345 人
选修了C，876 人选修了 Pascal 和 Fortran，231 人选修了 Fortran 和C，290 人选修了 Pascal 和C。如果
189 个学生选了 Forrran，Pascal 和C，那么 2504 个学生中有多少学生没选这 3 门程序设计语言课的任何
一门?

5. 一个学校有 507，292，312 和 344 个学生分别选了微积分、离散数学、数据结构或程序设计语言课，且有
14 人选了微积分和数据结构课，213 人选了微积分和程序设计语言课，211 人选了离散数学和数据结构课，
43 人选了离散数学和程序设计语言课，没有学生同时选微积分和离散数学课，也没有学生同时选数据结
构和程序设计语言课。问有多少学生在微积分、离散数学 、数据结构或程序设计语言中选了课?

6. 求不超过 100 且是奇数或平方数的正整数个数 。

7. 有多少 8 位二进位串不包含 6 个连续的 0?

8. 在10个十进制数字的排列中有多少个以 3 个数字 987 开始，在第 5 和第 6 位包含数字 45，且最后 3 位
是 123?

9. 有4 个集合，如果这些集合分别有 50，60，70 和 80 个元素，每一对集合有 5 个公共元素, 每 3 个集合有
1 个公共元素，并且没有元素在所有的 4 个集合里。问在这 4 个集合的并集中有多少个元素?

10. 根据容斥原理写出关于 5 个集合并集元素数的显式公式。

11. 有6 个集合，如果知道其中任 3 个集合都是不相交的，根据容斥原理写出关于这 6 个集合并集元素数的
显式公式。

12. 设 忆 ，E: 和 瑟; 是样本空间 S 的 3 个事件。求一个关于 E; U EUE, 的概率的公式。

13. 从1到 100(含 1 和 100 在内)不允许重复地随机取 4 个数，求所有的都是奇数、所有的都被 3 整除或所有
的都被 5 整除的概率。

14， 一个样本空间有 5 个事件，如果其中没有4 个事件同时出现，求关于这 5 个事件的并的概率公式。

15. 求一个样本空间中 个事件的并的概率公式。

4.6 容斥原理的应用

4.6.1 引言

可以使用容斥原理求解许多计数问题。例如，我们可以使用这个原理找出小于某个正整数的
素数个数。通过计数从一个有穷集到另一个有穷集的映上函数的个数，能够求解许多问题，而容
斥原理就可以用来求出这种函数的个数。也可以使用容斥原理求解著名的帽子认领问题。帽子认
领问题是: 一个招待随机地将帽子发还存放帽子的人，求没有人取回自己的帽子的概率。

4.6.2 容斥原理的另一种形式
容斥原理有另一种表述形式，它在计数问题中是很有用的。特别地，这种形式可以用于求解
在一个集合中的元素数，使得这些元素不具有) 个性质 P, ，P, ，…，P, 中的任何一条性质。
设 A, 是具有性质 P, 的元素的子集。具有所有这些性质 P, ，P, ，…，己, 的元素数将记作
NCP,P.…P,)。用集合的术语写这些等式，有
14, na4Asn和na 1= NOP,P.…P,)
如果不具有 个性质P, ，P:，…，P, 中的任何一条的元素数记作 N(P', P';…P',)并且集合中
的元素数记作 N，那么有
NCP PP一N-l4U4AU…UA.Il
由容斥原理，有
NCPP…P,) =N一 > NGCP)+ > NIPP)- > NIPPIP)

1<rm      Ti<)坪       1Si本jw
十…十(一D"NCP,P:…P,)
例 1 说明怎样使用容斥原理确定具有约束条件的方程的整数解的个数。
例1  Zi十zz十zi一11 有多少个整数解? 其中症， Za 和 zs 是非负整数， 且 立委3，z <委4，
Ts6。
解  为使用容斥原理， 令解的性质 卫， 为 zi二3， 性质 也 为 刀盖4， 性质 书: 为三二6。 满足不



--- 第 199 页 ---
第4章 高级计数技术。181

等式 刀过3，习所4以及辣过6 的解的个数是
NCP, PP,) =N一NCP)一NCP,)一NIP,)十NOCP,P,)
十NCP,P,)十NCP,P,)一NOCPP,P,)
使用与 3.5 节的例 5 相同的技术，、得
N ==解的总数 = C(3二11一1,11) =一78
NCP,) =(具有zi 全4的解数) = C(3十7一1,7) = C(9,7) = 36
NCP,) =(具有二5的解数) = C(3十6一1,6) = C(8,6) 一 28
NICP,) =(具有zs 三7的解数) 一C(3十4一1,4) 一C(6,4) 一15
NICPP:) =一(具有xz 三4且z伍5的解数) =C(3十2一1,2) 一C(4,2) 一6
NCP,P) =一(具有xz二4且>三7的解数) = C(3十0一1,0) = 1
NIP:P,) 一(具有习达5且党全7的解数) 一0
NCP,P,P,) =一(具有zi 三4,r 三5且z 人三?7的解数) =0
把这些等式代人关于 NCP, P: P; )的公式，证明满足 z生3，z<4 以及冯6 的解的个数等于
NICP,P,P,) 一78一36一28一15二6二1十0一0=1*6            国

4.6.3 埃拉托色尼筛
可以用容斥原理找出不超过一个给定正整数的素数个数。一个合数可以被一个不超过它的平
方根的素数整除。因此，为找出不超过 100 的素数个数，首先注意到不超过 100 的合数一定有一个
不超过 10 的素因子。由于小于 10 的素数只有 2，3，5 和 7，因此不超过 100 的素数就是这 4 个素
数以及那些大于 1 和不超过 100 且不被2，3，5或7整除的正整数。为应用容斥原理，令 P, 是一
个整数被 2 整除的性质，P, 是一个整数被 3 整除的性质，P, 是一个整数被 5 整除的性质，P4 是
一个整数被 7 整除的性质。于是，不超过 100 的素数个数是
4十NGCPP,P,P,)
由于存在 99 个比 1 大且不超过 100 的正整数，容斥原理显示
NICP,P: P; P,) 一99一NCP)一NCP,)一NCP,)一NCP)
十NCPP)十NCPP,)十NCPIP)二NOP:P,)十NOP,P,)十NOCP,P,)
一NCP, PP,)一NICPP.P,)一NCPP,P,)一NOCP,P,P)
十NOCP P,P,P,)
不超过 100(且大于 1)并被12，3，5， ?的子集中的所有素数整除的正整数个数是100/N，其中 N
是这个子集中的素数之积。(这是由于任意两个素数都没有公因子。)因此

“PP P') 一99_|100|_|100 |100|_|110ol 1 10 | 1oo1 | 100.
NGCP1P2 PP ) 一99  | 2  | 3 | 虽  | 史上+| |+|老 上+|交|
100   100   100     100      100      100
+| 。 +|3 。 +| ao 3。 -| .3。 和-|; “5。
100       100
加ET
一99一50一33一20一14十16十10十7十6十4二2一3一2一1一0二0
一21
于是存在 4十21=25 个不超过 100 的素数。
1 可以用埃拉托色尼萍求不超过一个给定正整数的所有的素数。例如， 可用下面的过程
    找不超过 100 的所有素数。首先，保留 2 而将其余那些被 2 整除的整数删除。 因为 3 是
保留下来的第一个大于 2 的整数，除 3 之外，删除其余那些被 3 整除的整数。 因为 5 是在 3 后面下
一个留下来的整数，除 5 之外删除其余那些被 5 整除的整数。 下一个留下的整数是7，因此留下 7，
删除其余那些被 7 整除的整数。由于所有不超过 100 的合数被 2，3， 5或7整除,那么所有留下来

的大于 !1 的数是素数。在表 4-2 中,4 个子表显示了每一步删除的整数，在第一个表中得到下划线
的是除 2 之外其余被 2 整除的整数，在第二个表中得到下划线的是除 3 之外其余被 3 整除的整数，

 

 



--- 第 200 页 ---
182。第4章 高级计数技术

'在第三个表中得到下划线的是除 5 之外其余被 5 整除的整数，在第四个表中得到下划线的是除 7 之
外其余被 ?7 整除的整数。没划线的整数是不超过 100 的素数。

表 4-2 埃拉托色尼筛

 

除 2 之外其余被 2 整除的整数得到下划线                                   除 3 之外其余被 3 整除的整数得到下划线
1234567 8 9 lo  12345678 9 1
Il1 12 13 14 15 16 17 18 19 20   li 12 13 1415 16 17 18 19 20
2 22 23 24 235 26 27 28 29 30   2 22 233 24 235 26 27 28 29 30
31 32 33 34 35 36 37 38 39 40   31 32 33 34 35 36 37 38 39 40
41 42 43 44 45 46 47 48 49 50   41 42 43 44 45 46 47 48 49 50
51 52 53 54 55 56 57 58 59 60   5 52 53 54 55 56 57 58 59 60
61 62 63 64 65 66 67 68 69 70   61 62 63 64 65 866 67 68 69 70
71 ?72 73 74 75 ?6 77 78 79 80   7 72 73 724 75 76 77 78 79 80
8 8 83 84 85 86 87 88 89 90   8 8 83 8485 8687 88 89 90
91 92 93 94 95 96 97 98 99 100   9 892 93 94 95 96 97 98 99 100
除 5 之外其余被 5 整除的整数得到下划线                      除 7 之外其余被 7 整除的整数得到下划线

1 23345867 8 9   1 22344567 8 9?
2131431617 8 19    1了13共下17了琢 19
2 22 23 24 25 26 27 28 29    2 22 22322526 27 下29

31 32 33 34 35 36 37 38 39

31 32 33 34 35 36 37 38 39        守  8
41 42 43 44 45 46 47 48 49

41 42 4 和全外47 4 49
5 52 53 54 55 56 57 58 59

51 3532 53 54 55 56 57 58 59
61 62 63 64 65 66 67 68 69

71 72 73 ?4 75 ?6 77 78 79
8 8 83 84 85 86 8 88 89

61 62 63 64 65 66 67 68 69

71 72
az

8 82 83 84 85 86 87 88 89

| se We悦几恰蝶

91 92 93 94 95 96 97 98 99

上 Ws必人几le 习习 上只号

4.6.4 了映上函数的个数

也可以用容斥原理确定从 mm 元素集合到”元素集合的映上天数的个数。首先考虑例 2。

例2 从6 元素集合到 3 元素集合有多少个映上函数?

解 假定在陪域中的元素是训，户， 六。设 P ，P ，P, 分别是乌，包，访 不在函数值域中的
性质。注意到一个函数是映上的当且仅当没有性质 P, ，P, 和 P, 。根据容斥原理得到 6 元素集合到
3 元素集合的映上函数个数是

NICP,P:, P:,) 一N一[LNCP,)十NCP,)十NCP,)]
十[LNCP,P:,)十NCP,P:,)十NIP,P,)]一NOCP,P,P,)
其中 凡是从 6 元素集合到 3 元素集合的函数总数。我们将对等式右边的每一项求值。

由3. 1 节的例 5 得出 N=3 。注意到 NCP,)是值域中不含久 的函数个数。所以，对于定义域
中的每个元素的函数值有 2 种选择，从而得到 NCP,)=2*。此外，这种项有 C(3，1)个。注意到
NICPPi)是值域中不含记和妨 的函数个数。所以，对于定义域中的每个元素的函数值只有 1 种选
择。从而得到 NCP,P,)=1 一1。此外，这种项有 C(3，2)个。还有，注意到 NCP, P,P,)=0，因
为这个项是值域中不含六，包 和访 的函数个数。很显然，没有这样的函数。于是，从6 元素集合
到 3 元素集合的映上郴数个数是

35 一C(3,1)25 十C(3,2)15 一729一192十3 一540                     国

现在令述从 疡元素集合到”元素集合的映上天数个数的一般性结果。这个结果的证明留给读

者作为练习。



--- 第 201 页 ---
第4章 高级计数技术。183

ES到用 设 ”和， 是正整数满足办三*。那么存在
zi 一CCay1)人7一1) 十CCn2)(2一2)7 一十(一1一CC一1)。1”
个从痛元素集合到 元素集合的映上函数。

从普个元素的集合到 个元素的集合的映上函数是这样一种对应方式: 它把定义域中的闫个
元素分配到= 个不可辨别的盒子中，使得每个盒子都不是空的，然后将陪域中的个元素中的每一
个元素都与一个盒子相对应。这意味着从具有 mm 个元素的集合到具有? 个元素的集合的映上函数
的个数，等于把 m 个可辨别的物体分配到” 个不可辨别的盒子中，使得每个盒子都不空时的方法
数乘以具有?个元素的集合的排列数。因此，从 关个元素的集合到”个元素的集合的映上函数的
个数为z! SGm，5)，其中 S(m，站是 3.5 节中定义的第二类斯特林数。这意味着我们可以用定理
1 来推导 3.5 节所给的关于 S(m，zm)的公式。(关于第二类斯特林数更详细的信息，可参见
[MiRo91]中的第6 章.。)

下面给出定理 1 的另一个应用的实例。

例3 把5项工作分给4个不同的雇员，如果每个雇员至少分配 1 项工作，问有多少种方式?

解 ”把工作分配肴作从 5 个工作集合到4 个雇员集合的函数。每个雇员至少得到 1 项工作的分
配对应于从工作集合到雇员集合的映上函数。因此，由定理 1 存在

笃一C(4,1)3 十C(4,2)2 一C(4,3)15 一1024一972十192一4一240
种方式来分配工作并使得每个雇员至少得到 1 项工作。                  国

4.6.5 错位排列

下面将用容斥原理计数排列个物体并使得没有一个物体在它的初始位置上的方式数。考虚
下面的例子。

例4 帽子认领问题”在一个餐厅里，一个新的雇员寄存 ”个人的帽子时忘记把寄存号放在帽
子上。当顾客取回他们的帽子时，这个雇员从翻下的帽子中随机选择发给他们。问没有一个人收
到自己的帽子的概率是多少?                                        莉

注意 ”答案就是重新排列避子使得没有帽子在它的初始位置上的方式数除以郊个帽子的
排列数m1。在我们找出排列于个物体并使得没有一个物体在它的初始位置上的方式数以
后再考虑这个例子。

站 一个错位排列是使得没有一个物体在它的初始位置上的排列。为求解例 4 中的问题我
 人们需要确定”个物体的错位排列数。
例S 排列 21453 是 12345 的一个错位排列，因为没有数在它的初始位置上。但是，21543 不
是 12345 的错位排列，因为4留在它的初始位置上。                                          硬
设 D, 表示?个物体的错位排列数。例如，D,王2，因为 123 的错位排列是 231 和 312。我们将
使用容斥原理对所有的正整数 ”求卫, 。
  ! 元素集合的错位排列数是
,一zl [说+页-亢+…+-D 十]
证 如果排列保持元素; 不变，就设排列有性质 P, 。错位排列的个数就是对 ;一1，2，…，m，
没有性质 P, 的排列数，或
D, 王 NCPP:…P.,)
使用容斥原理得到
D, 一N一 27NCPD)+ NIPP)- NOPPiP)十…十(一D"NCPP,…P)
其中 N 是=个元素的排列数。这个等式说明，所有的元素都发生变化的排列数，等于排列的

总数减去至少保持 1 个元素不变的排列数，加上至少保持 2 元素不变的排列数，减去至少保持 3 个
元素不变的排列数，等等。现在找出在等式右边出现的所有的量。



--- 第 202 页 ---
184 "第4章 高级计数技术

首先注意到 N=24，因为 N 仅仅就是”个元素排列的总数。还有，N(CP) =一(一1)!，这是由
乘积法则得到的，因为 NCP,)是保持元素i不变的排列数，因而第 i 个位置是确定的，但是其余的
每个位置可以放任意元素。类似地，

NCPP)) = (2一2)1
因为这是保持元素; 和/不变的排列数，但是其余("一2)个元素的位置可以被任意地安排。一般说来有
NCP, P,…P,) 一(nz一mm)1!
因为这是保持元素羡，产，…，im 不变的排列数，但是其他(一z)个元素的位置可以被任意安排。
由于存在 CC(a，z)种方式从:个元素中选择mm个，从而有
> NCP,) 一CO,1)Cn一1)1

1写,所”

>) NCPP,) 一CCn2)(z一2)1

] ij宝
一般地， 有
>) NOCP,P…P.) = Cnm)(Cn一mm)1

1
所以，把这些等式代人关于 D, 的公式得
也, 一1一CGO ,12一1)1十CCGn2)(2一2)1一…十(一1)"CCnz)(a 一m)1!
好1

(7一1)1十                          101

(2一2)1一十(一])”

 

一?1                                             01

化简这个表达式得

   如!           7
14(C2一1)1        21(n一2)!

D. =本+丰一2机]                 口
现在对于给定的正整数”求 了D. 就简单了。例如，使用定理 2 得
1 1 1          1 1
D, = 3 1一+页一台]= (1一1+计-于)=-2
正如我们前面所看到的。
现在可以给出例4 中的问题的解。
解 没有一个人收到自己的帽子的概率是 D,/zl。由定理 2，这个概率是
D_ 11.
好上     1]!1 21!
对于 2和”魏7，这个概率的值在表 4-3 中给出。
表 4-3 错位排列的概率
杂         2         3         4         5         6       ?了

……十(一D"工
72!

Duynl              0,. 500 00            0. 333 33            0. 375 00            0. 366 67            0. 368 06         0. 367 86

1       1    1
已  一1一十于一

因为这是一个项趋向于0 的交错级数，当半无限增长时，没有一个人取回自己的巾子的概率趋
于e “~0.368。事实上，可以证明这个概率与 e:的差在 1/(z*十1)! 之内。              国

练习

1. 假设 1 蒲式耳 100 个革果中 20 个有虫，15 个有据伤。只有没虫也没擦伤的苹果才可以卖。如果 10 个擦伤
的苹果有虫，那么 100 个茧果中有多少个可以卖?

2. 方程 增十zz十zs一13 有多少个解? 其中 ri ，za，  za 是小于6 的非负整数。

3. 使用容斥原理求小于 200 的素数的个数。

4. 有多少小于 10 000 的正整数不是一个整数的 2 次或更高次宕?

二(CD"二十… 一0.368
天



--- 第 203 页 ---
第4章 高级计数技术*。185

5. 有多少种方式把 6 个不同的玩具分给 3 个不同的孩子并使得每个孩子至少得到 1 个玩具?
6. 有多少种方式把 7 项不同的工作分给 4个不同的雇员 ，使得每个雇员至少得到 1 项工作，并且把最困难的
工作分给最好的雇员?
7. 一个7元素集合有多少个错位排列?
8. 一个把信放人信和袋的机器发生了故障并且随机把信放人信和红中。在一组 100 封信中发生下面事件的概率是
多少?
a)没有信放对了信和绕。
b)恰好 1 封信放对了信和袋。
c)恰好 98 封信放对了信和袋。
d)恰好 99 封信放对了信和弘。
e)所有的信都放对了信袋。
#*9.。有多少种方式安排数字0，1，2，3，4，5，6，7，8，9 使得没有偶数在它的初始位置上?
10. 对哪些正整数 >"，错位排列数 D, 是偶数?
*11. 当 的素因子分解式是
.                中一 旋) 1 力2
时，使用容斥原理推导一个关于 gz)的公式。
12. 有多少个{11，2，3，4，5，6}的错位排列的前 3 位是取某种次序的整数 1，2，3?

13. 证明定理 1。

关键术语和结果

术语

递推关系: 一个公式，它把序列除了某些初始项以外的项，表示成这个序列前面的一个或若干个
项的画数。

递推关系的初始条件: 满足递推关系的序列在该关系起作用之前的某些项的值。

常系数线性齐次递推关系: 一个递推关系，除了初始项之外，它把序列的项表示成前面项的线性
组合。

常系数线性齐次递推关系的特征根: 与常系数线性齐次递推关系相关的多项式的根。

常系数线性非齐次递推关系: 一个递推关系，除了初始项之外，它把序列的项表示成前面项的线
性组合加上一个仅仅依赖于序标的不恒为 0 的函数。

分治站法: 求解问题的一种算法，求解中递归地把问题划分成固定数目的较小的同种类型的问题。

序列的生成函数: 用序列的第 ”项作为z" 的系数的形式宪级数。

埃拉托色尼第: 找出小于一个给定正整数的素数的过程。

错位排列: 使得没有物体在它的初始位置上的排列 。

结果
两个有穷集合并集的元素数公式:
AUBI=1AI+IBI-lIAnBI
三个有穷集合并集的元素数公式:
IIAUBUCI=lI4AI+IBI+Cci-IAnBI-IAnclI-IBsnclI+AnBnmCIl
窜斥原理，
IAAU4aU…U41i=》 4I- 14na4AIl

筷i二nm               ]过i到JJ区

+ 习14AnAnaAil

1二二

一DAnAnnasl
从了殉元素集合到妹元素集合的映上函数个数:
1一Cn 1)(G 一1) 十Ca:2)(02一2)7一十(一1一CCzm 一1])。1”



--- 第 204 页 ---
186 "第4章 高级计数技术

〗个物体的错位排列数，

复习题

1.

co Fo

心

10，

11.

12.
13.

a)什么是递推关系?
b)如果在一个获利 9%%的账上储著 1 000 000 美元，求与年后账上钱数有关的递推关系。

. 解释怎样用斐波那契数求解关于兔子的斐波那契问题。
. a)找出与求解汉诺塔难题的所需步数有关的递推关系。

b)显示怎样使用选代来求解这个递推关系。

. a)解释怎样找一个与不包含两个连续的 1 的位二进位串个数有关的递推关系。

b)描述另一个计数问题使得它的解满足同一个递推关系。

定义一个 阶的线性齐次递推关系。
. a)解释怎样求解二阶线性齐次递推关系。

b)如果 ao王3，al王15，对于 "人2，求解递推关系 a,一13a。-:一22a,-: 。
c)如果 ao王3，ai王35，对于 *盖2，求解递推关系 an二14an-1一49a-a。

. aa)如果 jz)满足分治递推关系 Fa一anb二5g(CD，这里避整除正整数a，解释怎样求 fF(久) ，其中上是

正整数。
b)如果 fm一3FGn/4)十5a/4 上且Fl)一7?，求 F(256) 。

， a)对于用二分搜索在表中找一个数所用的比较次数推导一个分治的递推关系。

b)从你在(a)给出的分治递推关系使用 4. 3 节中的定理 1，对于二分搜索所用的比较次数给出一个大 O
估计。

. a)给出一个关于 3 个集合并集元素数的公式。

b)解释为什么这个公式是有效的。
c)解释怎样使用(a)的公式求不超过 1000 且能被6，10 或 15 整除的正整数个数。
d)解释怎样使用(a)的公式求方程 十z: 十za十必一22 的非负整数解的个数，其中 一二8，z 一6，z 一5。
a)给出一个关于4个集合并集元素数的公式 。解释为什么它是有效的。
b)假设 A, ，A4: ，4A:， 和 A, 每个集合含 25 个元素，其中任意 2 个集合的交含 5 个元素，任 3 个集合的交含
2 个元素，所有 4 个集合含 1 个公共元素。问在这4 个集合的并集中有多少个元素?
a)令述容斥原理。
b)概述这个原理的证明。
解释怎样使用容斥原理计数从 z 元素集合到?” 元素集合的映上函数的个数。
a) 怎样计数把 mm项工作分给” 个雇员并使得每个雇员至少得到一项工作的方案数?
b)把 7 项工作分给 3 个雇员并使得每个雇员至少得到一项工作有多少种方案?

.解释怎样使用容斥原理计数不超过正整数 ”的素数个数。
. a)定义一个错位排列。

b)一个寄存帽子的人给”个人发还帽子，使得没有人得到自己帽子的方式的计数为什么和?个物体的错
位排列数一样?
c)解释怎样计数 ”个物体的错位排列数。

补充练习

1.

ko

一个 10 人小组开始一系列的通信活动，每个人把这封信寄给另外4 个人。每个收到信的人再把这封信寄
给另外的4个人。

a)如果没有人收到的信多于 1 封，求与这个通信活动的第 ”步寄出信数有关的递推关系。

b)在(a)中递推关系的初始条件是什么?

c)在这个通信活动的第 =”步寄出了多少封信?

, 一个核反应堆产生了 18 克放射性同位素。每小时放射性同位素训变 1听。

a)对?小时后留下的同位素量建立一个递推关系。          b)对于(a)的递推关系，初始条件是什么?



--- 第 205 页 ---
Km

9

#10.
1]1,
12.

#<]13.

17.

第4章 高级计数技术。187

c)求解这个递推关系。

.美国政府每小时印 1 美元纸币超过 10 000 张，5 美元纸币超过 4000 张，10 美元纸币超过 3000 张 ，20 美元

纸币超过 2500 张 ，50 美元纸币超过 1000 张 ，100 美元纸币与前一小时的张数一样。在初始时刻每种钱币
有 1000张。

a)建立一个关于第 ”小时总钱数的递推关系。              b)(a)中递推关系的初始条件是什么?

c)求解这个第对小时总钱数的递推关系。                    d)建立一个关于前”小时总钱数的递推关系。

e)求解这个关于前小时总钱数的递推关系。

. 每个前一小时已经存在的细菌在每小时都分裂出 2 个新的细菌，并且所有的细菌只有 2 小时的寿命。假设

这群细菌开始时有 100 个新细菌 。
a)建立关于半小时后存在细菌数目的递推关系。        b)这个递推关系的解是什么?
c)什么时候这群细菌的个数将超过 100 万个?

, 使用两个不同的信号在通信信道发送信息。传送一个信号需要 2 微秒，传送另一  个信号要 3 微秒。   一个信

息的每个信号后紧跟着下一个信号。

a)求与在=微秒中可以发送的不同信号数有关的递推关系。
b)对于(a)的递推关系，初始条件是什么?

c)在 12 微秒内可以发送多少个不同的信息?

. 一个小邮局只有4分、6 分和 10 分邮票。如果考虑邮票使用的次序，求与这些邮票构成 = 分邮资的方式数

有关的递推关系。这个递推关系的初始条件是什么?

. 使用在练习 6 描述的规则，有多少种方式构成下述邮资?

a)12 分           b)14 分           c)18 分           d)22 分
. 求具有 ao=1和如=2 的联立方程组

an一ao-十名-

刀一an-1一名-1

- 如果 oo=1且 ai一2，求解递推关系 as一as-/a。-:。[提示: 两边取对数得到关于序列 loga, 的递推关系，

nm一0，1，2，…。]

如果 ao一2 和wa一2，求解递推关系 e王o -ax 。(见练习 9 的提示 。)

如果 ao一2，a 一4 和az一8，求解递推关系 a王3a, :一3a,-:十ay -3十1。

如果 ao一2，a 一2 和az一4，求解递推关系 a,一3a,-:一3a,-:十av -3 。

假设在 4. 1 节的例 4 中，一对兔子在繁殖 2 次以后就离开这个岛。求与第 ”个月中的岛上兔子对数有关
的递推关系。

。当 可被 5 整除时求解递推关系 Fn) 一3f(na/5)十224 ，其中 mn一9，是正整数，F1)=1。
- 如果 是增函数，估计练习 14 中 了的大小。
. 找出与下述算法所使用比较次数有关的递推关系: 通过把 个数的序列递归地划分成两个子序列找出最

大和第二大的元素，在每一步划分时要求这两个子序列项数相等或一个子序列比另一个子序列多一项。
当子序列达到 2 项时停止。
估计练习 16 描述的算法所使用的比较次数。

设{a,}是实数序列。这个序列的前向差分定义如下: 第一个前向差分是 Aa,一av+l1一av; 第&十1 个前向

差分 At+ia。 是通过 A'r1a一Atar:一Ata. 由 Atav 得到的。

18.

19，

#20.。
21.

22.

求 Atae,，其中
a)an一3               b)a,一4?十7               c)a一嵌十zz十1
设 a.=3z2十a十2，求 Atae.，其中等于
a)2        b)3        c)4
假设 o.=P(z) ，其中己是d 次多项式。证明: 对所有的非负整数n，A“'a,=0。
令{a}和{甸}是实数序列。证明
A(Cab,)一as+l(Ab)十DC(Aas)
证明: 如果 F(z)和 G(Cz)分别是序列{at}和{丸}的生成隔数，且< 和 是实数，那么(cF十dG)(z)是
{cat十cb)}的生成函数。



--- 第 206 页 ---
188。

23.

24.

25.

26.

27.

28.

29.
30，

31.

#x32.

33.
34.
35，

第4章 高级计数技术

(需要微积分)这个练习说明了怎样使用生成函数求解递推关系(?十1)av+i=一as十(1/nzl)，n二0,初始条件
ao一1]。

a)设 G(z)是关于{a,}的生成函数。证明 G(z)=G(z)十e且G(O)=1。

b)由(a)证明(e-2G(z))王1，且断定 G(Cz)一ze十ef。

c)使用(b)找出关于 a, 的封闭公

假设在离散数学班的第一次考试中 14 个学生得 A，第二次考试中 18 个得 A。如果 22 个学生在第一或第
二次考试得 A，有多少学生两次考试都得 A?

在蒙默思郡(英国威尔士郡原郡名)323 个农场至少有马、牛或羊其中的 1 种。如果 224 个农场有马，85
个有牛，57 个有羊，18 个农场 3 种家畜全有，那么有多少个农场恰好有这 3 种家畜中的 2 种?

查询某学院关于学生记录的数据库得到下述数据: 学院有 2175 个学生，其中 1675 个不是一年级学生，
1074 个学生选了微积分，444 个学生选了离散数学 ，607 个不是一年级学生且选了微积分，350 个学生选
了微积分和离散数学，201 个不是一年级学生且选了离散数学，143 个不是一年级学生并且选了微积分和
离散数学。所有这些对查询的回答都是正确的吗?         v

某大学数学学院的学生可以选择下述一个或多个方向作为主修方向: 应用数学(AM) 、纯粹数学(PM) 、
运筹学(OR)及计算机科学(CS)。如果包括同时主修在内，主修 AM 的有 23 个学生; 主修 PM 的有 17 个
学生; 主修 OR 的 44个; 主修CS的63个; 主修 AM 与PM的5个; 主修AM 与CS的8个; 主修 AM
与OR的4个; 主修 PM与CS的6个; 主修PM与OR的5个; 主修OR与CS的14个; 主修PM，OR
与CS的2个; 主修AM，OR 与CS的2个: 主修PM，AM 与OR 的1个; 主修PM，AM 与CS的1个;
还有 1 个主修所有 4 个方向。问这个学院有多少学生?

当使用容斥原理表示 7 个集合的并集中的元素数时，如果其中没有 6 个或更多的集合含有公共元素，那
么需要多少项?

方程 zx 十zz十了三20，2一站一6，6一忆二10，0一z一5 有多少个正整数解?

有多少小于 1 000 000 的正整数

a)能够被2，3 或 5 整除?        b)不被7，11 或 13 整除?        c)被 3 整除但不被 7 整除?
有多少小于 200 的正整数是

a)整数的 2 次或更高次寡?                          b)整数的 2 次或更高次寡，或是素数?

c)不被一个大于 1 的整数的平方整除?           d)不被一个大于 1 的整数的立方整除?

e)不被 3 个或更多的素数整除?

把 6 个不同的工作分给 3 个不同的雇员，如果最难的工作分给最有经验的雇员并且最容易的工作分给最
缺乏经验的雇员，那么有多少种分法?

由寄存帽子的人随机发还给个人帽子，那么恰好一个人拿到自己帽子的概率是多少?

有多少个 6 位二进位串不包含 4 个连续的 1?

一个6 位二进位串包含至少4个 1 的概率是多少?

计算机题目
按下述给定的输入和输出写出程序。

1，
2.

给定正整数 上，列出汉诺塔难题从一根柱子到另一根柱子依照游戏规则移动 ”个盘子需要的所有移动。
给定正整数 ” 和整数上，1和上委”，列出语雷姆~-斯图尔特算法(见 4. 1 节练习 27 前面的说明?依照游戏规则
用 4 根柱子从一根柱子到另一根柱子移动 "个盘子需要的所有移动。

, 给定正整数 >，列出不包含连续 2个0的所有的”位二进制序列。
. 给定正整数 mn，写出在 "十1 个变量的乘积中加括号的所有方式。
* 给定递推关系 as一claw-i十czaw-z和正整数上，其中 c: 和 Cz 是实数， 初始条件为 ao一Co 及ai=Ci， 使用

和迭代求 GE

* 给定递推关系 an二clan -1十czar -和初始条件 ao=Co 及a=Cl， 确定唯一的解。
. 给定形如 ja)一af(n/b)十c 的递推关系，其中由 是实数,5 是正整数，c 是实数, 上 是正整数，使用迭代

求 F(坟)。

, 给定 3 个集合的交集中的元素个数，每两个集合的交集中的元素个数，和每个集合中的元素个数，求其并

集中的元素个数。



--- 第 207 页 ---
第4章 高级计数技术"189

9. 给定正整数 mw，求在个集合的并集中元素个数的公式。
10. 给定正整数 m 和? ，求从靖元素集合到”元素集合的映上函数个数。
11. 给定正整数 xn，列出集合(1，2，3，…,. 中的所有错位排列。

计算和研究

使用一个计算程序或你已完成的程序做下面的练习。

, 求 o ，F 和 ooo的精确值，其中 广 是斐波那抽数。

. 求比 1000 000 大、比 1 000 000 000 大和上比 1 000 000 000 000 大的最小的斐波那契数。

. 求尽可能多的同为素数的斐波那契数，目前还不知道是否存在无限多个这样的数。

. 写出求解 10 个盘子的汉诺塔难题所需要的所有的移动。

. 按照雷夫难题的规则，用 4 根柱子从一根柱到另一根柱移动 20 个盘子，写出使用弗雷姆-斯图尔特算法需
要的所有移动。

6. 通过下面的方法验证求解 "个盘子的雷夫难题的弗雷姆猜想，对于尽可能多的整数>，证明这个难题不可
能使用比具有最优选择 上的弗雷姆-斯图尔特算法还要少的移动来求解。

7. 计算对于各种整数"，包括 16，64，256 和 1024，使用在 4. 3 节描述的快速乘法和整数相乘的标准算法做
两个”位整数相乘所需要的运算次数。

8. 计算对于各种整数mn，包括4，16，64 和128， 使用在 4. 3 节描述的快速矩阵条法和答阵相策的标准算法做
两个”xz矩阵相乘所需要的运算次数。

9. 使用埃拉托色尼簿求不超过 1000 的所有素数。

10. 使用在 4. 6 节描述的求不超过 100 的素数个数的方法求不超过 10 000 的素数个数。

11. 列出(1，2，3，4，5，6，7，8}的所有的错位排列。

12. 对所有不超过 20 的正整数>计算z” 个物体的一个排列是错位排列的概率， 并确定这些概率逼近e 的速度。

写作题目

用本书以外的资料，按下列要求写成短文。

1. 找出斐波那契发表的关于兔子数模型难题的原始材料 。 讨论斐波那契提出的这个问题和其他问题，并且给
出关于斐波那契本人的某些信息。

解释斐波那契数怎样在其他应用中出现，如叶序 、植物叶片排列的研究、 镜子反射的研究等。

- 描述汉诺塔难题的各种不同的变形问题，包括多于 3 个柱子的(包括课本和练习中讨论的雷夫难题在内)，
盘子移动受限制的，以及允许有同样大小盘子的。 关于求解每种变形问题所要求的移动次数有什么已知的
结论?

. 尽可能多地讨论出现卡塔兰数的不同的问题。

. 描述派尔克发现的与一次谎话搜索相关的乌拉姆问题的解。

. 讨论派尔克发现的与多次谎话搜索相关的乌拉姆问题的变种， 关于这个问题你还知道什么?

. 讨论求平面上点集的凸包的分治算法。

. 查询音运数(lucky number)的定义。 解释怎样使用类似于埃拉托色尼得的技术找出幸运数。求所有小于
1000 的幸运数。

9 描述在数论中使用的得法。使用这种方法已经得到了哪些结果?

10, 查询古代法国纸牌相遇游戏的规则。捞述这些规则并且描述皮埃尔 。 雷蒙德 。 蒙特莫特关于“相遇问题"

的论文。

11. 描述怎样使用指数生成函数求解各种计数问题。

12, 描述计数的 Polya 理论和可使用这个理论求解的计数问题的种类

13. 管家问题是求安排 ”对夫妇围圆桌就座的方法数， 使得就座时男女相间并且没有丈夫和妻子相

邻。解释怎样用卢卡斯(E. Lucas)方法求解这个问题。
14， 解释怎样使用棋盘多项式(rook polynomial)求解计数问题。

cn 庆 四请

co fo

oo ~ 中 辐 必



--- 第 208 页 ---
第5章|

Discrete Mathematics and Its Applications，6E

关 系

在许多情况下集合的元素之间都存在某种关系。每天我们都要涉及各种关系，例如在一个商
行和它的电话号码之间的关系，雇员与其工资之间的关系，一个人与一个亲属之间的关系，等等。
在数学中我们研究的关系，如一个正整数与被它除的一个正整数、一个整数与和它模 5 同余的一
个整数、一个实数与一个比它大的实数之间的关系，以及一个实数 zx 和它的函数值 f(z)，等等。
在计算机科学中常常出现的关系，如一个程序与它所使用的一个变量、一种计算机语言与这个语
言的一个有效语句之间的关系等。

集合的元素之间的关系被表示成一种结构，这种结构叫做关系。它其实是集合间的笛卡儿积
的一个子集。可以用关系来求解问题，例如，确定在一个网络中的哪两个城市之间开通航线，为
一个复杂课题的不同阶段的工作找一个可行的执行次序，或者产生一个有用的方式以便在计算机
数据库中存储信息 。

在某些计算机语言中，一个变量名仅是它的前 31 个字母有效。此关系由前 31 个字母相同的字
符串有序对组成，这是一种被称为等价关系的特殊关系。等价关系在数学和计算机科学中均有体
现。本章将要学习等价关系和其他几种特殊关系。

5.1 关系及其性质

5.1.1 引言
1 可以用两个相关元素构成的有序对来表达两个集合的元素之间的关系，这是一种最直
“…”” 接的方式。为此，有序对的集合就叫做二元关系。在这一节，我们引入用于描述二元.
关系的基本术语。在这一章的后面，我们将使用关系来求解涉及通信网络、项目调度以及识别集
合中具有共同性质的元素等问题。
设A和日是集合，一个从A到日的二元关系是AX吕的子集。

换句话说，一个从A到也 的二元关系是有序对的集合 有， 其中每个有序对的第一个元素取自
A并且第二个元素取自已。我们使用记号 ecR6 表示(ae，纪ERR，a了表示(ae，b)和你及。当(a，D)属于
尺时称a 与有关系尺。

二元关系表示了两个集合的元素之间的关系。在本章的后面我们将引入 元关系，它表示了
在三个以上集合中元素之间的关系。当不发生混消时我们将省去二元这个词。

例 1一例 3 说明了关系的概念。

例1 设A是你们学校的学生的集合，焉是课程的集合。令尺是由Ca，纪对构成的关系，其中
4a是选修课程2的学生。例如，如果 Jason Goodfriend 和 Deborah Sherman 选修 CS518，即离散数
学，有序对(Jason Goodfriend，CS518 ) 和 (Deborah Sherman，CS518 ) 属于 尺。如果 Jason
Goodfriend 也选修 CS510，即数据结构，那么有序对(jason Goodfriend，CS510)也属于 尺。但是，
如果 Deborah Sherman 没有选修 CS510，那么有序对(Deborah Sherman，CS510)不在只中。

注意如果一个学生目前没有选修任何课程，那么在尺中没有以这个学生为第一元素的对。类
似地，如果一门课程目前没有开设,那么在尺中也没有以这门课程作为第二个元素的对。     于

例2 设4是所有城市的集合，引是美国的 50 个州的集合。如下定义关系 尺，如果城市 a 是
在州5，则(ae，世属于尺。例如，(Boulder，科罗拉多州)，(Bangor，缅因州)，(Ann Arbor，密软
根州)，(Cupertino，加利福尼亚州)和(Red Bank，新泽西州)是在尺中。               力

 



--- 第 209 页 ---
第5章 关 系。191

例3  设A=(0， 1， 21}， 如一{a， 总》， 那么{(0， C)， 《0， p)，(1， Q)， (2， 2是从A到吕的
关系。这意味着，比如说有0Ra，但没有 1R6，关系可以用图来表示，如图 5-1 所示，用箭头来表
示有序对。另一种表示关系的方式就是用一张表，这也在图 5-1 给出。在 5. 3 节我们将更详细地讨
论关系的表示 。                                   面
5. 1.2 函数作为关系            0

一个从集合4到集合忆的函数 广如 2.3节的         国        及
定义)对于 A 中的每个元素都指定 中一个唯一的            0 | X  X

1
2

/

元素。j 的图示是使得6= Fa)的有序对(a,， 六的 je
集合。由于了的图示是AX刀的子集，它就是一个
从A到B的关系。此外，函数的图示有下述性质，
A 的每个元素恰好是图中一个有序对的第一元素。

相反，如果尺是从A 到翌的关系,并且使得 2。
A中的每个元素是尺 中恰好一个有序对的第一元   图5-1 在例 3的关系只中的有序对
素，那么民的图示就可以定义一个函数。只要对 A
的每个元素指定唯一的元素 pbE B 使得(ac，bER 就可以做到。

可以用关系表达在集合 4 和集合 有之间的一对多的相关性，其中 4 的一个元素可以与已中
多个元素有关。函数表示了这样一种关系，对于 A 中的每个元素恰好只有一个 B中的元素与之
相关。

关系是函数的推广，可以用关系表示集合之间的更为广泛的联系。

5.1.3 集合的关系
集合入到它自身的关系是特别令人感兴趣的。
ER 集合4的关系是从A到A 的关系。
换句话说， 集合 A 的关系是AXA 的子集。
例4 设4是集合(1，2，3，4}》，A 上的关系尺={(ae，b) |a 整除纱中有哪些有序对?
解 〈a,，芒在尺中，当且仅当a 和睛是不超过4 的正整数且“整除5，我们看到
一{(1,1),(1,2),(1,3),(1,4)，(2,2),(2,4)，(3,3) (4,4)}

量力

、

 

 

在这个关系中的有序对的图和表的表示都在图 5-2 中给出。                面
例 5 给出了某些整数集合上的关系的实例。
例5 考虑下面这些整数集合上的关系，    雯
民= (ab 1a雪外
R= {(ab | aa之刁            2     罗
RR=({(a'p) |一5或a =一外
Ri一(Ca人|a =全            3。     3
R,一((a'六|a一5十1)
R 一{(a'b) |a+Tb二3}          4一04
其中,哪些关系包含了有序对(1，1)，(1，2)，     图52 例4中关系尺的有序对

(2，1)，(1，一巧以及(2，2)?
注意”和例 1一例4的关系不同，这些是无穷集合上的关系。

解  有序对(1， 1)在尺,， 及: ， 及 和 RR。 中; 有序对(1， 2)在尺， 和 尺， 中; 有序对(2， 1)在尺,，
R 和 尺。 中; 《1， 一1)在民:， 及,和 玉， 中; 最后， 有序对(2， 2)在 RR, ， 下， 和 尺， 中。        国

不难确定有穷集上的关系个数，因为集合 A 上的关系仅仅是AXA 的子集。

例6 7元素集合有多少个关系?

解 集合4上的关系是4XA 的子集。因为当4 是”元素集合时4X4 有关 个元素，并且 mm



--- 第 210 页 ---
192。第5章 关   系

个元素的集合有 2" 个子集，故4AXA 的子集有2" 个。于是二元素集合有 2" 个关系。例如，在集合
{ae，5，c}上存在 27 一2?一512 个关系。                         加

5.1.4 关系的性质

有若干个用于把集合上的关系分类的性质。这里我们只介绍其中最重要的性质。

在某些关系中一个元素总是与自己相关。例如, 设尺是所有的人的集合上的关系,， 若工积y
有相同的母亲和相同的父亲， 那么(z，y)属于尺。于是对于每个人 zx，有 zRr。

”如果对每个元素aEA 有(ae，ca)ER，那么集合A上的关系尺叫做自反的。

注意 我们看到如果VYa((a，a)ER)，那么集合上的关系是自反的，这里的论域是全中
所有元素的集合。

我们看到如果 A 的每个元素都关系到它自己，A 上的关系就是自反的。例 7一9 说明了自反关
系的概念 。

例7 考虑下面{1，2，3，4}上的关系

RR,一((1,1),(1,2),(2,1),(2,2),(3,4)，(4,1)， 044))}
=一{(1,1),(1,2),(2,1))
一{(1,1),(1,2),(1,4),(2,1),(2,2),(3,3), (4,1)， (4 4)》
R,一{(2,1),(3,1),(3,2),(4,1),(4,2),(4,3))
R;,一{(1,1),(1,2),(1,3),(1,4),(2,2),(2,3),(2,4),(3,3),(3,4) (44)}
R,一(1(3,4)}
其中哪些是自反的?

解 ”关系R, 和R: 是自反的，因为它们都包含了所有形如(a，a)的对，即(1，1)，(2，2)，
(3，3)和(4，4) 。其他的关系不是自反的，因为它们不包含所有这些有序对。特别地，R, ，R:，
尺, 和 尽, 不是自反的，因为(3，3)都不在这些关系里。                  国

例8 例5中哪些关系是自友的?

解 ”这个例子中的自反关系是 尺 (因为对每个整数 ae 有，e委ac) ，R, 和 尽, 。对于这个例子中其
他的关系容易找到不在关系中的形如(ae，a)的对(留给读者作为练习) 。            轿

例9 正整数集合上的“整除?关系是自反的吗?

解 ”因为只要 a 是正整数就有a | c,“整除"关系是自反的。(注意，如果我们将正整数集替换
为所有整数集，则"整除?关系不是自反的，因为 0 不能整除0。)                    国

在某些关系中一个元素与第二个元素相关，当且仅当第二个元素也与第一个元素相关。比如
一个关系由(z，2)对构成，其中zx和> 是你校的学生并且他们至少学一门公共课程。这个关系就
有这种性质。而某些关系有另一种性质，即如果一个元素与第二个元素相关,那么第二个元素就
不与第一个元素相关。比如一个关系由(z，y)对构成，其中工和>y 是你校的学生，且工比y 的平
均成绩高 。这个关系就有后一种性质。

E   对于 ae，pEA，如果只要(a、纪ER就有(8，a) ER，则集合4A上的关系尺叫做对
称的。如果对a，pEA，仅当a=8时(a，门ER和(2，a) ER，则集合4上的关系尺叫做反对
称的。

注意 使用量词，可以看到如果VYaVYpb((a，b)ER-=>(O，a)ER)，则4上的关系尺是对
称的。类似地，如果VYaVp((Ca,，b)ERA(G，a)A人人ER)一(ae一b))，则A上的关系民是
反对称的。

就是说，关系尺是对称的，当且仅当如果 a 与六相关则驴与a 就相关。关系尺是反对称的，当
且仅当不存在由不同元素 和构成的有序对使得a 与尺相关并且 与 a 也相关。对称与反对称的
概念不是对立的，因为一个关系可以同时有这两种性质或者两种性质都没有。一个关系如果包含
了某些形如(a，刀的对，其中 ae和9，这个关系就不可能同时是对称和反对称的。

 

 



--- 第 211 页 ---
第5章 关 系“

注意 尽管从统计数据中可以看出，对称的或反对称的关系相对不多，但许多重要的关
系都具有两种性质其中之一(见练习 21) 。

例10 例?7中的哪些关系是对称的? 哪些是反对称的?
ea 、，:. 解 ”关系R 和尺 是对称的，因为在这些关系中，只要(a，刀属于关系就有(06，a)属于
关系。对于关系 尽 ，唯一需要检查的就是(1，2)和(2，1)属于这个关系。对于 尺 ，必须

要检查(1，2)和(2，1)属于这个关系，还有(1，4)和(4，1)也属于这个关系。读者应该能够验证其
他的关系中没有一个是对称的，只需找到一个有序对(e，b) ，使得它在关系中但(5，a)不在关系中。

R、R 和民 都是反对称的。其中每一个关系都不存在这样的有序对，即它由元素 c 和 构
成，使得 as和5，但(ae，思和(6，a)都属于这个关系。读者只需找到有序对(ae，纪满足 ec和5，但(ao，
6)和(，wa)都属于这个关系，就能够验证其他关系中没有一个是反对称的。              国

例11 例5中的哪些关系是对称的? 哪些是反对称的?

解 ”关系民、R, 和有Rs 是对称的。R, 是对称的，因为如果 a=8或a一一5，那么就有06=a 或
0一一a。R, 是对称的，因为 ea一0 推出一a。R. 是对称的，因为 十6生3 推出 6十ae和3。读者应该
能验证其他关系没有一个是对称的。

关系 R 、R: 、R,， 和 RR, 是反对称的。R, 是反对称的，因为不等式 < 和8<委a 推出ac一5。R，
是反对称的，因为 a>& 和>a 是不可能的。R, 是反对称的，因为两个元素相对于 R, 相关，当且
仅当它们是相等的。R: 是反对称的，因为 ae=5十1 和=十1 是不可能的。读者应该能验证其他
关系没有一个是反对称的。                                              国

例 12 正整数集合上的整除关系是对称的吗? 是反对称的吗?

解 ”这个关系不是对称的，因为1|12, 但2}#1。它是反对称的，因为如果a 和2 是正整数且
al2和5 |a，那么 e王六这个验证留给读者作为练习) 。                                   国

设尺是有序对(z，y)构成的关系，其中xz与》是你校的学生，且工比得到更多的学分。假
设z与y? 相关并且? 与 相关，这意味着 zx 比y 得到更多的学分并且y 比 zx 得到更多的学分。可以
断言 z 比= 得到更多的学分，因此 z 与 相关。我们证明了R 有传递性，这个性质定义如下。

如果对于2，2，c<EA，(a，b思ER尺并且(6，c)ERR则(ce，c)E尺，那么集合4上的关
系刃叫做传递的。

注意 使用量词，如果YaVpbyc(((a， 人ERA(，c)ER)一(ae，c)ER)，集合A上的

关系就叫做传递的。

例13 例7中的关系哪些是传递的?
    解 尺、R 和及 是传递的。对于这些关系，我们可以通过验证若(a，6) 和(5，c)属于
这个关系则(ae，c)也属于这个关系来证明每个关系都是传递的。例如，R, 是传递的，
因为只有(3，2)7和(2，1)，(4，2)和(2，1)，(4，3)和(3，1)，以及(4，3)和(3，2)是这种有序
对，而(3，1)，(4，1)和(4，2)属于 尺,。读者应该能验证 R, 和 尺, 也是传递的。

R 不是传递的，因为(3，4) 和(4，1)属于 R,，但(3，1)不属于 R,。R, 不是传递的，因为
42，1)和(1，2)属于 R,，但(2，2)不属于 R, 。R, 不是传递的，因为(4，1)和(1，2)属于 R,，但
(4，2)不属于 民,。                              .                    国

例14 例5中的哪些关系是传递的?

解 ”关系民、R:、R, 和尺, 是传递的。R, 是传递的，因为 a< 和过c推出c和过<c<。R, 是传递
的，因为 c> 和0>c推出ae>c。Rs, 是传递的，因为 ea一士 和6一士c推出<一土c。 正如读者应该
验证的，显然 R, 也是传递的。R, 不是传递的，因为(2，1)和(1，0)属于 R,，但(2，0)不属于 R,
有R, 不是传递的，因为(2，1)和(1，2)属于 R, ，但(2，2)不属于 R,。                   国

例15S 正整数集合上的“整除?关系是传递的吗?

解 假设o 整除 且5整除<，那么存在正整数上和/! 使得5一必和c一以，因此c一a(k0D) ，即a
整除<。从而证明了这个关系是传递的。                                      硬

 

193



--- 第 212 页 ---
194。第5章 关   系

可以使用计数技术确定具有特殊性质的关系的个数。由此可以得知: 这个性质在?元素集合
的所有关系的集合上有多普遍。

例 16 ?7元素集合上有多少个自反的关系?

解 4上的关系尺是4AXxA的子集。因此，要通过指定4XA 中于个有序对中的每一个是否
在尺中来确定关系。因而，如果尺是自反的，对于aE4, ?az个有序对(a，a)中的每一个都必须
在尺中。其他 nz一1)个形如(ae，刀的有序对，a天45，可能在也可能不在尺中。因此，由计数的
乘积法则，存在 2"” ”个自反的关系。[这就是选择具有 a天0 的每个元素(a，妃是否属于尺的方
式数.]                                                       轿

寻元素集合上的对称关系和反对称关系数可以用和例 16 类似的推理得出(见本节末的练
习21)。计数元素集合上的传递关系数的问题已超出本书的范围。

5.1.5 关系的组合
因为从A到吾的关系是AX昌的子集，可以按照两个集合组合的任何方式来组合两个从 A 到
电 的关系。考虑例 17 至例 19 。

例17 设4A={(1，2，3}和了=(1，2，3，4}。组合关系尺={((1，1)，(2，2)，(3，3)) 和
R:一{(1，1)，(1，2)，(1，3)，(1，4))可以得到
RUR:=((1,1),(1,2),(1,3),(1,4), (2,2),(3,3)}
尽 站RR一{1(C1,1)}
RR 一RR一{1(2,2),(3,3))
”丽,一民一{(1,2),(1,3),(1,4)》                    醒

例18 设A和日分别是学校的所有学生和所有课程的集合。假设 R 由所有有序对Ca，组
成，其中a是选修课程上的学生。R, 由所有的有序对(ce，妃构成，其中课程5 是a 的必修课。关系
RUR，， 玉门民: ， R及中RR: ， 玉, 一下， 和 尺:一民， 是什么?

解 关系RUR: 由所有的有序对(ae，人纪组成，其中 a 是一个学生，课程 要么是他的选修课，
要么是他的必修课。R门R, 是有序对(a，纺的集合，其中 a 是一个学生，他选修了课程 5并且课
程也是a 的必修课。R,引R, 由所有的有序对(ae，纪组成，其中学生 a 已经选修了课程上 但课程
不是a 的必修课，或者课程“是a 的必修课，但是 没有选修它。有RR, 一R, 是所有对(ae，刀的集合，
其中a 已经选修了课程46，但5不是a 的必修课，即5是a 的选修课。R, 一R, 是所有对(ac，b)的集
合，其中2是a 的必修课，但 < 没有选修它。                          是

例19 设尽是实数集合上的“小于"关系，R:, 是实数集合上的“大于”关系，即尺一{Cz，y) |
z<y} 和民:一{(Cz， y) | Z盖y) 。 尺 UR:， 玉，门RR, ， 及 一RR: ， 下: 一忆 ， 下 中R， 是什么?

解 注意到(z，y)ERUR: 当上且仅当(z，y)ER, 或(rz，y)ER:，因此(z，y)ER,UR, 当且
仅当z<y或zx>y。由于条件 zx<y或zx>y与条件z天yy一样，因此 RUR:一{Cz，y) | z天妇。
换句话说,“小于?关系与“大于”关系的并是“不相等"关系。

其次，注意到一个对(z，y)同时属于 R， 和 R, 是不可能的，因为 x<y 并且z>之y是不可能的。
从而得到 RR 站R: =好。 也可以看到 R 一R一R，R 一RR 一下， 有 中R:=R UR: 一民门民: 一
{(z，y) | zx天y) .9                                        国

组合关系有另一种方式，  这种方式和函数的复合相似

二人河 设尺是从集合4 到集合下 的关系，S 是从集合吕到集合 C 的关系。  R 和S 的合成是
由有序对(oa， c)构成的关系，其中aEA，cEC，并且对于它们存在一个元素5E卫使得(c，bER
和(5，c)和ES。我们用 S 。民表示尺与S 的合成。

计算两个关系的合成需要我们找出这些元素，它们既是第一个关系中的有序对的第二个元素，
也是第二个关系中的有序对的第一个元素。正如例 20 和例 21 所示 。

 

旨 ”原书此处为 RU Rs一Ri门Rs，译文根据本书第 1 章的定义加了括号。一一译者注



--- 第 213 页 ---
第5章 关   系。 195

例20 尺是从(1，2，3}到{1，2，3，4}的关系且尺=((1，1)，(1，4)，(2，3)，(3，1)，
(3，4)}，S 是从{1，2，3，4}到{0，1，2}的关系且 S=((1，0)，(2，0}，(3，1)，(3，2)，
(4，1))}, 尺与S 的合成是什么?

解 S。尺是由所有尺中的有序对和 S 中的有序对构成的，其中在 尺中有序对的第二元素与 S
中有序对的第一元素相同。例如，R 中的有序对(2，3)和 S 中的有序对(3，1)产生了 S。愉中的有
序对(2，1)。计算所有在尺。S 中的有序对，我们得到

S。慑={((1,0),(1,1),(2,1),(2,2),(3,0), (3,1))              国

例21 双亲关系与自身的合成 设愉是所有人集合上的双亲关系，即如果a 是如的父母，则
(ay， DER。(a，c)ER。愉，当且仅当存在一个人5使得a 是已的父母且b 是c 的父母。换名话说，
(a，c)ER。尽当且仅当a 是c 的祖父母或外祖父母。                                        国

从两个关系合成的定义可以递归地来定义关系尺的寡。

己义 7  设尺是集合A 上的关系。 震 尺"， 7一1，2，3，…， 递归地定义为
民 一民  和  RRr+l 一 民 。民

这个定义证明了 尺:一尺。尺，R: 一RE 。R一(R。R) 。尺，等等。

例22 设R={((1，1)，(2，1)，(3，2)，(4，3)} ，求宕 R，n一2，3，4，…-

解 ”因为及一RR。R，我们得到天一{((1，1)，(2，1)，(3，1)，(4，2))。进一步，因为
民一R: 。R，R:一{(1，1)，(2，1)，(3，1)，(4，1)}。其他的计算证明了 Ri 和民 一样，因此
忆一((1，1)，(2，1)，(3，1)，(4，1)}。从而对 *=5，6，7，…，有民"一R 。读者应该能够验
证这个结果。             醒

下面的定理证明一个传递关系的寡是该关系的子集。5.4节将要用到这一结果。

 集合A上的关系尺 是传递的，当且仅当对 =1，2，3，有 R"CR。

证”首先证明定理的充分条件。假设对=1，2，3，有R"SR。特别地，有 展思尺。为证明尺
的传递性，注意到如果(a，pb)E尺并且(6，c)ER，根据合成定义就有(a，c) ER。因为玉:CR，
这就意味着(Ca，c)ER。因此尺是传递的。

我们将使用数学归纳法证明定理的必要条件。对于 ”一1，定理的这个结果是显而易见的。

假定 REGR，其中交是一个正整数，这是归纳假设。为完成归纳步骤，必须证明这将推出
R" 也是民 的子集。为证明这一点，假设(a，b) ER ， 那么因为民一R 。民，存在元素zEA
使得(ae，z)E尺并且(z，bER"。由归纳假设，即 尺和R，推出(z，b皇尽。下一步，因为尺是传
递的，以及(e，z)ER和(z，忆EGR，得到(ae，包ERR。这就证明了 尺和EGR，从而完成了证明。 口

练习
1. 列出从 4一{0，1，2，3，4}到 B={0，1，2，3}的关系尺中的有序对，其中(ae，纺ER，当且仅当
a) Q一必      b) a十5一4      c) ab      d) al6      e) gcd(ae，b)一1      人 lcm(a、六一2
2. 对集合{1，2，3，4}上的如下每一个关系，确定它是否是自反的，是否是对称的，是否是反对称的，是否
是传递的。
a) {((2，2)，(2，3)，(2，4)，(3，2)，(3，3)，(3，4))}
b) {(1，1)，(1，2)，(2，1)，(2，2)，(3，3)，(4，4)}
c) ({(2，4)，(4，2)}
d) {(1，2)，(2，3)，(3，4))
el {(1，1)，(2，2)，(3，3)，(4，4))
fD {(1，3)，(1，4)，(2，3)，(2，4)，(3，1)，(3，4)}
3. 确定所有 Web 页上的关系及是否为自反的、对称的、反对称的和传递的，其中(a，瓦ER，当上且仅当
a) 每个访问 Web 页 a 的人也访问了 Web 页 5。
b) 在Web页a 和5上没有公共链接 。
c) 在Web页aa和避土至少有一条公共链接 。
d) 存在一个 Web 页包含了到 Web 页 c 和 Web 页必的链接。

 



--- 第 214 页 ---
196。

生。

第5章 关   系

确定所有整数集合上的关系只是否是自反的、对称的、反对称的和传递的，其中(z，y)ER，当且仅当
a) z天y             b) zy字1           c) z一y十1 或 z一y一1      d) x=反y(mod 7)
e) 工是y 的倍数      D z与> 都是负的或都是非负的         g) z一六     h) >z之六

如果对于每个ccEA，有(a，a)和代R尺，那么集合 A 上的关系尺 是反自反的，即如果没有 A 中的元素与自己

有关系，关系尺就是反自反的。

oo 站中cn

9.

 练习 2 的哪些关系是反自反的?

. 练习 3 的哪些关系是反自反的?

. 集合上的关系可能既不是自反的也不是反自反的吗?
. 给出在所有人的集合上一个反自反关系的例子。

一个关系尺叫做非对称的，如果(a，5)ER尺推出(沪，a)作尺。
使用量词表达一个关系是非对称的含义 。

10. 从普元素集合到" 元素集合有多少个不同的关系?

补

设尺是从集合4 到集合吾 的关系。从到A 的北关系是有序对的集合{(6，a) | (ae，纪ER)}，记作 入 ，
关系枣是有序对的集合{(e，刀1 (a，电公民} 。

11. 设愉是正整数集合上的关系尽={(ae，5) | a 整除6) ，求

12，

13.

]4，

16.

17.

a) 尺”            b) 玉

设从A到吕的函数所是一一对应的。令尺是入的图相等的关系，即 R一{(a，jF(a)) | aEA}。逆关系
尺 是什么?

设 A 是你校的学生的集合，日是学校图书馆的书的集合。设 R 和 R, 都是有序对(<c，纪构成的关系，在
R, 中,学生 a 修一门课程需要读书5，在 Rs 中,学生 a 已经读过书5。描述在下面每个关系中的有序对。
a) 尺 UR。            b) 尺 门R:            c) 民 中R，            d) 尺 一民。         e) 玉: 一民

设只是由人的集合上的有序对(ae，妃组成的关系，其中是 的父母。设 S是由人的集合上的有序对(a，
2组成的关系，其中ce 是尹的兄弟姐妹。S *尽和愉。S是什么关系?

练习 15一16 涉及的都是实数集合上的关系，
民一{(a，b)ER: | a>邹,“大于”关系

民: =一((a，b)ER: | a三钞,“大于或等于"关系
RR:一{(a，b)ER: | a<人j,“小于”关系
民一{(a，bERz: | ce魏引,“小于或等于"关系
Rs一{((a，b)ER: | a一外,，“等于"关系
Re一{((a，b)ER: | a夭引,，“不等于"关系

. 求
a) 尺: UR，            b) RURs            c) Ri 门Rs            d) RR门R
e) RR 一Rs            们 六,一尺，            g) 尺:GR。            h) R:个R;
求
a) 及。。R，           b) R:。R，           c) R。Rs           d) R， .Ri
e) Ri 。R，           们 R。Rs           gE) R，*Rs           h) Re “Re

设愉是具有博士学位的人的集合上的关系，要求(a，纪ER，当且仅当n 是避的导师。什么情况下一个有
序对(ea,，忆在 尺 中? 什么情况下一个有序对(a，刀在 R" 中? 这里”是正整数。(注意每个具有博士学位
的人有一个导师。)

: 设 R 和及 分别是整数集合上的“模 3 同余"和*模 4 同余”关系，即 R, 一{(ae，b) | <反Amod 3)) 和及:一

{(ae，6) | a=5Cmod 4)} 。求
a) 及 UR，           b) RR门R，           c) 民 一尺，           d) 玉: 一民         e) R 中R:

:10，1}上的 16 个不同的关系中有多少个包含了对(0，1)?
. a) 在集合fa，5，c，d}上有多少个关系?

b) 在集合{a， 妨，c， dj上有多少个关系包含对(a， Q)?

. 刀元素集合上有多少个关系是

a) 对称的?       b) 反对称的?       c) 非对称的?       d) 反自反的?       e) 自反的和对称的?



--- 第 215 页 ---
第5章 关   系。197

f) 既不是自反的也不是反自反的?
22. 找出在下面定理证明中的错误。
“定理", 设尺是集合4A 上的对称和传递的关系，则 尺是自反的。                     .
“证明": 设eEA。取元素gEA 使得(ae，纪ERR。由于只是对称的，因而有(6，a)扩尺。现在使用传递
性，由(a，切入民和(，a)E民可以得出结论(a，a)E民。
23. 证明: 集合 A上的关系尺是对称的，当且仅当尺一R  ，其中尺 :是尺的道关系。
24. 证明: 集合A 上的关系尺 是自反的，当且仅当逆关系尺:是自反的。
25. 设只是自反的和传递的关系，证明对所有的正整数 nn，R"一及。
26. 设尺是集合4 上的自反关系， 证明对所有的正整数 n，尺" 也是自反的。
27, 假设关系尺是反自反的，尽: 一定是反自反的吗? 对你的答案给出理由。

5.2 mn 元关系及其应用

5.2.1 引言

在两个以上集合的元素中常常会产生某种关系。例如，学生的姓名、学生的专业以及学生的
平均学分绩点之间的关系。类似地，一个航班的航空公司、航班号、出发地、目的地、起飞时间
和到达时间等也有一种关系。在数学中也有这种关系。例如，有 3 个整数，其中第一个整数比第
二个整数大，而第二个整数比第三个整数大。另一个例子是直线上的点之间的关系，即当第二个
点在第一和第三个点之间时，这三个点有关系。

本节我们将研究两个以上集合的元素之间的关系。这种关系叫做盖元关系。可以用这种关系表
示计算机的数据库。这种表示有助于回答对数据库中所存信息的查询，例如: 哪个航班在午夜 3 点
到4点之间降落在 O Hare 机场?你们学校的二年级学生娜些是主修数学或计算机科学的，并且平均
学分绩点大于 3. 0? 公司的哪些雇员为这个公司工作不到 5 年但所赚的钱已经超过 50 000 美元?

5.2.2 7元关系

我们从建立关系数据库理论的基本定义开始。

 设 4A,，A,，…，A, 是集合。在这些集合上的半元关系是A, XA,X…XA, 的子集。
这些集合 A, ，A: ，…，4, 叫做关系的域， ?叫做它的阶。

例1 只是NXxNXN上的三元组(ae，5，c)构成的关系，其中a，6，c 是满足一5<c 的整数。
那么(1，2，3)ER，但(2，4，3)和他R。这个关系的阶是3。它的域都等于整数集合。        国

例2 设尺是ZXZXxZ上的三元组(ae，5，c)构成的关系，其中的 ec，5，c 构成等差数列 ，即
(a， 5，c)ER，当且仅当存在一个整数上，使得 5一zc十&，c一ae十24，或者0一<一， c一力一上。。 可
知(1，3, 5)ER，因为3=1十2，5一1十2。2，但是(2，5，9)从R，因为5一2一3, 而9一5一4。这
个关系的阶为 3，且它的所有域均等于整数集。                               国

例3 设尺是ZXxZXxZ-上的三元组(ae，b，zm)构成的关系, 其中的ec，5，m 都是整数，且满
足 mm二1，和 =王2(mod m)。则 (8，2，3)，(一1，9，5)和(14，0，7)都属于尺，但(7，2，3)，
(一2，一8，5)和(11，0，6)都不属于尺，因为 8=2(mod 3) ，一1三9(Cmod 5)和 14=0(mod 7)，而
7夫2(mod 3)，一2尖一8(mod 5)和 11天0(mod 6) 。这个关系的阶为3，且它的前两个域是全部整数
集而第三个域为正整数集。                                           国

例4 设尺是由5元组(4，N，S，D，T)构成的表示飞机航班的关系，其中A 是航空公司，
N 是航班号，S 是出发地，刀是目的地，太是起飞时间。例如，如果 Nadir 直达航空公司在 15;00
有从 Newark 到 Bangor 的 963 航班，那么(Nadir，963，Newark， Bangor，15:00)属于民。这个关
系的阶是 5， 并且它的域是所有航空公司的集合、航班号的集合、城市的集合、城市的集合以及时
间的集合。                                                     [|

5.2.3 数据库和关系
5专承汪 操作数据库信息所需要的时间依束于这些信息是怎样存储的。插和信和删除记录，更新

    记录，检索记录以及从一个重奏的数据库中组合记录的操作，在一个大型数据库中每



--- 第 216 页 ---
198。第5章 关   系

天要执行几百万次。由于这些操作的重要性，已经开发了数据库表示的各种方法。我们将讨论其
中的一种基于关系概念的方法，叫做关系数据模型 。

数据库由记录组成，这些记录是由字段构成的2元组。这些字段是”元组的数据项。例如，学
生记录的数据库可以由包含学生的姓名、学号、专业、平均学分绩点(GPA)的字段构成。关系数
据模型把一个记录的数据库表示成一个元关系。于是，学生记录可以被表示成形如(学生姓名，
学号，专业，GPA)的4元组。6 个记录的一个数据库样本是:

(Ackermann，231455，计算机科学，3. 88)

(Adams，888323 ，物理学，3. 45)

(CChou，102147，计算机科学，3, 49)

(Goodfriend，453876，数学，3. 45)

(Rao，678543，数学，3. 90)

(Stevens，786576，哲学，2. 99)

用于表示数据库的关系叫做表，因为这些关系常常用表来给出。这些表的每个列对应于数据
库的一个属性。例如，同样的学生数据库显示在表 5-1。这个数据库的属性是学生姓名、学号、专
业和平均学分绩点(GPA) 。

表5-1 学生

         
 

231 455
888 323
102 147
453 876
678 543
786 576

3.88
3. 45
3. 49
3. 45
3. 90
2. 99

Ackermann
Adams
Chou
Goodfriend
Rao

Stevens

  
      
      
     
    
 

当 元组的某个域的值能够确定这个”元组时，m 元关系的这个域就叫做主关键字。这就是说
当关系中没有两个二元组在这个域有相同的值时，这个域就是主关键字。

常常要从数据库增加或删除记录。由于这一点，一个域是主关键字的人性质是随时间而改变的。
所以，一个主关键字应该选择那种无论数据库怎样改变都能继续存在的字段。一个关系当前含有
的所有?元组称为该关系的外延。数据库更持久的内容，包括它的名字和属性，则被称作数据库
的内涵。选择主关键字的时候，应当选择那种能够为本数据库所有可能的外延充当主关键字的。
要做到这一点，就必须认真考察数据库的内涵，以便预知可能在外延中出现的 元组集。

例5 假设将来不再增加 元组，对于表 5-1 所示的 元关系，哪个域是主关键字?

解 ”因为在这个表中对应每个学生的姓名只有一个4 元组，学生姓名的域是主关键字。类似
地，在这个表中学号是唯一的，学号的域也是主关键字。但是，所学专业的域不是主关键字，因
为包含同样的专业的4 元组有多个。平均学分绩点的域也不是主关键字，因为有2 个4元组包含了
同样的 GPA。                                  面

在一个”元关系中域的组合也可以唯一地标识”元组。当一组域的值确定了一个关系中的交元
组时，这些域的笛卡儿积就叫做复合关键字。

例6 对于表 5-1 中的”元关系，假设不增加半元组，所学专业的域与 GPA 的域的笛卡儿积
是复合关键字吗?

解 这个表中没有两个4 元组有同样的专业和同样的 GPA，因此这个笛卡儿积是一个复合关
键字。                                      图

因为主关键字和复合关键字用于唯一地标识数据库中的记录，当新的记录被加到这个数据库
时关键字要保持有效是非常重要的。因此，应该做检测以保证在这个或这些相应的字段中每个新



--- 第 217 页 ---
第5章 关 系"199

记录与表中所有其他的记录不同。例如，使用学号作为学生记录的关键字是有意义的，因为没有
两个学生有同样的学号。一个大学不应该使用姓名字段作为关键字，因为有可能两个学生有同样
的姓名(如 John Smith) 。

5.2.4 n元关系的运算

慰元关系存在可以用于构成新的元关系的不同的运算。综合使用这些运算能够回答对数据库
的满足特定条件的所有元组的查询。

一个?元关系最基本的运算是在这个”元关系中确定满足特定条件的所有 元组。例如，我们
可能想在学生记录的数据库中找出主修计算机科学专业的所有学生的记录。可能我们想在同一个
数据库中找出所有平均学分绩点在 3.5 以上的学生。也可能我们想在这个数据库中找出所有主修
计算机科学专业的平均学分绩点在 3. 5 以上的学生 。为完成这些任务我们使用了选择运算 。

人 设尺是”元关系，C是尺中元素可能满足的一个条件。那么选择运算 sc 将 元关系
及 映射到尺 中满足条件 C 的所有>? 元组构成的 元关系。

例7 为了找出表 5-1 所示的=”元关系尺 中主修计算机科学专业的学生的记录，我们使用运算
sc ，其中 C, 是条件专业=“计算机科学”。结果是两个 4 元组(Ackermann，231455，计算机科学，
3. 88)和(Chou，102147，计算机科学，3. 49) 。类似地，为了在这个数据库中找出平均学分绩点在
3.5 以上的学生记录，我们使用运算 xc ，其中 C 是条件 GPA>>3.5。结果是两个4 元组
(Ackermann，231455，计算机科学，3. 88) 和(Rao，678543，数学，3. 90) 。最后，为找出主修计
算机科学专业的 GPA 在 3.5 以上的学生记录，我们使用运算 xc ，其中 C, 是条件(专业=*计算机

 

 

科学”人GPA>3.5)。结果由一个4元组(Ackermann，231455，计算机科学，3. 88)构成。     面
大总秩玉于于关系中和条记录相同的城可以构建一 个新的元关系。
投影 忆……将半元组(al ，a ，…，a)映到普元组(oa …。)，其中m<<n。
换名话说， 投影亚   -删除了?> 元组的m一阅个分量，保留了第癌， ，…，z 个分量。

例8 当投影 P，,施用到 4 元组(2， 3，0，4) ，(Jane Doe，234111001，地理学，3. 14) 以及
(al ，a ，a ，ai)时结果是什么?

解 ”已:把这些4元组分别映到(2，0) ，(Jane Doe，地理学)和(aa ，a; ) 。            国

例 9 说明了怎样使用投影来产生新关系。

例9 当投影 已,施用于表 5-1 中的关系时结果是什么?

解”当施用投影 P,,时，表的第二列和第三列被删除，得到了表示学生姓名和平均学分绩点的
对。表5-2 给出了这个投影的结果。                                       国

当一个投影施用到一个关系的表中时，有可能使行变少。当关系中的某些元组在投影的mm
个分量中每个分量的值都相同，只在被删除的分量有不同的值时，就会出现这种情况。例如，考
形下面的例子。

例 10 当投影 P,.:施用到表 5-3 的关系时得到什么表?

解 表5-4给出了当投影 已,:施用到表 5-3 时得到的关系。注意在施用了这个投影后行数
减少。                                                        男

家 S-2 GPA

  
                                                                                                                                                                                                                                                                                                                                                                        
  
 
  
                                                                                                                                                                                      

  
  
  
  
  
 

Ackermann                                                                                                 Glauser

Adams
Chou
Goodfriend

MS 475
PY 410
MS 511
MS 603
CS 322
MS 575

3. 45                            Glauser

Glauser
3 49                            Marcus
3. 45                            Marcus
3. 90                          Marcus
Miller
Miller

只ao

 

Stevens

  



--- 第 218 页 ---
200，贡5章 关  系

当两个表分享着某些相同的字段时连接运算将这两个表组合成一个表。例如，一个表包含了
航空公司、航班号和通道的字段，另一个表包含了航班号、通道和起飞时间的字段。可以将这两
个表组合成一个包含航空公司、  航班号、通道和起飞时间字段的表。

                                                                                                                                                                                                                                                                 

设尺是六元关系且S 是?元关系，          表5S-4 专业
pb和mm 和刀委an。连接 J(R，S)是 思十mx一户元关系，它         学生         专业
包含了所有的(天十?一轧)元组Ca， QQo-py CI      Glauser       生物学
Cay CCpy 轨，B 站-)， 其中 关元组(al ，a:，      Marcus       数学
an cl c，…，c)属于尺且7元组(ce，c ，…，      Miller        计算机科学
co ai，加 …，p_)属于S。

换句话说，连接运算 J。 从两个关系产生一个新的关系，它把第一个关系的所有 普 元组和第二
个关系的所有? 元组组合起来，其中 六元组的后户个分量与”元组的前户个分量相同。

例11 当用连接运算 j* 组合表 5-5 和表 5-6 中的关系时所得结果关系是什么?

解”J 产生的关系在表 5-7 中。                                                国

表 5-5 ”教学课程

 
 
  
  
  
  
  
  
  
  
 

Cruz
Cruz
Farber
Farber
Gramrmer
Grammer
Rosen

Rosen

     
   
   
   
   
  
      

Cruz                                                                                                            93:00A. M.
8:00A. M.
3:00P. M.
11:00A. M.
4:00P. M，
2:00P. M.
3:00P. ML

Cruz
Farber
Farber
Gramrmer
Rosen

Rosen

从已知关系产生新关系的运算除了投影和连接运算以外还有其他运算。对这些运算的描述可
以在关于数据库理论的书中找到。

5.2.5 SQL
让 数据库查询语言 SQL(结构化查询语言 Structured Query Language 的缩写)可以用来执
行本节所描述的运算。例 12 说明了 SQL 命令是怎样与元关系上的运算相关的。
例12 我们将说明怎样用 SQL 来表达查询，这是通过显示怎样使用 SQL 从表 5-8 中做一次关
于航班的查询来说明的。SQL 语句
SELECT Departure _ time         (选择起飞时间)

FROM Flights                         (从航班)
WHERE destination = Detroit'        (当目的地= “底特律7)

 



--- 第 219 页 ---
第5章 关   系。201

是用于在航班数据库中找出投影 P; ，它能够(在起飞时间属性上)选出 5 元组使得这些 5 元组满足
条件: destination 一 'Detroit'。输出是一张以底特律为目的地的包含航班时间的表，即
08:10，08:47和 09:44。SQL 使用 FROM子句识别查询施用到的?元关系，RHERE 子句说明选择运算
的条件，而 SELECT 子句说明将被使用的投影运算。(小心: SQL 使用 SELECT 表示一个投影，而不
是一个选择运算。这是一个令人遗憾的术语不一致的例子。)                        国

表 5-8 航班

 

例 13 说明 SQL 怎样做涉及多个表的查询。

例 13 SQL 语句
SELECT professor，time                                    (选择教授，时间)
FROM teaching 、assignments，class 、schedule      (从教学课程，教室安排)
WHERE department = mathematics'                           (当系 = “数学?7)

用于找出在数据库(如表 5-7 所示)中的 5元组的投影 P.,，这个数据库是分别在表 5-5 中的教学课
程和表 5-6 中的教室安排，数据库满足 department一 mathematics"条件下的连接 。输出 由单一的
2 元组(Rosen，3:00PMD)构成。这里的 SQLFROM 子句用于找出两个不同数据库的连接。           男

本节我们仅仅接触到关系数据库的基本概念。更多的信息可以在[AhUl95]中找到 。

练习

工.
2.
3.

4.

On

8.
9.

列出关系{(a，5，c) | ae，6 和上 是整数上且 0一a<5<c一5}中的三元组。
列出表 5-8 关系中的 5 元组。

假设不增加新的元组，对于表 5-8 中的数据库找出一个由两个字段构成的复合关键字，其中一个字段是
航空公司 。

3 元关系中的 3 元组表示了一个学生数据库中的下述属性: 学号、姓名、电话号码。

a) 学号可能是主关键字吗?

b) 姓名可能是主关键字吗?

c) 电话号码可能是主关键字吗?

' 5 元关系中的 5 元组表示了美国所有人的下述属性: 姓名、社会保险号、住址、城市、州。

a) 对这个关系确定一个主关键字。
b) 在什么条件下(姓名、住址)是复合关键字?
c) 在什么条件下(姓名、住址、城市)是复合关键字?

' 设C是条件: 目的地一底特律，当你施用选择运算 sc 到表 5-8 的数据库时，可以得到什么?
7.

设C是条件: 〈航空公司一Nadir) V (目的地一丹佛)，当你施用选择运算 x 到表 8-8 的数据库时，可以得
到什么?

哪个投影映射用于删除一个 6 元组的第一、第二和第四个分量?

给出施用投影 P,,到表 5-8 以后得到的表。

10. 构造把连接运算 J，* 施用到表 5-9 和表 5-10 的关系中所得到的表。



--- 第 220 页 ---
202 .第5章 关 系

表5-9 零件需求                表 5-10 零件库存

     

    

mt
SG 和
记

  

11. 证明，如果 C, 和 C: 是”元关系及 的元素可能满足的条件，那么 xc (sc (R))一scs (sc (R)) 。

12. 证明: 如果 C 是”元关系尺 和 S 的元素可能满足的条件，那么xc(RS)一x(R)站sc(S)。

13. 证明; 如果尽和5S 是mn元关系,那么 P, (RUS)一已 CR)UP (CS)。

14. 给出一个例子证明: 如果尺和 S是两个n元关系,那么 已,。- (有R一S)可能与 PCR)一Pa (S)

2

不同。

15. a) 与下述用 SQL 语句表示的查询相对应的运算是什么?
SELECT Supplier，PBroject                    《选择供货商，项目)
FROM Part needs，Ppart inventorYy             〈从零件需求，零件库存)
WHERE Quantity<<10                        〈当数量过10)

b) 给定表 5-9 和表 5-10 的数据库作为输入，这个查询的输出是什么?
16， 试确定例 3 中的关系是否有一个主关键字。

5.3 关系的表示

5.3.1 引宫

在本节及本章的剩余部分要研究的所有关系均为二元关系。因此，在这些内容中出现的“关
系"一词都表示二元关系。有多种方式表示有穷集之间的关系。正如已经看到的，一种方式是列出
它的有序对;， 另一种方式是使用表，如 5.1 节所示。本节将讨论另外两种表示关系的方式: 一种
方式是使用 0-1 矩阵，另一种方式是使用称为有向图的图形表达方式，这种方法将在本节偏后一
些进行讨论。

一般说来，拖阵适用于计算机程序中关系的表示。另一方面，人们常常发现使用有向图来表
示关系对理解这些关系的性质是很有用的。

5. 3.2 用矩阵表示关系
可以用0-1和殖阵来表示一个有穷集之间的关系。假设尺是从A={a，a，…，an}到 B一{b，
2，…，b}的关系。(这里集合 A 和集合召 的元素已经按照某一特定的但是任意的次序列出。此
外，当4=如时我们对于A 和旦使用同样的排序.)关系尺可以用矩阵 Mx王[> ]来表示，其中
|     如果(a ,与) GE 尺
0 如果(w人5)人 尺
换句话说，当 a 和刀 有关系时表示尺 的0-1 矩阵的(1，7力项是1，当 ao 和电 没关系时在这个
位置是 0(这种表示依赖于对A 和召 使用的排序) 。
下面的例子说明用矩阵来表示关系。
例1 假设A={(1，2，3}，B=({1，2}。令尺是从A到悍的关系,且如果aEA，pbEB，
ap，则民包含(a，b) 。如果 4a 一1，a一2，a 一3，0 一1，六一2， 表示 只的矩阵是什么?
解 因为R=({((2，1)，(3，1)，(3，2)}，关于 尺的矩阵是



--- 第 221 页 ---
第5章 关   系"。203

0
1] 1

Mx 中的 1 说明了有序对(2，1)，(3，1)和(3，2)属于尺，0 说明了没有其他的有序对属于尺。 国
例2  设A={ai， CQay as } ， 了一{ ， 已， 总 ， Di， 太) 。 哪些有序对在下面的矩阵所表示的关

系尺中?
1]0 0 0
wii
10 1 0 1

解 ”因为尺由使得my一1 的有序对(a，心)构成，因而
民一{(alyp), (azs志)， (azyps)， (asp as)， (asp)， (as ps)}            力

集合上的关系的矩阵是一个方阵，可以用这个矩阵确定关系是否有某种性质。A 上的关系是
自反的，如果对于每个aeEA有(a，a)ER。于是，民是自反的，当且仅当对一1，2，…，
她， (ai， ai)和所尺。 也就有， 尺是自反的， 当且仅当对 ;一1， 2，…，?， 72a 一1。 换句话说， 如果如
图 5-3 所示，M 的主对角线的所有元素都等于1，那么尺是自反的。

如果(a，b)ER 推出(5，a)ER，那么关系尺是对称的。因此集合 A={al，a，…，a,}上的
关系民是对称的，当且仅当只要(a，w)E尺就有(w，caiD)ER。用矩阵 Me 的术语来说，尺是对称
的当且仅当只要 mi =王1 就有一1。这也意味着只要 mi 一0 就有ri一0。因此尺是对称的，当且
仅当对所有的整数对i，7(其中i1，2，…，m， 7一1，2，…，7m都有 mv一mi 。我们看到只是对
称的当且仅当

Mg 一 (MR)
即 Ms 是对称和矩阵。对称关系的矩阵形式如图 5-4a 所示 。

1
1           人0
1       1
”.        0
]
1               a) 对称的       b) 反对称的
图 5-3 关于自反关系的 0-1 矩阵       图 5-4 ”关于对称和反对称关系的 0-1 矩阵

 

关系尺是反对称的，当且仅当(e，纪ER和(8，a) ER推出ae一5。因此，反对称关系的矩阵
有下述性质，即如果 mw 王1，i汉) ，则 mw一0。或者换句话说，当 i夭) 时，m =一0或册一0。反对
称关系的矩阵形式显示在图 5-4b 中。

例3 假设集合上的关系尺由和矩阵

1 1 0
0 1 1

表示,，尺是自反的、对称的和反对称的吗?

解 ”因为这个矩阵所有的对角线元素都等于1,，尺是自反的。又由于 Ms 是对称的，因此 尺是
对称的。也容易看出 尺不是反对称的。                                        国

可以用布尔运算加和委找到两个关系的并和交的矩阵表示。假设集合A 上的关系尺 和尽, 分
别由和矩阵 Ma 和 Mx 来表示。MR 或 Mx, 在某个位置为1，则关系的并的矩阵相应位置有 1。Mx 和
M, 在某个位置同时为 1，则关系的交的矩阵相应位置有 1。于是，这些关系的并和交的矩阵表
示是

Mk un 一 MRV Mn,  9  Mn nk 一 MA人 Mn，



--- 第 222 页 ---
204。第5章 关   系

例4 假设集合4上的关系尺, 和尺: 由下述牌阵表示，尽 UR: 和民门尽: 的矩阵表示是什么?

1 0 1           1 0 1
Mn 一 |  0  ， MR 一  |
0 1 0           1] 0 0

解 ”这两个关系的矩阵是
1
|
0
1
Man = Ms人MR = |

1
0    0

现在我们来考虑怎样确定关系合成的矩阵。这个矩阵可以通过关系矩阵的布尔积得到。特别
地，假设尺是从A 到如的关系且S 是从妃到C 的关系。又假设4A、忠和C 分别有m， 7和户个元
素。令关于S*R, 慑和3S 的0-1和矩阵分别为 Ms一[二]，Me=[m]，Ms一[s%](这些矩阵的大小
分别为 严义轧，闷X寺和7X思有序对(a，c)属于S。R当且仅当存在元素b 使得(o，久?属于尺并
且(&，c)属于S。从而性王1，当且仅当对某个上有 rs一%一1。由布尔积的定义，这意味着

Ms 三 MeOMs

例5 找出关系 S "尺的矩阵，其中表示丸和3S 的矩阵是

1 0 1                1 0
MI 一 |  1  |   ， Ms:一|0 0  1
0 0 0             1 0 1

解 ”关于S-。R尺的矩阵是

1
Mk ug 一 MRV Mn， 一 |

乙呈吕王一口

1] 1 1
Ms 二 MGM: 一  1  1                            国
0 0 0
表示两个关系合成的矩阵可以用来求 Me 的矩阵，特别地，由布尔寡的定义有
Mk 一 MI

节末的练习 16 要求证明这个公式。
例6 求关系民' 的矩阵表示，其中民的矩阵表示是

1 0
MR一|0 1 1
1 0 0

解 尽' 的矩阵是

5. 3.3 ”用图表示关系

我们已经显示了一个关系可以通过列出它所有的有序对或使用 0-1 矩阵来表示。还有一种重
要的表示关系的方法就是图。把集合的每个元素表示成一个点，每个有序对表示成一条弧，弧上
的箭头标明了弧的方向。当我们把一个有穷集上的关系看做一个有向图时，就可以使用这种图形
表示。

FE 一个有向图由顶点(或结点)集 V 和边(或弧)集 已组成，其中边集是 V 中元素的有序
对的集合。顶点 a 叫做边(ae，妃的始点，而顶点六叫做这条边的终点。

形如(ae，a)的边用一条从顶点 a 到自身的弧表示。这种边叫做环。



--- 第 223 页 ---
第5章 关 系"205

例7 具有顶点a，0，c和d，边(a，b)，(a， dd ，(b， 交，(，ad)，(c，a)，(c，00)和(dd，0)
的有向图给在图 5-5 中。                               各

集合A 上的关系尺 表示成一个有向图，这个图以 4 的元素作为顶点，以有序对(ae，纪作为边，
其中(a，b)ER。这就在集合4上的关系和以A 作为顶点集的有向图之间构成了一一对应。于是，
每一个关于关系的论述对应着一个关于有向图的论述，反之亦然。有向图给出了一个关于关系信
息的可见显示。因此，也常常用图研究关系及其性质。(注意从集合 A 到集合召 的关系可以用一个
有向的图示来表示，其中对 4A 中的每个元素存在一个顶点，刀中的每个元素存在一个顶点，如 5. 1
节所示。然而，当 A=刀时，那种图示表示与这里描述的有向图表示不同，它对关系信息的显示要
少得多.)例 8一例 10 说明了怎样用有向图来表示关系。

例8 集合(1，2，3，4}上的关系

及一1(1,1),(1,3),(2,1),(2,3),(2,4), (3,1),(3,2), (4,1)》

的有向图显示在图 5-6 中。                              国

例9 图5-7中的有向图所表示的关系尺中的有序对是什么?

解 ”关系中的有序对(z，y)是

尺一{(1,3),(1,4),(2,1),(2,2),(2,3),(3,1)， (3,3), (4 1) (4,3)}

每个有序对对应了有向图的一条边，(2，2)和(3，3)对应了环。              自

@              访                      1              2

 

C       44      3
图 5-5 一个有向图    图5-6 关系尺的有向图   图5-7 关系尺的有向图

表示关系的有向图可以用来确定关系是否有各种性质。例如，一个关系是自反的，当上且仅当
有向图的每个顶点都有环，从而每个形如(z，z)的有序对都出现在关系中。一个关系是对称的，
当且仅当对有向图不同项点之间的每一条边都存在一条方向相反的边，从而只要(z，y)在关系中
就有(>，z)在关系中。类似地，一个关系是反对称的，当且仅当在不同的两个顶点之间不存在两
条方向相反的边。最后，一个关系是传递的，当且仅当只要存在一条从顶点工到顶点 y 的边和一
条项点y 到顶点 x 的边，就有一条从顶点工到项点 z 的边(完成一个三角形，其中每条边都是具有
正确方向的有向边) 。

注意 对称关系可以用无向图表示，这个图中的边没有方向。我们将在第 6 章研究无向图。

例10 对于图 5-8 所示的有向图的关系，确定它们是否为自反的、对称的、反对称的和传
递的。

 

，                            C                              可
al只的有向图         b)S的有向图
图 5-8 关系尺和S 的有向图



--- 第 224 页 ---
206。第5章 关   系

解 ”因为民的有向图的每个顶点都有环，因此它是自反的。尺 既不是对称的也不是反对称的，
因为存在一条从“到8 的边，但没有从2到a 的边，并且在连接避和* 的两个方向都有边。最后，
尺不是传递的，因为从a到 有边，从情到< 有边，但是从<到< 没有边。

因为在有向图 S 的所有项点没都出现环，因此关系不是自反的。因为在不同顶点之间的每条
边都伴随一条方向相反的边，因此它是对称的但不是反对称的。不难看出 S不是传递的，因为(ce，
a)和(za，世属于 S但(c，纪不属于 S。                                         国

练习
1 用插阵表示下面每个(1，2，3}上的关系(按增序列出这个集合的元素) 。
al {(1，1)，(1，2)，(1，3)}
b) {(1，2)，(2，1)，(2，2) ，(3，3)}
ce] {(1，1)，(1，2)，(1，3)，(2，2)，(2，3)，(3，3)}
d) {(1，3)，(3，1)}
: 列出和下面抢阵对应的{(1，2，3}上的关系中的有序对(其中行和列对应于按增序列出的整数) 。

1 0 1                  0 1 0                  1 1 1
a) |0 1 0             b) |0 1 0             c) |1 0 1
1 0 1                  0 1 0                  1 1 1

. 怎样用表示集合 4 上关系尺 的有向图确定这个关系是否是反自反的?

4. 确定练习 2 中的矩阵所表示的关系是否为自反的、反自反的、对称的、反对称的和传递的。

. 尺是包含了前 100 个正整数的集合 4一{1，2，…，100}上的关系，如果尺满足下述条件，那么表示尺的
抵阵有多人少个非 0 的元素?
a) {(a，0) | aa全呈           b) {(a，D5) | a天中          c) {(a，0) | a一0十1}
d) {(a，B) | a一1          e) {(a，b) | ap一1

- 当尺是有穷集A 上的关系时，怎样从表示 尺 的关系矩阵找到这个关系的补刺 的矩阵?

, 设尺是矩阵
0 1 1
Me 一 |  1  |
1 0 1

fo

 

《3

<m

下

所表示的关系，求表示下述关系的矩阵。

 

a) 尺一              b) 责              c) 尺?
8. 设尺是矩阵
0 1 0
Ma一  0 1 |表示的关系，求表示下述关系的矩阵
1 1 0
a) 屎:       b) 尺:       c) 民'
9. 设尽是”元素集合上的关系。如果在表示尺的矩阵 Ma 中存在上个非0 的元素，那么在表示及 的补天 的矩
阵 Mk 中存在多少个非 0 元素?

在练习 10一12 后四了过有向国所表示的关系中的有序对。
TI1. 4

人 门 也

13, 怎样用有穷集 A 上关系尺 的有丙国移定关系是可最妆对生的
14. 确定练习 10一11 所示的有向图表示的关系是否为自反的、反自反的、对称的、反对称的和传递的。
15. 设尺是集合A 上的关系，解释怎样用表示 尺 的有向图得到表示关系的着R-:的有向图?

16. 证明， 如果 MR 是表示关系R 的矩阵，那么 ME” 是表示关系RR。 的矩阵。



--- 第 225 页 ---
第5章 关 系。207

5.4 关系的闭包

5.4.1 引言

一个计算机网络在波士顿、芝加哥、有丹佛、底特律 、纽约和圣迭戈设有数据中心。从波士顿
到芝加哥，波土顿到底特律，芝加哥到底特律，底特律到丹佛和纽约到圣选辫都有单向的电话
线。如果存在一条从数据中心 <到的电话线，(a，妃就属于关系 尺。我们怎样确定从一个中心
是否有一条电话线或多条电话线(可能不直接)链接到另一个中心? 由于所有的链接不一定是直接
的，例如从波士顿可通过底特律到丹佛，因此不能直接使用尺来回答这个问题。用关系的语言
说，尺不是传递的，因而它不包含可能被链接的所有的对。正如我们将在本节证明的，我们可以
通过构造包含 尺的最小的传递关系来找出每一对有着链接的数据中心。这个关系叫做尺的传速
闭包。

一般说来，设尺是集合A 上的关系。尺可能具有或者不具有某些性质 P，例如自反性、对称
性或传递性。如果存在包含尽的具有性质下的关系S，并且 S 是包含R 且具有性质了的每一个关
系的子集，那么 S叫做尺 的关于下的闭包。(注意一个关系关于一个性质的闭包可能不存在，见节
末的练习8 和17。)我们将说明怎样找关系的自反闭包、对称闭包和传递闭包。

5.4.2 闭包

集合 A=王(1，2，3}上的关系R=((1，1)，(1，2)，(2，1)，(3，2)}不是自反的。我们怎样
才能产生一个包含 民 的尽可能小的自反关系呢? 这可以通过把(2，2)和(3，3)加到 尺中来做到，
因为只有它们是不在尺中的形如(ae，a)的对。很明显，这个新关系包含了 R。此外，任何包含 尺
的自反关系必须包含(2，2)和(3，3) 。因为这个关系包含了尺，是自反的，并且被包含在每一个包
含尺的自反关系之中，因此它就是尺的自反闭包。

正如这个例子所显示的，给定集合 A 上的关系尺，对于 aER，可以通过把形如(ae，c)的所有
的对，除了已在民中的之外，都加到尺中，就构成了尺的自反闭包。加入这些对产生了一个新的
自反的、包含 民的关系，并且它被包含在任何包含 尺的自反关系之中。我们看到 尺的自反闭包等
于RUA，其中A={(ae，a) | aEA}是A上的对角关系。(读者应能验证这个结果。)

例1 整数集上的关系尺={(a，5) | a一分的自反闭包是什么?

解 尺的自反闭包是

RUA=((a'o) la一外U(aa) laEZ = (ao 1a挟纱        国

{1，2，3}上的关系((1，1)，(1，2)，(2，2)，(2，3)，(3，1)，(3，2)}不是对称的。我们
怎样产生一个包含 尺的尽可能小的对称关系? 只需增加(2，1)和(1，3)，因为只有它们是具有
(aa，bER而(020，a)不在民中的那种(5，a)对。这个新关系是对称的，且包含了 尺。此外，任何包
含了尺的对称关系一定包含这个新关系，因为一个包含 尺的对称关系必须包含(2，1)和(1，3) 。
因此这个新关系叫做尺的对称闭包。

正如这个例子所显示的，关系尺的对称闭包可以通过增加所有形如(52，a)的有序对构成，其
中(ae，世在关系中而(2，a)不在关系中。增加这些有序对产生一个关系，它是对称的，包含了
尽，并且它被包含在任何包含 尺 的对称关系之中。关系尺的对称闭包可以通过取关系与它的道的
并来构造，即RUR-:是尺的对称闭包，其中尺-:一((56，a) | (ae，bER}。读者应能验证这个
结果。

例2 正整数集合上的关系尺= {((ae，5) | a>弛的对称闭包是什么?

解 尺的对称闭包是关系

RUR 一{(a'bo |a二pb U(Ca) la>外一(ap) |a天从
要 这最后一步相等是由于尺包含了所有正整数构成的有序对，其中第一元素大于第二元
    素，并且 RR -包含了所有正整数构成的有序对，其中第一元素小于第二元素。     国

假设关系 尺不是传递的，我们怎样产生一个包含 尺的传递关系并使得这个新的关系被包含在



--- 第 226 页 ---
208“* 第5章 关   系

任何包含民 的传递关系之中?对于已经在民中的(ae，纹和(5，c)，可以通过增加所有形如(<e，c)的
有序对构成 尺的传递闭包吗? 考虑集合{1，、2，3，4}上的关系愉=((1，3)，(1，4)，(2，1)，
(3，2)} 。这个关系不是传递的，因为对于在尺中的(ae，b和(0，c)，它不包含所有形如(Ca，c)的
有序对。这种不在 尺中的有序对是(1，2)，(2，3)，(2，4)和(3，1)。把这些有序对加到 尺中并
不能产生一个传递关系，因为所得的结果关系包含(3，1)和(1，4)，但不包含(3，4)。这说明构
造关系的传递闭包比起构造它们的自反闭包或对称闭包更复杂。下面我们将建立一个构造传递闭
包的算法。正如将要显示的，一个关系的传递闭包可以通过增加那些必须出现的有序对来得到，
要重复这个过程，直到没有必须增加的有序对为止。

5.4.3 有向图的路径

我们将看到用有向图表示关系有助于构造关系的传递闭包。为此现在引信某些将要用到的
术语。

通过没有向图的边(按照这条边的箭头指示的相同方向)移经有向图就得到一条有向图中的
路径。
  在有向图G中从a 到2 的一条路径是G 中一条或多条边的序列(ze ，z)，(z，z)，
(re，z)，…，(z-i， xz)，其中z一a， xz一。即一个边的序列， 其中一条边的终点和路径中下
一条边的始点相同。这条路径记为 ze ，zr ，…，xz-:，xz，长度为m。在同一顶点开始和结束的路
径叫做回路或图。

有向图的一条路径可以多次通过一个项点。此外，有向图的一条边也可以多次出现在一条路
径中。

例3  下面哪些路径是图 5-9 的有向图中的路径 : ap，e di ae cad， bi Da，c，D，
ay， ay bi d，ci cy， bai e, bb，a， 8，a，b，e? 这些路径的长度是多少? 这个列表中的哪些路径
是回路?

解 ”因为(ae，b)、(8，e)和(e，d)都是边，ae，2，e，qd 是长为 3 的路径。因为(c，d)不是边，
a，e，c，d, 0不是路径。因为(656，a)，(a，c)，(c，b) ，(5，a)，(a，a)和(a，鸭都是边，5，a，
c， 2b，a，a， 六是长为6 的路径。我们也看到，因为(d，c)是边，d，c 是长为1 的路径。还有由于
《c，纺和(2，a)是边，c，8，a 是长为 2 的路径。(e，旭，(2，a)，(a，b)，(b，a)，(a，D)，
(2，e)都是边，因此 e，6，a，5，a，5，e 是长为6 的路径。

两条路径5，a，c，5，a，a,， 5和e，6，a，5，a，p，e 是回路， 因为它们在同一顶点开始和
结束。路径 ae，5，e，di c，5，a 和dd ，c 不是回路。                            国

术语路径也用于关系。把有向图的定义推广到关系可
知， 如果存在一个元素的序列 ao， Ti To To-1 闫具
有(ae，TDER，(r，z)ER，…，(r DER，那么
在尺中存在一条从a 到5 的路径。从关系中的路径定义可
以得到定理 1 。

5本到四 设愉是集合A 上的关系。从a到0存在一条

 

长为 xn 为正整数)的路径，当且仅当(ae，轧ER。                   e

证 ”我们将使用数学归纳法。根据定义，从 ec到5 存      图 5-9 一个有向图
在一条长为 1 的路径，当且仅当(ae，b)ER。因此当 ”=1
时定理为真。

假定对于正整数 ”定理为真，这是归纳假设。从 e 到 存在一条长为n十1 的路径，当且仅当
存在元素 cEA 使得从a 到< 存在一条长为 1 的路径，即(ae，c)ER，以及- -条从<到的长为”的
路径，即(c，纪ER"。因此，由归纳假设，从到存在一条长为na十1 的路径，当且仅当存在一
个元素 “，使得(a，c)ER 和(c，纪ER'。但是存在这样一个元素，当上且仅当(a，b)E R'+:。因此，
从“到六存在一条长为na十1 的路径，当且仅当(a，b)E R"+: 。定理得证。               口



--- 第 227 页 ---
第5章 关   系。209

5. 4.4 传递闭包                                             ，

我们现在证明找一个关系的传递闭包与在相关的有向图中确定哪些顶点对被路径连接是等价
的。由此要定义一个新的关系。

  设尺是集合A 上的关系。连通性关系 尽' 由对(a，纪构成，使得在 尺中从顶点a 到刀
之间存在一条至少长为1的路径。

因为 尺" 由对(ac，世构成，使得存在一条从 a 到忆的长为=的路径，从而及 是所有集合 尽" 的
并。换句话说，

许多模型都用到连通性关系。

例4 设尺是世界上所有人的集合上的关系，如果a 认识5， 那么尺包含(a，b。R" 是什么?
其中对是大于 2 的正整数。尺" 是什么?

解” 如果存在c使得(ae，c)ER且(c，刀ER，即存在c使得a 认识c，c认识2，那么关系 尺:
包含(a， )。 类似地， 如存在 六1，并zy Zu使得ua 认识zi， 相 认识 rz， 四 zw_1认识D， 那么
尺" 包含对(ae，p) 。

如果存在从 ae 开始至b 终止的序列，使得序列中的每个人都认识序列中的下一个人人，那么 尺
包含对(a，b)。(关于尺"存在许多有趣的猜想。你认为这个连通关系包含以你作为第一元素，蒙
古的总统作为第二元素的一对元素吗? 在第 6 章我们将用图建立这个应用的模型 。)           国

例5S 设尺是纽约市所有地铁站集合的关系。如果可以从 a 站不换车就旅行到5 站，那么尺包
含对(ae，b) 。当?是正整数时，R" 是什么? 尺" 是什么?

解 如果换z一1 次车就可以从 a 站旅行到刀站，关系 尽 就包含(a，亿。从 a 站旅行到站，如
果需要可以换车任意多次，关系 尽" 就由这种有序对(ae，b)组成。(读者应该能验证这些论断.) 国

例6 设尺是美国所有的州的集合上的关系，如果 a 州和妃州有公共的边界,那么 尺包含
(a，0) 。尺' 是什么? 其中半是正整数。尺' 又是什么?

解 关系尽 由对(ae，纪构成，可以从 ea 州恰好跨越半次州界到达训州。尺:由对(ae，纪构成，
可以从< 州跨越任意多次边界到达8 州(读者应该能够验证这些论断。)那些包含与美国大陆不相连
的州(即含有阿拉斯加或夏威夷)的有序对是不在 尺' 中的。                                       国

定理 2 证明一个关系的传递闭包和相关的连通性关系是等同的。

  关系尺的传递闭包等于连通性关系尽' 。

证 注意尽"包含尺。为证明尺"是尺的传递闭包，我们必须证明 尺" 是传递的且对一切包含民
的传递关系S，有尺'三S。

首先，我们证明尺"是传递的。如果(a，六ER 和(58，c)ER' ，那么在尺中存在从a 到六 和从
2到< 的路径。我们从a 到的路径开始， 并且沿着从”到c 的路径就得到一条从a 到ce 的路径。因
此，(a，c)ER  。这就得出 尺" 是传递的。

现在假设S$是包含尺 的传递关系，因为 S是传递的，S" 也是传递的(读者应该能验证这一点)，
并且 SCS(由5.1节定理 1)。此外，因为

SS一Us

和他ES，因此 S$ 和S。现在注意到如果 RES，那么 R' ES' ，这是由于任何尺中的路径也是 S
中的路径。从而尺"伍S 三S。于是，任何包含 尺 的传递关系也一定包含R' 。因此，R' 是尺 的传
递闭包。                                                                     口

既然我们知道传递闭包等于连通性关系，我们考虑这个关系的计算问题。在一个有限的有向
图中不需要检测任意长的路径来确定是否在两个顶点之间存在-条路径。正如下面的引理所证明
的。检测包含不超过”条边的路径就足够了，这里是集合中的元素个数。

  设A是= 元素集合,， 尺是A 上的关系。如果 尺中存在一条从 a 到的长至少为1的

po



--- 第 228 页 ---
210。*。第5章 关   系

路径，那么存在一条长度不超过?的这种路径。 此外，当 a瑚时，如果在 及中存在一条从a 到，

的路径，那么存在一条长度不超过 "一1 的这种路径。
证 假设尺中存在一条从a 到少的路径。令是这种路径的最短长度。假设 re ，z，z，…，

Tm一[19 开m 是一条这样的路径 ， 其中 To一4，<Tn 一品。
假设 se一和六二2，使得 mm人zx十1。由鲍介原理， 因为全中有个项点， 在2个顶点zu，xzi，

习，…，zu_i中至少有两个是相同的(见图 5-10) 。

Xi+2

 

G=划加  2   硬-1 大=三 了    xm 二证

图 5-10 产生一条长度不超过 ”的路径

假设 ,一忆满足 0和ij肥mm一1。那么这条路径包含一条从 到z, 自身的回路。可以把这条

回路从由“到上 的路径中删除，剩下的路径，即 z ，z，…，z，DH，…，zwi，zn 是从wa到2
的更短的路径。因此，最短长度的这种路径的长度一定小于等于 n。
a天0 的情况留给读者作为练习。                                        口
由引理 1，我们看出尺的传递闭包是尺，尺，尺，…，尽" 的并。这是由于在 尺' 的两个顶点之

间存在一条路径，当且仅当对某个正整数 ii委站在 尺 的这些顶点之间存在一条路径。因为
R 一尺U居出配册…UR"
并且表示关系的并的 0-1 抢阵是这些关系的 0-1 矩阵的联合，因此传递闭包的 0-1 矩阵是尽的0-1

矩阵的前 次赛的 0-1 怎阵的联合。
| 设 M, 是 , 元素集合上的关系尺 的0-1 和矩阵。那么传递闭包 R: 的 0-1 矩阵是
Me = MeVMOV MD V …VME

例7 求关系尺的传递闭包的0-1 矩阵，其中

1 0 1
Ma 一     1    |
1] 1 0

解 ”由定理3，R: 的0-1 矩阵是
Mu = Ma V MA V MP

1] 1 1        1 1 1
[2          [3]
MR 一  1  |  ， MR 一  1
] 1 1        1 1
1 1 1  1 1 1  1 1 1
上  1  中  1  | -|  1          国
1] 1 1  1] 1 1  1] 1 1

本: 定理 3 可以作为计算关系 尺' 的矩阵的算法基础。为求出这个矩阵，要连续计算 Mn 的

布尔寡，直到第”次蹇为止。当计算每次赛时就构成这个宪与所有较小的宕的联合。
当做到第 ”次知时，就得到关于 尺' 的矩阵。这个过程见算法 1 。

 

因为

二号

所以



--- 第 229 页 ---
第5章 关   系。211

算法1 计算传递闭包的过程

Procedure traxsitizue closture (MA : 7X7 的0-1和矩阵)
人 :一MIR

B :一A

fori :一2 to刀
begin
A :一AOMR
下:一BV A
end{B 是关于尺" 的0-1 和矩阵}

 

我们可以容易地求出用算法 1 确定关系的传递闭包所使用的位运算次数。计算布尔守 Ma ，

MR ，…，MA 需要找到nm一1 个 zxXn的0-1 和矩阵的布尔积。每个布尔积可以使用普(2n一1)次位
运算求得。因此，计算这些乘积使用痉(2n一1)(n一1)次位运算。

为从个 Ms 的布尔赛求 Me ，需要求 x一1 个 0-1 矩阵的联合。计算每一个联合使用害 次位
运算。因此，在这部分计算中使用(一1)关 次位运算。所以，当使用算法1时，用吗(2一1)(n--
1)十(2一1天一20 (2一1)一O(d)次位运算就可以求出二元素集合上关系的传递闭包的和矩阵。下面
我们将要描述一个更有效的求传递闭包的算法。

5.4.5 沃舍尔算法

并 沃舍尔算法得名于史蒂芬。沃舍尔，他在 1960 年给出该算法。这个算法能够有效计算
””“ ”，美系的传递闭包。算法 1 求出”元素集合上关系的传递闭包使用 2 (nm一1)次位运算 。

而沃含尔算法只使用 272 次位运算就可以求出这个传递闭包。

注意 ”沃含尔算法有时也叫做罗伊-沃含尔算法，因为伯纳德。罗伊(B 。Roy)在 1959 年

描述了这个算法。

假设 尺是 元素集合上的关系，设 w， 了，…，zu 是这个元素的任意排列。沃舍尔算法中
用到一条路径的内点的概念。如果a，zm，DP，…，xzroi， 6是一条路径，它的内点是zi，
2 ，…，xznm-1，即除了第一和最后一个顶点之外出现在路径中的所有顶点。例如，在有向图的一
条路径a，c，d，8，g，h，b,， 了的内点是c，d，F，g，户，6。a，c，d，a，丰5的内点是c，d，
a，j。 (注意这条路径的起点不是内点，除非这条路径再次访问它，且不是作为终点来访问的。
类似地，这条路径的终点也不是内点，除非它在这之前曾被这条路径访问过，且不是作为起点来
访问的。)

沃含尔算法的基础是构造一系列 0-1 和矩阵。这些矩阵是 WwW ，Wi ，…，W,，其中 W,王M， 是
这个关系的 0-1 矩阵，且 W,= [zw ]。如果存在一条从 w 到 w 的路径使得这条路径的所有内点都
在集合{w，也，…，也上表中的前人个顶点)之中,那么 w包=1，否则为 0(这条路径的起点和终
点可能在表中的前个顶点的集合之外) 。注意 W,= Me- ，因为 Mu 的第(i，7力项是1，当且仅当
存在一条从 w 到 的路径，且全部内点都在集合{w，岂，…，队)   ，    ，

之中(但这些就是有向图的所有顶点)。例 8 说明和矩阵 W, 表示什么。

例8 设尺是一个关系，它的有向图如图 5-11 所示。设 <，，
c，d 是集合元素的排列。求矩阵 WwW,，wW,，w,，W, 和 W,。和矩阵
W, 是尺的传递闭包。

解 令了一ay网一09，四一c，且央一d。W, 是这个关系的撼      大一一一
阵，于是                               图 5-11 关系尺的有向图



--- 第 230 页 ---
212 "第5章 关   系

0
1 0
0

一 写盖号
二 一 一

0 0    0
如果存在一条w 到_w 的且只有一4作为内点的路径，W, 的(;，疙项有 1。注意因为所有长为1
的路径没有内点，所以仍旧可以使用这些路径。此外存在一条从“上到<的路径，即5，a，a。
因此

Wi， 一

避呈口吓

0 1
1 1
0 1
I

王一忆

0
如果存在一条立到世 的且只有办一a 和zu一作为内点的路径，W:, 的(i，力项有 1。因为没
有边以8 作为终点，当我们允许6 作为内点时不会得到新的路径。因此，W: 一W, 。
若存在一条 到zu 的只用zw =一a，也一和us一<作为内点的路径，则 W, 的(it，力项有 1。我
们现在有从 @ 到 a 的路径，即 d，c，a 和从了到的路径4&，c，vd。因此
0 0 1
10 1 1
1 00 1
1] 0 1 1
最后，如果存在一条从办到zi 的路径，并且以轨=a，u 一5，一<及=迟作为内点，那
么 W, 的(i，力项为1。因为这些是图的全部顶点，此项为1，当且仅当存在一条从 w 到 的路径。
因此

Wi; 王

1] 0 1 1
WwW, 一 1 0 1 1
1 0 1 1
1] 0 1 1
这个最后的矩阵就是传递闭包的和矩阵。                                              男
沃含尔算法通过有效地计算 Wo=Meg，W，WwW:，…，W,=Mz来计算 Me 。不难看出可以
直接从 W,_, 计算 Wi，:  存在一条从 了 到 Z 的只以 Wi，    情况1
，…，双中的顶点作为内点的路径，当且仅当要

四

么存在一条从 w 到 w 的且内点是表中前人一1个顶点 ，。。。 。。... 。。。:!
的路径，要么存在从vw 到承 的路径和从 到 的路       四

径，而这些路径的内点仅在表中的前&一1 个顶点      中的全部内点

中。这就是说，要么在 w 被允许作为内点之前从

到几 已经存在一条路径，要么允许 w 作为内点产生

一条从立到了共然后从双到六的路径。这两种情况如 傅况2

图 5-12 所示。                                        AL 人
第一种类型的路径存在，当且仅当xy “= 1，且  -二  N AAA  NS

 

四

第二  种关型的路径存在，  当且仅当 ww 一1 和        二
一1。于是，过 ， 是1， 当且仅当或者 w' 一1，        中的全部四上
或者岂 0 和已         、这就得到引理 2         图5-12 把 加到允许使用的内点集中

[要

|     设内一[ol o 1和撼阵，它在(i，力位置有1，当且仅当存在一条从六 到ww 的路
径， 其内点取自集合{zm， Ta 办) 那么

 



--- 第 231 页 ---
第5章 关  系。213

虽   ap        [ti
zj 一   V (aol  和 5  )

其中国 了7 和上 是不超过”的正整数。
引理 2 提供了有效计算和矩阵 W,(k=1，2，…，7M的手段。我们使用引理 2 把沃含尔算法的伪
码在算法 2 中给出

算法2 沃舍尔算法
procedure Warsphai (CMR : 2X7m 的0-1和矩阵)

凤 :一MR
for & :一1 to 7
begin
fori :=一]1ton
begin
for j :一 ] to7
Ti 一 VTS 人5)
end

 

end{ W一[rws]是 Ma }

[一匡      [k一       [一匡

很容易以位运算次数计算沃伟尔算法的计算复杂度。使用引理 2，从项 ww  ，ws “和了un

[刁

找到项 wy 需要 2 次位运算。为从 W,-:求出 W, 的所有产 个项需要 2x 次位运算。因为沃舍尔算

法从 W,=王Ma 开始，计算”个 0-1 和矩阵的序列 Wi ，W:，…，W,=Mne ，使用的位运算总次数是
1。 2和2一2722 。
练习

1. 设尺是集合{0，1，2，3}上的关系，尺包含有序对(0，1)，(1，1)，(1，2)，(2，0)，(2，2) 和
(3，0)，求
a)刃的自反闭包          b)R 的对称闭包

2. 设只是整数集上的关系{(ae，b) | a 整除让，尺 的对称闭包是什么?

在练习 3一4 中画出给定有向图所表示关系的自反闭包的有向图。
3.        必           4       二

C          过                  C          好
.对于练习 3~4 的有向图表示的关系，找出关系的对称闭包的有向图。
- 对于练习 3一4 的每个有向图表示的关系，求包含它的最小的自反对称关系的有向图。
. 假设有穷集 A 上的关系及 由矩阵 Mn 表示，证明表示 民 的对称闭包的矩阵是 Me V MKR 。
. 什么时候可能定义一个关系只的反自反闭包，即一个包含 尺 的关系是反自反的且被包含在每一 一个包含只
的反自反关系之中?
9. 设尺是集合(1，2，3，4，5}上的关系，尺包含有序对(1，3)，(2，4)，(3,)，(3，5)，(4，3)，(5，1)，
(5，2)和(5，4)。求
a)尺2          b)Rs          c)R+          d)民5          e)Rs          人尺*
10. 设只是所有学生的集合上的关系，如果 天5且w 和户至少有一门公共课程，则尺包含了有序对(ae，D。
什么时候(c，好在下面的关系中?
a)尺2         b)Rs          c)R，
11, 假设关系尺是对称的，证明 尺" 是对称的。

co v 中



--- 第 232 页 ---
214。第5章 关  系

12. 使用算法 1 找出下面{1，2，3，4}上的关系的传递闭包。
a){(1，2)，(2，1)，(2，3)，(3，4)，(4，1)}
b){(2，1)，(2，3)，(3，1)，(3，4)，(4，1)，(4，3)}
c)((1，2)，(1，3)，(1，4)，(2，3)，(2，4)，(3，4)}
d)((1，1)，(1，4)，(2，1)，(2，3)，(3，1)，(3，2)，(3，4)，(4，2)}

13. 使用沃舍尔算法找出练习 12 中关系的传递闭包。

14. 求出包含关系{(1，2) ，(1，4)，(3，3)，(4，1) }的最小的关系，使得它是
a)自反的和传递的。   b)对称的和传递的。   c)自反的、对称的和传递的。

15. 已经设计出算法用 O(x2)次位运算来计算两个zxXz 的0-1 矩阵的布尔积。假设可以使用这些算法，给
出用算法 1 和沃舍尔算法求 ”元素集合上关系的传递闭包所用位运算数的大O 估计。

16. 修改算法 1 找出 元素集合上关系的传递闭包的自反闭包。

17. 证明，集合{06，1，2}上的关系及=((0，0)，(0，1)，(1，1)，(2，2)}关于下述性质 P 的闭包不存在，
如果了
a) “不是自反的”。         b) “有奇数个元素"。

5.5 等价关系基础

5.5.1 引言

在一些程序设计语言中，变量的命名可以包含无数字符。当编译器确定要检查两个变量是否
相同时，字符的数量就有限制。例如，在传统 C 中，编译器只检查变量名的前八个字符。(这些字
符是大写或小写字母、数字或下划线.)所以编译器对于比八个字符长的串就考虑它的前八个字符
相同。设尺是字符审集合上的关系，* 和+上 是两个字符串，如果* 和+上 至少有八个字符长，而*和+
的前八个字符相符，或者 :一上 则 :Rz。容易得出尺是自反的、对称的和传递的。 而且只把所有字
符串的集合分成一些类，传统 C 的编译器认为在一特定类中的所有字符串是相同的。

如果4整除a一上"，整数x 和2 有模4 同余的关系。后面我们将证明这个关系是自反的、对称的
和传递的。不难看出 a 和怠相关，当且仅当被 4整除时，a 和2 有相同的余数。这个关系将整数集
划分成不同的4类。当我们仅关心一个整数被4 整除的余数时，我们只需要知道它在哪个类而不必
知道它的特定值。

这两个关系，尺 和模 4 同余关系是等价关系，即是自反的、对称的和传递的。本节将证明这种
关系把集合划分成由等价元素构成的不相交的类。当我们仅关心集合的一个元素是否在某个元素
类，而不介意它的特殊身份时，就出现了等价关系。

5.5.2 等价关系
1 在这一节我们将研究具有一组特殊性质的关系，可以用这组性质为在某一方面类似的

相关个体之间建立联系。
国 集合4上的关系叫做等价关系，如果它是自反的、对称的和传递的。

等价关系在整个数学和计算机科学中都很重要。原因之一就是在等价关系中，当两个元素相
联系就可以说它们是等价的。

ES网 加果两个元素 < 和2由于等价关系而相联系，则称它们是等价的。记法 a~ 通常用
来表示对于某个特定的等价关系来说，a 和8 是等价的元素。

为了使等价元素的概念有意义，每个元素都应该等价于它自身，因为对于等价关系来说，自
反性是一定成立的。在等价关系中说 ac 和8 相互联系也是正确的(而不仅是 as 联系于)，因为如果
a 联系于2，由对称性，2 也联系于a 。此外，因为等价关系是传递的，如果 a 和 等价且上和< 等
价，则可得出a和ec 也是等价的。

例 1一例 5 说明了等价关系的概念 。

例1 设尺是整数集上的关系， 满足 aRp，当且仅当 a=一5或=一565。在 5.1节我们证明了R
是自反的、对称的和传递的。因此尺是等价关系。                             国

 

 



--- 第 233 页 ---
第5章 关  系。215

例2 设尺是实数集上的关系，满足 gcRb，当且仅当 a一2 是整数。尺是等价关系吗?
Re 解 ”因为对所有的实数 a，a一a一0 是整数，即对所有的实数有 aRa，因此只是自反
的。现在假设 <cR5，那么 a--b 是整数，所以5一a 也是整数。因此有 5Ra。尺是对称的。
如果 aR5 和5Rc，那么 <一 和4一<是整数，所以 a一c=(a一久十(8一c)也是整数。因此 aRc。于
是，尺是传递的。综上所述，尺是等价关系。                                  于
最广泛使用的等价关系之一是模 zm同余关系，其中思是大于 1I 的正整数。
例3 模疾同余。设闷是大于1的正整数。证明以下关系是整数集上的等价关系。
尺一{(a,p) |a三pmod mm)}

解 oa=&mod m)，当且仅当靖整除一5。注意a一a=0被整除，因为0天0。m。因此 a王
a(mod m)，从而模 mm同余关系是自反的。现在假设 <=反5(mod mm) ，那么 a一"被m 整除，即 <一5
一上 ，其中上是整数。从而5一a=(一妨m，即 5EacCmod mm) ，因此模妆同余关系是对称的。下面
假设 <三wmod m)和6=c(mod m)，那么z整除a一5和8一c<。因此，存在整数上和/!，使得 c一5一
km 和0一c一/mm。把这两个等式加起来得 a一c=(a一旭十(6一c)一km十1一(k十站m。于是，a三<
(mod m) ，从而模 mm 同余关系是传递的。综上所述，模 mm同余关系是等价关系。           国

例4 设尺是英语字母串的集合上的关系并且使得 caRb 当且仅当上Ga)=一上(6 ，其中zz)是串工
的长度。尺是等价关系吗?

解 ”因为!(a)王上(a)，从而只要 a 是一个串，就有 aRa,，故尺是自反的。其次，假设 caR2，即
la)一上(bo)。那么有 5Ra，因为!(妇二上Ca)，因此尺是对称的。最后，假设 acR 和Rec，那么有
la)一上(0和LO一上cec)。因此 La)一上co)，即 aRc，从而尺是传递的。由于尺是自反的、对称的
和传递的，尺是等价关系。                                              本

例5 设”是正整数，S 是字符串集。假定尽, 是S 上的关系，s尺.: 当且仅当=上:或者s 和上
都至少含有z 个字符，且和+ 的前=” 个字符相同。就是说，少于 ”个字符的字符串只和它自身以
关系尺, 相联系; 至少含有?7个字符的字符串* 联系于上 当且仅当上 也含有至少” 个字符且以* 最前
面的 ” 个字符开始。例如，设 zx=3，S 是所有比特串的集合，sR:: 当s一:或者y* 和+ 的长订至少为
3，且前 3 个比特相同时成立。例如，01 R, 01，00111 R, 00101，但 01 只, 010，01011 尺; 01110 。

证明: 对所有的字符串集 S 和所有的正整数着，R, 是S 上的等价关系。

解 如果s=*，则Rs 只要是S 中的一个字符串，所以关系尺, 是自反的。如果sR.r，那
么或者 :=上:或者* 和上 都至少含有zn 个字符，且以相同的 ”个字符开始。这就意味着 :+RR,s 成立。
所以 RR, 是对称的。

现在假设*R,z 且上R,w。则有，*一:或者s 和上 都至少含有?2 个字符且以相同的”个字符开
始; 还有t一x或者上 和xz 都至少含有?na 个字符且以相同的”个字符开始; 由此可以推出 :=x或者*
和zx 都至少含有7? 个字符且以相同的”个字符开始(因为在这种情形下，我们知道 *，t，xv 都至少
有nm 个字符，且s和zx 都与上一样以相同的”个字符开始) 。所以尽. 是传递的。这就证明了 尺, 是一
个等价关系。                                                     国

在例6 和例 7 中，将看到两个非等价的关系。

例6 证明: 正整数上的“整除"关系不是等价关系。

解 由5.1节的例9和例15 可知,“整除"关系是自反和传递的。但是，由 5.1节的例 12，知
道此关系不是对称的(例如，2 14但4二2)。所以得出，正整数上的“整除”关系不是等价关系 。 国

例7 尺是实数集上的关系，z尺y 当且仅当z 和>y 是差小于 1 的实数，即 | zx一>” | 二1。证明
及不是等价关系。

解 尽是自反的，因为只要 zER，就有 | zx一zx | =0一1。尺是对称的，因为如果zRRy，此
处坟和y 是实数，那么有 | xz一y | 过1，这告诉我们 | y一zx | = | z一| 1，因此y>Rz。然而，
及不是等价关系，因为它不是传递的。取 z=2.8，?y=1.9，和 z=1.1，这样 | zx一| = | 2.8一
1.9 | =一0.9王1，| y一z| =上1.9一1.11=0.8<1，但是| z一z| 一|2.8一1.1 1一1.7>1。这



--- 第 234 页 ---
216 "第5章 关 系

就是说，2.8尺1.9，1.9尺1.1但2.8灵1.1。                            四

5.5.3 等价类
设 4是在你们学校所有的高中毕业生。考虑 4 上的关系尺,，尺由所有的对(z，y)构成，其中
并和 从同一高中毕业。给定学生 zx，我们可以构造所有的关于尺与zx等价的学生的集合。这个集
合由与堪在同一高中毕业的所有学生构成。A 的这个子集叫做这个关系的一个等价类 。
ER 设尺是集合4A 上的等价关系。与 A 中的一个元素ae 有关系的所有元素的集合叫做a
的等价类。4 的关于只 的等价类记作[a]jx。当只有一个关系被考虑时，我们将省去下标 只并把这
个等价类写作[a]。
换名话说，如果尺是集合A 上的等价关系，元素 a 的等价类是
[a]js 一fs|(es) EGR)
如果2E [Lajs，2叫做这个等价类的代表元。一个等价类的任何元素都可以作为这个类的代表元。
也就是说，对作为这个类的代表元所选择的特定元素没有特殊要求。
例8 对于例 1 的等价关系，一个整数的等价类是什么?
解 ”在这个等价关系中，一个整数等价于它自身和它的相反数。从而[oa]={一<，c}。这个集
合包含两个不同的整数，除非 <=0。例如，[7]={(一?，7}，[一5]={一5，5}，[o]=10)。    国
例9 对于模4 同余关系，0 和1 的等价类是什么?
解 0的等价类包含使得 o拓0(mod 4)的所有整数 。这个类中的整数是被 4 整除的那些整数。
因此，对于这个关系 0 的等价类是
[0 一{人一8,一4,0, 4 8 )}
1 的等价类包含使得 o=1(mod 4)的所有整数 a。这个类中的整数是当被 4 除时余数为 1 的那些整
数。因此，对于这个关系 1 的等价类是
[1王{(…,一7?,一3,1,5,9，…)                      图
在例 9 找到了 0 和 1 关于模 4 同余的等价类。用任何正整数m代替 4 很容易把例 9 加以推广。
模疡同余关系的等价类叫做模阅同余类。整数a模普的同余类记作[a].，满足[c], =
(9一27,a一1，Q，4十4十2z2，…}。例如，从例9 得出[0],={…，一8，一4，0，4，
8， …}和[1],一{…， 一7，一3，1，5，9，…}。
例 10 对于例 5 中全体比特串集合上的等价关系 尽; 而言，串 0111 的等价类是什么?〈回忆s
RR:; 上: 当且仅当*，: 是满足如下条件的比特串: *=:或者y* 和+ 都至少含有 3 个比特，且和+; 的前3
个比特相同。)
解 ”等价于0111 的是以 011 开始，至少含有 3 个比特的比特串。它们是 0101，0110，0111，
01100, 01101，01110，01111，等等。所以
[011]s 一 {011,0110,0111,01100,01101,01110,01111 ,…}               国
例11 C 程序设计语言中的标识符 在C语言中,标识符是变量、函数或者其他类型的实体
的名字。每个标识符是一个非空字符串，串中的每个字符可以是大写或小写的英文字母、数字或
下划线，而第一个字符必须为大写或小写的英文字母。标识符的长度是任意的，这就使得开发者
可以按照自己的意愿使用一定数量的字符来命名一个实体，比如变量。然而，对于某些版本的C
编译器来说，当比较两个名字看它们是否表示同一事物的时候，实际检查的字符个数是有限制的。
例如，当两个标识符的前 31 个字符相同时，标准 C 编译器就认为它们是相同的。所以， 开发者就
必须小心，不要使用前 31 个字符相同的标识符来表示不同的事物。我们可以看出，如果两个标识
符由例 5 中的关系 民,联系起来，那么它们将被视做相同。由例 5 知道， 在标准 C 的标识符集上，
关系 玉: 是一个等价关系。
现有下标识符: Number_of_tropical_storms，Number_of _named_tropical _storms， Number_ of _
named_tropical_storms_in_the_Atlantic_in_2005，它们的等价类各是什么?

 



--- 第 235 页 ---
第5章 关 系"217

解 ”注意，当一个标识符的长度小于 31 的时候，根据 Rs 的定义，它的等价类只包含它自身。
因为标识符 Number_of _tropical_storms 只含有 25 个字符，所以它的等价类只含有一个元素，即它
自己。

标识符 Number_of _named_tropical_storms 的长度刚好为 31。一个标识符就与它等价意味着以
这 31 个字符开始。所以，每个长度至少为31、以 Number_of_named_tropical_storms 开始的标识符
都与这个标识符等价。所以得出，Number_of _named_tropical_storms 的等价类是全体以 Number_
of _ named_tropical_storms 这 31 个字符开始的标识符。

一个标识符与 Number_of _named_tropical_storms_in_the_Atlantic_in_2005 等价，当且仅当它
以 Number_of _named_tropical_storms_in_the_Atlantic_in_2005 的前 31 个字符开始。因为这 31 个字
符是 Number_of _named_tropical _storms，我们看到一个标识符与 Number_of_named_tropical_
storms_in_the_Atlantic_in_2005  等 价，当且仅当它与 Number_of named_tropical_storms 等价。就
是说，最后这两个标识符的等价类是相同的。                                                  图

5.5.4 等价类与划分

设A是你们学校恰好主修一个专业的学生的集合，尺是A 上的关系，如果Z和>》 是主修同一
专业的学生，则(z，y)属于尺。那么正如读者可以验证的，尺是等价关系。我们可以看出尺将A
中的所有学生分成不相交的子集，其中每个子集包含某个特定专业的学生。例如，一个子集包含
所有(只主修)计算机专业的学生，第二个子集包含所有历史专业的学生。而且这些子集是 尺的等
价类。这个例子说明一个等价关系的等价类怎样把一个集合划分成不相交的非空子集。我们将在
下面的讨论中把这些概念进一步精确化。

设尺是集合4A 上的等价关系。下面的定理证明 A 的两个元素的等价类或是相等或是不相交。
      设民是集合A 上的等价关系，下面的命题是等价的。

(iD)aR6      (iD[o]一[g      (iiD[g门[径委

证 ”首先证明(D推出(ii 。假设 cR5，我们将通过[oa]E[势和[g国三[a]来证明[oj=[势。假设
cE[aj，那么 aRc。因为 aR8 和民 的对称性，有 5Ra。又由于尺是传递的以及Ra 和aRc，就得到
boRc，因而有 cE [oO。这就证明了[ojSE[妇。类似地，可证明[纪生La]，证明留给读者作为练习。

其次我们将证明(i记推出(ii) 。假设[Lo]=[归。这就证明了[a]站[g夫杂，因为[ao]是非空的
(由尺的自反性acE[c])。

下面证明{iii)推出(D 。假设[o]站[的天好，那么存在元素 <满足cE[La]和ecE[的。换名话说，
aRc 和8Rc。由对称性有 cRe。再根据传递性，由 aRc 和<cR8 就有aRb。

因为(D推出(iD ，(iD 推出(ii) ，(ii)推出(人D ，三个命题CD) 、(i和(iii)是等价的。       口

我们现在将显示一个等价关系怎样划分一个集合。设 尺是集合4 上的等价关系，尺 的所有等
价类的并集就是A 的全部，因为 A 的每个元素 a 都在它自己的等价类即[ajs 中。换名话说，

局ra]s=A
此外，由定理 1，这些等价类或是相等的或是不相交的，因此当[a]js天[gs 时，
[aJ]n 扫 [os 一 好

这两个观察证明等价类构成A的划分，因为它们将 A 分成不相交的子集。更确切地说，集合
S 的划分是一族 S 的不相交的非空子集，且 S 就是它们的并。换句话说，一族子集 4A,，iETI，(其
中了是指标集)构成 S 的划分，当且仅当

4天好，iET
4,门4=芝ii)

 

UA,=S
ET了



--- 第 236 页 ---
218" 第5章 关   系

(这里符号 ,。,A,表示对于所有的iEI集合A, 的并集。)图 5-13 说明了集合的划分的概念。

例12 假设S=({(1，2，3，4，5，6)}，一族集合4, 一
(11，2，3)， ,一(4， 5} 和 4;一(6)}构成 S 的一个划分，           L l7
因为这些集合是不相交的，且它们的并是 S。    轿

我们已经看到集合上等价关系的等价类构成这个集合
的划分。这个划分中的子集就是这些等价类。反过来，可

以用集合的每个划分来构成等价关系。两个元素关于这个
关系是等价的，当且仅当它们在这个划分的同一子集中。
为看到这一点，假设{A, | iE刀是S的划分。设尺是

S 上的由有序对(z，y)组成的等价关系，其中工和>》 属于      图 5-13 ”集合的划分
这个划分的同一子集 4,。为证明 尺是等价关系，我们必
须证明 尽是自反的、对称的和传递的。

对于每个acES 有(a，a)ER，因为 a 和它自己在同一子集中，因此尺是自反的。如果(a，b)ERR，
那么 和a 在这个划分的同一子集中，因此有(6，a) ER。从而尺是对称的。如果(a，b抵尺 和
(瀛，c)ER，那么 a 和2在这个划分的同一子集中，比如是X, 5和*e 也在这个划分的同一子集中，
比如是立。因为划分的子集是不相交的，并且台属于X 和Y，必有 X王Y。因而a 和 属于这个划
分的同一子集，即(ce，c)ER。于是尺是传递的。

这就证明了 尺是等价关系。尺的等价类由 S 的子集构成，这些子集包含了 S 的有关系的元素，
根据 尺的定义，它们就是划分的子集。定理 2 是对等价关系和划分之间建立的这种联系的总结。

图 设只是集合S 上的等价关系。那么 尺的等价类构成 S 的划分。相反，给定集合 S 的
划分{A, |iE了六，存在着等价关系尽，它以集合 AiCiE I)作为它的等价类。

例 13 说明了怎样从一个划分构造一个等价关系。

例13 A,=(1，2，3}，A:=(4，5)}，A4:一16}是例 12 给出的集合 S= (1，2，3，4，5，6)的
划分，列出这个划分所产生的等价关系 尺中的有序对。

解 ”划分中的子集是尺的等价类。对(a，bER，当且仅当a 和8 在划分的同一个子集中。由
于4一{1，2，3}是一个等价类，因此，对(1，1)，(1，2)，(1，3)，(2，1)，(2，2)，(2，3) ，
(3，1)，(3，2)，(3，3)属于 Ri; 由于 4,=(4，5}是一个等价类，因此，对(4，4)，(4，5)，
(5，4)，(5，5)也属于尺; 最后，由于{6}是一个等价类，对(6，6)属于尽。此外没有其他的对属

 

于尺。                                       国

模同余类对定理 2 提供了一个有用的说明。存在 关个不同的模靖 同余类，对应于当一个整
数除以 普时可能得到的mm 个不同的余数。这 严个同余类记作[0],。，[1]。，…，[m一1]。。它们构
成了整数集合的划分。

例14 模4同余产生的整数划分中的集合是什么?
解 ”存在4个同余类，对应于[0],，[1],，[2], 和[3],，它们是集合
[0o],= (一8,一4,0,4,8，)}
[=人,一7,一3,1,5,9，…)}
[2],={(…，,一6,一2,2,6,10,…)}
[3],=(…,一5,一1,3,7,11,…)
这些同余类是不相交的，并且每个整数恰好在它们之中的一个。换句话说，正如定理 2 所说，
这些同余类构成了一个划分。                             国
现在举一个例子: 从这个集合上的等价关系产生的全体串集合的划分。
例15 设民为例 5 中的关系。在全体比特串集合上，由 R, 产生的对全体比特串集合的划分
中是哪些集合? (回忆 *，上 是比特串，s R;, :+，如果 *一上或者* 和上 都至少含有 3 个比特，且它们的
前 3 个比特相同 。)



--- 第 237 页 ---
第5童 关  系。219

解 ”注意到每个长度小于 3 的比特串只和它自身等价，有[A]x 一(1}，[0]s 一(0}，[1]w 一
{1)》，[0o]s ={00}，[01]x 一{01)，[10]jx, 一{10)，[11]n 一{11)。 再注意到每个长度大于或等于 3
的比特串必和 000，001，010，011，100，101，110，111 这 8个比特串之一等价，我们有

[oo00]。 一 {000,0000,0001,00000,00001,00010,00011，…}

[001]。=- {001，0010，0011,， 00100,，00101，00110，00111，…》
[010]。 = {010，0100，0101，01000,01001,01010,01011,，…》

[ol1]。 = {011,0110,0111,01100,01101,01110,01111,…}

[1o0]Ja。 = {100,1000,1001,10000,10001,10010,10011,…}

[1o1]。 = {101,1010,1011,10100,10101,10110,10111,…》

[110]。 = {110,1100,1101,11000,11001,11010,11011,…》

[lll]s = {ll1,1110,1111,11100,11101,11110,11111,…}

这 15 个等价类是不相交的，每个比特串都恰好属于它们之一。正如定理 2告诉我们的，这些

等价类是全体比特串构成的集合的一个划分。                                     力

练习

1. 下面是{10，1，2，3}上的关系，其中哪些是等价关系? 确定一个等价关系的性质，这些性质是其他关系所
欠缺的。

a){(0，0)，(1，1)，(2，2)，(3，3)}
b){(0，0)，(0，2)，(2，0)，(2，2)，(2，3)，(3，2)，(3，3)}
c){(0，0)，(1，1)，(1，2)，(2，1)，(2，2)，(3，3)》
d){(0，0)，(1，1)，(1，3)，(2，2)，(2，3)，(3，1)，(3，2)，(3，3))
e){(0，0)，(0，1)，(0，2)，(1，0)，(1，1)，(1，2)，(2，0)，(2，2)，(3，3)}

2. 下面是从Z到Z的所有函数集合上的关系，其中哪些是等价关系? 确定一个等价关系的性质，这些性质是
其他关系所欠缺的。
a){(太，g) | FI)一gC1)}
b){(CF，g) | F(0)一5(0)或 FG1)一g(1)}
c){(F，g) | 对所有的 zEZ，F(z)一ECz)一1)
d){(F，g) | 对某个 CEZ，对所有的 zxEZ，(z)一5(Cz)一C)
e){(F，g) | F(0)一g(1)且 FL)一5(0)》

3. 在大学校园里的建筑物集合上定义 3 个等价关系，确定关于这些等价关系的等价类 。

4. 证明: 在所有复合命题集合上的逻辑等价关系是等价关系。这里T和了的等价类是什么?

5. 假设 4 是非空集合，厂是以A 作为定义域的函数，设只是A上的关系，若 f(z)=y)，则(z，y)属
于及。
a)证明尺是A 上的等价关系。           b)R 的等价类是什么?

6. 设尺是长度至少为 3 的所有二进位串的集合上的关系，尺由对(z，y)构成，其中工和> 在它们的前 3 位相
同。证明尺是等价关系。

7. 设尺是长度至少为 3 的所有二进位串的集合上的关系，尺由序对(z，y)构成，其中工和y 在它们的第 1 和
第 3 位字符相同。证明 尺 是等价关系。

8. 设尺是正整数的有序对集合上的关系，((ae, 间，(c，d))ER当是仅当a十d=8十c。证明民是等价关系。

9.〈需要微积分)
a)设尺是从及到及的所有可微分函数的集合上的关系,尺由所有的对(让，8)构成，其中对所有实数 z，

jz)一纺(z)。证明只是等价关系。

b)什么函数与函数 fxz)一寻 在同一个等价类中?

10. 设尺是所有 URL(或 Web 地址?集合上的关系，zRy 当且仅当在zx 的Web 页与在 y 的 Web 页相同，证明
尺是等价关系。

在练习 11一12 中确定具有所示有向图的关系是否为等价关系。



--- 第 238 页 ---
220 "第5章 关   系

13.
1]4.
15.

16.
17.

18.

19.

20.

21.

22.
23，

 

12.     四       户

设尺是所有二进位串的集合上的关系，sRt 当且仅当* 和+ 包含相同个数的 1，证明 愉 是等价关系。

对于练习 13 中的等价关系，二进位串 011 的等价类是什么?

当 ”为下列各数时，同余类[z]: (即 ”关于模 5 同余的等价类?是什么?

a)2                b)3                c)6                d) 一3

描述每一个模 6 同余类 。

a)对于练习 8 中的等价关系(1，2)的等价类是什么?

b)对于练习 8 中的等价关系 尺 解释等价类的含义。[提示: 差a一5对应(ae，b) 。]

下面哪些子集族是{1，2，3，4，5，6)}的划分?

a){1，2)，{(2，3，4)}，{4，5，6}          b){1)，{(2，3，6}，!(4}，!{5)}

c){2，4，6}，{1，3，5)                d){1，4，5}，{(2，6)

下面哪些子集族是 8 位二进位审的集合上的划分?

a)以 1 开始的二进位串的集合，以 00 开始的二进位串的集合，以 01 开始的二进位串的集合。

b)包含串 00 的二进位串的集合，包含串 01 的二进位串的集合，包含串 10 的二进位串的集合，包含串 11
的二进位串的集合。

c)以00 结尾的二进位串的集合，以01 结尾的二进位串的集合，以 10 结尾的二进位串的集合，以 11 结尾
的二进位串的集合。

d)以 111 结尾的二进位串的集合，以 011 结旦的二进位串的集合，以 00 结尾的二进位串的集合。

e)含 3个 1的二进位串的集合，其中& 为非负整数;: 含 3k十1个 1 的二进位串的集合，其中人为非负整
数; 含 3k十2个 1 的二进位串的集合，其中上是正整数。

下面哪些是整数的有序对的集合ZXZ的划分?

a)z或是奇数的(z，y)对的集合; z是偶数的(zx，y)对的集合，y 是偶数的(z，y)对的集合。

bz 和>y 都是奇数的(z，27对的集合; xx和》 只有一个是奇数的(z，y)对的集合; xx和>y 都是偶数的
(z，y)对的集合。

c)z 是正数的(z，y)对的集合; >是正数的(z，y)对的集合; 工和> 都是负数的(z，)对的集合。

d)z 和> 都被 3 整除的(z，y)对的集合; z被3整除且y不被 3 整除的(z，y)对的集合，z不被 3 整除且
y被 3整除的(z，y)对的集合; zx 和>y 都不被 3 整除的(z，y)对的集合。

e)z>>0且 y>0的(z，y)对的集合; z>0 且 y生0 的(z，y)对的集合; z生0 且 y>0 的(z，y)对的集合;
zx<0且 y<0 的(zx，y)对的集合。

TDz天0 且 >径0 的(z，杂对的集合;，z=0且 >天0 的(z，y)对的集合;，z天0且 >一0的(z，y)对的集合。

列出由{0，1，2，3，4，5}的划分产生的等价关系中的有序对 。

a){(0}，!(1，2)}，{3，4，5)}              b){0，1}，{2，3)}，{4，5)》

c){0，1，2)，{(3，4，5}               d){0}，{1)，{2}，{3}，{4}，{5)》

如果在划分 Pi 中的每个集合都是划分 P: 中每个集合的子集，则 已 叫做 Ps 的加细。

证明: 由模6 同余类构成的划分是模 3 同余类构成的划分的加细。

证明: 对于 16 位二进位串的集合，最后 8 位相同的二进位串的等价类所构成的划分是由最后 4 位相同的
二进位串的等价类所构成的划分的加细。

在练习 24 中，尺, 表示例 5 中定义的等价关系族。回忆字符串 *，: 满足* RR,:，如果 *一:或者* 和+ 都至

少含有? 个字符，且它们的前 5 个字符相同 。

24.

证明: 由等价关系 Ra决定的标识符等价类构成的C 语言中所有标识符的划分是由等价关系 Rs 决定的标
识符等价类构成的划分的加细。(旧的 C 语言编译器只要多个标识符的前 8 个字符相同就将它们视为相
同，而标准 C 的编译器需要多个标识符的前 31 个字符相同才将它们视为相同.)



--- 第 239 页 ---
第5童 关  系

25. 求出在集合(la，6，c，d，e}上包含关系{(a，b，(a，c) ，(d，e)}的最小的等价关系。
26. 考虑例 3 的等价关系，即 RR=一({(z，y) | <一》是整数} 。

a)关于这个等价关系的 1 的等价类是什么?

b)关于这个等价关系的 172 的等价类是什么?

*27. 设尺是2X2棋盘的所有涂色集合上的关系，其中4 个方格中的每一个可以被涂成红色或蓝色。C: 和 C:
是被这样涂色的2X2 棋盘， (Ci，C:)属于尺，当且仅当 C: 可以由旋转 C:，或旋转 C, 然后再翻转 Ci
得到。

a)证明 尺是等价关系。            b)R 的等价类是什么?

28. 通过列举确定 3 元集上的不同的等价关系个数。

*29. 当我们构造一个关系的自反闭包的对称闭包的传递闭包时，一定得到一个等价关系吗?

30, 假设我们使用定理 2 从一个等价关系 尽 构造一个划分已。如果再次使用定理 2 从 已构造一个等价关系，
那么结果的等价关系尺是什么?

31. 设计一个算法找出包含一个给定关系的最小的等价关系。

5.6 偏序

5.6.1 引言
1 我们常常用关系对集合的某些元素或全体元素排序。例如，使用包含着字对(Cz，交的
”关系对字排序，其中按照字典顺序排在 y 的前面。使用包含闭对(z，光的关系安排
课题，其中上和> 是课题中的任务并且 z 必须在 》 开始之前完成。使用包含着对(zx，y)的关系排
序整数集合，其中工小于>。当我们把所有形如(z，z)的对加到这些关系中时，就得到了一个自
反、反对称和传递的关系。这些都是刻画元素有序集合的关系特征的性质，而这些关系使用它们
相对的大小来排序集合的元素。
集合 S上的关系尺，如果它是自反的、反对称的和传递的，就称为偏序。集合 S 与
偏序 R 一起叫做偏序全，记作(S，R) 。
例1 证明:“大于或等于”关系(二)是整数集合上的偏序。
se 解 ”因为对所有整数 e 有aa，是自反的。如果 a0 且0二ae，那么 ae一0，因此是
反对称的。最后，因为 c2 和6过c 推出a伺c，所以三是传递的。从而达是整数集合上

 

的偏序且(Z，三)是偏序集。
例2 整除关系“ | "是正整数集合上的偏序，因为正如 5. 1 节所述，它是自反的、反对称的和
传递的。我们看到(Z* ，| )是偏序集(Z+ 表示正整数集合) 。                       国

例3 证明: 包含关系和是集合 S 的寡集上的偏序。

解 ”因为只要A是S 的子集，就有ASA，反是自反的。因为AGEB和BCEA推出A=B，因
此它是反对称的。最后，因为 ASB 和BESC推出ASC，是传递的。因此, 是 P(S)上的偏
序,，且(P(S)，王)是偏序集。                                            国

例 4举出了一个不是仿序的关系。

例4 设只是由人构成的集合上的关系，z尺 y 当且仅当z 和y 是人，且xz年纪大于y。证明，
尺不是偏序 。

Ri 解 注意尺是反对称的，因为如果有一个人z比另一个人y 年长，那么 y 就不会比x
年长。也就是说，如果zRRy，那么y》 及zx。关系只是传递的，因为如果z比y年长，

而>又比z年长,那么工肯定比z 年长。就是说，如果zRy，yR z，那么zxRz。但是，R不是
自反的，因为没有谁会比自己年长。即对于所有的人 zx，z 只 zx。这就意味着 只不是偏序。     加

在一个偏序集中记号 <<8 表示(ce，纪ER尺。使用这个记号是由于“小于或等于”关系是偏序关
系的范例。(注意符号入用来表示任意偏序集的关系， 并不仅仅是“小于或等于”关系。)记号 a<8表
示 a系pb，但 a夭5。如果 ae<5，我们说“a 小于6或“大于ca                  .

当a 与上 是偏序集(S，<入)的元素时，不一定有 a<5或5<a。例如，在(PCZ)， 三) 中，

”221



--- 第 240 页 ---
222。第5童 关  系

{(1，2}与{1，3}没有关系，反之亦然， 因为没有一个集合被另一个集合包含。类似地，在
(Z ，|)中，2 与 3没关系，3 也与 2 没关系，因为23且3十2. 由此得到定义2。

ER 偏序集(S，尖)的元素 ac 和已叫做可比的，如果 a和5或5<a。当a和是S 的元素并
且既没有 a<o，也没有8<a，则称a 与 是不可比的。

例5 在偏序集(Z  ，| )中，整数 3 和9 是可比的吗? 5 和7 是可比的吗?

解 ”整数3和9是可比的,因为3|19。整数5和7是不可比的，因为5+#7且?7 二5。    国

用形容词“部分的(偏的) ”描述偏序是由于一些对元素可能是不可比的。当集合中的每对元素
都可比时，  这个关系叫做全序。

E   如果(S，<科)是偏序集，且 S 的每对元素都是可比的，则 S 叫做全序集或线序集，且
委叫做全序或线序。一个全序集也叫做链。

例6 偏序集(Z，近)是全序集，因为只要 a 和6 是整数，就有 a<委0 或5委a。         国

例7 偏序集(Z-  ，| )不是全序集，因为它包含着不可比的元素，例如5 和7。        国

我们注意到(Z” ，到?是良序的，其中入是通常的“小于或等于关系。我们现在定义良序集。

定义   对于偏序集(S，和) ，如果科是全序，并且 $S 的每个非空子集都有一个最小元素，就
称它为良序集。

例8 正整数的有序对的集合 Z+ X2t与和构成良序集。对于(aa ，a ) 和(钙，久)，如果
ai<叫， 或如果 al 一妃 且 o%委久(字典顺序)， 则(ai ， az)和(oo，2)。 有关的验证留作节后的练习。
集合乙与通常的委序不是良序的，因为负整数集合是 Z 的子集，但没有最小元素。         国

现在我们令述使用良序归纳原理证明关于一个良序集的结果这个证明技术是有效的。

汪2 良序归纳原理 设S是一个良序集，如果下述条件成立:

归纳步骤: 对一切 yES，如果 P(z)对所有 zxES且z<y为真，则 P(y)为真。
那么 P(z)对所有的 zxE S 为真。

证 假若 P(z)不对所有的 zxES 为真。那么存在一个元素 yE S 使得 P(y)为假。于是集合
4A={zES|P(z)为假}是非空的。因为 S是良序的，集合 A 有最小元素c。根据 。 是选自A 的最
小元素，我们知道对所有的 zxE SCz<a)都有 P(z)为真。由归纳步这就可以推出 P(e)为真。这个
矛盾就证明了 P(z)必须对所有 zxE S 为真。                                     口

良序归纳原理对证明关于良序集的结果是一种通用的技术。即使可以使用关于正整数集合的
数学归纳法证明一个定理时，使用良序归纳原理甚至可能更简单。

5.6.2 字典顺序

字典中的字按照字母顺序或字典顺序排列，字上典顺序是以字母表中的字母顺序为基础的。这
是从一个集合上的偏序构造一个集合上的串的序的特殊情况。我们将说明这种构造在任~-个偏序
集上是怎样做的。

首先，我们将说明怎样在两个偏序集(4 ，<, ) 和(4: ，<,)的笛卡儿积上构造一个偏序。在
4,XA: 上的字典顺序定义如下: 如果第一个对的第一个元素(在 A, 中)小于第二个对的第一个元
素，或者第一个元素相等，但是第一个对的第二个元素(在 4, 中)小于第二个对的第二个元素，那
么第一个对小于第二个对。换名话说，(a ，a; )小于(与 ，包) ，即

(alyaz) 到 (加，2)

 

 

 

 

或者 mw天和，或者 a =所 且 as <<:访。

把相等加到 A, XA, 上的序<就得到偏序< 。这个验证留作练习。

例9 确定在偏序集(ZXZ，<)中是否有(3，5)<(4，8)，(3，8) <(4，5)和(4，9) 二
(4，11)? 这里的入是从乙上通常的入关系构造的字典顺序。

解 因为3<4，故而(3，5)<(4，8)且(3，8)<(4，5)。因为(4，9)与(4，11)的第一元素相
同，但是9<11，我们有(4，9)<(4，11) 。                                 国

图5-14明显地显示了 Z+ XZ+中比(3，4)小的有序对的集合。



--- 第 241 页 ---
第5章 关   系。223

者          妇     万    帮    生    才
(7) (2.7) (3.7) (4.7) (3.7) (6.7) (7.7)
二          全     二     二     全     和
(1.6) (2.6) (3.6) (4.6) (5.6) (6.6) (7.0)

全       多   外   外   多   鳃
(1.5) (2.5) (3.5) (4.5) (5.5) (6.5) (7.5)

亿   外   三   二   委   生   和
(1.4) (2.43) (3.4) (4.4) (5.4) (6.4) (7.4)

全   全   生   人   @@   银   和
t1.3) (2.3) (3.3) (4.3) (5.3) (6.3) (7.3)

如   量   生   和   生   志   和
(2) (2.2) (3.2) (42) (5.2) (6.2) 《7.2)

@@   外   @@   国   外   和   昌 ...
(1) (2.I) (3.1) (4D) (3 (01) (7.1)

图 5-14 按照字典顺序比(3，4)小的有序对

可以在”个偏序集(A, ，入, ) ，(4A, ，<:) ，…，(A.，<,)的笛卡儿积上定义字典顺序。如下
定义 4,X4:X…XA4.上的偏序入: 如果 ai <南，或者存在整数 ;盖0 使得 ai 一训，…，w一户，且
Qi+iBH， 那么

(al ,as yan) < (0)
如果 a < ， 或者如果存在整数 ;0，使得 ai =锯，…，ai一户，且 ar <irtpri。换句话说，如
果在两个”元组不同元素出现的第一位置上第一个:元组的元素小于第二个”元组的元素，那么第
一个半元组小于第二个元组。
例10 注意(1，2，3，5)<(1，2，4，3)，因为这些4元组的前两位相同，但是第一个4元

，组的第三位 3 小于第二个4元组的第三位 4(这里的4元组上的字典顺序是整数集合上的通常的“小

于或等于?关系导出的字典顺序) 。                                        国

我们现在可以定义串上的字典顺序。考虑偏序集 S上的串 aia…a。和刀2…b,，假定这些串
不相等。设 上是阅，? 中较小的数。定义字典顺序如下: ataz…as 小于入记…和，当上且仅当

(alyaz和ya)<到(pb) 或者

(al ya ai) 一(中,pi) 并且m一m
其中这个不等式中的<表示 $S 中的字典顺序。换句话说，为确定两个不同串的序，较长的串被切
到较短的串的长度 上+，即 :一min(m，z) 。然后使用 S' 上的字典顺序比较每个串的前: 位组成的上 元
组。如果对应于第一个串的上元组小于第二个串的上元组，或者这两个上元组相等，但是第二个串
更长，那么第一个串小于第二个串。这是偏序的验证留给读者作为练习。

例11 考虑小写英语字母串构成的集合。使用在字母表中的字母序，可以构造在串的集合上
的字典顺序。如果两个串第一次出现不同字母时，第一个串的字母先于第二个串的字母，或者如
果第一个串和第二个串在所有的位都相同，但是第二个串有更多的字母，那么，第一个串小于第
二个种。这种排序和字典使用的排序相同。例如，

discreet<discrete
因为这两个串在第 7 位首次出现不同字母，并且 e<t。
discreet<aiscreet7ze55
因为这两个串前 8 个字母相同，但是第二个串更长。此外，

discrete<aliscretio7r



--- 第 242 页 ---
224 "第5章 关   系

因为
cliscrete玫discre                                                                   本

5.6.3 哈塞图

在有穷偏序集的有向图中有许多边可以不必显示出来，因为它们是必须存在的。例如，考虑
在集合{1，2，3，4}上的偏序{((ae，b) | e委引的有向图，参见图 5-15a。因为这个关系是偏序，它
是自反的并且有向图在所有的顶点都有环。因此，我们不必显示这些环，因为它们是必须出现的。
在图 5-15b 中没有显示这些环。由于一个偏序是传递的，我们不必显示那些由于传递性而必须出
现的边。例如，在图 5-15c 中没有显示边(1，3) ，(1，4)和(2，4)，因为它们是必须出现的。如果
假设所有边的方向是向上的(如图中所示)，我们不
必显示边的方向; 5-15c没有显示方向。

一般说来，我们可以使用下面的过程表示一个有
穷集上的偏序。从这个关系的有向图开始。由于偏序                  3
是自反的，每个顶点有一个环，移走这些环。移走所
有由于传递性出现的边，因为偏序是传递的，这些边
是必须出现的。例如，如果(a,，刀和(6，c)在偏序                2
中，移走边(ae，c) ，因为它必须要出现。此外，如果
(c，d也在偏序中，移走边(ae，d) ，因为它也是必须
出现的。最后，排列每条边使得它的起点在终点的下
面(正如在纸上所画的)。移走所有的有向边上的箭
头，因为所有的边向上指向它们的终点。(只有和偏 图5-15 构造关于({1，2，3，4}，之)的险塞图
序集的覆盖关系中的对所对应的边留下来。)            ，

这些步骤是有着明确定义的，并且对于一个有穷偏序集只有有限步需要执行。当所有的步骤
执行以后，就得到一个包含着足够的表示偏序信息的图。这个图叫做哈塞图，它是用 20 世纪德国
数学家赫尔姆，。哈塞的名字命名的。

例12 画出表示(1，2，3，4，6，8，12}上的偏序{((ae，0) | a 整除6)的哈塞图。

解 ”由这个偏序的有向图开始，如图5-16a所示。移走所有的环，如图5-16b所示。然后删
除所有由传递性导出的边。这些边是(1，4)，(1，6)，(1，8)，(1，12)，(2，8)，(2，12) 和
(3，12) 。排列所有的边使得方向向上，并且删除所有的箭头得到哈塞图。结果如图 5-16c所示 。

国

4       4       4

a)                              b)                                       Cc)

 

3)                        b)               C)
图 5-16 构造((1，2，3，4，6，8，12}，| )上的哈塞图



--- 第 243 页 ---
第5章 关   系。225

例13 画出赛集 P(CS)上的偏序{((4A，B) | ASB)的哈塞图，其中 S一人ae，2，c) 。

解”关于这个偏序的哈塞图是由相关的有向图得到的，先删除所有的环和所有由传递性产生
的边，即(世，({(a，6))，(世，(ae，c)门，(厅，(5，c)，(O，{a，D，c))，((a)，{(a，b，c))，
({8j，{a,， 5，c)和({c}，{a，b，c)) 。最后，使所有的边方向向上并删除箭头。得到的哈塞图如
图 5-17 所示。                国

5. 6. 4 极大元素与极小元素

具有极值性质的偏序集元素有许多重要应用。偏序集的一个元素叫做极大的，当它不小于这
个偏序集的任何其他元素。即 a 在偏序集(S，入)中是极大的，当不存在5E S 使得ae<0。类似地，
偏序集的一个元素叫做极小的，如果它不大于这个偏序集的任何其他元素。即 a 在偏序集(S，失)
中是极小的，如果不存在5E S 使得5<a。使用哈塞图很容易识别极大元素与极小元素。它们是图
中的“顶?元素与“底?元素。

例14 偏序集({2，4，5，10，12，20，25}，| )的哪些元素是极大的，哪些是极小的?

解 图5-18关于这个偏序集的哈塞图显示了极大元素是 12，20 和 25，极小元素是2 和5。通

过这个例子可以看出，一个偏序集可以有多于一个的极大元素和多于一个的极小元素。       国
fa, bc}
12           20
{a,c}             {b ec}
CC5X               和
{a}             {b}
和                     “          5
图5-17 (P((ta， 65，c))，)的哈塞图           图 5-18 ” 偏序集的哈塞图

有时在偏序集中存在一个元素大于每个其他的元素。这样的元素叫做最大元素。即 < 是偏序
集(S，科)的最大元素，当对所有的ES 有2和a。当最大元素存在时它是唯一的。类似地，一个
元素叫做最小元素，当它小于偏序集的所有其他元素。即 a 是偏序集(S，科)的最小元素，如果对
所有的5E S有a<和b。当最小元素存在时它也是唯一的。

例15 确定图 5-19 的每个哈塞图表示的偏序集是否有最大元素和最小元素 。

pe dd ee 过
ab

3)           b)          C)          d)
图 5-19 ”四个偏序集的哈塞图
解”哈塞图图 5-19a 的偏序集的最小元素是 ec。这个偏序集没有最大元素。哈塞图图 5-19b 的

偏序集既没有最小元素也没有最大元素。哈塞图图 5-19c 的偏序集没有最小元素，它的最大元素是
d。了哈塞图图 5-19d 的偏序集有最小元素 ec 和最大元素 4 。                               国



--- 第 244 页 ---
226 "第5章 关   系

例16 设S是集合。确定偏序集(P(S)，S)中是否存在最大元素与最小元素。

解”最小元素是空集，因为对于 S 的任何子集开，有凶ST。集合 S是这个偏序集的最大元
素，因为只要了工是S 的子集，就有 TS S。                                   国

例17 在偏序集(Z-+ ，| )中是否存在最大元素和最小元素?

解 1是最小元素，因为只要?是正整数，就有1 | nn。因为没有被所有正整数整除的整数，所
以不存在最大元素。                                               国

有时候可以找到一个元素大于偏序集(S，和)的子集 A 中所有的元素。如果v是S 的元素使得
对所有的元素caEA，有a<和x，和那么x叫做A 的一个上界。类似地，也可能存在一个元素小于A 中
的所有其他元素。如果! 是 S 的一个元素使得对所有的元素aEA 有1!<和sa，那么/叫做A 的一个
下界。

例18 找出在图 5-20 所示哈斯图的偏序集的子集{ae，2，c}，{(7，A和(aa，c，d，上户的下界和
上界。

解 (ae，2%，c}的上界是e，F，7 和疡，它的唯一的下界是a。{(7，人没有上界，它的下界是 a，
6，c，d，e和j。(a，c，d，力的上界是 刻 六和7，它的下界是 a。                  年

元素工叫做子集 A 的最小上界，如果 是一个上界并且它小于A 的其他上界。因为如果
这样的元素存在，只存在一个，称这个元素为最小上界是有意义的。即如果只要aEA就有a
<z，并且只要=是A的上界，就有z<和z，z就是A的最小上界。类似地，如果y是A的下
界，并且只要 >是A的下界，就有>和>，就是A的最大下界。A的最大下界如果存在也是
唯一的。一个子集 4A 的最大下界和最小上界分别记作 glb(A)和 lub(A4A) 。             国

例19 在图5-20 所示偏序集中如果{a，d，g)}的最大下界和         站
最小上界存在，求出这个最大下界和最小上界。                            4/

解 {2，d，8}的上界是g 和刀。因为 5<h，8 是最小上界。    8            了
{5，dqd，8g}的下界是a 和6。因为 <p， 8是最大下界。       辆

例20 在偏序集(Z  ，| )中，如果集合{3，9，12}和{1，2，    了
4，5，10}的最大下界和最小上界存在，求出这些最大下界和最小
上界。

-可 解 如果3，9，12 被一个整数整除那么这个整数就

      是{3，9，12}的下界。这样的整数只有 1 和3。因为1
|3，3 是{3，9，12}的最大下界。集合{(1，2，4，5，10}关系到
| 的下界只有 1，因此1 是(1，2，4，5，10}的最大下界。

一个整数是{3，9，12}的上界，当且仅当它被3，9 和 12 整除。具有这种性质的整数就是那些
被3，9 和12 的最小公倍数 36 整除的整数。因此，36 是{13，9，12}的最小上界。一个正整数是集
合(1，2，4，5，10}的上界，当且仅当它被1，2，4，5 和 10 整除。具有这种性质的整数就是被这
些整数的最小公倍数 20 整除的整数。因此，20 是{1，2，4，5，10}的最小上界。          国

5.6.5 格

如果一个偏序集的每对元素都有最小上界和最大下界，就称这个偏序集为格。格有许多特殊
的性质。此外,，格有许多不同的应用，如用在信息流的模型。格在布尔代数中也起到了重要的
作用。

例21 确定图 5-21 的每个哈塞图表示的偏序集是否是格。

解 ”在图5-21a和图5-21c中的哈塞图表示的偏序集是格 ，因为在每个偏序集中每对元素都有
最小上界和最大下界，读者应该能验证这一点。另一方面，图 5-21b 所示的哈斯图的偏序集不是
格，因为元素上和< 没有最小上界。为此只要注意到 dg，e 和xj了中每一个都是上界，但这 3 个元素
的任何一个关于这个偏序集中的序都不大于其他 2个。                          国

如

图 5-20 ”偏序集的哈塞图



--- 第 245 页 ---
第5章 关   系。227

 

如                      既
3)                  b)                 Cc)
 5-21 三个偏序集的哈塞图

例22 偏序集(Z- ，| ?是格吗?

解 设a和5是两个正整数。这两个整数的最小上界和最大下界分别是它们的最小公倍数和最
大公约数，读者应能验证这一点。因此这个偏序集是格。                         国

例23 确定偏序集((1，2，3，4，5}，| )和({(1，2，4，8，16}， | )是否为格。

解 因为2和3在((1，2，3，4，5}，| )中没有上界，它们当然没有最小上界。因此第一个
偏序集不是格 。

第二个偏序集的每两个元素都有最小上界和最大下界。在这个偏序集中两个元素的最小上界
是它们中间较大的元素，而两个元素的最大下界是它们中间较小的元素。读者应能验证这一点。
因此第二个偏序集是格 。                                            国

例24 确定(P(S)，)是否是格，其中 S 是集合。

解 设4A和刀是S 的两个子集。4A 和召 的最小上界和最大下界分别是AUB 和AfB，读者可
以证明这一点。因此(P(S)，握)是格。                                    加

NE 例25 信息流的格模型”在许多设置中，从一个人或计算机程序到另一个人或计算机

”程序的信息流要受到限制，这可以通过安全权限来实现。我们可以使用格的模型来表
示不同的信息流策略。例如，一个通用的信息流策略是用于政府或军事系统中的多级安全策略。
为每组信息分配一个安全级别，并且每个安全级别用一个对(4A，C)表示，其中A是权限级别，C
是种类。然后允许人和计算机程序从一个被特别限制的安全类的集合中访问信息。

在美国政府中，使用的典型的权限级别是不保密(0)、秘密(1)、机密(2)和绝密(3)。在安全
级别中使用的种类是一个集合的子集，这个集合含有和与一个特定行业领域相关的所有的分部，每
个分部表示一个指定的对象域。例如，如果分部的集合是{间谍 ，跟筷，双重间谍}，那么存在 8
个不同的种类，分部集合有 8 个子集，对于每个子集有一类，例如{间谍 ，外扎}。

我们可以对安全类排序，规定(A, ，C)<和(4A:，C:)当且仅当A迁4A, 和CSEC,。信息人允许从
安全类(A, ，C' )流向安全类(A, ，C: ) 当且仅当(4A,，C)和(4A,，C:, )。例如，信息允许从安全类
(机密，!{间谍，邑筷))流向安全类(绝密，!{间谍，奶和所，双重间谍}))，反之，信息不允许从安全
类(绝密，{间谍，只饼})流向安全类(机密，{(间谍，吴饼，双重间谍))或(绝密，{间谍} ) 。   国

5.6.6 拓扑排序
.8 假设一个项目由 20 个任务构成。某些任务只能在其他任务结束之后完成。如何找到关
“于这些任务的顺序? 为了对这个问题构造模型，我们建立一个任务集合上的偏序，使
得ae<%，当且仅当a 和是任务且直到 a 结束后6 才能开始。为安排好这个项目，需要得出与这个
偏序相容的所有 20 个任务的顺序。我们将说明怎样做到这一点。
我们从定义开始。如果只要 aRb 就有a<和oo，则称一个全序委与偏序 尺 是相容的。从一个偏序
构造一个相容的全序叫做拓扑排序。我们需要使用引理 1。
 每个有穷非空偏序集(S，苹)都有极小元素。
证”选择 S 的一个元素s。。如果 a 不是极小元素，那么存在元素 a ，满足w < 。如果 ai 不



--- 第 246 页 ---
228，第5章 关   系

是极小元素，那么存在元素 as ，满足 a; <a, 。继续这一过程，使得如果 a, 不是极小元素，那么存
在元素 e+满足ai:<av。因为在这个偏序集只有有穷个元素，这个过程一定结束并且具有极小元
素 a,。                                                          口

我们将要描述的拓扑排序算法对任何有穷非空偏序集都有效。为在偏序集(4A，和)上定义一个
全序，首先选择一个极小元素 w，由引理 1 这样的元素存在。接着，正如读者应该验证的，
(4一{a}，委)也是一个偏序集。如果它是非空的，选择这个偏序集的一个极小元素 os 。然后再取
走 ao ，如果还有其他的元素留下来，在 A一{a ，az}中选择一个极小元素 a: 。继续这个过程 ，只要

还有元素留下来， 就在 A一(al， Ca ”1 at} 中选择极小元素 Ce+le
因为4是有穷集，这个过程一定终止。最终产生一个元素序列 c ，as ，…，a,。所需要的全
序定义为

Ga1 二妇 <一…和<二纪。
这个全序是与初始的偏序相容的。为看出这一点，注意如果在初始的偏序中5<c，c 在算法的某个
阶段被选择为极小元素，则这时 已经被移出，否则 c 就不会是极小元素。关于这个拓扑排序算法
的擅码在算法工给出。

算法1 拓扑排序
procedure iotpological sort(S: 有穷偏序集)
天:  一1
while S天他
begin

ak 5 一S的极小元素{由引理 1 这样的元素一定存在}
S1 一S一{ak}
玉: 一丰十1

endta  ，az ，…，a 是S 的相容的偏序}

 

例26 找出对于偏序集({(1，2，4，5，12，20}， | )的一个相容的全序。

解 ”第一步是选择一个极小元素。这个元素一定是 1，因为它是唯一的极小元素。下一步选择
〈{2，4，5，12，20}，1| )的一个极小元素。在这个偏序集中有两个极小元素，即 2 和5。我们选
择 5。剩下的元素是(2，4，12，20}。在这一步，唯一极小元素是 2。下一步选择 4，因为它是
((4，12，20}，| )的唯一极小元素。因为 12 和 20 都是({12，20}，| )的极小元素，下一步选哪
一个都可以。我们选 20，只剩下 12 作为最后的元素。这产生了全序

1<5<2<4<20二12
这个排序算法所使用的步骤在图 5-22 中给出。                                              国

号

iii表1 | 5 | 2 | ，| an

图 5-22 ({1，2，4，5，12，20}，| )的拓扑排序

                                                                                                                                                                                                                                                                  



--- 第 247 页 ---
第5章 关  系。229

在项目的安排中常会用到拓扑排序。
例 27 一个计算机公司的开发项目需要完成 7 个任务。其中某些任务只能在其他任务结束后
才能开始。考虑如下建立任务上的偏序，如果任务Y在X 结束             G
后才能开始，则任务 X<<任务Y。这 7 个任务关于这个偏序的哈

乒
塞图在图 5-23 中给出。求一个全序，使得可以按照这个全序执    ”
行这些任务以完成这个项目。
解 ”可以通过执行一个拓扑排序得到 7 个任务的排序。排序    8

的步骤显示在图 5-24 中。这个排序的结果，A<C<B玫已<下到

忆<CG，给出了关于任务的一种可能的次序。                   4   C      开
图 5-23 关于 7个任务的哈塞图

 

图5-24 任务的拓扑排序

练习

1. 以下这些集合{0，1，2，3}上的关系，哪些是偏序?如果不是偏序，请问它缺少偏序的哪些性质，
a){(0，0)，(1，1)，(2，2)，(3，3)}
b){(0，0)，(1，1)，(2，0)，(2，2)，(2，3)，(3，2)，(3，3)}
c)((0，0)，(1，1)，(1，2)，(2，2)，(3，3)》
d)1(0，0)，(1，1)，(1，2)，(1，3)，(2，2)，(2，3)，(3，3)}
e){(0，0)，(0，1)，(0，2)，(1，0)，(1，1)，(1，2)，(2，0)，(2，2)，(3，3)}

2. 设是< 和夕人，S是全世界所有人构成的集合，(a，b) ER。请问(S，R)是否为仿序，如果

a)a 比如个子高?             b)a 不比尹高?
c)a=或a 是2 的祖先?          da 和如有共同的朋友?
3. 下面哪些集合是偏序集?
a)(了，一)         b)(Z，尖)         c)(Z，三)         d)(Z，填)
4. 确定以下 0-1 和抢阵表示的关系是否为偏序。
1 1 1 0
1 1 1      1 1 1
0 1 1 0
引) | 1 |     b) 1     c)
00 1 1
0 0 1       0 0 1
1 1 0 1

在练习 5一6 中确定有向图所表示的关系是否为偏序。

5.   。    记                     6 ( 因    地 )
(六    xz《 )



--- 第 248 页 ---
230 "第5章 关    系

7. 求下面偏序集的对偶。

a)({0，1，2}，到)    b)(Z，二)          c)(CP(Z)，)       d)(Z+，|)
8. 在下面偏序集中找出两个不可比的元素。

a)(P(f0，1，2))，握)                  bl(f1，2，4，6，8}，|)
9. 找出下面的元组的字典顺序。

a)(1，1，2)，(1，2，1)                b)(0，1，2，3)，(0，1，3，2)

c)(1，0，1，0，1)，(0，1，1，1，0)
10. 找出二进位串0，01，11，001，010，011，0001 和0101 的基于 0一1 的字典顺序 。
11. 画出(0，2，5，10，11，15}上的“小于或等于”关系的哈塞图。
12. 画出下述集合上整除关系的哈塞图。

a){(1，2，3，4，5，6，7，8}                 b)(tl1，2，3，5，7，11，13}
c){1，2，3，6，12，24，36，48)}          d){(1，2，4，8，16，32，64}
列出练习 13一14 所示哈塞图的偏序中的所有有序对。
13.C      过                           14. df     忆     了
,                                     和
4                                起     人     C

设(S，<科)是偏序集。我们说一个元素 yES 和覆盖元素工ES，当<y并且没有元素xES使得
Zz<z<y。使得 >覆盖xz 的对(z，y)的集合叫做(S，X)的覆盖关系。
15. 3S 的寡集上的偏序{((4，B) | AS中)的覆盖关系是什么? 其中 S={a，5，c} 。
16. 证明， 一个有穷偏序集可以从它的覆盖关系重新构造出来。[提示: 证明偏序集是它的覆盖关系的自反传

递闭包。]
17. 对偏序集(({3，5，9，15，24，45}，| )，回答下述问题。

a)求极大元素 。                      b)求极小元素。

c)存在最大元素吗?                   d)存在最小元素吗?

e)找出{3，5}的所有上界。               人如果存在的话，求413，5}的最小上界。

g)求{15，45}的所有下界。          h)如果存在的话，求(15，45}的最大下界。
18. 对偏序集({{1}，{2)》，{4}，{1，2}，{(1，4}，{(2，4}，{(3，4}，{1，3，4}，{2，3，4)}，验)，回答下

述问题。

a)求极大元素。                      b)求极小元素。

c)存在最大元素吗?                   d)存在最小元素吗?

e)求{{2} ，{4)}的所有上界。            f如果存在的话，求{{2}，{4尹的最小上界。

g)求{{1，3，4}，{2，3，4}}的所有下界。
h)如果存在的话，求{{(1，3，4}，{2，3，4几的最大下界。
19. 证明: 字典顺序是两个偏序集的笛卡儿积上的偏序。
20. 假设(S，和:)和(T，所:)是偏序集。证明(SxXT，<)也是偏序集，其中(*，b和(xu，z，当目仅当s<,x
且上<:v。
a)证明: 在一个具有最大元素的偏序集中恰好存在一个极大元素。
bb证明, 在一个具有最小元素的偏序集中恰好存在一个极小元素。
22. 确定具有下面哈塞图的偏序集是否为格。

21.

和

a)         8             b) 入                    c)
了             了       8                 和
dd      。            了      。          了      8
万        。                      过        e



--- 第 249 页 ---
第5章 关  系。231

23, 证明: 一个格的每个有限非空子集有最小上界和最大下界。

24. 在一个公司里用信息流的格模型控制敏感信息，这些信息具有由有序对(4A，C)表示的安全类别。这里 A
是权限级别，这种权限级别可以是非私有的(0)、私有的(1)、受限制的(2)或注册的(3)。种类 C 是所有
项目集合{猜鹏，黑斑羚，美洲狮}的子集(在公司里常常使用动物的名字作为项目的代码名字) 。

a)信息是天允许从(私有的，{猎鹏，美洲狮})流向(受限制的，{美洲狮})?
b)信息是否允许从(受限制的，{猜鹏))流向(注册的，{猎鹏，黑斑羚))?
c)允许信息从(私有的，{猎鹏，美洲狮})流向哪个类?

d)人允许信息从哪个类流向安全类(受限制的，{黑斑羚，美洲狮}))?

*25. 证明: 一个集合上的所有划分的集合与关系 S 构成一个格，其中如果划分 已 是划分 P 的加细，则 P, 和
P:(见 5.5 节的练习 22 前面的说明) 。

26. 证明: 每个有限格都有一个最小元素和一个最大元素。

27. 验证(Z- XZ-” ，委)是一个良序集，其中和是如例 8 所声明的字典顺序。

如果偏序集中不存在元素的无限递减序列，即元素 rz ，z ，…，z…使得…<z<才…<z<z，则这个
偏序集是良基的。设偏序集(尺，扩) ，如果对所有的 xzES和?ESCz<y)都存在元素 xzE尺使得z<z<y，则
称这个偏序集是稠密的。

28. 证明: 偏序集(Z，扩)(其中 zx<y 当且仅当|z|二|y|)是良基的，但不是全序集。
29. 证明:， 有理数和通常的“小于或等于”关系构成的偏序集(Q，扩)是稠密偏序集。

30. 证明，偏序集是良序的，当且仅当它是全序的并且是良基的。

31. 求一个与例 27 构造的序不同的完成开发项目中任务的序。

32. 如果关于一个软件项目的任务的哈塞图如下所示，对这个软件项目的任务进行排序。

开发模块A
AN
写文档

开发系统需求           设置测试点

 

关键术语和结果

术语

从A到吾的二元关系: AX忆的子集。

从的关系: 从A到自身的二元关系(即4AXA 的子集) 。

SR: 尺与S 的合成。

RR 一: 尺的送关系。

RR" : 及的= 次寡。

自反的: A上的一个关系是自反的，如果对所有的 aEA有(a，ca)ER。

对称的: A上的一个关系是对称的，如果只要(ae，bE尽就有(5，a)ER。

反对称的: A上的关系是反对称的，如果只要(ae，纪ER 和(56，a)ER就有aa一5
传递的: A 上的关系尺 是传递的，如果从(ae，b)E妨和(8，c)ER尺推出(ae，c)ER。
4，A4A:，…，A, 的于元关系: AXA,X…XA, 的子集.



--- 第 250 页 ---
232"第5章 关   系

关系数据模型: 一个使用z 元关系表示数据库的模型 。

主关键字: 元关系的一个域，使得一个?元组被它在这个域的值唯一确定。

复合关键字: 一个?元关系域的笛卡儿积，使得一个=”元组被它在这些域的值唯一确定。

选择算子: 一个函数，它在寻元关系中选出满足特定条件的=”元组。

投影;一个函数，它从一个?元关系通过删除域产生一个阶较小的关系。

连接;一个函数，它把具有某些相同的域的?元关系组合起来。

有向图: 称为顶点的元素以及这些元素的有序对(也叫做边)的集合。

环 : 形如(a， a)的边。

关系及关于性质王的闭包: 包含尺的关系S(如果存在的话)具有性质 P，并且被任何包含 尺且具
有人性质 P 的关系所包含。

有向图中的路径: 边的序列(a， Ti)，(zT zz)，…，(Z-z To-1)，( Zuo-iy b)使得序列中每条边
的终点是后面一条边的起点。

有向图的回路(或国): 以同一顶点作为起点和终点的路径。

尽" (连通性关系): 由有序对(ce，纪构成的关系，条件是存在一条从 “到的路径。

等价关系; 自反的、对称的和传递的关系。

等价; 如果尺是等价关系，若 aRp，那么 a 等价于。

[ajs(Ca关于尺的等价类): A 中所有等价于ae 的元素的集合。

[a]。(模的同余类): 与ea模zm同余的整数的集合。

集合 S 的划分: 一族两两不相交的非空子集，且这些子集的并就是 S。

偏序，自反的、反对称的和传递的关系。

偏序集(S，R) : 集合 S 与这个集合上的偏序尺。

可比的: 偏序集(4，委)的元素a 和0 是可比的如果a<8或5<a。

不可比的: 一个偏序集的元素不是可比的。

全序(或线序) : 一个偏序，并且它的每对元素都是可比的。

全序(或线序)集: 具有一个全序(或线序)的偏序集。

良序集; 偏序(S，所)，其中科是全序，S 的每个非空子集至少有一个元素。

字典顺序: 笛卡儿积或串的一个偏序(参见 5. 6.2 节) 。

哈塞图: 偏序集的图表示，其中所有的环和由传递性导出的边不出现， 并且顶点的位置指示了边
的方向。

极大元素: 偏序集的一个元素，它不小于这个偏序集的所有其他元素。

极小元素: 偏序集的一个元素，它不大于这个偏序集的所有其他元素。

最大元素: 偏序集的一个元素，它大于或等于这个集合的所有其他元素。

最小元素: 偏序集的一个元素，它小于或等于这个集合的所有其他元素。

集合的上界: 偏序集的一个元素，它大于这个集合的所有其他元素。

集合的下界: 偏序集的一个元素，它小于这个集合的所有其他元素。

集合的最小上界: 集合的一个上界，它小于所有其他的上界。

集合的最大下界: 集合的一个下界，它大于所有其他的下界。

格: 一个偏序集，其中每对元素都有一个最大下界和一个最小上界。

与一个偏序相容的全序: 包含了给定偏序的一个全序。

拓扑排序: 用给定偏序构造一个相容的全序。

结果

。 集合 4的关系尺的自反闭包等于RUA，其中心={(ae，a) | cEA) 。

。 集合 4 的关系尺 的对称闭包等于RUR，其中R 一((，a) | (a，亿所尺) 。
。 一个关系的传递闭包等于从这个关系构成的连通性关系。



--- 第 251 页 ---
第5章 关 系"233

为了求一个关系的传递闭包的沃含尔算法(见 5.4.5 节)。

设尺是等价关系，那么下面三条语句是等价的:

(1)aRo (2)[a]s站[的天好 (3)[a]s一[oa

集合 4 的等价关系的等价类构成A 的划分。相反，从一个划分可以构造一个等价关系使得等价

类就是划分中的子集。
。 和良序归纳原理。
。 拓扑排序算法(见 5.6.5节)。
复习题
1. a)什么是集合上的关系?          b)一个二元素集合上有多少个关系?
2. a)什么是自反关系?            b)什么是对称关系?
c)什么是反对称关系?           d)什么是传递关系?
3. 给出一个集合{1，2，3，4}上的关系的例子，使得它是
a)自反的、对称的但不是传递的。      b)不是自反的，是对称的和传递的。
c)自反的、反对称的，但不是传递的。    d)自反的、对称的和传递的。

蕊站

~

5

e)自反的、反对称的和传递的。

- a)在一个 元素集合上有多少个自反的关系?

b)在一个对元素集合上有多少个对称的关系?
c)在一个?元素集合上有多少个反对称的关系?

. a)解释在一个大学里怎样用一个盖元关系表示有关学生的信息。

b)怎样用一个包含学生姓名、地址、电话号码、专业和平均学分绩点的 5 元关系构造包含学生姓名、专业
和平均学分绩点的 3 元关系。

c)怎样将包含学生姓名、地址、电话号码和专业的4元关系和包含学生姓名、学号、专业和学分数的4元
关系组合成一个单一的元关系?

. a)解释怎样使用一个0- 1 矩阵表示有穷集上的关系。

b)解释怎样使用表示关系的0~ 1和矩阵来确定这个关系是否为自反的、对称的和反对称的。

. a)解释怎样使用一个有向图来表示有穷集上的关系。

b)解释怎样使用表示关系的有向图来确定这个关系是否为自反的、对称的和反对称的。

. a)定义一个关系的自反拷包和对称闭包。

b)可以怎样构造一个关系的自反闭包?
c)可以怎样构造一个关系的对称闭包?
d)求集合{1，2，3，4}上的关系{(1，2)，(2，3) ，(2，4) ，(3，1)}的自反闭包和对称闭包。

. a)定义一个关系的传递闭包。

b)一个关系的传递奢包能够通过包含所有的对(ae，c)得到吗? 其中(ae，c)满足Cae，0)和(6，c)属于玉。
c)撒述求关系的传递闭包的两个算法 。
d求关系{(1，1)，(1，3)，(2，1)，(2，3)，(2，4)，(3，2) ，(3，4) ，(4，1)}的传递闭包。

10. a)定义等价关系。

11.

b)集合{a，b，c，吃上的哪些关系是包含了(ae，纺和(5，dq)的等价关系?
a)证明模 zm同余关系是等价关系，其中和是正整数。
b)证明关系{(ae，b) | a生士gmod7)}是整数集上的等价关系。

: a)什么是一个等价关系的等价类?

b)什么是模 5 同余关系的等价类?
c)什么是问题 11(b)中等价关系的等价类?

- 解释在集合的等价关系与集合划分之间的联系。

- a)定义偏序。              b)证明正整数集合上的整除关系是偏序。
- 解释怎样用集合 A 和 A; 上的偏序定义在集合 A, XA:, 上的偏序。

. a)解释怎样构造有穷集上的偏序的哈塞图。



--- 第 252 页 ---
234 。

18

19.

20.

第5章 关  系

b)画出集合{2，3，5，9，12，15，18}上的整除关系的哈塞图。

- a)定义一个偏序集的极大元素和最大元素。

b)给出一个有 3 个极大元素的偏序集的例子。
c)给出一个有 1 个最大元素的偏序集的例子。

.a)定义格。

b)给出一个 5 元偏序集是格的例子和一个 5 元偏序集不是格的例子。

a)证明一个格的每个有穷子集有一个最大下界和一个最小上界。

b)证明每个具有有限元素的格有一个最小元素和一个最大元素。

a)定义一个良序集。

b)描述一个从偏序集产生良序集的算法 。

c)如果仅当某个或某些其他任务完成以后，一个任务才可以开始，解释怎样用(b)中的算法排序这个项目
中的任务 。

补充练习

1.

oo 情 避

设 S是所有英语字母的串的集合。确定下面的关系是否是自反的、反自反的、对称的、反对称的和传
递的。

a)RR一{(a，b) | a 和没有公共字母}

b)R:一((ae，b) | ae 和 长度不相等}

c)R一{(a，b) |1a比5长}

内 构造集合{a， 已， CE dj上的关系， 使得它是

a)自反的、对称的，但不是传递的。

b)反自反的、对称的和传递的。

c)反自反的、反对称的，但不是传递的。

d)自反的，既不是对称的也不是反对称的，是传递的。

e)既不是自反的、反自反的、对称的和反对称的，也不是传递的。

,也XZ上的关系民定义如下: (ae，bRIc，d)，当且仅当 a十d=8十c。证明, 尺是等价关系。
. 证明: 一个反对称关系的子集也是一个反对称关系。

. 设尺是A上的自反关系,，证明: RCR: 。

, 假设 R 和民: 是集合 4 上的自反关系，证明: 尺,四R, 是反自反的。

: 假设 尺 和 RR 是集合 4 上的自反关系，R 站R: 也是自反的吗? RUR, 也是自反的吗?

. 假设尺是集合4A 上的对称关系，丽也是对称的吗?

- 设 R 和RR: 是集合4A 上的对称关系，R: 站R: 也是对称的吗? R, UR;, 也是对称的吗?

10.
11.

一个关系尺叫做循环的，如果 Rb 和pbRc 推出cRa 。证明尺是自反的和循环的，当且仅当它是等价关系。
证明: 一个”元关系的主关键字也是这个关系的任何投影的主关键字，其中这个投影包含这个关键字作
为它的一个域。

. 一个”元关系的主关键字也就是由取这个关系与第二个关系的连接而得到的较大的关系的主关键字吗?
- 证明: 一个关系的对称闭包的自反闭包和它的自肥闭包的对称闭包是相同的。
: 设尺是所有数学家的集合上的关系，尺包含有序对(ae，纪，当且仅当a 与5 合写了一篇论文。

a)描述关系屎* 。         b)描述关系尺" 。

Cr c)如果一个数学家与多产的匈牙利数学家保罗 埃德斯合写了一篇论文，那么这个数学家的埃德斯数是

15.

16.

1。如果这个数学家没有与埃德斯合写一篇论文，但是与某个与埃德斯合写过论文的人合写了--篇论
文，那么这个数学家的埃德斯数是 2，依此下去(埃德斯本人的埃德斯数是 0) 。用 尺 中路径的概念给出
埃德斯数的定义。
a)给出一个例子，证明一个关系的对称闭包的传递闭包不一定与这个关系的传递闭包的对称闭包相等。
bb证明: 一个关系的对称闭包的传递闭包一定包含这个关系的传递闭包的对称闭包。
a)设 S 是一个计算机问题的子程序的集合。定义关系 尺，如果在执行中子程序 P 调用子程序 Q，那么
PRQ。 描述 R 的传递闭包。

b)对于哪些子程序P，(P，P)属于尺的传递闭包?



--- 第 253 页 ---
17-

18.
#]19.

20.

#21].
22.
23.

x24.
25.

26，

27.

称这个子集为一条链。如果它的每一对元素都是不可
比的，就称这个子集为一条反链。

28.
29.

30.

兴关3了

#32.

第5章 关  系" 235

c)描述 尺 的传递闭包的自反闭包。

假设尺和3S 是集合4A 上的关系，RSS, 且尺和S$ 的关于性质P的闭包存在。证明尺关于了的闭包是 S
关于P 的闭包的子集。

证明: 两个关系的并的对称闭包是它们的对称闭包的并。

设计一个基于内点概念的算法，求有向图中两个顶点之间的最长路径的长度，或确定在这些顶点之间存
在任意长的路径。

下面的刀些关系是所有人集合上的等价关系?

at((z，?y) |工与y》有同样的星座}

b)t(z，?) |与y》出生在同一年}

ct(z，?y) |工与y》曾竺在同一城市}

在 5 元素集合上有多少个不同的等价关系愉有 3 个不同的等价类?

证明; {(z，?) | zx一yYEQ)是实数集上的等价关系，其中Q 是有理数集合。[1]，[1/72]和[zx]是什么?

设 了一{4:， A; ，…，4。) 和 P:一{B，  了 ，  人 了, }都是集合 S 的划分。 证明， 形如 A4门忆， 的非空子
集族是 S 的划分，且是 P, 和 P, 的加细(见 5. 5 节练习 22 前面的说明) 。

证明: 关系尺的自反闭包的对称闭包的传递闭包是包含尺 的最小的等价关系。

设 R(S)是集合 S上的所有关系的集合。如下定义 R(S)上的关系入，如果 RISER;, 则 R,<R:，这里的 R，
和尺: 是S上的关系。证明: (R(CS)，科)是偏序集。

设 P(S)是 S上的所有划分的集合。定义P(S)上的关系如下: 如果 Pi 是 P, 的加细，则 P, < P,(见 5.5
节的练习 22)。证明: (P(S)，扫)是偏序集。

右下图为误调中均任务的哈塞图，通过规定那些必需任务的顺序来安排烹调。

如果一个偏序集子集的每一对元素都是可比的，就

找出 5. 6 节练习 13一14 的哈塞图所表示的偏序集
中所有的链。

找出 5. 6 节练习 13一14 的哈塞图所表示的偏序集
中所有的反链。

证明: 在一个有穷偏序集(S，入)中每个极大链包
含 S的一个极小元素。(一条极大链是一条链，但
不是一条更大的链的子链。)
证明: 一个偏序集可以被分成下条链，其中糙是在
这个偏序集中一条反链的最多元素数。

证明: 在任意一组 mn十1 个人中要么存在 mm十1 个
人的一个列表，其中每个人(除了表的第一个人以
外)都是表中前一个人的后代; 要么存在 m十1 个
人人，其中没有一个人是其他*个人中任何一个人的
后代。[提示:, 用练习 31。]

假设(S，和)是良基的偏序集。良基妇纳原理说，

 

打食谱

如果YVz(Y?y(7<z~P(y))一P(z))，那么对所有的zxES，、有 P(z)为真。

33，

闪虽4

35.

36.
#37。

证明: 对于良基归纳原理不需要另外的基础情况，就是说，如果Yz(CYy(y?<z~P(y))-P(r))，P(a)
对于 S 中所有的极小元素 * 为真。
证明: 良基归纳原理是有效的。

集合 4 上的关系及 叫做A 上的近似序，如果尺是自反的和传递的。

设尺是从Z 到2的所有函数的集合上的关系，使得(f，&g)属于尺，当且仅当了是O(g)， 证明: 尺是近
似序。

设愉是A 上的近似序， 证明: RnmR-:是等价关系。

设尺是近似序，设 S是尺站R :的等价类的集合上的关系，C 和了 是R 的等价类，(C，D)属于 S，当且



--- 第 254 页 ---
236。第5章 关   系

仅当存在 C 的元素c，D 的元素&，使得(c，d2)属于尺。证明 S 是偏序。

设工是一个格。由并Ay一glb(z，y)和<zVy=1lub(z，y)定义交(人7)和并(V 1)运算 。
38. 证明下面的性质对格工 的一切元素z，y，z成立:

a)zAy一yAz，zVy=一yyVT (交换律)

b)(CrzAy)Az一zA(G7Az)，(zVy)Vz=一rrV(yVz) (结合律)

c)zxA(CzVy)一六 ZV(CZAy)一工〈《吸收律)

d)工人>一工 VZ一蒂 〈辕等律)
39. 证明: 如果和>y 是格的元素，那么 zxVy一y当上且仅当六人y一工。

一个格工是有界的，如果它有一个上界，记作 1，即对所有的 zxE工有z拉1; 并且有一个下界，记作 0，
即对所有的 zxE工有0执z。
40. 证明: 如果革是具有上界 1 和下界 0 的有界格，那么对所有的元素 zxE工，具有下面的性质，

a)zV1一1         b)zA1王工         c)zV0一工         d)zA0=0
41. 证明: 每个有限格是有界的。

一个格叫做分配的，如果对工中所有的=，y，z*，有
ZV(yAz)一(TVyJ)ACVz)和xzA(GCyVz)一(zAy)VCzAz)
*42. 给出一个不是分配格的例子。
43. 证明: 格(P(S)，三)是分配格，其中 P(S)是有穷集 S 的圭集。
44. 格(Z- ，| )是分配格吗?

有界格工的元素a 关于上界 1 和下界 0 的补元是元素 0，使得 eVb=1 和aAb=0。如果一个格的每个元
素都有补元，那么这个格叫做有补格。
45. 给出一个有限格的例子，其中至少 1 个元素有多于 1 个的补元且至少 1 个元素没有补元。
46. 证明, 格(P(S)，握)是有补格，其中 P(S)是有穷集 S 的赛集。
*47. 证明: 如果工是有限分配格，那么荆的一个元素至多有 1 个补元。

1.7 节例 12 中介绍的 Chomp 游戏可以推广到在任意最小元素为 < 的有限偏序集 (S，入)上玩。在这个游
戏中，一个移动由选择 S 中的元素z，及移动 x 和所有 S 中比z 大的元素构成。失败者是被迫选择最小元素
a的那个玩家。

48. 证明: 1.7节例 12 所搞述的 Chomp 游戏(曲奇饼摆放在 mxXn 的矩形网格中)与偏序集(S，| )上的

Chomp 游戏相同，其中 S 所有除 ” :9"” :的正整数集合，这里 和9 是两个不同的素数。

49. 证明: 如果(S，把)有最大元素 6，那么在偏序集上存在一个获胜策略。[提示: 推广 1.7节例 12 中的
讨论.]

计算机题目

按下述给定的输入和输出写出程序。

. 给定表示有穷集上关系的矩阵，确定这个关系是否是自反或反自反的。

. 给定表示有穷集上关系的矩阵，确定这个关系是否是对称或反对称的。

. 给定表示有穷集上关系的矩阵，确定这个关系是否是传递的。

. 给定正整数 na，显示一个元素集合上所有的关系。

*5. 给定一个正整数 >，确定 ” 元素集合上的传递关系的个数。

*6, 给定一个正整数 "，确定 元素集合上的等价关系的个数。

*7. 给定一个正整数 ”，显示 个最小的正整数集合上的所有等价关系。

8. 给定一个”元关系，当某些特定的字段被删除以后求这个关系的投影。

9. 给定一个元关系、一个元关系和一个公共字段的集合，找出这些关系关于这些公共字段的连接。

10, 给定表示一个有穷集上关系的矩阵，求表示这个关系自反闭包的矩阵。

11, 给定表示一个有穷集上关系的矩阵，求表示这个关系对称闭包的矩阵。

12, 给定表示一个有穷集上关系的矩阵，通过计算表示这个关系的矩阵的宪的联合求表示这个关系传递闭包
的矩阵 。

co 吓



--- 第 255 页 ---
第5童 关   系。237

13. 给定表示一个有穷集上关系的矩阵，使用沃舍尔算法求表示这个关系的传递闭包的和矩阵。
14. 给定表示一个有穷集上关系的矩阵，求表示包含这个关系的最小的等价关系的卸阵。
15. 给定一个有穷集上的偏序，使用拓扑排序找出一个与它相容的全序。

计算和研究
使用一个计算程序或你已完成的程序做下面的练习。

1.
2.
3.
关生。
5.

6.
7.
#g，
#9.

显示一个4元素集合上的所有不同的关系。

显示一个6 元素集合上的所有不同的自反和对称的关系。

显示一个 5 元素集合上的所有不同的自反和传递的关系。

对所有的正整数 >，nr<s7，确定在 ”元素集合上有多少个传递关系。

使用对应于某个特定的运输或通信网络的有向链路的关系，或者使用一个随机生成的关系，在至少 20 个
元素的集合上求所用关系的传递闭包。

对于所有不超过 20 的正整数 >，计算 =元素集合上的不同的等价关系个数。

显示 7 元素集合上的所有的等价关系。

显示 5 元素集合上的所有的偏序。

显示 5 元素集合上的所有的格。

写作题目

用本书以外的资料写成短文回答下列问题。
1. 讨论模糊关系的概念。怎样使用模糊关系?

' 不限于 5. 2 节所介绍的内容，描述关系数据库的基本原理。关系数据库与其他类型的数据库相比，使用面

有多广?

“ 查找沃舍尔和罗伊(Roy)的原始论文(法文)，在那篇论文中他们提出了求传递闭包的算法。讨论他们的方

法。为什么可以认为沃含尔算法是被多人独立发现的?

. 描述怎样用等价类把有理数定义为整数对的类，以及遵照这种方法怎样定义有理数的基本算术运算。
.解释替尔姆" 哈塞怎样使用我们现在称为哈塞图的图示 。

. 描述在计算机操作系统中用来执行信息流策略的某些机制。

. 讨论计划评审技术(Program Evaluation and Review Technique，  PERT)在安排一个大的复杂项目的任务中

的应用。PERT 的使用面有多广?

- 讨论关键路径方法(Critical Path Method，CPM) 对找出完成项目的最短时间的应用。CPM 的使用面有

多广?

. 讨论格中的对偶性的概念。解释怎样用对偶性建立新的结果?

10. 解释模格的意义。描述模格的某些人性质，描述模格是怎样在投影几何的研究中产生的。



--- 第 256 页 ---
第6章|

Discrete Mathematics and lts Applications，6己

图是由顶点和连接顶点的边构成的离散结构。几乎可以想到的每个学科中的问题都可以运用
图模型来求解。我们将给出实例说明如何在各种领域中运用图来建模。例如，如何用图表示生态
环境里不同物种的竞争，如何用图表示组织中谁影响谁，如何用图表示循环锦标赛的输出。我们
将描述如何用图对人们之间的相识关系、研究人员之间的合作关系、电话号码间的呼叫关系以及
网站之间的链接关系进行建模。我们将说明如何用图对地图和一个组织内员工的工作指派进行
建模。

运用图模型，可以确定能不能遍历一个城市的所有街道而不在任一条街道上走两遍，还能找
出对地图上的区域着色所需要的颜色数，可以用图来确定某一个电路是否能够在平面电路板上实
现; 用图区分两种有着同样的分子式但结构不同的两种化合物; 我们能够运用计算机网络的图模
型确定两台计算机是否由通信链路连接;对其边赋予了权重的图可以求解诸如在运输网络中寻找
两个城市间的最短路径这类问题。我们还可以用图来安排考试和指定电视台的频道。本章将介绍
图论的基本内容，还将给出许多不同的图模型。为了求解能够用图研究的多种问题，我们将介绍
许多不同的图的算法，还将研究这些算法的复杂度。

6.1 图和图模型

首先给出图的定义。

定义   一个图 G 由顶点(或结点)的非空集 Y 和边集五 构成，每条边有一个或两个项点与它
相连，这样的项点称为边的端点。边连接它的端点。

注意 图G的顶点集V 可能是无限的。顶点集为无限集的图称为无限图，与之相对，顶

点集为有限集的图称为有限图。在本书中，通常只考虑有限图。

现在假设一个网络由数据中心和计算机之间的通信网络组成。可以把每个数据中心的位置用
一个点来表示，把每个通信链接用一段线来表示，如图 6-1 所示。

底特律

 

纽约
旧金山               芝加哥
丹佛            华盛顿

洛杉矶
图 6-1 计算机网络

这个计算机网络可以用图来建模，图中的顶点表示数据中心，边表示通信和链接。通常，用点
表示项点、用线段或者曲线表示边来可视化图。其中，表示边的线段的端点就是表示相应边的端
点的点。当我们画图时，尽量不让它们的边相交。然而，并不是必须这样做，因为任意的用点表
示顶点、任意形式的顶点间的连接表示边的描述方法均可使用。实际上，有些图不能够没有边相
交地画在平面上(见 6.7 节)。关键一点是，只要正确地描述了顶点间的连接，画一个图的路线方
式可以是任意的。

说明一下，表示这个计算机网络图的每条边都连接两个不同的顶点，即没有任何一个顶点连



--- 第 257 页 ---
第6章 图'239

接它自身，另外，也没有不同的两条边连接着相同的一对顶点。每条边都连接两个不同的顶点且
没有不同的两条边连接着相同的一对项点，这样的图称为简单图。注意，在简单图中，每条边与
一对无序的顶点相关联，而且没有其他的边和这条边连接相同项点。因此，当有一条简单图的边
与{x，?}相关联，也可以说{x，直是该图的一条边，这不会产生误解。

一个计算机网络可能在两个数据中心之间有多重链接，如图 6-2 所示。为这样的网络建模，
需要有不止一条边连接同一对顶点的图。可能会有多重边连接同一对顶点的图称为多重图。当有
mi 条不同的边与相同的无序顶点对相关联，我们也说{w，中是一条多重度为 普的边。就是说，可
以把这个边集考虑是边{z，友的 记 个不同副本。

艺加可 底特律  纽约

   
 

旧金山
华盛顿

洛杉矶
图 6-2 数据中心之间带有多重连接的计算机网络

有时候一个数据中心与它自己连接一条通信线，也许是一个为了诊断目的的反馈环。图 6-3
说明了这样的网络。为这个网络建模，需要包括把一个项点连接到它自身的边的图。这样的边称
为环。可能包含环、还有可能包含连接同一对顶点的多重边的图 ，称作擅图。

底特律

芝加哥                纽约

  
  

  

旧金山

洛杉矶
 6-3 ”带诊断线的计算机网络

到目前为止，我们所介绍的图是无向图。它们的边也被认为是无向的。然而，要建立一个图
模型，可能会发现有必要给这些边赋予方向。例如，在计算机网络中，一些连接可以只对一个方
向操作(这种边称为单工线路) 。这可能是这种情况，有大量的数据送到某些数据中心，但只有很
少或者根本没有相反方向的数据传输。这样的网络如图 6-4 所示 。

底特律
芝加哥               纽约

 
 

旧金山

洛杉矶
图6-4 带有单向通信线的通信网络

我们使用有向图为这样的计算机网络建模。有向图的每条边与一个有序对相关联。这里给有
向图的定义比在第 5 章使用的更加广义，在第 5 章中使用有向图来表示关系。
一个有向图(V,，巨)由一个非空顶点集 V 和一个有向边(或弧)集 已组成。每条有向边
与一 个顶点有序对相关联， 认为与有序对(x, 世相关联的有向边开始于 wx、结束于 v。
当画线描述一个有向图时，我们用一个从x 指向v 的箭头来表示这条边的方向是开始于x 结束

 



--- 第 258 页 ---
240)。第6章 图

于 uw。一个有向图可能包含环，也有可能包含开始和结束于相同顶点的多重有向边。有向图也有可
能包含连接 x 和 的两个方向上的有向边; 就是说，当一个有向图含有从 x 到 的边，它也可能包
含从vv到x 的一条或多条边。注意，当对一个无向图的每一条边都页予方向后，就得到了一个有向
图。当一个有向图不包含环和多重有向边时，就称为简单有向图。因为简单有向图在每一对有序
顶点(x，了o最多连一条边。如果在图中它们只连一条边，则称为(x，z)边。

在某些计算机网络中，两个数据中心之间可能会有多重的通信和链接，正如图 6-5 所示的那样。
用可以包含从一个顶点指向第二个(也许是同一个)顶点的多重有向边的有向图来对这样的网络建
模，我们称这样的图为有向多重图。当闫条有向边中的每一条都与一对有序顶点对(x. zw)相关联，
我们就说(w，刀是一条多重度为关的边。

蔚加可   底特律         纽约

    

 

旧金山

洛杉矶

图 6-5 带多重单向线的计算机网络

对于某些模型我们可能需要这样的图，其中有些边是无向的，而另一些边是有向的。有向
边和无向边都有的图称为混合图。例如，可能会用一个混合图来给这样的计算机网络建模，该网
络包含的链接有些可以双向运行，另外一些只能单向运行。

表6-1总结了各种图的专门术语。有时我们将用"图”作为一个通用的术语指代有向或无向的
(或两者几有)、有环或无环的，以及有多重边或无多重边的图。在其他情形下，当上下文清楚时，
我们使用术语“图”只表示无向图。

 
    
                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                  
 
                                                                                                                                                                                                                                                                 
 

无向                                              否

多重图                      无向                                              香
伪图                       无向                                              是
有向图                      有向                                              是
有向                                          是

有向的和无向的                                         是

  

:友呈:由于现代对图论的研究兴趣，还因为其在各个学科的广泛应用，图论中引入了许多不
   同的术语。不管什么时候遇到这些术语，读者应该注意它们的实际含义。数学家们用
以描述图的术语已经逐步得到规范，但是讨论运用于其他学科的图的术语仍然多种多样。
尽管描述图的术语可能区别很大，但是以下三个问题能够帮助我们理解图的结构 ;
*。 图的边是有向的还是无向的(还是两者凤有)?
*。 如果是无向图， 是否存在连接相同顶点对的多重边? 如果是有向图、 是否存在多重有向边?
*。 是否存在环?
回答这些问题有助于我们理解图。而记住所使用的特定术语就不那么重要。
图模型
as 图可用在各种模型里。这里将介绍几种领域的图模型。本章的后续小节和后面几章将

要介绍其他模型。当建立一个图模型，需要确认已经正确回答了我们提出的关于图结
构的三个关键问题。



--- 第 259 页 ---
第6章 图"241

5人1 生态学里栖息地重叠图 图可用在涉及不同种类的动物在一起活动的许多模型
一和 里。例如用栖息地重登图为生态系统里物种之间的竞争建模。用项点表示每个物种。
若两个物种竞争(即它们共享某些食物来源)，则用无向边连接表示它们的顶点。栖息地重秋图是
了 一个简单图，因为在此模型中不需要环和多重边。图 6-6 里的图表示森林生态系统。
从这个图看出松鼠与浣熊竞争，但是乌鸦不与网区竞争。            国
.in 例2 熟人关系图 可用图模型来表示人与人之间的各种关系。例如可用图来表示两个
”人是否互相认识，即他们是否是熟人。用顶点表示具体人和群里的每个人。当两个人互
相认识时，用无向边连接这两个人。不使用多重边，通常也不使用环。(如果我们想表达“自己认
识自己”这层意思，就在图中包含环.)图 6-7 显示了一个小型熟人关系图。世界上所有人的熟人关
系图有超过 60 亿个顶点和可能超过 1 万亿条边! 在 6.4 节里将要进一步讨论这个图。    国

Eduardo

  

Kari                Shaquira
图6-6 栖息地重登图              图 6-7 熟人关系图

例3 影响图 在对群体行为的研究里，可以观察到某些人能够影响其他人的思维。一种称为
影响图的有向图可以用来为这样的行为建模。用顶点表示群体的每个人。当顶点 ae 所表示的人影
响到项点训所表示的人时，就有从顶点 ac 到顶点如的有向边。图 6-8 表示了群体成员的影响图的例
子。在这个用影响图建模的群体里，Deborah 影响 Brain、Fred 以及 Linda，但是没有人影响
Deborah。另外，Yvonne 与 Brain 互相影响。                                一
2 例4 好莱坞图 好莱坞图用项点表示演员，并且当两个顶点所表示的演员共同出演一

”部电影时，就连接这两个项点。这个图是简单图，因为它的边是无向边，不包含多重
边和环。根据互联网电影数据库，在2006年1月，好莱坞图有 637 099 个顶点和超过 2000 万条边，
这些顶点所表示的演员出现在 339 896 部电影中。稍后在 6.4 节里将要讨论好莱坞图。       |

例5 循环赛 每个队都与其他每队恰好比赛一次的联赛称为循环赛。用其中顶点表示每个队
的有向图来为这样的比赛建模。注意若“ 队击败上队，则(a，纪是边。该图是简单有向图，不包含
环和多重有向边(因为没有任何两支队的比赛多于一次)。图 6-9 表示这样的有向图模型。注意在

这个比赛里，队 1 无败绩而队 3 无胜绩。                                                      面
队!      队2
Linda        Brian
队6                   队3
Deborah       Fred       Yvonne                        队5      队4

图 6-8 影响图                  图 6-9 循环赛的图模型



--- 第 260 页 ---
242 "第6章 图

二本: 例6 合作图 合作图可用来为学术论文的合作者关系建模。在合作图中，项点表示人

““' ” (可能限制为某个学术圈子的成员) ，如果两个人合写论文，则用边连接这两个人。已
经发现在数学研究论文上合作者的合作图有超过 400 000 个顶点和 675 000 条边。在 6.4 节里将对
这个图补充说明 。                                                  图
计二本 例7 呼叫图 可用来为网络(比如长途电话网)里的电话呼叫建模。具体地说，有向图

   “” 用来为呼叫建模，其中用顶点表示每个电话号码，用有向边表示每次电话呼叫。表示
呼叫的边是以发出呼叫的电话号码为起点，以接受呼叫的电话号码为终点。我们需要有向边，因
为其表示的通话方向是有意义的。我们需要多重有向边，因为需要表示每一个从特定号码拨到第
二个号码的通话 。

一个小型的电话呼叫图如图 6-10a 所示，它表示 7 个电话号码。例如，这个图表示从732-555-
1234 到 732-555-9876 有3 次呼叫和 2 次反向呼叫，但是从 732-555-4444 到其余 6 个号码(732-
555-0011 除外?没有了旦叫。当只关心是否有连接两个电话号码的呼叫时，就使用无向图，其中当两
个号码之间有了呼叫时，就用边连接这两个电话号码。这个版本的呼叫图如图 6-10b 所示。     国

732-555-1001

    
  

732-555-1234                                            732-S5S5-4444

]?-     -|
732-555-9876                                      0011

732-$55-6666
a)

732-555-1001

    
  

732-S55-1234                                            733-$55-4444

732-555-9876                                             2 555.0011

732-555-6666
b)

 6-10 呼叫

表示实际呼叫活动的呼叫图可以非常大。例如,在 AT&T 研究的一个呼叫图里，有大约 30
亿9 千万个顶点和 40 亿条边，这个图表示在 20 天里进行的呼叫。在 6.4 节里将要进一步讨论呼
叫图。
-3 例8 网络图 万维网可用有向图来建模，其中用项点表示每个网页，并且若有从网页
四   4指向网页2 的链接，则有以 a 为起点以2 为终点的边。因为几乎每秒钟都有新页面在
网络上某处产生并且有其他页面被删除，所以网络图几乎是连续变化的。目前网络图有超过 30 亿
个顶点和 200 亿条边。 许多人正在研究网络图的性质，以便更好地理解网络的特性。6. 4 节将要继
续讲解网络图， 第 7 章将要解释网络朴虫(搜索引擎用它来产生网页的索引)是如何利用网络图的。
国



--- 第 261 页 ---
第6音 图"243

例9 优先图与并发处理 ”通过并发地执行某些语句，计算机程序可以执行得更快。重要的是
避免语句执行时还要用到尚未执行语句的结果。语句与前面语句的相关性可以表示成有向图。用
顶点表示每个语句，若在执行完第一个顶点所表示的语句之前不能执行第二个顶点所表示的语句，
则从第一个顶点到第二个顶点有一条边。这样的图称为优先图。图 6-11 显示计算机程序和优先
图。例如，该图说明在执行语句 S, 、S, 和 S, 之前不能执行语句 S, 。            国

例10 路线图 可以用图对路线图建模。在这样的模型        &
中，定点表示交叉点，而边表示路，无向边表示双向道路， 有 》 ， 。:-0
向边表示单行道，多重无向边表示连接相同交叉点的多条双向
道路，多重有向边表示从一个交叉点开始、到第二个交叉点结
束的多条单行道; 环表示环形路。因此，如果一个路线图中只

有双向道路，没有环形路，没有两条路连接相同的一对交叉 中 4:=b+9   发
31     32

35

点，那么这个路线图可以用一个简单无向图来表示。一个路线 5 “=d+l
图中只有单行道，没有环形路，没有两条路起始于相同的交叉 Se *:=c+d
点且终止于相同的交叉点，那么它可以用一个简单有向图来表
示。描述包含单行道和双向道路的线路图则需要混合图。 ”国

练习

1. 画出表示航空公司航线的图模型，并说出所用图的类型，其中每天有 4 个航班从波士顿到纽华克，2 个航
班从纽华克到波士顿，3 个航班从纽华克到迈阿密，2 个航班从迈阿密到纽华克，1 个航班从纽华克到底特
律，2 个航班从底特律到纽华克，3 个航班从纽华克到华盛顿，2 个航班从华盛顿到纽华克，1 个航班从华
盛顿到迈阿密，其中
a)若城市之间有航班(任何方向)，则在表示城市的项点之间有边。
b)对城市之间每个航班(任何方向)来说，在表示城市的顶点之间有边。
c)对城市之间每个航班(任何方向)来说，在表示城市的顶点之间有边，以及有表示在迈阿密起飞和降落的

特殊观光旅行的环 。

9d)从表示航班出发城市的项点到表示航班终止城市的顶点之间有边。
e)对每个航班，从表示出发城市的顶点到表示终止城市的顶点之间有边。

试确定练习 2一5 中所示的各个图有有向边还是无向边，是否有多重边，是否有一个或多个环。用你的答
案指出该图属于表 6-1 中的哪种图。

2. 4               力      3.       a            已           4

图 6-11 优先图

 

C     过

6. 设C是一个简单图。尺是G 的节点集上的关系，x尺vw 当且仅当G 中有与1{w, z)相关联的边。证明， 关系
及是对称的和非自反的关系。
7. 集合 4 ，4:，…，4, 的交图对每个集合来说都有一个项点，车两个集合有非空交集，则有一条边连接代
表这两个集合的顶点。构造下列集合的交图。
a)Ai王(0，2，4，6，8}，A:={10，1，2，3，4)
4一(1 3，5，7，9}，A4一(5，6，7，8，9)
Ai一(0 1，8，9)}
b)4一{…，一4，一3，一2，一1，0}
4:一(…，一2，一1，0，1，2，…}
43:一人一6，一4，一2，0，2，4，6，…}



--- 第 262 页 ---
244+"。第6童 图

AN一(和，一5，一3，一1，1，3，5，…}
Ai一{(…，一 6，一3，0，3，6，…》}
c)Ai一(zz<0)，A4:=(z |一1和xz一0)}
A3一(并| 0一z<1)         Ai一(| 一1一z一1)
A5一{T| 7一1}          Ai一
8. 构造 6 种鸟的栖息地重杰图，其中隐士煌与旅煌以及蓝松鸦竞争，旅寿也与瑚办竞争，嘲和也与蓝松鸦竞
争，以及榴鸟与多毛吸木鸟竞争 。
9. 可用图来表示两个人是否生活在同一时代。面出这样的图来表示本书前4 章里有生平介绍的在 1900 年前去世的
属于同一时代的数学家和计算机科学家。(如果在同一年里两个人都在世，就假设他们生活在同一时代。)
10. 构造公司董事会成员的影响图，主席影响技术总监、市场总监和营运总监; 技术总监影响营运总监; 市
场总监影响营运总监: 无人影响首席财务官或受其影响。

11. 在循环赛里，老虎队击败蓝松鸦队，蓝松鸡队击败红衣主教队，红衣主教队击败北美金营队，用有向图
为这样的结果建模。

12. 解释如何用一月份和二月份的电话呼叫图来确定改变了电话号码的人的新电话号码。

13. 如何用表示网络里发送电子邮件的图来找出最近改变了原来电子邮件地址的人?

14. 描述一个图模型，它表示在某个聚会上每个人是否知道另一个人的名字。图中的边应该是有向的还是无
向的? 是否应该允许多重边? 是否应该允许环?

15. 描述一种表示传统婚姻的图模型。这个图有什么特殊性质?

16. 构造下列程序的优先图 :

Si zx: 一0
Sa: : 工: 一并十1
Si : yi: 一2

S;: z: 一y
Si:， rr: 一工十2
Su : yi 一工十zx
Sy7: zz: 一4

17. 描述一种用来为群体里成对个人之间关系建模的基于图的离散结构，其中每个人可能喜欢或者不喜欢另
一个人,或者中立，而反过来的关系可以是不同的。[提示: 给一个有向图添加结构。分别处理表示两个
人的顶点之间的反向边.]

6.2 图的术语和几种特殊的图

6.2.1 引言
1 : 本节将介绍图论的一些基本词汇。当解决许多不同类型的问题时可以使用这些词汇。
”其中一个这样的问题涉及判定能否把图画在平面里，使得没有两条边是交叉的。另一
个例子是判定两个图是否具有顶点之间的一一对应，使得这样的对应能够产生边之间的一一对应
我们还将介绍在例子和模型里经常用到的几种重要的图族。在这些特殊类型的图出现的地方，将
会介绍几种重要的应用。

6.2.2 基本术语

首先给出描述无向图的顶点和边的一些术语。

定义  若x和是无向图G 中的一条边的端点，则称两个顶点 x 和 称为在G 里邻接(或相
邻)。若。 和{x，z相联系，则边 e 称为关联顶点zx 和uv。也可以说边 e连接x 和vv。顶点和 称
为与{，z} 相联系的边的端点。

为了反映出有多少条边关联着一 个顶点，有下述的定义。

全习 在无向图里项点的度是与该顶点关联的边的数目，例外的情形是，顶点上的环为顶
点的度做出双售于献。 顶点的度表示成 deg(v) 。

 

 



--- 第 263 页 ---
第6章 图"245

例1 如图6-12 所示， 图G 和图所的顶点的度是什么?

图 6-12 无向图CG 和也

解 在G里，deg(a)王2，deg(b)一deg(c)一deg(记一4，deg(d)一1，deg(e)一3，deg(Cg)一0。
在万里，deg(a)一4，deg(0)一deg(e)一6，deg(c)一1，deg(d)一5。                   国

把度为0 的顶点称为孤立的。因此孤立点不与任何顶点相邻。例 1 里图 C 的顶点g 是孤立的。
顶点是悬挂的，当且仅当它的度是 1。因此悬挂点怡与 1 个其他项点相邻。例 1 里图 G 的顶点d 是
悬挂的。

当对图 C=(V， 五)的所有项点的度求和时，得出了什么? 每条边都为顶点的度之和贡献 2，
因为一条边恰好关联2个(可能相同) 顶点。这意味着项点的度之和是边数的2 倍。下面描述握手定
理，这是因为在一条边上有两个端点可以类比为一次握手涉及两只手这种情形 。

分析一个图模型中顶点的度，能够提供关于该模型的有用信息，如例 2 所示。

例2 栖息地重倒图(6. 1 节例 1 中介绍的)中一个顶点的度表示什么意义? 该图中的哪些顶点
是悬挂的，哪些是孤立的? 运用6. 1 节图6-6 中所示的栖息地重亚图解释你的答案。

解 ”栖息地重亚图中的两个顶点之间有边，当且仅当这两个顶点所代表的两个物种相互竞争 。
因此，栖息地重秋图中的一个顶点的度表示了该生态系统里与此顶点代表的物种竞争的物种数目。
如果一个物种恰好与另一种物种竞争，则相应的顶点是悬挂的。最后，如果某一物种不与其他任
何物种竞争，那么代表该物种的项点就是孤立的。

例如，6. 1 节图6-6 中代表松鼠的顶点的度是4，因为松鼠于其他 4 种物种竞争: 乌鸦、负鼠、
浣熊和吸木鸟。图 6-6 所示的图中,老鼠是唯一的一个由悬挂顶点表示的物种，因为老鼠只与网
风竞争，而其余的所有物种都至少与两种以上的他物种竞争。如果一个物种仅与另一种物种竞争 ，
则表示它的顶点是悬挂的。图 6-6 所示的图中没有孤立的顶点，因为每种物种都至少与生态系统
中的其他一种物种竞争 。

 握手定理 设 G=(V，E)是有ee条边的无向图，则

2e 一 > deg(v)

(注意即使出现多重边和环，这个式子也仍然成立。)

例3 一个具有 10 个顶点而且每个顶点的度都为6 的图，有多少条边?

解 ”因为顶点的度之和是6。10王60，所以 2e=60。因此“=30。                 四
定理 1 说明无向图顶点的度之和是偶数。这可以推导出许多结论，其中一个结论作为定理 2

 

     无向图有偶数个奇数度顶点。
证 在无向图 G=(VY，)里，设 W, 和 V: 分别是偶数度项点和奇数度项点的集合。于是

2e 一 > deg(z) 一 > deg(v) 十 > deg(z)
因为对 vE V, 来说，deg(z)是偶数，所以上面等式右端的第一项是偶数。另外，上面等式右

端的两项之和是偶数，因为和是 2e。因此，和里的第二项也是偶数。因为在第二项的和里， 所有
的项都是奇数，所以必然有偶数个这样的项。因此，有偶数个奇数度顶点。         本



--- 第 264 页 ---
246。第6章 图

对带有有向边的图来说也有一些有用的术语。
ER 当(x，>)是带有有向边的图 G 的边时，说 x 邻接到vv，而且说vv从zx 邻接。顶点 zx 称
为(&，z)的起点，称为(&，丰的终点。环的起点和终点是相同的。

因为带有有向边的图的边是有序对，所以这时顶点度的定义细化成反映这个顶点作为起点和
作为终点的不同度数。

E  在带有向边的图里，项点v的入度(表示成 deg (zz))是以作为终点的边数。顶点
的出度(表示成 deg'* (u))是以ww作为起点的边数(注意顶点上的环对这个顶点的人度和出度的贡献
都是1)。

例4 求出图 6-13 所示带有向边的图G 里每个顶点的人度和出度 。

解 人度是: deg (aa)一2，deg (pb)一2，deg (cec)一3，
deg (dl)一2，deg (e)一3，deg- (门天0。出度是，deg+ (a) 一
4，deg (0) 一1，deg'* (ec)一2，deg (dl)一2，deg+(e)一3，
deg" (万一0。                             本

因为每条边都有一个起点和一个终点，所以在带有向边的
图里，所有顶点的人度之和等于出度之和。这两个和都等于图
的边数。把这个结果表述成定理 3 。

 设 G=(V，E)是带有向边的图。于是         图613 有向图C

2 deg-  (u) 一 2 deg'  (z) 一|下|

带有向边的图有许多性质是不依赖于边的方向的。 因此忽略这些方向经常是有用处的。忽略
边的方向后得出的无向图称为底无向图。带有向边的图与它的底无向图有相同的边数。

6.2.3 一些特殊的简单图

下面要介绍几类简单图。这些图常常用作例子，来自于许多应用。

例$5 完全图 #个顶点的完全图(表示成 多,)是在每对不同顶点之间都从有一 0
对nm一1，2，3，4，5，6来说,图6-14 显示图 氏, 。

和A风仿侣

Ki

 

 

 

图6-14 图天,，"一1，2，3，4，5，6

例6 团图 图图C,(n二3)是由) 个项点，妈，…，Pm 以及边{u ，权(人可，四 ，…，
{zw-i， wh》 ， {uv， }组成的。 图6-15 显示圈图 C，CI，Cs ，C。                   图

入癌人7

图6-15 圈图C: ，C,，C: ，Cr

例7 轮图 对>z>3来说，当给圈图 C, 添加另一个顶点，而且把这个新顶点与 C, 里z 个项



--- 第 265 页 ---
第6音 图。247

点逐个连接时，就得出轮图 妈,。图 6-16 显示轮图 凤, ，W, ，砚: ，W，。           国

从史食吕

图 6-16 轮图 W ，妈,，W，Wy

例8 王立方体图 7立方体图(表示成 Q.)是用顶点表示 2" 个长度为的位串的图。两个顶点
相邻，当且仅当它们所表示的位串恰恰相差一位。图 6-17 显示图 Q 、Q: 、Q, 。注意可以从”立方
体图 Q, 来构造("十1)立方体图 Q,::，方法是建立 Q, 的两个副本，在 Q, 的一个副本的顶点标记前
加 0，在 Q, 的另一个副本的顶点标记前加 1，并且加入连接那些标记只在第一位不同的两个顶点
的边。在图 6-17 中，从 Q: 来构造 Q, ，方法是画出 Q, 的两个副本作为 Q, 的顶面和底面，在底面
每个顶点的标记前加0，在项面每个顶点的标记前加1。(这里,“面"意为三维空间中立方体的一个
面。试想在三维空间中画出以 Q: 的两份拷贝作为立方体顶面和底面的 Q, 的图形，然后在平面上
画出结果描述方法(此 Q, 图形一一译者注)的投影。)                               国

 

10      ]1

 

@I           Q@:              @
图 6-17 对于 一1，2，3 的”立方体图Q，

6.2.4 偶图

刁了 有时可以把图的项点分成两个不相交的子集，使得每条边都连接一个子集里的顶点与
“”… “”，另一个子集里的顶点。例如，考虑一下表示村民之间的婚姻关系的图，其中用顶点玫

示每个人，用边表示婚姻。在这个图里，每条边都连接表示男人的顶点子集里的顶点与表示女人

的顶点子集里的顶点。这引出了定义 5。

3 若把简单图 G 的顶点集分成两个不相交的非空集合VW 和V, ，使得图里的每一条边都
连接着 W 里的一个项点与 V: 里的一个顶点(因此 G 里没有边是连接着 w, 里的两个顶点或 v。 里的
两个项点)，则 G 称为偶图8 。当此条件成立，称(V, ，V?: )为 G的顶点集的一个二部划分。

在例 9 里说明 C, 是偶图，在例 10 里说明 K, 不是偶图。

例9 图6-18所示的Cs 是偶图，因为把它的顶点集分成两
个集合 一(人 ，思，u)和V:一(人加，办，w)，C, 的每一条边都
连接 w, 里的一个顶点与 V:, 里的一个项点。             国

例 10 K;, 不是偶图。为了看明白这一点，注意车把 K, 的
顶点集分成两个不相交的集合，则两个集合之一必然包含两个
顶点。假如这个图是偶图,那么这两个顶点就不能用边连接，但是在 K， 里每一个顶点都用边连接
到其他每个顶点 。                                                 转

 

 

图 6-18 Cs 是价图

马 也称为二部图、二分图。一一译者注



--- 第 266 页 ---
248 "第6章 图

例 11 6-19 所示的图CG和玉 是否为偶图?

如                       忆                                            如                       心
本
有
  4                   >            了                                                    《
1                                                                                                                                        -<竹二>
已            好                        马            太

G                      用
图 6-19 无向图和五

解 图G是偶图，因为它的顶点集是两个不相交集合la，26，dj}j 和;{c，e，j太58)}的并，每条边
都连接一个子集里的一个顶点与另一个子集里的一个顶点。(注意对偶图G来说， 不必让
{e，5，d)}里每一个顶点与{c，e，，g}里每一个顶点都相邻。例如2与& 就不相邻。)

 刀不是偶图，因为它的顶点集不能分成两个子集，使得边都不连接同一个子集的两个顶点
(读者应当通过考虑顶点 ae、D、上来验证它) 。                                    国

定理4给出了决定图是否为偶图的有用准则。

 一个简单图是偶图，当且仅当能够对图中的每个顶点赋以两种不同的颜色，而不让
相邻接的顶点被赋以相同的颜色 。

证 首先，假设 G=(V, E)是一个二分简单图。那么, V=WUV:，其中V, 和YV: 是不相交的
顶点集且 三中的每一条边都连接一个 W 中的顶点和一个V: 中的顶点。如果对 WwW 中的每个顶点赋
予一种颜色而 V, 中的顶点赋予第二种颜色，那么相邻接的顶点就不会被赋予相同的颜色 。

现在假设可以仅用两种颜色对图中的顶点着色，以使得相邻接的顶点都被赋予不同的颜色。
让 V, 为一种颜色的顶点集，V: 为另一种颜色的顶点集，则 VW 和 V:不相交且V=Vw UV:。此外，
每条边都连接一个 w, 中的项点和一个 V: 中的顶点，因为并无相邻接的顶点同在 V, 中或同在 V，
中。所以，G 是偶图。                                                 口

例 12 将说明如何用定理4判断一个图是不是假图。

例12 用定理4判断例 11 中的图是不是偶图。

解 ”首先考虑图G。将图 G 中的每个顶点赋予两种颜色(如红色和蓝色)中的一种，使得 G 中
的每一条边都连接一个红色顶点和一个蓝色顶点。不失一般性，我们先任意地赋予顶点 ec 红色。
然后，必须对c，e，厂和8 顶点赋予蓝色，因为这些顶点与顶点 a 相邻接。为了避免一条边有两个
蓝色的端点，所有与 c，e，j 或g 顶点相邻接的顶点必须被染成红色。这就是说，必须把训和d 染
成红色(也意味着，a 必须染成红色，而a 已经是红色的了)。现在，已经将所有的顶点都进行了染
色，a,， 和az 为红色，c，e，厂和8 为蓝色。查看每一条边，我们看见每条边都连接一个红色顶点
和一个蓝色顶点。因此，由定理4，图 G是偶图。

接下来，将对图 媚 中的每个顶点赋予红色或蓝色，以使 五中的每一条边都连接一个红色顶点
和一个蓝色顶点。不失一般性，我们任意地对 a 赋以红色。然后，必须对6，e 和上卫赋以蓝色，因
为它们每个都与 a 邻接。但这是不可能的，因为e 和上向邻接，因此不能两个都赋以蓝色。这一了矛
盾表明我们不能对 互 中的每一个定点赋以两种颜色之中的一种，以使没有邻接的顶点被赋以相同
的颜色。根据定理 4，万不是偶图。                                      图

定理 4 是图论中*图的着色?部分的一个结果示例。图的着色是图论中一个重要的部分，有着
许多重要的应用。我们将在 6. 8 节进一步学习图的着色。

决定一个图是否是偶图的另一个标准是基于路径的概念，将在 6. 4 节学习这个概念。一个图
是偶图，当且仅当从一个顶点出发经过奇数条不同的边再回到它本身是不可能的。当我们在 6. 4
节讨论图中的路径和环路时，将会让这个概念变得更加精确(参见那一节的练习 26) 。



--- 第 267 页 ---
第6章 图。，249

例13 完全偶图“完全倡图 K。,是顶点集分成分别含有mm 和? 个顶点的两个子集的图。两个
顶点之间有边当且仅当一个顶点属于第一个子集而另一个项点属于第二个子集。图 6-20 显示完全
偶图 K:.: ，天:3:，  天:以及 天:ee。                                                                 力

大:3                                                                  天3.3
大3                                                                          大6

 6-20 ”部分完全偶图

6.2.5 特殊类型的图的一些应用

以下例 14一16 将要说明如何把特殊类型的图用在数据通信和并行处理的模型里。

例14 任务分配”设一个小组内有 mm 名雇员，有17 个不同的任务需要完成，其中 普乞J) 。每个
员工都受过相关训练，可以做这了个任务中的一个或多个。我们可以用一个图来为员工的能力建
模。每个员工和每个任务都用一个顶点表示。对于每个员工，从表示该员工的顶点到表示该员工
受训能做的所有任务，都作一条边。注意到这个图的顶点集可以被划分成两个不相交的集合，一
个代表员工的顶点集，另一个代表任务的顶点集。而且每一条边都连接一个表示员工的顶点和一
个表示任务的顶点。因此，该图是一个偶图。

例如，设一个小组由4名员工:， Alvarez，Berkowitz，Chen 和 Davis; 再设完成一个项目有4 种
工作要做: 需求，架构，实现和测试。设 Alvarez 受训可以完成需求分析和测试; Berkowitz 接受
的训练是完成架构、实现和测试Chen 接受的训练是完成需求、架构和实现; 而 Davis 只接受训
练做需求。可以用图 6-21 所示的偶图对员工的这些能力建模。

为了完成项目，必须给员工指派任务，以满足每个 Aivaez   Benkowitz   Chen   Davis
任务都有一个员工接手，而且每个员工最多只分配一个
任务。在这种情况下，可以让 Alvarez 做测试，

Berkowitz 做实现，Chen 做架构，Davis 做需求。如图
6-21 所示(带颜色的线表示了任务的分配) 。

寻求一种对员工的任务分配方案可以看成是在图模    需求    架构     实现    测试
型中寻找一个匹配。简单图的匹配是该图边集的一个子   图6-21 为受训员工分配工作建模
集，该子集中没有两条边与同一个顶点相关联。最大匹
配是所含边数最多的匹配。换句话说，匹配是边集的子集使得如果{s*，引和{uw，zv}是匹配中的边，
那么st &和mm 就是不同的项点。在给职员分配任务的过程中，要给最多数的职员都分配，实际
上就是寻找员工能力的图模型中的最大匹配。(感兴趣的读者可以在关于图论的书中找到更多有关
匹配的内容，这些书中包括LGrYe06J]。)                                    力
2 例15 局域网 在一座大楼里，像小型计算机和个人电脑这样的各种计算机，以及像

”打印机和绘图仪这样的外设，都可以用局域网来连接。一些这样的网络是基于星形拓
扑，其中所有设备都连接到中央控制设备。局域网用图 6-22a 所示的完全偶图 开,,,来表示。通过中



--- 第 268 页 ---
250。第6章 图

央控制设备在设备间传输信息。
其他局域网是基于环形拓扑，其中每个设备恰恰连接到两个其他设备。带环形拓扑的局域网
用图 6-22b 所示的 ”圈图 C, 来建模。消息围绕着圈从设备送到设备，直到抵达消息目的地为止。

LI SS

a)            b)             c)
图 6-22 局域网的星形 、环形以及混合拓扑

最后，一些局域网采用这两种拓扑的混合形式。消息是围绕着环或通过中央设备来传送。这
样的宛余使得网络更加可靠。带完余的局域网用图 6-22c 所示的轮图 攀, 来建模。      医

例 16 并行计算的互联网络 ”直到最近，计算机执行程序还是一次完成一个操作。因此，为
解决问题而写的算法都设计成一次执行一步; 这样的算法称为串行的(几乎所有本书描述的算法都
是串行的) 。不过，像气象模拟、医学图像分析以及密码分析这样的许多高强度计算问题，即使在
超级计算机上 ，也不能通过串行操作在合理的时间范围内解决。另外，计算机执行基本操作的速
度，还存在物理的限制，所以总是有问题不能用串行操作在合理的时间范围内解决。

并行处理利用包含许多自带内存的单处理器的计算机来帮助克服串行计算机的局限性。并行
算法把问题分成可并发解决的若干子问题，于是可以设计并行算法，用带有多处理器的计算机来
快速解决问题。在并行算法里，单个指令流控制着算法的执行，包括把子问题送到不同的处理器，
以及把子问题的输入和输出定向到适当的处理器。

采用并行处理时，一个处理器需要另一个处理器产生的输出。因此处理器需要互联。可用适
当类型的图来表示带有多重处理器的计算机里处理器的互联网络。在以下讨论里将要描述最常用
类型的并行处理器互联网络。用来实现具体并行算法的互联网络的类型，差异在于处理器之间交
换数据的需求量和所需要的速度，当然还有可用的硬件等。

最简单却又最昂贵的网络互联处理器，包含每对处理器之间的双向连接。当有半个处理器时，
这样的网络表示成?个项点上的完全图并.,。不过，这种类型的互联网络有严重的问题，它所需要
的连接数太大。实际上，处理器的直接连接数目是有限的，所以当处理器数很大时，处理器不能
直接连接到所有其他处理器。例如，当有 64 个处理器时，就需要C(64，2)王2016 个连接，每个处
理器都得直接连接到其他 63 个处理器。

另一方面，互联盖个处理器的最简单方式或许是使用称为线性阵列的排列方式。除 P， 和 卫，
外的每个处理器 已, 都通过双向连接来连接到相邻处理器 P,-,和 P,,:。有P 只连接 P,，P, 只连接
P,-,。图6-23 显示 6 处理器线性阵列。这种方式的缺点是为了让处理器共享信息，有时需要使用
大量的称为 hop 的中间连接。

栅格网络(或二维阵列)是通用的互联网络。在这样的网络里，处理器个数是一个完全平方数，
比方说z一辣。72 个处理器标记成忆(i，六，0委过普一1，0近j委六一1。双向连接把处理器PGi，尹
连接到它的4个相邻处理器 P(i士1，)和 P(i，j士1) ，只要这些处理器是在栅格里。(注意，栅格
角上的4个处理器只有 2 个相邻处理器，边界上其他处理器只有 3 个相邻处理器; 有时也用每个处
理器恰有 4 个连接的变种的栅格网络。)栅格网络限制每个处理器的连接数。某些成对处理器之间
的通信需要 O(Va)王OC)个中间连接(见本节末的练习 33) 。图 6-24 表示 16 个处理器的栅格网络
的图。



--- 第 269 页 ---
                                                                                                                    

 
  

P(0.0) _P(0, 1) _P(0.2) P(0.3)

  

二 PG3， 2
人

图 6-23 6个处理器的线性阵列                    图 6-24 16 个处理器的棚格网络

超立方体是互联网络的一个重要类型。对这样的网络来说，处理器数是 2 的寡，z一2"。n
个处理器标记成 P,，P, ，…，P, ,。每个处理器都有到 关个其他处理器的双向连接。连接到处
理器 已上的处理器，其下标的二进制表示与半的二进制表示恰恰相差 1 位。超立方体网络在每个
处理器的直接连接数与保证处理器通信的中间连接数之间取得了平衡。已经用超立方体网络建造
了许多计算机，而且用超立方体网络设计了许多算法。z立方体图 Q. 表示带”个处理器的超立
方体网络 。 6-25 显示 8 个处理器的超立方体网络(图6-25 中画 Q, 的方式与图6-17 所示的方
式不同) 。                                                     力

局   忆   产   及   忆   记   上   户

SS一

 6-25 8 个处理器的超立方体网络

PP 有呈甩有 矶

                                                                                                                                                                                                                                      

6.2.6 从旧图到新图

有时解决问题只需要图的一部分。例如，只关心大型计算机网络中涉及纽约、丹佛、底特律
以及亚特兰大的计算机中心的那一部分。其他的计算机中心以及不连接到这 4 个具体计算机中心
里任何2 个的所有电话线可以忽略。在大网络的图模型里，可以删除除这 4 处外的计算机中心所对
应的顶点，可以删除所有与所删除顶点关联的边。删除后所剩下的图称为原图的子图。

ES 图C一(V，E)的子图是图 互一(双，F) ，其中WESTV 而且FCE。

例17 图6-26 所示的图G是天, 的子图。

可以用各种方式组合两个或更多的图。把这些图

面
的所有顶点和边所组成的图称为这些图的并图。两个
简单图的并图的定义如下。                  。          b            5
ES 两个简单图 G, = (V ，FE )和 G, 一(V:，
已)的并图是带有顶点集 WwW UV， 和边集已 U已的简
好    C            人

单图。G 和 G: 的并图表示成 CUCG: 。

例 18  求图 6-27a 所示的图 Ci 和C: 的并图。                图 6-26 天; 的子图
如       五       C      &          |才汉        5
d       e           dt             7          d        e        让
ci                  G>                       CGIU G，

al)                                         b)
图 6-27 a)简单图G 和 G::，b)它们的并 CUG，



--- 第 270 页 ---
252 "第6童 图

解 并图G,UG: 的顶点集是两个顶点集的并，即tae，2，c，qd，e，媳。并图的边集是两个边
集的并。并图显示在图 6-27b 中。                                                 玫

练习
在练习 1一2 里，求所给无向图的顶点数、边数以及每个顶点的度。指出所有孤立点和悬挂点。

1 4           也           C           2.

 

三          e         df
3. 带有 15 个顶点而且每个顶点的度都为 5 的简单图能否存在?

在练习4一5 里，对给定的有向多重图来说，确定项点数和边数，并求出每个顶点的人度和出度 。

4            也        5 4@           旋
-了          人
看
二         C            可            C      已
6. 构造出图 6-13 里带有向边的图的底图。
7. 在合作图里，项点的度表示什么? 孤立点和悬挂点表示什么?
8. 在6.1节例7所描述的电话呼叫图里，顶点的人度和出度表示什么? 在这个图的无向版本里，顶点的度表
示什么?

9. 在为循环赛建模的有向图里，项点的人度和出度表示什么?
在练习 10一12 里，确定图是否为偶图。

10. Q         户          11.     妃         C             12，          书
C           df                   扩           已
上               df
它

13. 设一个新公司有 5 和名员工: Zamora、Agraharam、Smith、Chou 和 Macintyre。每个员工承担下列 6 种责
任之一: 策划,宣传，销售，市场，开发，以及工业关系。 每个员工能够做这些工作中的一种或多种，
Zamora 能做策划、销售、市场或工业关系;Agraharam 能做策划或开发;Smith 能做宣传、销售或工业
关系; Chou 能做策划、销售或工业关系; Macintyre 能做策划、宣传、销售或工业关系。

a)用一个偶图对这些员工的能力建模。
b)找出一个能力的指派，使得每个员工被指定一种能力。

14. 下列图有多少个顶点和多少条边?

a)开。             b)C。              c)，
d)天。。            e)Q，

一个图的度序列是由该图的各节点的度按非递增顺序排列的序列。例如，本节例 1 中图 G 的度序列就是
4，4，4，3，2，1，0。

15, 求下列各个图的度序列。



--- 第 271 页 ---
第6章 图

a)开，              b)C，              c)Wr，
d)开2,             eaQa
16. 图 K, 的度序列是什么(其中是正整数)? 并解释你的答案 。
17. 车图的顶点有度5. 2，2，2，2， 1. 则它有多少条边? 画出这样的图。

如果一个序列是一个简单图的度序列，那么该序列是成图的。

18. 判断下列序列是否是成图的。如果是，请画出一个简单图使其具有给定的度序列。
al)3，3，3，3，2                     b)5.、 4，3，2，1
c)4，4，3，2，1                      d)4，4，3，3，3
e)3，2，2，1，0                    人1，1，1，1，1

19. 证明: 一个由非负整数非递增排列的序列 贝，d ，…，d 是成图序列当且仅当把序列 ds; 一1，
du一1，du-*，…， dh 中的元素重新排序为非递增而得到的序列是成图序列。

20. 证明: 每个元素之和为偶数的非递增非负整数序列都是某个伪图的度序列。伪图是允许有环的无向图。
[提示，首先通过给每个顶点添加尽可能多的环来构造一个图，然后添加一些边连接度为奇数的顶点。解
释为什么这种构造方法能够证明此问题。]

21. 至少带有 1 个顶点的 K: 的子图有多少个?                                       帮           旋

22. 夯出右面这个图的所有子图。

若简单图每个顶点的度都相等，则这个图称为正则的。若正则图每个顶点的度都

为m，则这个图称为半正则的。

23. 对哪些”值来说，下列图是正则图?

a)乓。           bDcC，           CU           d)Q，
24. 度都为4而且带有 10 条边的正则图有多少个顶点?
25. 求右面的简单图对的并图(假设带有相同端点的边是相同的) 。     a    bu 5
26. 简单图 G 的补图避 与G 有相同的项点。两个顶点在 区里相邻，当

且仅当它们在 G 里不相邻。求下列图。                 《       。

aa天。    bDK。，   cC;    d)Q.

27. 若简单图G 有zu 个顶点和e 条边，则已有多少条边?

28. 简单图 G 的度序列为d,，吃，…，, 心。求蕊的度序列。

29. 证明: 若G是且个顶点的简单图 则 G 和G 的并图是天,。
表示成 G' 的有向图G一(V，E)的北图是图(V，F)，其中(xz、mEF，当且仅当(u，xEEE。

30, 描述 6. 1 节练习 4一5 里每个图的逆图。

31, 证明: 图G是它自身的逆图，当且仅当G所关联的关系(参见 8. 3 节)是对称的。

32. 画出 9个并行处理器互联的栅格网络。

33. 证明: 在 "一喇 个处理器的栅格网络里，用O(Vm )王O(m)个 hop 就能让每一对处理器互相通信。

6.3 图的表示和图的同构
6.3.1 引言

图的表示方式有很多种。在本章里将看到选择最方便的表示会有助于对图的处理。本节将要
说明如何用多种不同的方式来表示图。

有时两个图在这样一种意义下恰好具有相同的形式，就是在两个图的顶点之间存在着-一一对
应，这个对应保持边的对应关系。在这种情形下就说两个图是同构的。确定两个图是否同构，这
是本节里将要研究的重要图论问题。

6.3.2 图的表示
表示不带多重边的图的一种方式是列出这个图的所有边。另一种表示不带多重边的图的方式
是用邻接表，它规定与图的每个顶点相邻的顶点。

nm



--- 第 272 页 ---
254 "第6章 图

例1 用邻接表描述图 6-28 所示的简单图。
解 表6-2列出与图的每个项点相邻的顶点。                                      国

旋

表 6-2 简单图的边表

 

E   d
图 6-28 ”简单图
例2 通过列举在图的每个顶点上发出的边的终点，表示图 6-29 所示的有向图。
解 ”表6-3 表示图6-29 所示的有向图。                      国

表6-3 有向图的边表

  

图 6-29 一个有向图

6.3.3 邻接和矩阵
若图里有许多边，则把图表示成边表或邻接表，会不便于执行图的算法。为了简化计算，可
用和拖阵表示图。在此将给出两种类型的常用的表示图的矩阵。一种类型是基于顶点的相邻关系，
另一种类型是基于顶点与边的关联关系。
假设G=(V，E)是简单图，其中|1V | =。假设把 G的顶点任意地排列成v ，
对这个顶点表来说，G 的邻接矩阵 A(或Ac)是一个mxXn的0-1和矩阵，它
满足这样的性质: 当zw 和zu 相邻时第(?，7力项是1，当w 和zw 不相邻时第(i，j项是0。换句话
说，若邻接矩阵是A=[a,]，则
有   若{uw,u) 是G的一条边
”to 。理则
例3 用邻接矩阵表示图 6-30 所示的图。
解 ”把顶点排列成w，6，c，qd。表示这个图的和矩阵是
1 1
1 0 1
1 1 0
0 0 0
例4 夯出带有相对于顶点顺序 c，6，c，dx 的邻接矩阵的图。
1 1 0
0 1
0
1

1
0
和

1
1   1
0   0
解 图6-31 显示带有这个邻接矩阵的图。                     国

一 呈呈



--- 第 273 页 ---
第6章 图。255

C       过                    巡       CC
图 6-30 简单图         图6-31 带有给定的邻接扼阵的图

注意，图的邻接抢阵依赖于所选择的项点的顺序。因此带z个顶点的图有zl! 个不同的邻接和抢
阵，因为”个顶点有nfl 个不同的顺序。
简单图的邻接矩阵是对称的，即 a, =a, ，因为当vw 和 相邻时，这两个项都是 1，否则都是
0。另外，因为简单图无环，所以每一项 a,都是0，i一1，2，3，…，m。
邻接抢阵也可用来表示带环和多重边的无向图。把顶点 w 上的环表示成邻接抢阵第(i，zi)位
置上的 1。当出现多重边时，邻接和矩阵不再是0-1和矩阵，这是因为邻接和抢阵的第(i，户项等于与
{a，o}关联的边数。包括多重图与伪图在内的所有无向图都具有对称的邻接矩阵 。
例5 用邻接矩阵表示图 6-32 所示的伪图。                 aa       已
解 ”顶点顺序为a，8，c，d 的邻接矩阵是
3 0 2
3011

0 11 2                四
     1 2 0              4    5
我们曾在第 5 章里用0 - 1和矩阵表示有向图。若有向图 G一(V，巨)    图 6-32 ”擅图
从二到w 有边，则它的矩阵在(it，力位置上有1，其中四,到，…，了节

是有向图任意的顶点序列。换句话说，若 A一[a,]是相对于这个顶点表的邻接矩阵，则
有  若{uwu)}是CG的一条边
和”lo 和理则

有向图的邻接矩阵不必是对称的，因为当从 w 到a, 有边时，从 a 到a, 可以没有边。

邻接矩阵也可用来表示有向多重图。同样，当有连接两个项点的同向多重边时，这样的矩阵
不是0- 1 矩阵。在有向多重图的邻接矩阵里，au, 等于关联到(w ，v ) 的边数。

在邻接表和邻接矩阵之间取舍“”当一个简单图包含的边相对较少，即该图是一个稀疏图
的时候，通常邻接表比邻接矩阵更适合表示它。例如，当每个顶点的度都不超过 c，c是一个
比 小很多的常数，则邻接表中的每一条链表都最多只含有(个节点。所以整个邻接表中的元
素不超过 om个。另一方面，m个顶点的图的邻接矩阵含有喷 个元素。但是，需要注意的是，
稀朴图的邻接矩阵是一个稀朴矩阵 ，即矩阵中只有少量元素不为0。有特别的技术专门表示和
处理稀疏矩阵。

现在设想一个稠密的简单图，它含有很多条边，例如，它含有的边数超过总的所有可能有的
边的一半。在这种情形下，用邻接矩阵来表示图就比用邻接表好。为了知道原因，我们来比较判
断某条边{tuw ，w }是否存在的复杂度。在邻接矩阵中，可以通过查看第(i, 7个元素来决定这条边
是否存在。如果该元素是 1 边就存在，如果是 0 边就不存在。所以，只需要一次比较，即将第
(Giy 轧个元素和 0 比较，就可以判断这条边是否存在。而另一方面，如果使用邻接表表示这个图，
就需要搜索 w 或 w 的链表中的顶点才能判断这条边是否存在。当图含有的边很多时，这和需要
BeC1V | )次的比较。



--- 第 274 页 ---
256 "第6章 图

 

6.3.4 关联矩阵
表示图的另一种常用方式是用关联和夫阵。设 G=(V，巨)是无向图。设 ww，也，…，了凡是顶点
而e, ，e  ，…，e, 是边。则相对于V 和五 的这个顺序的关联矩阵是mX关矩阵 M一[my ]，其中
用  当边 e 关联w 时
”to 和理则
例6 用关联矩阵表示图 6-33 所示的图。
解 ”关联矩阵是
el er 6 el e5 es
mi   1 0 000
加|001101
mW和|I000011    加  Y Y
Il01000
wwlolollo0         图 6-33 ”无向图

关联矩阵也可用来表示多重图边和环。在关联抢阵里用各项相等的列来表示多重边，因为这
些边关联同样一对顶点。用恰有一项等于 1 的列来表示环，它对应于环所关联的顶点。

例7 用关联矩阵表示图 6-34 所示的伪图。

解 ”这个图的关联矩阵是

el ez ez ee 6 2E56 ET

 

忆 11000000

ol1l1o110    四
wooo1l1o0o00

oo0000o0l

wooool1o000      图 6-34 伪图

6.3.5 图的同构

我们经常需要知道是否有可能以同样的方式来画出两个图。例如，在化学里用图为化合物建
模。不同的化合物可能分子式相同但结构不同。这样的化合物不能用以同样方式来画的图表示 。
表示过去已知化合物的图可以用来判定想象中的新化合物是否已经研究过了 。

对具有同样结构的图来说，存在着一些有用的术语。

2  设G一(w， 下 )和 C:一(V:， 开:)是简单图， 若存在一对一的和映上的从 W， 到 V， 的
函数 ff，且 具有这样的性质: 对 w, 里所有的a 和4来说，a和4在G 里相邻当且仅当ao)和
70)在 G:, 里相邻，就说 G, 与 G: 是同构的。这样的函数 广称为同构2 。

换句话说，当两个简单图同构时，两个图的顶点之间具有保持相邻关系的一一对应。

例8 证明: 图6-35 所示图 G=(V，E)和歹=(妈，F)同构。

解 顶数了满足Fa)一 ，Fa)一册，帮ia)一，Fx)一凤，它是V和殉之间的一一对
应。为了看出这个对应保持相邻关系，注意 G 里相邻的顶点是xz; 和罗，z 和由，凡 和司，以及
xz 和z，由ai)一妆 和Fe)一Fi)一册 和大(0)一加Fi)一WW 和Fux)一加，以及
Fu)一mm 和大w)一w 所组成的每一对顶点都是在 五 里相邻的。                            国

判定两个简单图是否同构常常是一件困难的事情。在两个带有 ”个顶点的简单图顶点集之间
有?za! 种可能的一一对应。若太大，则通过检验每一种对应来看它是否保持相邻关系是不可
行的。

 

所 ”同构(isomorphism)这个词来自两个希腊语字根，表示“相等"的 isos 和表示"形式”的 morphe。



--- 第 275 页 ---
第6意 图.257

- :gg :有时候要说明两个图不同构并不困难。特别地，如果能找到某个属性，两个图中只有
入” 一个图具有这个属性，且该属性只在讨论同构时使用，就可以说这两个图不同构。这
种保留在图的同构问题中使用的属性被称为图的非变体性。例如，同构的简单图必然具有相同的
顶点数，因为在这些图的顶点集之间有着一一对应。

同构的简单图必然有相同的边数，因为在顶点之间的一一对应建立了边之间的一一对应。另
外，同构的简单图的对应顶点的度必然相同。即图 G 中的过度顶点v 必然对应图 如 中的过 度顶点
jz ，这是因为在图 G 中顶点z 与v 相邻，当且仅当在图 互 中 fu)与 Fo)相邻。

例9 说明图 6-36 所示的图不同构。

户                                                   起

人1                         42                        Wi                                  V2                                 [玫                      SS

                                   已                          区                       所                          芝

3                     4                     3                              44
为                                                                  (人                                                  抹

图5-35 图C和万                    图6-36 图G和号

解 G和妃都具有5个顶点6条边。不过，G有1度顶点e而五没有1度顶点。所以G
与 互是不同构的。                                              国
项点数、边数以及顶点度都是在同构下的不变量。若两个简单图的这些量有任何不同，则这
两个图就不是同构的。不过，当这些量都相同时，也不一定意味着两个图同构。目前还没有已知
的用来判定简单图是否同构的不变量集。
例10 判定图6-37 所示的图是否同构。

台                   声      3                   了
可                   C       ，                   放
避                          轧
图6-37 图G和万

解 图G和媚都具有8个顶点10条边。它们都具有4个2 度顶点和4个3度顶点。因为这些
不变量都相同，所以它们可能会是同构的。
然而G和鼠不是同构的。为了看明白这一点，注意
到因为在 G里 deg(a)=2，所以 a 必然对应于互 里的!，   4
wu，xz或y?，这是因为这些顶点是 万里的 2 度顶点。不      时        ，。
过，瑟里的这 4 个顶点中的每一个都与 五里另一个 2 度
顶点相邻，但是在 G 里a 却不是这样的。
看出 G与妃 不同构的另一种方式是，注意到若这两   d
个图同构，则由 3 度顶点和连接它们的边所组成的子图
同构(读者应当验证它)。然而图 6-38 所示的这些子图却 “外册认C训和连关它们的这所



--- 第 276 页 ---
258 "第6章 图

不是同构的。                                   国

为了说明从图 G 的顶点集到图瑟 的顶点集的函数 了是一个同构，需要说明 了保持边的关系。
一种有助于这样做的方式是利用邻接和矩阵。具体地说，为了说明 是一个同构，就说明 G 的邻接
和矩阵与已 的邻接扼阵相同，其中 G 的邻接矩阵的行和列的标记都是G 里的顶点， 万 的邻接矩阵的
行和列的标记都是G 里的对应项点在三下的像。例 11 解释如何这样做。

例11 判定图 6-39 所示的图G和所是否同构。

解 G和瑟都具有6个顶点 ?7 条边，都
具有4个2度顶点和2个3度顶点。还容易看  局       |       呈9
出由2 度顶点和连接它们的边所组成的G 和
互 的子图是同构的(读者应当验证它)。因为
G和互对这些不变量来说是相同的，这就有
理由试着找出一个同构          区       如       时

现在定义晒数 f，然后判定它是否同构。      C         厅
因为 deg(zw )一2 而且 xz 不与任何其他 2 度顶
点相邻，所以 zu 的像必然是ww 或内，它们是
五里仅有的不与 2 度顶点相邻的顶点。任取 Fu ) 一内。(如果发现这个选择得不出同构，就接着
试验 wu )一办。)因为岂 与同 相邻, 所以凤 可能的像是ww 和癌。任取 zx, )一ww 。照这样继续下
去，用项点的相邻关系和度作为指引，令 Fi)一四，u) 一可， )一w，以及Fu)一友。现
在已经有了在 G的顶点集与 互 的顶点集之间的一一对应，即ju )一由， )一四，F太0)一ww
Cu一ua)一，以及Fu)一同。为了查看 了上是否保持边，就检查 G 的邻接和矩阵;

Mi za La 2 ts zc

0

图6-39 图G和万

荆
已呈一一人吕
呈 富有 一
司口王品一
呈避一尼 一
一 已产一一呈
乙一一口盖呈

0
以及用 G 里的对应顶点的像来标记行和列的 瓦 的邻接矩阵，
Wi

0 1 0

避 一避 有
|

乙定一定一
己 一局一

0
1
0
Vs | 1
0
0

忆一吓一下
一二一司品

忆 一 呈

和二

因为 Ac一Ar，所以 了是保持边的。由此得出 了是一个同构，所以 G与瑟是同构的。注意，
若事实证明 了不是一个同构，是无法得出G与五不是同构的，因为G和互 里的顶点的另一个对应
仍然可以是同构 。                                  力
- 2  判定两个图是否同构，已知的最好算法具有指数的最坏情形时间复杂性(对图的顶点数
”来说)。不过，解决这个问题的线性平均情形时间复杂性的算法已经找到，而且有希望
找到判定两个图是否同构的多项式最坏情形时间复杂性的算法。一种名为 NAUTY 的最佳实用算
法，在现代个人电脑上可在 1 秒钟之内判定带有 100 个顶点的两个图是否同构。可以在因特网上下
载 NAUTY 软件并用它做实验。



--- 第 277 页 ---
第6章 图"259

练习
在练习 1一2 中，用邻接表表示给定的图。
1.a      户           2
C       芝

 

Co

- 用邻接抢阵表示练习 1 里的图。
. 用邻接矩阵表示练习 2 里的图。
. 用邻接矩阵表示下列每一个图。

cn 产

a)K，           b) Ki            c)K:.
d)C，            eW，            fDQs
6. 画出用下面的邻接矩阵表示的图。
pol
0 0 10
1101
1 1 10

在练习7一8 中，用邻接矩阵表示给定的图。

 

9. 画出用下面的邻接矩阵所表示的无向图。

1] 2 0 1
2 0 3 0
0 3 1 1
1 0 1 0

在练习 10一11 中，求给定的有向图的邻接矩阵。

  

12. 画出用下面的邻接矩阵表示的图。

13. 每一个对称的和对角线全为0的0-1方阵是否都是简单图的邻接矩阵?
14. 用关联矩阵表示练习 7一8 中的图。



--- 第 278 页 ---
260"第6章 图

*15. 什么是无向图的邻接矩阵的一列里的各项之和? 对有向图来说呢?
16. 什么是无向图的关联答阵的一列里的各项之和? 对有向图来说呢?

在练习17一21 中，判定所给定的一对图是否同构。给出一个同构或给出不存在同构的严格证明。

 

22. 证明: 简单图的同构关系是等价关系。
23. 描述一下图的邻接矩阵里对应于孤立点的行和列 。
24. 证明: 带有 2个以上项点的偶图的顶点可以排序，使得邻接矩阵形如

[

其中所示的四项都是抢形块。

若简单图 G 和C 是同构的，则 G 称为自补图。
25. 求带有 5 个顶点的自补简单图。
26, 对哪些整数 ”来说C, 是自补图?
27. 带有5 个项点和 3 条边的非同构的简单图有多少个?
28. 带有下列邻接矩阵的简单图是否同构?

1 0 1  1 11
oo ra
10041  0 0 1
aljo o 1|,，|l1 oo    b)   ，
0001  oo 1
11ol oo
1110  1 1 0
1 1 0  1 0 1
|:ool leoo
 001 loool
11ololon



--- 第 279 页 ---
第6章 图。261

29. 把简单图的同构定义推广到包含环和多重边的无向图。
在练习 30一31 里，判定所给定的一对图是否同构。

到
30.、          让          由             ，              31.            1                             i
23          14          13   )            42            43        吕2             3

32. 证明: 若G和瓦是同构的有向图 则G和五的道(在 9. 2 节练习 61 之前定义)也是同构的。
33. 找出一对非同构的图，它们具有相同的度序列，但一个是偶图而另一个不是。
*34. 无向图的关联矩阵与它的转署之积是什么?

6.4 连通性

6.4.1 引言

许多问题可以用沿图的边旅行所形成的通路来建模。例如，判定在两个计算机之间用中间连
接能和否传递消息的问题，就可以用图模型来研究。利用图里的通路所组成的模型，可以解决投递
邮件、收取垃圾以及计算机网络诊断等有效规划路线的问题。

6.4.2 通路

非形式化地说，通路是边的序列，它从图的一个顶点上开始并且行经图的边，总是连接相邻
的顶点对。定义 1 给出通路的形式化定义和相关术语。

FE 设 ,是非负整数昌 G 是无向图。在G中从x到uv的长度为的通路是G 的m 条边

e，…，e 的序列，使得 扰e)一(三，思) 大e)一全，厂) 和Fe)一(zi， 六)，其中心一z
而xz,一v。当这个图是简单图时，就用顶点序列 z ，zi ，…，xz, 表示这条通路(这是因为列出这些
项点就唯一地确定了通路) 。若一条通路在相同的顶点上开始和结束，即 x一v且长度大于 0，则它
是一条回路。把这条通路或回路说成是经过顶点 zi ，z ，…，z，,或遍历边 。 ，e ，…，e, 。若通
路或回路不重复地包含相同的边，则它是简单的。

当没有必要区分多重边时，就用顶点序列 z ，z ，…，z, 表示通路e ，e ，…，e ，其中对

1一1，2，…， 来说，帮ee)一{z-， 六)}。这种记法仅仅指出通路所经过的顶点。经过这个顶点序
列可以有多条通路。注意长度为 0 的通路由单个顶点组成。

注意 关于定义 1 中的概念，有很多不同的术语。例如在有些书里，使用路径(walk) 而
不是通路(path)，这时路径被定义为图的顶点和边相互交替的序列，m，el，uw，e ，…，
Ti-i，es，u，其中由1和了牙是ei的端点，i一1，2，3，…，P。 当使用“路径?”这个术语时，
就会使用"闭合路径”(closed walk)而不是回路(circuit)来表示起始和终止于相同顶点的路
径; 使用路线(trail)来表示没有重复边的路径(代替“简单通路")。当使用路线这一术语
时，术语通路(path)通常就会用来表示没有重复顶点的路线，这与定义 1 中的术语相冲
突。由于这些术语上的各种变体，当你在特定的书或者文章中阅读有关遍历图的边的内
容时，需要弄清楚使用的是哪一组定义。文章[GrYe06]是关于本注释中提到的各替代术
语的一本好的参考文献 。

例1 在图6-40 所示的图里，a，qd，c，F，e是长度为 4 的简单通路，因为fae，dj ，{d，c)，
{c，及和({矿 e}都是边。但是 4，e，c，a 不是通路，因为{fe，c}不是边。注意 5，c，f，e，0 是长
度为4的回路，这是因为148，c}，{c，丰，{F，e}和{e，引都是边，这条通路在5 上开始和结束。
长度为 5 的通路 as，p，e，d，a，8不是简单的，因为它两次包含边{a，全 。              国



--- 第 280 页 ---
262"第6章 图

有向图里的通路和回路在第 5 章里介绍过。现在对有向多重图来定义这样的通路。

 

十》    设>是非负整数且G 是有向多重图。在G中从zx 到   da      尼      c
的长度为交的通路是G 的边的序列e,， ez eu 使得 Ce)一
(ro，zT)，Fe:)一(zi )，罗Ce)一(T_T)，其中ro一zx

而z,一w。当有向图里没有多重边时，就用顶点序列 zx ，zi ，…，
z, 表示这条通路。把在相同的顶点上开始和结束的长度大于 0 的
通路称为回路或图。若一条通路或回路不重复地包含相同的边，
则把它称为简单的。                        图 6-40 简单图

注意 由定义 2 给出的术语并非经常用来表示其中描述的概念。特别地，使用路径
(walk)、闭合路径(closed walk) 、路线(trail) 、通路(path)的术语(在定义1之后的注解中
介绍过)可能用来描述有向图。详见[GrYe06] 。

注意，通路上一条边的终点是这条通路上下一条边的起点。当没有必要区分多重边时，就用
项点序列 zx ，zi，…，xz, 表示通路el，e，…，e，其中对i=1，2，…, 7来说，太Ce ) 一
Cz-l， zi)。这种记法仅仅指出通路所经过的项点。可以有多条通路经过这个顶点序列。

通路表示许多图模型里的有用信息，如例 2~4 所示。

1 例2 熟人关系图中的通路 ”在熟人关系图中，如果相邻两个人彼此认识则将此二人连
” 接起来，形成一条人链。例如在 6. 1 节的图 6-7 中，有一条连接 Kamini 和 Ching 的6

个人的链。许多社会学家猜想，是否可以用只包含 5 个或更少的人的短链来连接世界上几乎每一
对人。这意味着世界上所有人的熟人关系图中几乎每对顶点都通过长度不超过 4 的通路来连接。
约翰，奎尔(John Guare)的戏剧《六度分离》(Sir Degrees o Separation)就是基于这个概念。     国
5 例3 合作图中的通路”在合作图中，如果表示作者的两个顶点 c 和已之间有从 a 开始
”到结束的一系列作者，使得每条边端点所表示的两个作者写过一篇联名论文，则 a 和
就通过一条通路而连接。在所有数学家的合作图中，数学家 靖的埃德斯数(在第 5 章补充练习 14
中用关系术语定义过)就是在 m 和代表成果极其丰富的数学家保罗“。埃德斯(1996 年去世)的顶点
之间的最短通路的长度。换名话说，一个数学家的埃德斯数就是从保罗。埃德斯开始到这个数学
家结束的最短的数学家链的长度，其中每一对相邻的数学家都联名写过论文。根据“埃德斯数项
目"，2006 年具有各个埃德斯数的数学家的数目如表 6-4 所示。                           国

表 6-4 具有给定埃德斯数的数学家的数目

 

上 例4 好莱坞图中的通路 ”在好莱坞图(参见6. 1 节例4)中，当存在连接两个顶点 a 和
”的演员链，其中在这个链上每两个相邻的演员都出演过同一部电影时，a 和”就被连
接。在好莱坞图中演员 c 的培根数定义为连接< 和著名演员凯文。培根的最短通路的长度。随着新
电影(包括凯文， 培根的新电影) 的不断产生，演员们的培根数也在不断地发生变化。表 6-5 中显
未的是从培根网站得来的 2006 年具有各个培根数的演员的数目。                                   国



--- 第 281 页 ---
第6意 图。263

表6-5 具有给定培根数的演员数

    
 

1 902
160 463
457 231
111310

  
   
 

业 四一

 
 

6. 4.3 无向图的连通性

若消息通过一个或多个中间计算机来传递，则计算机网络何时具有每对计算机都可共享信息
的性质? 当利用图来表示这个计算机网络，用顶点表示计算机而用边表示通信连接时，这个问题
就变成: 何时在图里任何两个顶点之间都存在通路?

ES 若无向图每一对不同的顶点之间都有通路，则该图称为连通的。

因此，在网络里任何两个计算机都可以通信，当且仅当这个网络图是连通的。

例S 图6-41 里的图 G, 是连通的，这是因为在每一对不同的顶点之间都有通路(读者应当验
证它) 。但是图 6-41 里的图 G, 不是连通的。例如，在顶点 c 和坟 之间没有通路。       国

在第 7 章里将用到下述定理。

E本到明 在连通无向图的每一对不同顶点之间都存在简单通路。

证 设x和vv是连通无向图G=(V，E)的两个不同的顶点。因为 G 是连通的， 所以ww和mv之
间至少有 1 条通路。设 rz ，zi ，…，xz, 是长度最短的通路的顶点序列，其中盖=v 而zx.一w。这条
长度最短的通路是简单的。为了看明白这一点，假设它不是简单的。则对满足 0过;< 的某个;和
j 来说，有 zx一立。这意味着通过删除项点序列 x ，…，xzr ,所对应的边，就获得了带有顶点序列

To TI Ti-rly TO TI 的从zx 到 的更短的通路。                         口
外 不连通的图是 2 个或 2 个以上连通子图之并，每一对子图都没有公共的顶点。这些不相
“”“ ， 交的连通子图称为图的连通分支。

例6 图6-42所示的图 五的连通分支是什么?
解 图妃是图6-42 所示的3个不相交连通子图 再 、瑟 和 瑟, 之并。这 3 个子图是 囊 的连通

分支。                                                                                       国
Q          力
廊，
上               一              有
C              G         必                         过          马
                          和一个
   -一
8          e          吉          上                               娘
Ci                    Cn:
图6-41 图CI 和Cs                    图 6-42 图所和人它的连通分支 妞| ，百:和 五，

1 例7 呼叫图的连通分支，当电话呼叫图(参见 6. 1 节例 7)中存在一系列从工开始到y

”结束的电话呼叫时，两个顶点 zx 和y 就属于同一个连通分支。当分析 AT&工 网络中特
定一天内发生的电话呼叫的呼叫图时，发现这个图具有 53 767 087 个顶点、超过1 亿?7 千万条边和
超过 370 万个连通分支。这些连通分支大多数都很小: 大约四分之三是由表示只在彼此之间呼叫
的一对电话号码的两个项点所组成。这个图具有一个包含 44 989 297 个顶点(占总数的 80%%)的户



--- 第 282 页 ---
264 "第6章 围

大的连通分支。另外，这个连通分支中每个顶点都通过一条不超过 20 个顶点的链连接到任何其他
顶点。                                                        国
有时删除一个顶点和它所关联的边，就产生带有比原图更多的连通分支的子图。把这样的顶
点称为审点(或节点)。从连通图里删除割点，就产生不  。    地    /   8
连通的子图。同理，把一旦删除就产生带有比原图更多
的连通分支的子图的边称为割边或桥。
例8 求出图 6-43 所示的图 G 的割点和制边。
解 图G的割点是2、c 和e。删除这些顶点中的一

个(和它的邻边) ，就使得这个图不再是连通的。割边是 “      “
{e，纱和{ce，e})。删除这些边中的一条，就使得 C 不再          图6-43 图G
是连通的。                                                     国

6. 4.4 有向图的连通性
根据是否考虑边的方向，在有向图里有两种连通性概念。
   若每当a 和5 都是一个有向图里的顶点时，就有从 到5 和从5到< 的通路，则该图

 

是强连通的。

为了让一个有向图是强连通的，从这个图里任何一个顶点到任何另外一个顶点必须存在有向

边的序列。  有向图可以不是强连通的但还是“一整块”。定义 5 准确地说明了这个概念。
全相”若在有向图的底图里，任何两个顶点之间都有通路，则该有向图是弱连通的。

有向图是弱连通的，  当且仅当在忽略边的方向时，任何两个顶点之间总是存在通路。显然，
任何强连通有向图也是弱连通的。

例9 图6-44 所示的有向图G和互 是否为强连通的? 是否为弱连通的?

解 C是强连通的，因为在这个有向图里，任何两  。
个项点之间都存在通路(读者应当验证它)。因此 G 也是
弱连通的。图 五不是强连通的，在这个图里，从 a 到2
没有有向通路。但是 媚是弱连通的，因为在 五的底图
里，任何两个顶点之间都有通路(读者应当验证它) 。国

 

有向图 G 的子图是强连通的而不包含在更大的强连 “       4       4
通子图中，即极大强连通子图，可称之为 G 的强连通分         5                 几
支或强分支。                                           图 6-44 有向图G和呈

例10 图6-44 中的图 刀有3个强连通分支，包括: 顶点 a; 顶点ef 由顶点b5、c和d 以及边
(，c) 、(c，d) 和(dt，纪所组成的图。                                      国
2 例11 网络图的强连通分支 ”6.1节例8 介绍的网络图用顶点表示网页并且用有向边表

示链接。网络在 1999 年的快照产生了具有 2 亿个项点和 15 亿条边的网络图(参见
[Br00]来了解详情) 。网络图的底无向图不是连通的并且有一个连通分支包含了这个图中大约 90色
的顶点。底无向图的这个连通分支所对应的原来有向图的子图(即具有相同的顶点以及连接这个图
中项点的所有有向边)有一个非常大的强连通分支和许多小的强连通分支。前者称为这个有向图的
巨型强连通分支。可以遵循从这个分支里任何其他网页开始的链接来到达这个分支里的某一个网
页。已经发现这项研究产生的网络图里的巨型强连通分支有超过 5300 万个顶点。这个无向图的大
型连通分支里的其余顶点表示 3 种不同类型的网页: 可以从巨带强连通分支里的网页来到达，但
是不能通过一系列链接来返回前面这些网页的网页，可以通过一系列链接来返回巨型强连通分支
里的网页，但是不能通过巨型强连通分支里网页上的链接来到达的网页; 婚不能到达巨型强连通
分支里的网页，也不能通过一系列链接从巨型强连通分支里网页来到达的网页。在这项研究里，
发现其余这三个集合中每个都具有大约 4400 万个顶点(这三个集合都接近同样的规模，这是相当
令人惊讶的) 。                                                     国



--- 第 283 页 ---
第6章 图"265

6.4.5 通路与同构

有多种方式可以利用通路和回路来帮助判定两个图是否同构。例如，具有特定长度的简单回
路的存在性，就是一种可以用来证明两个图是不同构的有用的不变量。另外，可以利用通路来构
造可能的同构映射。

前面指出过，简单图的一个有用的同构不变量是长度为&的简单回路的存在性，其中上是大于
2 的正整数。例 12 说明如何用这个不变量来证明两个图不同构。

例 12 判定图 6-45 所示的图 G 和吾 是否同构。

解 G和囊都具有6个顶点和8条边。各自具有4    o       wi
个3度顶点和2个2度顶点。所以对两个图来说有 3 个
不变量(顶点数、边数以及顶点度)都是相同的。但是有 ws        ua        oa
有长度为 3 的简单回路，即 ww ，岂，内，w，而G没有
长度为 3 的简单回路(G 里的所有简单回路的长度至少为     ，
4) 。因为长度为 3 的简单回路的存在性是一个同构不变

量，所以G和古不同构。           图     YY        YY

我们已经说明了如何用某种类型的通路，即具有特
定长度的简单回路，来证明两个图是不同构的。还可以      图6-45 图G和古
用通路来求出潜在的同构映射。

例13 判定图 6-46 所示的图G和互 是否同构。

解 G和互都具有5个顶点和6条边，都具有2个3度顶点和3个2度顶点，都具有1个长度
为 3 的简单回路，1 个长度为4的简单回路，以及 1 个长度为 5 的简单回路。因为所有这些同构不
变量都是相同的，所以G和互 可能是同构的。为了求出可能的同构，沿着经过所有顶点并且使得
两图里的对应顶点的度都相同的通路前进。例如，G 里的通路zw ,ws，w，z，z 和已里的通路
va， zu，mW，u，u 都经过图里的每一个顶点，都在 3 度顶点上开始，都分别经过2 度顶点、3 度
顶点和 2 度顶点并且在 2 度顶点上结束。通过在图里沿     ua        加
着这些通路前进，定义映射 太 满足Fax )一，Fu)一
区，大aa)一，o)一加和Fu)一册。通过说明 太保     性  "5     ?3
持边，或者通过说明在顶点的适当顺序下CG和五 的邻接
和矩阵是相同的，读者就可以说明 了是一个同构，所以 G  4s   23    中   53
与五是同构的。               国     G        刀

图6-46 图G和五

6.4.6 计算顶点之间的通路数

在一个图里两个项点之间的通路的数目，可以用这个图的邻接矩阵来确定。

EEE量到 设G是带有相对于顶点顺序w ，了区，…，zuw 的邻接矩阵 A 的图(允许带有无向或有向
边、带有多重边和环)。从z 到ui 的长度为r 的不同通路的数目等于Ar 的第(i，疙项，其中->是正
整数。

证 用数学归纳法证明。设 @G是带有邻接矩阵 A 的图(假设 G的顶点具有顺序 w ，z ，…，
uw)。从六到 长度为1 的通路数是A的第(it，疙项，这是因为该项是从 w 到 的边数。

假设 A- 的第(i，力项是从 到 的长度为~的不同通路的个数。这是归纳假设。因为 A++:一
A'A，所以A~ :的第(i，7力项等于
。                                           pa 十ba 十十DoQw
其中心是人A 的第(i，A)项。根据归纳假设，如是从vw 到uw 的长度为r 的通路数。

从忆到六 的长度为~十1 的通路，包括从 w 到某个中间顶点 w 的长度为> 的通路以及从 w 到
z 的边。根据计数的乘法规则，这样的通路的个数是从 ~w 到ww 的长度为> 的通路数(即 各 )与从 内
到 的边数(即 au )之积。当对所有可能的中间顶点 求这些乘积之和时，根据计数的加法规则，



--- 第 284 页 ---
266 "第6章 图

就得出所需要的结果。                              口
例14 在图6-47 所示的简单图G里，从a到d 的长度为4的通路有多少条?
解 G的邻接矩阵(顶点顺序为wa，2#，c，d)是                     a      避
1 1 0
1 0 .01
和一
1 0 0 1
0 1 1 0             4    。
    4   1，   。
因此从 <到dd 和 ， 4)项 。因为           图6.47 图C
0 8 8 0
Ai+ 一
0 8 8 0
0 0 8

ER . 所以怡好有8 条从a到d 的、长度为4的通路。通过检查这个图，我们看出 c，6，a，

pb di ay bb ac di ap dp di ap dc di a ca pb di ac，a

c， di arcyd bd和ac， dc,d是8条从<到di的通路。                  国

定理 2 可以用来求出在图的两个顶点之间的最短通路的长度，还可以用来判定图是否连通(见
练习 25) 。

练习

1. 下述的每个顶点列表是否可以构成右图里的通路?” 哪些通路是简单的?   Q        尹        人
哪些是回路? 那些通路的长度是多少?
a)Q，e，力，C，力           b)ae，e，c，d，站，c，芭
c)e，古，Q，坟，户，e        dc，8，o，a， ec

在练习 2一3 里，判定所给的图是否连通。                            df         ee

人人

4, 熟人关系图的连通分支表示什么?

. 解释一下为什么在数学家的合作图里，表示一个数学家的顶点与表示保罗。埃德斯的顶点是在同一个连通
分支里，当且仅当这个数学家具有有穷的埃德斯数。

6. 光世“下竹图是可是强连通的，  如果不是，  生下电是下是明连通的。

<m

 

a)a                   C         b) a
已                       达

7. 电话妊叫图的强连通分支表示什么?
8. 求下列每个图的强连通分支。

a) Q   旋   C

|

 仁直



--- 第 285 页 ---
9.

10.

11.

12.
13.

14，

#]16.
#]7.。
. 若网络里的通信连接故障会导致不能传送某些消息，则应当提供备份连接。对下面(a)和(b)里所示的通

第6章 图"267

c) Q     心     C     过     e

   及   8   上了
求出 K, 里两个不同项点之间长度为的通路的数目，若”是
a)2          b)3          c)4          d)5

运用通路要么证明这两个图不是同构的，要么找出这两图之间的一个同构。
妈     12              全     V2
28              5    8              V3
&7                  24     V7                  4
26    45             6     5
C                   九

运用通路要么证明这两个图不是同构的，要么找出这两图之间的一个同构 。

Vi

V3
G               万

对练习 9 里的?=值来说，求出 Ka:.:里任意两个不相邻顶点之间长度为二的通路的数目。
设 G一(V，忆)是简单图。设尺是V 上的关系，它是由这样的顶点对(x，z)所组成的，使得存在从x 到
的通路或使得“一v。证明: 尺是一个等价关系。

在练习14一15 里，求所给图的所有割点。

G      过      e                15. 4      户      了

人                           co <

心        C        也                                                      如
可        磊

假设"是一条割边的端点。证明: v是割点当且仅当它不是悬挂点。
证明: 在至少有 2个顶点的简单图中，至少有 2 个顶点不是割点。

 

信和网络来说，确定出那些应当有备份的连接。
a)

 

洛杉矶



--- 第 286 页 ---
268" 第6 章

b)            班和
西雅图 。“ 波特兰       伯灵上顿

 
  
 

                                                                                                                                                                                                                 

丹佛 ”芝加哥
RE 也   之

     

洛杉矶

一个有向图里的顶点基是顶点的一个集合，使得到该有向图里该集合之外的任何顶点，都有从该集合里
某个项点开始的一条通路，并且该集合里任何两个顶点之间都没有通路。
19. 在影响图(在 6. 1 节例 3 里描述)里顶点基的重要性是什么? 找出在该例里的影响图的顶点基。
*20. 证明: 若简单图 G 有上& 个连通分支，而且这些分支分别具有 ma，ma ，…， 闭个顶点，则 G 的边数不超过

生
> Cu ,2)

*21. 证明: 若带且个顶点的简单图G 具有超过("一1)(z一2)72 条边，则它是连通的。
22. 当?取如下值时，存在多少个不同构的、带有个顶点的连通简单图?
a)2                b)3                C) 4                d)5
23. 用定理 2求出图 6-40 里的多重图从 < 到了的最短通路的长度。
吕24. 设 P, 和P 是简单图 G里项点x 和 之间的没有相同边的两条简单通路。证明: 在G里存在简单回路。
25. 解释一下如何用定理 2 判定图是否连通。
26. 证明: 简单图 G 是偶图，当且仅当G 没有包含奇数条边的回路。

6.5 欧拉通路与哈密顿通路

6.5.1 引言

能否从一个顶点出发沿着图的边前进，恰好经过图的每条边一次并且回到这个顶点? 同样，
能否从一个顶点出发沿着图的边前进，恰好经过图的每个顶点一次并且回到这个顶点? 虽然这两
个问题有相似之处，但是对于所有的图来说，可以轻而易举地回答第一个关于是否具有欧拉回路
的问题，却非常难以解决第二个关于是否具有哈密顿回路的问题。本节将研究这些问题并且讨论
这些问题的难点。虽然两个问题在许多不同领域里都有实际应用，但是都来源于古老的智力题。
下面将介绍这些古老的智力题以及现代的实际应用。

6.5.2 欧拉通路与欧拉回路

2 普鲁士的哥尼斯堡镇(现名加里宁格勒，属于俄罗斯共和国)被普雷格尔河支流分成四
”部分。这四部分包括河两岸、河中心岛以及两条支流之间的部分。在 18 世纪这四部分

用七座桥连接起来，如图 6-48 所示 。

 

图 6-48 哥尼斯保七桥



--- 第 287 页 ---
第6章 图.269

镇上的人们在周日里穿过镇子进行长距离的散步。他们想和弄明白是否可能从镇里某个位置出
发不重复地经过所有桥并且返回出发点。
瑞士数学家列晶哈德，欧拉解决了这个问题。他的解答发     c
表在 1736 年，这也许是人们第一次使用图论。欧拉利用多重
图来研究这个问题，其中用顶点表示四个部分，用边表示桥，
如图 6-49所示。
不重复地经过每一座桥来旅行的问题可以利用这个模型来    A     DD
重新叙述。问题变成: 在这个多重图里是否存在着包含每一条
边的简单回路?
定义  图CG里的欧拉回路是包含着G 的每一条边的简单
回路。图 G 里的欧拉通路是包含着 G 的每一条边的简单通路 。     2
例 1 和例 2 解释了欧拉回路和欧拉通路的概念。      图 6-49 哥尼斯堡镇的多重图模型
例1 在图6-50 里，哪些无向图具有欧拉回路? 在没有欧拉
回路的那些图里，哪些具有欧拉通路?

户   妈     二   妇

 

C       过           C       己           过           已
CGI                  CO>                        Ca
图 6-50 无向图 G ，G: 和 G:

解 图G 具有欧拉回路，例如a，e，c，d，e，5，a。G 和 G, 都没有欧拉回路(读者应当验证
它)。但是 G, 具有欧拉通路，即 o，c，d，e，5，d，a，5。G, 没有欧拉通路(读者应当验证它) 。 国
例2 在图6-51 里，哪些有向图具有欧拉回路? 在没有欧拉回路的那些图里，哪些具有欧拉通路?
解 图瑟, 具有欧拉回路，例如a，g8，c，6，&g，e，d，j，a。媚 和 媚, 都没有欧拉回
路(读者应当验证它)。瑟, 具有欧拉通路，即 c，a，28，c，d，5，但是 瑟, 没有欧拉通
路(读者应当验证它) 。                                                 于
欧拉回路和欧拉通路的充要条件 对判断多重图是否具有欧拉回路和欧拉通路来说，存在着
简单的标准。欧拉在解决著名的哥尼斯堡七桥问题时发现了它们。假设在本节里讨论的所有图都
具有有穷多个项点和边。
若一个连通多重图具有欧拉回路，则它有什

Q    户
么性质呢? 可以说明的是; 每一个顶点都必有偶 4   4          有  :
数条边。为此，首先注意-一条欧拉回路从顶点 a  | |  ， 人ys   斌
开始，接着是 < 关联的一条边，比方说{fe，乡。边
{a，b}为 deg(a)贡献 1 度。这条回路每次经过一     。        ~人、

个项点就为该顶点的度贡献 2 度，这是因为这条 六             忆

双    心

回路经过关联该顶点的边进入，又经过另一条这
样的边离开。最后，这条回路在它开始的地方结     图 6-51 有向图 厅 ，有再; 和 媚，
束，为 deg(a) 贡献 1 度。因此 deg(a)必为偶数，
这是因为当回路开始时它贡献 1 度，当回路结束时它贡献 1 度，每次经过 a 都贡献 2 度(如果它又
经过了 a)。除 a 外的其余项点都有偶数度，这是因为每次回路经过一个顶点就为该顶点的度贡献 2
度。由此得出结论若连通图有欧拉回路，则每一个顶点必有偶数度。

欧拉回路的存在性的这个必要条件是否也是充分的? 即若在连通多重图里所有顶点都有偶数



--- 第 288 页 ---
270。第6 章

度，则是否必有欧拉回路? 这个问题可以通过构造来解决。

假设 G 是连通多重图而且 G 的每一个顶点都有偶数度。构造从 G 的任意顶点a 开始的简单回
路。设 一a。首先任意地选择一条关联 a 的边{m ，z}。通过建立尽量长的简单通路{zs，z }，
{m，z)，…，{z 1，z}来继续构造。例如，在图 6-52 的图G里，从 a 开始而且连续地选择边
{tae，刀，{F，c}，{c，b和(2，a) 。

这样的通路必然结束，这是因为图的边数是有
穷的。它在a 上以形如{a，z)}的边开始，而且在 a
上以形如{y，aj}的边结束。这是因为通路每次经过
一个偶数度顶点时，它只用 1 条边进入这个顶点，
所以至少还剩下 1 条边让通路离开这个顶点。这条
通路可能用完了所有的边，也可能没用完。

车所有的边都已经用完，则欧拉回路已经构造
好了。和否则，考虑通过从 G 里删除已经用过的边和
不关联任何剩余的边的顶点这样所得到的子图 百。          <                “

当从图 6-52 里的图删除回路 cc，，c<，5，a 时，      图 6-52 构造G里的欧拉回路
就得到标记为 互 的子图 。

因为 CG是连通的，所以 瑟 与已经删除的回路至少具有 1 个公共顶点。设 凤是这样的顶点(此
例中ec是这个项点) 。

互里的每一个顶点都有偶数度。(因为 G 里的所有顶点都有偶数度，对每个项点来说，把与这
个顶点关联的边成对地删除，以便形成 万。.)注意 妃可能是不连通的。像在 G 里做过的那样，在 ze
上开始，通过尽可能地选择边来构造 互 里的简单回路。这条回路必然在 w上结束。例如，在
图6-52里，c，d，e，c是五里的回路。下一步通过把 囊 里的回路与G 里原来的回路拼接起来形
成G 里的回路(这是可行的，因为 双 是这个回路的顶点之一) 。当在图 6-52 的图里这样做时，就得
到回路 ae，F，c，d，e，c，b，a。

继续进行这个过程，直到已经用完了所有的边为止(这个过程必然结束，这是因为图里只有有
穷的边数) 。这样就产生出欧拉回路。这样的构造说明，若连通多重图的顶点都有偶数度，则该图
具有欧拉回路。

把这些结果总结成定理 1。

 连通多重图具有欧拉回路当且仅当它的每个顶点都有假数度 。

现在可以解决哥尼斯堡七桥问题了。因为图 6-49 所示的表示这些桥的多重图具有 4 个奇数度
顶点，所以它没有欧拉回路。从给定点开始、恰好经过每座桥一次并返回开始点是无法实现的。

算法 1 给出了在定理 1 之前的讨论里所给的求欧拉回路的构造过程。(因为这个过程里的回路
是任意地选择的，所以存在一些不确定性。这里不再通过更精确地说明过程的步骤来消除这些不
确定性。)

 

算法1 构造欧拉回路

procedure xler(CG: 所有顶点有偶数度的连通多重图)

circuiti 二在CG里任选的顶点开始， 连续地加和人边所形成的回到该项点的回路
五 : 一删除这条回路的边之后的 G

While 万 还有边

begin
supbcircait : 一在既是 五 里的顶点也是 circxit 的边的端点处开始的互 里的一条回路
王 :二删除 supcircuir 的边和所有孤立点之后的互
circait ; 一在适当顶点上搬人 szupcircxit之后的circzx这

end{f circui 是欧拉回路}

 



--- 第 289 页 ---
第6章 图*。271

下一个例子说明如何利用欧拉通路和欧拉回路来解决一种类型的智力题。

例3 ”有许多智力题要求用铅笔连续移动，不离开纸面并且不重复地画出图形。利用欧拉回路
和欧拉通路来解决这样的智力题。例如，能否用这样的方法画出图 6-53 所示的物罕软德短查刀?
其中图形是在同一个顶点上开始和结束。

解 ”可以解决这个问题，因为图 6-53 所示的图 G 具有
欧拉回路。它具有这样的回路是因为它的所有顶点都有偶数
度。 用算法 1 来构造欧拉回路。 首先形成回路 a，D，d，c，
6，e，i，丰，e，a。通过删除这条回路的边并且删除因此产
生的孤立点，就得到子图 万。然后形成 万里的回路d，&S，
九，j ，i， 天，大，g，丰，d。形成这条回路之后就用完了 G 里            G
的所有边。在适当的地方拼接这条回路和第一条回路，就产     有
生出欧拉回路 a，6，d，g，A， 站 证 Ag    图 6-53 稳罕默德短弯刀
0，e，i，丰，e，a。这条回路给出了铅笔不离开纸面并且不重复地画出次刀的方法。         图

构造殉拉回路的另一个算法称为弗勒里算法，在本节末尾的练习里描述它。

现在说明，连通多重图具有欧拉通路(不是欧拉回路)当且仅当它恰有 2 个奇数度顶点。首先
假设连通多重图有从 < 到“的欧拉通路，但不是欧拉回路。通路的第一条边为 a 的度贡献 1 度。通
路每次经过 “ 就为 的度贡献 2 度。通路的最后一条边为如的度贡献 1 度。通路每次经过总就为5
的度贡献 2度。所以a 和”的度都是奇数。每一个其他顶点都具有偶数度，这是因为每当通路经过
一个项点时，就为这个顶点的度贡献 2 度。

现在反过来考虑。假设这个图恰有 2 个奇数度顶点，比方说a 和0。考虑由原来的图和边
ta，引所组成的更大的图。这个更大的图的每一个顶点都有偶数度，所以具有欧拉回路。删除新
边就产生原图的欧拉通路。定理 2 总结了这些结果。

汪 连通多重图具有欧拉通路但无欧拉回路当且仅当它恰有 2 个奇数度顶点。

例4 图6-54所示的哪些图具有欧拉通路?

本光人7痪

图 6-54 三个无向图

解 Ci 恰有2个奇数度顶点，即和dz。因此它具有必须用避和< 作为端点的欧拉通路。一条
这样的欧拉通路是 4，a，6，c，d，5。同理，G, 恰有 2 个奇数度顶点，即六和<。因此它具有必
须用避和da 作为端点的欧拉通路。一条这样的欧拉通路是5，a，g，F，e，d，c，g，5，c， 和，d。
G: 没有欧拉通路，因为它具有 6 个奇数度顶点。                                  条

回到 18 世纪的哥尼斯堡，是否有可能在镇里某点开始，旅行经过所有的桥，在镇里其他某点
结束? 通过判定表示哥尼斯保七桥的多重图是否具有欧拉通路，就可以回答这个问题。 因为这个
多重图有四个奇数度顶点，没有欧拉通路，所以这样的旅行是不可能的。

有向图里欧拉通路和欧拉回路的充要条件，在本节末尾的练习里讨论 。

二 可以用欧拉通路和欧拉回路解决许多实际问题。例如，许多应用都要求一条通路或回

””” ”路，它要恰好一次地经过一个街区里的每条街道、 一个交通网里的每条道路、一个高
压输电网里的每个连接或者一个通信网络里的每个链接。 求出适当的图模型里的欧拉通路或欧拉
回路就可以解决这样的问题。例如， 如果一个邮递员可以求出表示他所负责投递的街道的图中的
欧拉通路，则这条通路就产生恰好一次经过每条街道的投递路线。 这个问题称为中国邮递员问题.

 

 



--- 第 290 页 ---
72 "第6章 图

以纪念在 1962 年提出这个问题的中国科学家管梅谷。参看[MiRo91j了解关于不存在欧拉通路时中
国邮递员问题的解的更多信息。

应用欧拉通路和欧拉回路的其他领域有: 电路布线、网络组播和分子生物学，在分子生物学
中欧拉通路用于 DNA 测序。

6.5.3 哈密顿通路与哈密顿回路
3 包含多重图每一条边恰好一次的通路和回路的存在性的充要条件已经得出。那么包含
“” 图的每一个顶点恰好一次的简单通路和回路的存在性的充要条件是否也能得出呢?

 

本  在图 G一(V， )里，  若V一{zo， TI z}并且对 0过1一1J委w 来说有
iTi， 则通路 z。， TI 1 T 称为哈密顿通路。 在图 G一(V，开)里， 若 zx， TI
Zz,_i，x7, 是哈密顿通路，则 rz ，z ，…，zr, _i，z，z(其中力1)称为哈密顿回路。

这个术语来自爱尔兰数学家威廉。罗万.哈密顿姑士在 1857 年发明的智力题。哈密顿的智力
题用到了木质十二面体(如图 6-55a 所示，十二面体有 12 个正五边形表面)，十二面体每个顶点上
的钉子，以及细线。十二面体的 20 个顶点用世界上的不同城市作标记。智力题要求从一个城市开
始，沿十二面体的边旅行，访问其他 19 个城市每个恰好一次，回到第一个城市结束。旅行经过的
回路用钉子和细线来标记。

因为作者不可能向每位读者提供带钉子和细线的木质十二面体，所以考虑一个等价的问题，
图 6-55b 中的图是否具有恰好经过每个顶点一次的回路? 它就是对原题的解，因为该图同构于包
含十二面体顶点和边的图。图 6-56 是哈密顿智力题的解。

区 侈

图 6-55 哈密顿的“周游世界"智力题       图 6-56 “周游世界"智力题的解

例5 6-57 里，哪些简单图具有哈密顿回路? 或者没有哈密顿回路但是有了哈密顿通路?

总过二|

图 6-57 三个简单图

解 G 有险密顿回路: se，6，c，d，e，a。G; 没有险密顿回路(从包含每一个顶点的任

何回路必然两次包含边{a，全可以看出这一点)，但是 G, 确实有哈密顿通路，即 <，56

<“，d。G, 既无哈密顿回路也无哈密顿通路，这是因为包含所有顶点的任何通路都必然多次包含边
{ta，引，{e，甩和{c，d)其中之一。                                        国
是否存在简单方式来判定一个图有无哈密顿回路或哈密顿通路?”初看起来，似乎应当有判定
这一点的简单方式，因为存在简单方式来回答一个图有无欧拉回路这样的相似问题。令人吃惊的



--- 第 291 页 ---
第6童 图"273

是，没有已知的简单的充要条件来判定哈密顿回路的存在性。不过，已经有许多定理对哈密顿回
路的存在性给出了充分条件。另外，某些性质可以用来证明一个图没有哈密顿回路。例如，带有 1
度顶点的图没有哈密顿回路，因为在哈密顿回路里每个顶点都关联着回路里的两条边。 另外，若
图中有 2 度顶点，则关联这个顶点的两条边属于任意一条哈密顿回路。此外注意，当构造哈密顿
回路而且该回路经过某一个顶点时，除了回路所用到的两条边以外，这个顶点所关联的其他所有
边不用再考虑。而且，哈密顿回路里不能包含更小的回路。

例6 证明图 6-58 里的图都没有哈密顿加路。  ， ， ，   ，     ，

解 C里没有哈密顿回路，因为G有1度硕点，
即e。现在考虑 所。因为顶点ae， 5,， qd 和*e 的度都为
2，所以这些顶点关联的每一条边都必然属于任意一

条哈密顿回路。现在容易看出 五 里不存在哈密顿回 “
路，因为任何这样的哈密顿回路都不得不包含 4 条关    C         几
联c 的边，这是不可能的。           面    图 6-58 两个没有哈密顿回路的图

例7 证明: 每当”3 时，K, 就有哈密顿回路。

解 ”从K, 里的任意一个顶点开始来形成哈密顿回路。以所选择的任意顺序来访问顶点，只要
求通路在同一个顶点开始和结束，而且对其他每个顶点恰好访问一次。这样做是可能的，因为在
反, 里任意两个顶点之间都有边。                           国

虽然还未发现任何有用的关于哈密顿回路存在性的充要条件，但很多充分条件已经找到了。
注意到一个图的边越多，这个图就越可能有险密顿回路。另外，加入边(而不是顶点)到已经有哈
密顿回路的图中就产生有相同哈密顿回路的图。因此，当加入边到图中时，特别是当确保给每个
顶点都加入边时，这个图存在哈密顿回路的可能性就更大了。这里叙述充分条件中最重要的两个。
这些条件是加布里尔。A。 狄拉克(Gabriel A. Dirac)在 1952 年和奥伊斯坦 。奥尔(Oystein Ore) 在
1960 年发现的。

生理一狄拉克定理 ”如果 G是带，个顶点的连通简单图，其中 *3，并且 G 中每个顶点的
度都至少为mw/2，则 G 有哈密顿回路。

ES 奥尔定理 如果G是带"个顶点的连通简单图，其中 x之3，并且对于 G 中每一对不
相邻的项点xx 和立来说，都有 deg(zx)十deg(z三xz，则 G 有哈密顿回路 。

本节末的练习 27 粗略介绍了奥尔定理的证明。狄拉克定理可以作为奥尔定理的推论来证明，
因为狄拉克定理的条件殖含了奥尔定理的条件。

奥尔定理和狄拉克定理都给出了连通简单图有哈密顿回路的充分条件。但是，这些定理没有
给出哈密顿回路存在性的必要条件。例如，图 C, 有哈密顿回路，但既不满足奥尔定理的假设也不
满足狄拉克定理的假设，读者可以验证这一点。

:ss 已知的最好的求一个图里的哈密顿回路或判定这样的回路不存在的算法具有指数的最
” ，坏情形时间复杂性(相对于图的顶点数来说) 。找到具有多项式最坏情形时间复杂性的
解决算法是 NP 复杂的，它的发现将具有重大意义，因为这意味着其他许多难题都会迎刃而解。

可以用哈密顿通路和哈密顿回路来解决实际问题。例如, 许多应用都要求一条通路或回路，
它要恰好一次地访问一个城市里的每个路口、一个设备网格里的每个管道交汇处或者一个通信网
络里的每个节点。求出适当的图模型里的哈密顿通路或哈密顿回路就可以解决这样的问题。著名
的旅行商问题要求一个旅行商为了访问一组城市所应当选取的最短路线。这个问题可归结为求完
全图的哈密顿回路，使得这个回路的边的权的总和尽可能小。

现在给出哈密顿回路在编码上的一种不太明显的应用。

例8 格雷码 ”旋转的指针的位置可以表示成数字的形式。一种方式是把圆周等分成 2" 段弧
并且用长度为”的位串给每段弧赋值。图 6-59 里显示出了用长度为 3 的位串来这样做的两种方式。

用?个接触点来确定指针位置的数字表示。每个接触点用来读出位置的数字表示中的一位。
图 6-60 针对图 6-59 里的两种赋值对此做了解释。

 



--- 第 292 页 ---
274，第6章 图

序

串里

寺

当指针靠近两段弧的边界时，在读出指针位置时可能发生错误。这可能引起读出的
一个大的错误。例如，在图 6-59a 的编码方案
里，若在确定指针位置的过程里发生了一个小

程里的错误的影响降到最低，用位串对 2" 段弧
的赋值，应当使相邻的弧所表示的位串只相差
一位。在图 6-59b里的编码方案的情况恰好就

的错误，则读出的位串是 100 而不是 011。所  AS
有三位都是错的! 为了把在确定指针位置的过

是这样的。在确定指针位置的过程里的一个错        引                  b)
误使给出的位串为 010 而不为 011。只有一位     图 6-59 把指针位置转换成数字形式
是错的。

此处第一位为1

此处第一位为1

此处第 位为1             下 :位为1
AN         此处第一位为1 ”此处第一位为1 人 此处第-位为!

此处第一位为1  EEG

此处第-=位为1                     此处第 -位为
图 6-60 指针位置的数字表示

1 格雷码是圆周的弧的一种标记，使得相邻的弧具有恰好相差一位的位串标记。在
”图6-59b里的赋值是一个格雷码。可以这样找出格雷码， 以下述的方式列出所有长度为
?的位串，使得每一个串与前一个位串恰好相差一位，而且最后        0     1

一个串与第一个位串恰好相差一位。可以用n 立方体 Q, 来为这

个问题建模。解决这个问题所需要的是 Q. 里的一条哈密顿回路      人

这样的哈密顿回路容易求出。例如，Q, 的一条哈密顿回路显示10

在图 6-61 里。这条哈密顿回路所产生的前后恰好相差一位的位         团     病
000     001

串序列是 000，001，011，010，110，111，101，100。
格雷码是以弗兰克，格雷的名字来命名的，20 世纪 40 年代，
格雷在贝尔实验室研究如何把数字信和号传送过程中错误的影响降
到最低时发明了它们。                 国  图 6-61 Q, 的哈密顿回路

练习

在练习 1一4 里，判定给定的图是否具有欧拉回路。当存在欧拉回路时构造出这样的回路 如果不存在欧
拉回路，就确定这个图是否具有欧拉通路，若存在欧拉通路则构造出这样的通路。
1.  心   刘                    2. ga       上



--- 第 293 页 ---
第6章 图"275

 

S

. 在加里宁格勒(哥尼斯堡现名)，除了 18 世纪的七座桥之外，还有另外两座桥。这些新桥分别连接区域 B
和C 以及区域妨和呈。是否有人能够经过加里宁格勒的九座桥恰好一次并且回到出发点?
6. 何时可以画出一个城市里街道的中心线而不重复经过街道(假设所有街道都是双向街道)?

在练习7一8 里，判定是否可以用一支铅笔连续移动，不离开纸面并且不重复地画出所示的图形。

衣

*9. 证明, 不带有孤立点的有向多重图具有欧拉通路而没有欧拉回路，当且仅当该图是弱连通的并且存在两
个项点，一个项点的人度比出度大 1 而另外一个项点的出度比人度大 1，其余每个项点的人度与出度都
相等。

在练习 10一12 里，确定所示的有向图是否具有欧拉回路。若存在欧拉回路，则构造出一条欧拉回路。
如果不存在欧拉回路，就确定这个有向图是否具有欧拉通路。若存在欧拉通路，则构造出一条欧拉通路 。

10. a               了            11. 4               访               CC

Nd
人AN

二               才                过               所

<m

 

13. 设计一个算法，构造有向图里的欧拉通路 。
14. 当不重复任何部分地画出练习 1一4 里的每个图时 ，求出铅笔必须离开纸面的最少次数。

在练习15一17 里，确定所给的图是否具有哈密顿回路。若有哈密顿回路，则求出这样一条回路。若没有
哈密顿回路，则论证为什么这样的回路不存在。

15. a                16.          a           六       &         17. &
人>              到             3
e            达                     邓        皮            过        的              上            已

18. 对哪些 m和7 值来说，完全偶图 K-.,具有了哈密顿回路?



--- 第 294 页 ---
276 "第6章

19. 对于下列每个图确定; (iD能否用狄拉克定理来证明这个图有了哈密顿回路，(记能和否用奥尔定理来证明这
个图有哈密顿回路;(谴)这个图是否具有哈密顿回路。

白 向办 世

*20. 证明: 每当?”是正整数时，就存在半阶格雷码，或者等价地证明: x*盖1 的?立方体Q, 总是具有哈密顿回
路。[提示: 用数学归纳法。 证明如何从 "一1 阶格雷码产生 ”阶格雷码。]

民交到 构造欧拉回路的弗留利算法是从连通多重图的任意一个项点开始，连续地选择边来形成一条回路。一
且选择了一条边，就删除这条边。连续地选择边，使得每条边从上一条边结束的地方开始，而且使得这条边
不是一条割边，除非别无选择。
*21. 用伪代码表达弗留利算法。
*22. 给出变化的弗留利算法来产生欧拉通路。

23, 证明: 带有奇数个项点的偶图没有哈密顿回路 。

马在国际象棋中是这样一种棋子，它的移动可以是水平两格加垂直一格，
或者是水平一格加垂直两格。即在(z，y)格子的马可以移动到 8个格子
(z士2,?士1)，(z士1，y士2)中的任何一个，只要这些格子是在棋盘上，如右
图所示 。

上卫徐 马的周游是马的合法移动的序列，马在某个格子上开始而且访问每个格
子恰好一次。若存在一种合法移动，它让马从周游的最后一个格子回到周游开
始的地方，则马的周游称为重返的。可以用图为马的周游建模，棋盘上每个格
子都用一个顶点来表示，若马可以在两个项点所表示的格子之间合法地移动，
则用一条边连接这两个项点。

24. 面出表示马在3X4棋盘上的合法移动的图。
*25. 证明: 存在马在3X4棋盘上的周游。
*26. 证明: 不存在马在4X4棋盘上的周游。

27, 本练习粗略介绍奥尔定理的证明。假设 G 是带有m 个项点的简单图,zx人三3，并且每当zx和>y是G 中不相

邻的项点时，deg(z)十deg(y)?。奥尔定理称在这些条件下 G 有哈密顿回路。

a)证明: 如果CG没有了哈密顿回路，则存在另一个带有与 G 相同顶点的图 瓦，可以这样来构造 媚: 加人边

到 CG 使得再加人一条边就产生 媚 中的哈密顿回路。[提示: 依次在 G 的每个顶点处加人不产生哈密顿
回路的尽可能多的边.]

b)证明: 在五中存在哈密顿通路 。

c设wy， um ，…，加是五中的哈密顿通路。证明:， deg(u )十deg(w )人三 并且至多存在 deg(uw )个顶点不

与 ww 相邻(包括 w 在内) 。

d)设 S$ 是与哈密顿通路上 w 相邻的每个顶点前面的顶点的集合。证明 S包含 deg(uw )个顶点并且 w人SS。

e)证明: S包含与w 相邻的顶点ww。这草含着存在连接 w 与 w-， 和了藉 与的边。

证明: (e)萄含着 轨，下天 mu 是G中的哈密顿回路。从这个矛盾

得出奥尔定理成立。

 

6.6 最短通路问题
6.6.1 引言
许多问题可以用边上赋权的图来建模。作为说明，考虑一下航线系统如何建模。如果用顶点



--- 第 295 页 ---
第6章 图"277

表示城市，用边表示航班。给边赋上城市之间的距离，就可以为涉及上距离的问题建模;， 给边赋上
飞行时间，就可以为涉及飞行时间的问题建模; 给边贱上票价，就可以为涉及票价的问题建模。
图6-62 显示了给一个图的边赋权的三种不同方式，分别表示距离 、飞行时间和票价。

波士顿

和

 

      
 

 

 6-62 ”为航线系统建模的带权图

给每条边赋上一个数的图称为带权图。带权图用来为计算机网络建模。通信成本(比如租用电
话线的月租费)、计算机在这些线路上的响应时间或计算机之间的距离等都可以用带权图来研究。
图 6-63 显示三个带权图，它们表示给计算机网络的图的边赋权的三种方式，分别对应于距离、响
应时间和成本 。

与带权图有关的几种类型的问题出现得很多。确定网络里两个顶点之间长度最短的通路就是
一个这样的问题。说得更具体些，设带权图里一条通路的长度是这条通路上各边的权的总和。(读
者应当注意，对术语长度的这种用法，与表示不带权的图的通路里边数的长度的用法，这两者是
不同的.)问题是: 什么是最短通路，即什么是在两个给定顶点之间长度最短的通路”例如，在图



--- 第 296 页 ---
278。第6章 图

 

响应时间                                                              波士顿

 

月租费

 

图 6-63 为计算机网络建模的带权图 “

6-62 所示带权图表示的航线系统里，在波士顿与洛杉矶之间以空中距离计算的最短通路是什么?
在波士顿与洛杉矶之间什么样的航班组合的总飞行时间(即在空中的总时间，不包括航班之间的时
间)最短? 在这两个城市之间的最低费用是多少? 在图 6-63 所示的计算机网络里，连接旧金山的
计算机与纽约的计算机所需要的最便宜的一组电话线是什么? 哪一组电话线给出旧金山与纽约之
间的通信的最短响应时间? 哪一组电话线有最短的总距离?

与带权图有关的另外一个重要问题是: 求访问完全图每个顶点恰好一次的、总长度最短的回
路。这就是著名的旅行商问题，它求一位推销员应当以什么样的顺序来访问其路程上的每个城市
恰好一次，使得他旅行的总距离最短。本节后面将讨论旅行商问题。

6.6.2 最短通路算法
三击贱: 求带权图里两个顶点之间的最短通路有几个不同的算法。下面将给出荷兰数学家下* 迪
 ”，克斯特拉在 1959 年所发现的一个解决无向带权图中最短通路问题的算法，其中所有的



--- 第 297 页 ---
第6章 图。279

权都是正数。可以很容易地将它修改后来解决有向图里的最短通路问题。

在给出这个算法的形式化表示之前将给出一个启发性的例子。

例1 在图6-64 所示的带权图里，a 和zx 之间的最短通路的长度是多少?

解 虽然通过观察就容易求出最短通路，但是需要  3  <
想出一些有助于理解迪克斯特拉算法的办法。要解决的
问题就是: 求从 a 到各个相继的顶点的最短通路，直到
到达 = 为止。                                      “4

从aa开始、(直到到达终点为止)不包含除 a 以外的
顶点的唯一通路是wa, 娟和a，qd&。因为wa,和ac，z的长    5
度分别为4 和2，所以4 是与a 最靠近的顶点。        图 6-64 “一个带权的简单图

可以通过查看(直到到达终点为赴)只经过a 和dt的
所有通路，来求出下一个最靠近 a 的项点。到8的最短通路仍然是ae，2，长度为4，而到 e 的最短
通路是ae，d，e，长度为5。所以，下一个与<最靠近的顶点是六。

为了找出第三个与 最靠近的顶点，只需要检查(直到到达终点为止)只经过了 ae，d 和 的那
些通路。存在长度为7到"的通路，即a，25%，c，以及长度为6到>z的通路，即ae，d，e，>xz。所以，
=是下一个与a 最靠近的顶点，而且到 = 的最短通路的长度为 6。                        国

例 1 说明了在迪克斯特拉算法里使用的一般原理。注意通过检查就可能求出从 < 到>* 的最短通
路。不过，无论对人还是对计算机来说，检查边数很多的图都是不切实际的。

现在将考虑一般问题: 在无向连通简单带权图里，求出a 与z 之间的最短通路的长度。迪克斯
特拉算法如下进行: 求出从 a 到第一个顶点的最短通路的长度，从au 到第二个顶点的最短通路的长
度，依此类推，直到求出从 < 到* 的最短通路的长度为止。

这个算法依赖于一系列的选代。通过在每次迭代里添加一个顶点来构造出特殊顶点的集合。
在每次迭代里完成一个标记过程。在这个标记过程里，用只包含特殊顶点的从“到也的最短通
路的长度来标记 ww。添加到特殊项点集里的顶点是尚在集合之外的那些顶点中带有最小标记的
顶点 。

现在给出迪克斯特拉算法的细节。它首先用 0 标记 a 而用ce标记其余的顶点。用记号 Lu,(a)=
0 和 Lu。(v)一cs表示在没有发生任何迭代之前的这些标记(下标 0 表示“第 0 次”迭代) 。这些标记是
从”到这些顶点的最短通路的长度，其中这些通路只包含顶点 ae。(因为不存在从 a 到其他顶点的
这种通路，所以ce是 a 与这样的顶点之间的最短通路的长度。)

迪克斯特拉算法是通过形成特殊顶点的集合来进行的。设 S, 表示在标记过程大次迭代之
后的特殊顶点集。首先让 S,=王条。集合 S,是通过把不属于 S,_-,的带最小标记的顶点x 添加到
中-:里形成的。 一旦把 x 添加到 S, 里，就更新所有不属于 S, 的顶点的标记，使得顶点 v在第
&个阶段的标记Letv)是只包含 S: 里顶点(即已有的特殊顶点再加上 四的、从 wa到uv的最短通
路的长度。

设v是不属于 S, 的一个项点。为了更新的标记，注意 L(m是只包含 S, 里顶点的从a 到
的最短通路的长度。当利用下面的观察结果时，就可以有效地完成这个更新:只包含 S, 里顶点的
从a 到"的最短通路，要么是只包含 S, ,里顶点(即不包括 “在内的特殊顶点)的从<到 的最短通
路，要么是在第&一1 阶段加上边(x，z)的从a到xz 的最短通路。换句话说，

Petayu) 一 min{ZiCayu) ,Laya)十zyu))

这个过程这样选代: 相继添加顶点到特殊顶点集里，直到添加> 为止。 当把 = 添加到特殊顶点
集里时，它的标记就是从“到>* 的最短通路的长度。在算法 1 里给出迪克斯特拉算法。随后将证明
这个算法的正确性。

   



--- 第 298 页 ---
280。，第6 章

 

算法 1 迪克斯特拉算法
procedure Dijkstra(G: 所有权都为正数的带权连通简单图)

{G带有顶点&一由，a，…，功二z和权双(u，站)，其中若1w，世}不是G里的边，则 zw(w ，z )一ce)
fori :一1 to7
Lu ) : 一co
LI(a) : 一0
S :一好
{现在初始化标记，使得 “ 的标记为 0 而所有其余标记为cc ，S 是空集合}
whilez和他 S
begin
4 : 一不属于 S 的L(o最小的一个顶点
SS:一SUfz
for 所有不属于 S 的顶点

证艺(z)十rz，z)<天Lv) then Lo) : 一直)十(az)
{这样就给 S 里添加带最小标记的顶点，并且更新不在 S 里的顶点的标记}
end{工(z)一从a 到>z 的最短通路的长度}

 

下面的例子说明迪克斯特拉算法是如何工作的。随后我们将证明这个算法总是产生带权图里
两个顶点之间最短通路的长度。
例 2 用迪克斯特拉算法求图 6-65a 所示的带权图里项点 a 与 x 之间最短通路的长度。

让 3tdcj di0(a.co)

(OO 24(o)     e 10{a.c.jd

 

图 6-65 用迪克斯特拉算法求从 a 到 z 的最短通路

解 图6-65里显示了迪克斯特拉算法求 o 与 z 之间最短通路所用的步骤。在算法的每次迭代
里，用圆圈圈起集合 S, 里的顶点。对每次迭代都标明了只包含 S,里顶点的从 a 到每个顶点的最短



--- 第 299 页 ---
第6章 图。281

通路。 当圆圈圈到=时， 算法终止。 找到从 ec到= 的最短通路是a， C 2 Le， Z， 长度为 13 。黑

注意 ”在执行迪克斯特拉算法时，为了更便于在每步里跟踪顶点的标记，有时可以用一
个表来代替、，而不再对每步都重新画出这个图。

下一步，用归纳论证来证明迪克斯特拉算法产生无向连通带权图里两个顶点 a 与z 之间最短通
路的长度。用下列断言作为归纳假设: 在第上次迭代里

(DS里的顶点vw(z天0)的标记是从 a 到这个项点的最短通路的长度。

(ii不在 S里的顶点的标记是(这个顶点自身除外)只包含 S 里顶点的、从w 到这个顶点的最短
通路的长度。

当&=0 时，在没有执行任何迭代之前，S={a}，所以从 a 到除 a 外的顶点的最短通路的长度
是ce。设是在第&十1 次迭代里添加到 S 里的顶点，使得v是在第上& 次迁代结束时带最小标记的
不在S 里的顶点(在该顶点不唯一的情形里，可以采用带最小标记的任意顶点) 。

根据归纳假设，可以看出在第 4十1 次和迭代之前，S 里的顶点都用从wu 出发的最短通路的长度
来标记。另外，必须用从 “到z 的最短通路的长度来标记w。假如情况不是这样、那么在第上次和2
代结束时，就可能存在包含不在 S 里的顶点的、长度小于 Lu)?的通路(因为 Lu)是在第上次迭代
之后、只包含 S 里顶点的、从“到 的最短通路的长度) 。设x 是在这样的通路里不属于 S 的第一
个顶点。则存在一条只包含 S里顶点的、从a 到zx 的长度小于L,(z)的通路。这与对vw的选择相予
盾。因此，在第 &十1 次适代结束时(iD成立。

设 “是在第&十1次迭代之后不属于 S 的一个顶点。只包含 S 里顶点的从au 到x* 的最短通路要
么包含w、要么不包含 v。若它不包含 w，则根据归纳假设，它的长度是世,(x)。若它确实包含 w，
则它必然是这样组成的: 一条只包含 S 里除v 之外的顶点的、从a到uv的、具有最短可能长度的通
路，后面接着从v到zx 的边。在这种情形里它的长度是 Lu)十zu(u，xz)。这样就证明了(ii)为真，
因为 工 (zi)一min{EL Cu)，L(w十zu，uw)) 。

已经证明了定理 1 。

 迪克斯特拉算法求出连通简单无向带权图里两个顶点之间最短通路的长度。

现在可以估计迪克斯特拉算法的计算复杂性(就加法和比较而言)。这个算法使用的和迭代次数
不超过 ”一1 次，因为在每次和迭代里添加一个顶点到特殊顶点集里。若可以估计每次迭代所使用的
运算次数，则大功告成了。可以用不超过 ”一1 次比较来找出不在 S, 里的带最小标记的顶点。于是
我们使用一次加法和一次比较来更新不在 S, 中的每一个顶点的标记，所以在每次迭代里的运算不
超过 2("一1)次，因为在每次选代里要更新的标记不超过 ”一1 个。因为迁代次数不超过 一1] 次，
每次迭代的运算次数不超过 2(n一1)次，所以有下面的定理。

 迪克斯特拉算法使用 O(z )次运算(加法和比较)来求出连通简单无向带权图里两个顶
点之间最短通路的长度。

6.6.3 旅行商问题
二 现在讨论与带权图有关的一个重要问题。考虑下面的问题: 一位旅行商想要访问 ”个
加    城市中每个城市恰好一次，并且返回到出发点。例如，假定这个旅行商想要访问底特
律、托莱多、萨吉诺、格兰特。拉皮滋以及卡拉玛祖(见图 6-66)。他应当以什么顺序访问这些城
市以便旅行总距离最短? 为了解决这个问题，可以假定旅行商从底特律出发(因为这个城市必须是
回路的一部分)，并且检查他访问其余四个城市然后返回底特律的所有可能方式(从别处出发将产
生相同的回路)。这样的回路总共有 24 条，但是因为往返路程距离相同，所以在求最短总距离时，
只需要考虑 12 条不同的回路即可。列出这 12 条不同回路和每条回路旅行的最短总距离。从表 6-6
可以看出，回路底特律-托莱多~卡拉玛祖-格兰特，拉皮滋-萨吉诺，对应 458 英里的最短总距离。
上面描述了旅行商问题的一个实例。旅行商问题求带权完全无向图里访问每个顶点恰好一次
并且返回出发点的总权数最小的回路。这等价于求完全图里总权数最小的哈密顿回路，因为在回



--- 第 300 页 ---
282 "第6章 图

路里访问每个顶点恰好一次。

 

图 6-66 ”说明五个城市之间距离的图

 

 

表 6-6
路 线                                                 总本离(英里)
底特律一托莱多一格兰特' 拉皮滋一萨吉诺一卡拉玛祖-底特律                             610
底特律-托菜多-格兰特，拉皮滋一卡拉玛祖一萨吉诺一底特律                             516
底特律-托莱多-卡拉玛祖一萨吉详一格兰特 拉皮滋一底特律                               588
底特律-托莱多-卡拉玛祖-格兰特，拉皮滋一萨吉诺一底特律                               458
底特律-托莱多一萨吉诺一卡拉玛祖一格兰特，拉皮汶一底特律                             540
底特律一托莱多一萨吉诺一格兰特* 拉皮汶一卡拉玛祖一底特律                                504
底特律-萨吉诺一托莱多-格兰特" 拉皮滋一卡拉玛祖一底特律                                598
底特律-萨吉诺一托莱多一卡拉玛祖一格兰特。拉皮滋一底特律                               576
底特律-萨吉诺一卡拉玛祖一托菜多一格兰特" 拉皮滋一底特律                             682
底特律一萨吉诺一格兰特' 拉皮滋一托莱多一卡拉玛棚一底特律                              646
底特律-格兰特。拉皮滋一萨吉诺一托莱多一卡拉玛祖一底特律                                670
底特律-格兰特* 拉皮滋一托菜多一萨吉诺一卡拉玛祖一底特律                                728

最直截了当的求解旅行商问题实例的方式是检查所有可能的哈密顿回路，并且挑出总权数最
小的一条回路。若在图中有 ?个城市，则为了求解这个问题，得检查多少条回路? 一旦选定了出
发点，需要检查的不同的哈密顿回路就有("一1)! 条，因为第二个顶点有 一1 种选择，第三个项
点有zx一2 种选择，依此类推。因为可以用相反顺序来经过一条哈密顿回路，所以只需要检查
Ca一1)172条回路来求出答案。注意(z一1)! /2 增长得极快。当只有几十个顶点时，试图用这种方
式来解决旅行商问题就是不切实际的。 例如，假如有 25 个顶点，那么就不得不考虑总共241 /2(约
为 3. 1X10”)条不同的哈密顿回路。假定检查每条哈密顿回路只花费 1 纳秒(10“秒) ，那么就需要
大约一千万年才能求出这个图里长度最短的一条哈密顿回路。

因为旅行商问题在实践和理论上都具有重要意义，所以已经投入了巨大的努力来设计解决它
的有效算法。不过，还没有已知的解决这个问题的多项式最坏情形时间复杂性的算法。进一步地，
假如这种算法找到了，那么许多其他难题(比如在第 1 章里讨论过的确定个变元的命题公式是否
重言式)也可以迎刃而解。这个结果是从 NP 完全性理论得出的(关于这个理论的更多信息请参考
[GaJo79]) 。



--- 第 301 页 ---
第6竟 图"283

当有许多需要访问的顶点时，解决旅行商问题的实际方法是使用近似算法。近似算法是这样
的算法，它们不必产生问题的精确解，取而代之的是保证产生接近精确解的解。即它们可能产生
带总权数 克 的哈密顿回路，使得 色近允'季cW，其中风 是精确解的总长度，而是一个常数。例
如，存在多项式最坏情形时间复杂人性算法使得 c=3/2。对于一般带权图和每个正实数上来说，总
是产生至多&倍于最优解的解的算法还是未知。假如这样的算法存在，那就可能证明 P 类等于NP
类，这是关于算法复杂人性的最著名的未解决问题。

在实际中,已经研究出这样的算法，它们可以只用几分钟的机时，就解决多达 1000 个顶点的
旅行商问题，误差在精确解的2%%之内。关于旅行商问题的更多信息，包括历史、应用和算法等，
见《离散数学的应用》(Appiicatiors o太 Discrete Mathematics)[MiRo91i]中关于这个主题的那一章。

练习
1. 对下列关于地铁系统的每个问题 ，描述一个可以用来解决这个问题的带权图模型。
a)在两站之间旅行所需要的最短时间是什么?
b)从一站到达另外一站所经过的最短距离是什么?
c)若把各站之间的票价求和就得出总票价，则在两站之间的最低票价是什么?
2. 求下面的带权图里 a 与 x 之间的最短通路的长度。
心    5    寺    5   了了

   

3. 在练习 2 的带权图中,ae 与 = 之间的最短通路是什么?
- 在图 6-63 所示的通信网络里，求下列每对城市的计算机中心之间的(距离)最短路线。
a)波士顿与洛杉矶      b)纽约与旧金山       c)达拉斯与日金山      d)丹佛与纽约
- 利用图 6-63 里给出的租费，求在练习 4 中成对的计算机中心之间月租费最便宜的路线。
: 推广求带权简单有向连通图里两个项点之间最短通路的迪克斯特拉算法，以便求出在顶点 a 与图中其余每 、
个顶点之间的最短通路的长度。
7. 在下图里的带权图说明新泽西的一些主要道路。图 as 说明这些道路上的城市之间的臣离; 图b 说明通行费。
a)利用这些道路，求在纽华克与卡姆登之间，以及在纽华克与五月角之间的距离最短的路线。
b)利用给出的道路图 求在本题部分(a)里成对城市之间就总通行费而言最便宜的路线。
纽华克

必

mm cn

  

a)                                                   b)
8. 哪些应用必须求出带权图里两个顶点之间的最长简单通路的长度?

< 可以用沿洛伊德算法来求出带权连通简单图里所有顶点对之间最短通路的长度。不过，不能用这个算
法来构造出最短通路(在下面，把无穷权赋给任何一对不被图中的边所连接的顶点上) 。



--- 第 302 页 ---
284 "第6章 图

算法2 弗洛伊德算法
procedure Floyd(G: 带权简单图)

{G 有顶点ww ，杰，…，人区 和权妆(ww，)，其中若(uw，)不是边，则 w(m ，相)一ce)》
fori : 一] toz
for ) : 一1 to 7
di aa): 一un)
forzi :一] to

for :一1 to mn
for& :一LI tom
证dvw， zu)十du，w)一do，了)
then dz ，w) 一Cu zu)十cu，四)
{d(uw，z)是在 w 与ww 之间的最短通路的长度}

 

 

9. 用弗洛伊德算法求图 6-65a 中带权图里所有顶点对之间的距离。
*10. 给出弗洛伊德算法为了确定在带有?个顶点的带权简单图里、所有项点对之间的最短距离而使用的运算
(比较和加法?次数的大 O估计。

11, 通过求出所有哈密顿回路的总权数并且确定出总权数最小的回路，来解决下图的旅行商问题。
如      3      书

地       了       [
12, 求访问下图里每个城市的机票总价最低的路线，其中边上的权是在这两个城市之间的航班所提供的最低
票价。
$329       底特律

   

AN
洛杉矶    丹佛

13. 构造一个带权无向图，使得对于访问某些顶点超过一次的回路来说，访问每个顶点至少一次的回路的总
权数是最小的。[提示: 存在带三个顶点的例子。]

6.7 可平面图

6.7.1 引言
5  ， 考虑把三座房屋与三种设施每种都连接起来的问题，如图 6-67 所示。是否有可能这样
“” 来连接这些房屋与设施，使得在这样的连接里不发生交叉? 这个问题可以用完全偶图

K:.来建模。原来的问题可以重新令述为: 能否在平面里画出 K,, ，使得没有两条边发生交叉?
本节将研究能否在平面里让边不交叉地画出一个图的问题。特别是，将回答这个房屋与设施

的问题。

图的表示方式有许多种。何时有可能至少求出一种方式来在平面里表示这个图而让边没有任

何交叉?

 

 若可以在平面里画出一个图而边没有任何交叉(其中边的交叉是表示边的直线或弧线
在它们的公共端点以外的地方相交)， 则这个图是可平面的。这种画法称为这个图的平面表示。

即使通常带交叉地画出了一个图，这个图也仍然可能是可平面的，这是因为有可能以不同的
方式来不带交叉地画出这个图。



--- 第 303 页 ---
第6章 图"285

 

 6-67 三座房屋与三种设施

例1 天,(如图6-68 所示，有两条边交叉)是可平面吗?

解 ”天, 是可平面的，因为可以不带交叉地画出它，如图 6-69 所示。                  男
图6-68 图K              图 6-69 不带交叉的图 呈，

例2 图6-70 所示的Q, 是可平面吗?

解 Q:是可平面的，因为可以画出它而没有任何边交叉，如图 6-71 所示 。           国
图 6-70 图QQ，              图 6-71 Q, 的一种平面表示

可以通过显示一种平面表示来证明一个图是可平面的。更难的是证明一个图是非可平面的。
下面给出一个例子说明如何以一种特别的方法来做到这一点。

例3 图6-72 所示的 天:.:是可平面吗?

解 ”在平面里画出 玉:.:而没有边交叉，任何这样的尝试都注定是失败的。现在说明这是为什
么。在 开:.:的任何平面表示里，顶点 w 和也 都必须同时与 w 和关 连接。这四条边所形成的封闭
曲线把平面分割成两个区域 RR 和 R: ，如图 6-73a 所示。顶点 w 属于 R, 或R。当 属于闭曲线
的内部 R， 时， 在 和 m 之间以及在 TY 和 不 之间的边， 把 玉， 分割成两个区域 尺: 和 Ra ， 如
 6-73b 所示。

下一步，已经没有办法来不交叉地放置最后一个顶点 w 。因为车 w 属于 R ，则不能不带交叉
地画出 w 和愉m 之间的边。若 w 属于 R ，则不能不带交叉地画出迪 和_w 之间的边。若 w 属于



--- 第 304 页 ---
286。第6章 围

R: ，则不能不带交叉地画出 w 和之间的边。

4                        V5                台1                        5

有Ri             Ri

84                   5                   Ve                                   a)                                    b)

图 6-72 图 KK:         图 6-73 证明 K:.:是非可平面的

当mw 属于 尽 时，可以使用类似的论证。请读者来完成这个论证。所以 ;是非可平面的。 国

例 3 解决了在本节开头所描述的设施与房屋的问题。不能在平面里连接这三座房屋与三种设
施而不发生交叉。可以用类似的论证来证明 K, 是非可平面的(见本节来的练习6) 。

图的平面性在电子电路的设计中有重要作用。可以用图来为电路建立模型，用顶点表示电路
的器件并且用边表示器件之间的连接。如果表示一个电路的图是可平面的，则可以把这个电路无
连接交叉地印刷在单个电路板上。当这个图不是可平面的时，就必须求助于成本更高的选项。例
如，可以把表示电路的图的项点划分成可平面子图。然后使用多层来构造这个电路。每当连接交
叉时就可以用绝缘线来构造电路。在这种情况下，重要的是以尽可能少的交叉来画出这个图。

6.7.2 欧拉公式

一个图的可平面表示把平面分割成一些面，包括一个无界的面。例如，图 6-74 所示的图的可
平面表示把平面分割成 6 个面并加以标记。欧拉证明过一个图的所有可平面表示都把平面分割成
相同数目的面。他是这样证明的: 求出可平面图的面数、顶点数以及边数之间的关系。

下一欧拉公式 设G是带e 条边和zv个顶点的连通可平面简单图。设~是G 的可平面表示
里的面数。则 rr一e一"十2 。

证 首先规定 G 的可平面表示。将要这样证明定理: 构造一系列子图 G ，G. ，…，G.=G，
相继地在每个阶段添加一条边。用下面的归纳定义来这样做。任意地选择一条 CG 的边来获得 G, 。
这样通过 G,-,获得 G,: 任意地添加一条与 C,-,里顶点相关联的边，若与这条边关联的另一个顶点
还不在 G,-,里，则添加这个顶点。这样的构造是可能的，因为 G 是连通的。在添加 e条边之后就
获得G。设一，e, 和zw, 分别表示G 的可平面表示所引导出的G, 的可平面表示的面数、边数和项
点数。

现在通过归纳来进行证明。对 G,来说，关系六=e 一忒十2 为真，因为=1，w 一2，而 ~ 一
1。这种情形如图6-75 所示。

图6-74 图的可平面表示的面        图 6-75 欧拉公式的证明中的基础情形

 

现在假定 r,.=e.一内十2。设{o.,;,，六,,}是为了获得 G,, 而添加到 G, 上的边。有两种情形需
要考虑。在第一种情形里，a, ,,和上总，都已经在 G, 里了。这两个顶点必然是在-个公共面 尺 的边
界上，和否则就不可能把边{a,;,,，六,, }添加到 G, 里而没有两条边交叉(并且 G,,,是可平面的) 。这
条新边的添加把 R 分割成两个面。所以，在这种情形里，r, 一"~,十1，e,， 一e十1，而且v ,=
过。因此，关系到面数、边数、顶点数的公式两边都恰好增加 1，所以这个公式仍然为真。换句话



--- 第 305 页 ---
第6章 图。287

说，r ,=e ,一ww十2。在图 6-76a 里说明这种情形。

Qm+1

bnyl

a)                                     b)
图 6-76 ”添加一条边到 C, 来产生 GC,+

在第二种情形里，新边的两个顶点之一还不在 G, 里。假定 ao,,,在G, 里但是六,不在 G, 里。
添加这条新边不产生任何新的面，因为 六;必然是在边界上有 a,: 的一个面里。所以，王+ 一mm。
另外，e, 一e,十1且 w+一内十1。关系到面数、边数、顶点数的公式两边都保持相等，所以这个
公式仍然为真。换句话说，r :=e 一w+十2。在图6-76b 里说明这种情形 。

已经完成了归纳论证。因此对所有?来说，都有 盖一e,一内十2。因为原图是在添加了 e 条边
之后所获得的图CG.，所以这个定理为真。                                    口

例4 解释欧拉公式。

例4 假定连通可平面简单图有 20 个顶点，每个顶点度都为3。这个可平面图的平面表示把平
面分割成多少个面?

解 这个图有 20 个顶点，每个顶点的度都为3，所以v=20。因为这些顶点的度之和 3v一
3，20一60 等于边数的两倍 2e，所以有 2e一60 或e王30。所以，根据欧拉公式，面数是

六一2一十2一30一20十2一12                 团

可以用欧拉公式来建立可平面图所必须满足的一些不等式。在下面的推论里给出一个这样的

不等式。

 

3 若C 是带e 条边和v个项点的连通可平面简单图，其中 v盖3，则 e委3v一6。
在证明推论 1 之前先用它证明下面这个有用的结论 。
有 若G是连通可平面简单图，则 G 有度数不超过 5 的顶点。
证 如果G有1个或2个项点，则结果为真。如果G至少有3个项点，则根据推论 1 知道e委
3一6，所以 2e委6v一12。假如每个顶点的度数至少是6，则由于 2e = >ydeg(z) (根据握手定理)，
pmE共

所以就有 2e>6v。但是这与 2e受6v一12 相矛盾。所以必定
存在度数不超过 5 的项点。                                 口

推论 1 的证明是基于面的次数的概念，它定义为这个
面的边界上的边数。当一条边在边界上出现两次(所以当描
画边界时就描画它两次)时，它贡献的次数是 2。图 6-77-
里显示出面的次数。

现在可以给出推论 1 的证明了。

证 画在平面里的连通可平面简单图把平面分割成面，
比如说 ~个面。每个面的次数至少为 3。(因为这里所讨论
的图都是简单图，不允许带有可能产生 2 次面的多重边，
或者可能产生 1 次面的环.)特别地，注意无界的面的次数

 

 

 6-77 面的次数



--- 第 306 页 ---
288 .第6 章

至少为3，因为在图里至少有三个顶点。
注意各面的次数之和恰好是图中边数的两倍，因为每条边都在面的边界上出现两次(或者在两
个不同面里，或者两次在相同面里)。因为每个面都有大于或等于 3 的次数，所以
2e = >， deg(R) 之 3r

所有区壤R
因此，
《27/3)e 二
利用 r=e一z十2(欧拉公式)，就得到
e一4十2近(2/3)e
所以 e/3委v一2。这样就证明了 e委3v一6。                                    口
可以用这个推论来证明 Ks 是非可平面的。
例$S 用推论 1证明: 并。 是非可平面的。
解 K;, 有 5 个顶点和 10 条边。不过，对这个图来说，不满足不等式 e生3v一6，因为 e=10
和 3z一6一9。因此，天; 不是可平面的。                                   转
前面已经证明了 开;.:不是可平面的。不过，注意这个图有 6 个顶点和 9 条边。这意味着满足不
等式 一9和12一3。6一6。所以，满足不等式 e生3v一6 的事实并不意味着一个图是可平面的。不
过，可以利用下面定理 1 的推论来证明 玉:,:不是可平面的。
SEE 若连通可平面简单图有。e 条边和个顶点，uw3 并且没有长度为 3 的回路，则

 

e委2v一4。

推论 3 的证明类似于推论 1 的证明，不同之处在于，在这种情形里，没有长度为 3 的回路的事
实蕴含着面的次数必然至少为4。把这个证明的细节留给读者(见本节末的练习 8) 。

例6 用推论 3 证明: K:.:是非可平面的。

解 ”因为天:没有长度为 3 的回路(容易看出这一点，因为它是偶图)，所以可以使用推论 3。
K: :有 6个顶点和9 条边。因为 e一9 和 2一4=8，所以推论 3 证明 开, ,是非可平面的。       图

6.7.3 库拉图斯基定理

我们已经看到 K:.: 和 天: 都不是可平面的。显然，若一个图包含这两个图作为子图，则它不是
可平面的。另外，所有非可平面图必然包含一个子图，它是可以利用某些允许的操作从 天, ,或 K，
来获得的。                                      -

车一个图是可平面的，则通过删除一条边{vw，丰并且添加一个新顶点 ww 和两条边{z，了mg}与
{z，直，所获得的任何图也是可平面的。这样的操作称为初等细分。若可以从相同的图通过一系
列初等细分来获得图 Ci一(V，天)和图 G:一(V: ，忆: )， 则它们称为是同胚的。

例7 证明: 图6-78 所示的图G，G, ，G:, 是同胚的。

解 ”因为这三个图都可以从图 C, 通过初等细分得到，所以它们是同胚的。G, 可以从它自身出
发，通过一个空的初等细分序列而得到。要从 G, 得到 G, ，采用如下初等细分序列，

1)删掉边{a，c} ，增加顶点 A，然后添加边{e，记和{太，c) 。

2)删掉边{2，c} ，增加顶点 g，然后添加边{15，g}和{g，c)} 。

3)删掉边{6，g} ，增加顶点 关，然后添加边{g，A} 和{疡,0) 。

把找出由 G 到 G, 的初等细分序列的任务留给读者。                           国

  

图 6-78 同胚图



--- 第 307 页 ---
第6章 图"289

波兰数学家库拉图斯基在 1930 年证明了下面的定理，这个定理用图同胚的概念刻画了可平面图。
四 一个图是非可平面的当且仅当它包含一个同胚于 天;.:或 KK 的子图。

显然，一个包含着同胚于 K:.:或 K, 的子图的图是非可平面的。不过，相反方向的命题一一即
每个非可平面图都包含一个同胚于 天.或 Ks 的子图一一证明起来是复杂的，因而不在这里给出。
下面的例子说明如何使用库拉图斯基定理。

例8 确定图 6-79 所示的图 C 是否是可平面的。

吕吕冯

 6-79 无向图 G、同胚于 K, 的子图 甩以及KK

.时这。，解”G有同胚于K* 的子图 互。囊是这样获得的: 删除 P，7 和A 以及所有与这些顶点

关联的边。互是同胚于天, 的，因为从 K,(带有顶点 ae，0，c，&g 和?i)通过一系列初等

细分，添加项点 d，e 和上就可以获得 娓(读者应当构造出这样的一系列初等细分)。因此，G 是非

可平面的。                                                     图

例9 在图 6-80a 中所示的彼得森图是可平面吗? (丹麦数学家朱利鸟斯。和披得森在 1891 年介
绍过这个图，它常用来说明关于图的各种性质的理论。)

了               矿    二    上
e                                    |         |
及           e           [1           入

a)                    b) 万                     C) 大33
图 6-80 a)和披得森图: b)同胚于 K:,:的子图 刀，c)K:，

解 ”彼得森图的子图 互是这样获得的: 删除上 和以6 作为端点的三条边，如图 6-78b 所示，
它是同胚于带有顶点集合{F，4d，四和{e，i，和的 天:的，这是因为可以通过一系列初等细分来获
得它，删除{d，A并且添加{fc，A和{c，dy，删除{e，户并且添加{a，e}和{ta，户，删除{i，放并
且添加{g&，寻和{g，让。因此，彼得森图不是可平面的。                         图

练习
1. 五座房屋能否不带连接交叉地与两种设施相连接?
2. 不带任何交叉地画出下面的可平面图。

 

 



--- 第 308 页 ---
290。第6章 图

在练习 3一5 里，确定所给的图是否可平面。若是可平面的，则画出它使得没有边交叉。
3.      |                 4.     Q    放             5.

 

6. 用类似于在例 3 里给出的论证来证明: K; 是非可平面的。

7. 假定一个连通可平面图有 6 个顶点，每个项点的度都为4。这个图的可平面表示把平面分割成多少个面?

8. 证明推论 3。

*9. 假定一个带有。e 条边和vv 个顶点的连通可平面简单图不包含长度为 4 或更短的回路。证明: 若 v4 则
e<(5/3)u一(10/3) 。

10. 下面的哪些非可平面图具有这样的性质: 删除任何一个顶点以及与这个顶点关联的所有边就产生一个可
平面图?
a)Ks               b)K。               c)K:              d)开;.。

11. 确定下面的图是否同胚于 K:.: 。

人           已            C
有 人 由 人
可
在练习 12一13 里，用库拉图斯基定理来确定所给的图是不是可平面的。
12. 4         声         C         过           13.

 

2 一个简单图的交叉数，是指当在平面上画出这个图(其中不允许任何三条表示边的弧线在同一个点交
叉)时交叉的最少次数。
*#14，求下面每个非可平面图的交叉数。
a) KK，         b)K。         c)K;
d) 天;        e)K        全氏:
*#15, 证明: 若和?都是偶正整数，则 天,的交叉数小于或等于 mm (mm一2)(nm一2)/16。[提示:，沿着 工轴放
置m个顶点，使得它们间距相等并且关于原点对称，再沿着 y 轴放置 = 个项点，使得它们间距相等并且
关于原点对称。现在连接轴上关个项点中的每一个与y 轴上 ” 个顶点中的每一个，并且计算交叉数。]

简单图 G 的厚度是指，以 G 作为它们的并图的G 的可平面子图的最小个数。
*16. 求练习 14 里的图的犁度 。
*]17. 在一个环面上画出 KK:.: ，使得没有边交叉 。



--- 第 309 页 ---
第6章 图"291

6.8 图着色
6.8.1 引言
2 在图论中，有许多与地图区域(比如世界各部分的地图)着色有关的理论成果。当为一

幅地图着色时8 ，具有公共边界的两个区域在传统上指定为不同的颜色。一种确保两个
相邻的区域永远没有相同的颜色的方法是对每个区域都使用不同的颜色。不过，这种方法效率不
高，而且在具有许多区域的地图上，可能难以区分相似的颜色。另一种方法是，应当尽可能地使
用少数几种颜色。考虑这样的问题: 确定可以用来给一幅地图着色的颜色的最小数目，使得相邻
的区域永远没有相同的颜色。例如，对图 6-81 左侧地图来说，四色是足够的，但是三色就不够
(读者应当验证这一点)。对图 6-81 右侧地图来说，三色是足够的(但是二色就不够) 。

图 6-81 两幅地图

平面里的每幅地图都可以表示成一个图。为了建立这样的对应关系，地图的每个区域都表示
成一个项点。若两个顶点所表示的区域具有公共边界，则用边连接这两个顶点。只相交于一个点
的两个区域不算是相邻的。这样所得到的图称为这个地图的对偶图。根据地图的对偶图的构造方
式，显然在平面里的任何地图都具有可平面的对偶图。图 6-82 显示对应于图 6-81 所示地图的对

偶图。
吾
昌
       s      5    性=
用                             半               天
忆
巨

 6-82 图6-81 地图的对偶图

给地图的区域着色的问题等价于这样的问题: 给对偶图的顶点着色，使得在对偶图里没有两
个相邻的项点具有相同的颜色。给出下面的定义。
2   简单图的着色是对该图的每个顶点都指定一种颜色，使得没有两个相邻的顶点颜色

 

通过对每个项点都指定一种不同的颜色，就可以着色一个图。不过，对大多数的图来说，可
以找到所用颜色数少于图中项点数的着色。什么是所需要的最少颜色数?

图的色数是着色这个图所需要的最少颜色数。

注意，求平面图的色数等于是求平面地图着色所需要的最少颜色数，使得没有两个相邻的区
域指定为相同的颜色。这个问题已经研究了 100 多年。数学里最著名的定理之一给出了它的答案。

  四色定理 平面图的色数不超过四。

 

扎 假定地图里所有区域都是连通的。这样就消除了像密歌根这样的地理状况所引起的问题，因为密软根州是由两个
分离的半岛组成的。                                                       .



--- 第 310 页 ---
292。第6章 图

ee

:和5 四色定理最早是作为猜想在 19 世纪 50 年代提出的。美国数学家肯尼思， 阿侯尔和沃尔
7 夫网。黑肯最终在 1976 年证明了它。在 1976 年之前，发表过许多不正确的证明，其中
的错误常常难以发现。另外，还尝试过画出需要超过四色的地图来构造反例，而这样做是无效的。
(证明五色定理就没有这样困难。)                   .

也许迄今为止在数学里最有名的错误证明就是伦敦的律师和业余的数学家艾尔弗雷德。肯普
在 1879 年所发表的四色定理证明。数学家们一直认为他的证明是正确的，直到 1890 年珀西“。希伍
德发现了一处错误，才发现肯普的论证是不完全的。不过，事实证明，肯普的推理路线是阿佩尔
和黑肯所给出的成功证明的基础。他们的证明依赖于计算机所完成的对各种情形的仔细分析。他
们证明，若四色定理为假，则存在一个反例，它是大约 2000 种不同类型中的一种，然后他们证明
这些类型都没有导致反例。在他们的证明中使用了 1000 多个小时的机时。计算机在证明过程中起
到如此重要的作用，由此引发了广泛的争论。例如，在计算机程序里有没有导致不正确结果的错
误? 假如论证依赖于或许不可靠的计算机得出，那么它是不是真正的证明?

注意，四色定理只适用于平面图。在例 2 里将证明非可平面图可以有任意大的色数。

证明一个图的色数为”需要做两件事。首先必须证明: 用”种颜色可以着色这个图。构造出这
样的着色就可以完成这件事。其次证明: 用少于”种颜色不能着色这个图。例 1 至例 4 说明如何求
出包数。

例1 图6-83所示的图G和已的色数是什么?

图 6-83 简单图G 和万

可 解 图G的色数至少为3，因为顶点 ae, 和* 必须为不同的颜色。为了看出是否可以

“用三种颜色来对CG 着色，指定 a 为红，6 为蓝，*c 为绿。于是，可以(而且必须)令 d 为

红，因为它与上和< 相邻。另外，可以(而且必须)令 e 为绿，因为它只与红色和蓝色顶点相邻，可
以(而且必须)令 /为蓝，因为它只与红色和绿色顶点相邻。最后，可以(而且必须)令 g 为红，因
为它只与蓝色和绿色的顶点相邻。这样就产生出恰好使用三种颜色的 G的着色，如图 6-84 所示。

5 鸦色        e 绿色                      5 蓝色绿色。
红色 <人3汉 > g 红色 红色 4               & 棕色
c 绿色 7 鸦色              “绿色 ， 了蓝色

图6-84 图CG和所的着色

图互是由图C 和连接< 与& 的一条边所组成的。用三种颜色来着色 五 的任何尝试都必须遵循
与着色 G 所用的同样的推理，不同之处是在最后阶段当除了 g 以外的所有项点都已经着色时，因



--- 第 311 页 ---
第6章 图"293

为g与红色、蓝色和绿色顶点(在 吾里)相邻，所以需要使用第四种颜色，比如棕色。因此，互的
色数为四。图 6-84 右图显示 互 的一  种着色。                                   国

例2 天, 的色数是什么?

解 通过给每个顶点指定一种不同的颜色，有用)种颜色可以构造多, 的着色。使用的颜色能否
更少一些? 答案是不能。没有两个项点可以指定相同的颜色，因为这个图的每两个顶点都是相邻
的。因此，五,的色数一za。(回忆一下，当 5 时 天,不是可平面图，所以这个结果与四色定理并
不矛盾。)在图 6-85 里显示使用五种颜色的 开。 的着色。                                 图

例3 完全偶图 KK的色数是什么? 其中 m和?都是正整数。

解 ”需要的颜色数似乎依赖于阅和?2。不过，仅仅需要两种颜色。个顶点为一种颜色，? 个
顶点为另外一种颜色。因为边都只能连接 m个顶点中的一个顶点与z个项点中的一个项点，所以

没有相邻的顶点具有相同的颜色。在图 6-86 里显示带有两种颜色的 类,的着色 。           草
6红色
dd黄色
图 6-85 关; 的着色                        图 6-86 天:,:的着色

例4 图C, 的色数是什么(3)? (回忆一下，C,是带有2 个顶点的圈图。)

解 首先考虑一些个别情形。首先，设 "一6。挑选一个顶点并且把它着色成红色。在图 6-87
所示的 Cs 的平面画法里顺时针前进。必须给到达的下一个顶点指定第二种颜色，比如蓝色。以顺
时针方向继续下去，可以令第三个顶点为红色，第四个顶点为蓝色，第五个顶点为红色。最后，
令第六个顶点为蓝色，它与第一个顶点是相邻的。因此，C, 的色数为2。图 6-87 显示这里构造的
着色 。

其次，设 "一5 并且考虑 C; 。挑选一个顶点并
且令它为红色。顺时针前进，必须给到达的下一个

顶点指定第二种颜色，比如蓝色。以顺时针方向继             人
续下去，可以令第三个顶点为红色，第四个顶点为

蓝色。第五个顶点既不能为红色也不能为蓝色，因           eg贡色   红色访<
为它与第四个顶点和第一个顶点都相邻。所以，对              蓝色

这个顶点就需要第三种颜色。注意，假如以着时针
方向对顶点着色，同样需要三种颜色。因此，GC:                    Cs
的色数是3。用 3 种颜色对 Cs: 着色见图 6-87。 6-87 “C; 和 Cs 的着色

在一般情形里，当 是偶数时，对 C,着色需要
两种颜色。为了构造这样的着色，简单地挑选一个顶点并且令它为红色。然后(利用图的平面表
示)以顺时针方向绕图前进，令第二个顶点为蓝色，第三个顶点为红色，依此类推。可以令第个
顶点为蓝色，因为与它相邻的两个顶点(即第 "一1 个顶点和第一个顶点)都是红色。

当半是奇数而且”>>1 时，C,的色数为3。为了看出这一点,挑选一个初始顶点。为了只用两
种颜色，当以顺时针方向遍历这个图时，必须交替使用颜色。不过，所到达的第 ”个顶点与带不
同颜色的两个顶点(第一个顶点和第 "一1 个顶点)相邻。因此，必须使用第三种颜色。       轿
和 已知最好的求图的色数的算法(对图的顶点数来说)具有指数的最坏情形时间复杂性。

 ”即使求图的色数的近似值也是很难的。已经证明，假如存在具有多项式最坏情形时间

 



--- 第 312 页 ---
294。第6章

复杂性的、可以达到 2 倍地近似图的色数的算法(即构造出一个不超过图的色数的两倍的界限)，
那么也存在具有多项式最坏情形时间复杂性的求图的色数的算法。

6.8.2 图着色的应用

图着色在与调度和分配有关的问题中具有多种应用。(注意，由于不知道图着色的有效算法，
所以这并不能得出调度和分配的有效算法.)在这里将给出这样的应用的例子。第一个应用是用来
安排期末考试。

例5 安排期末考试 ”如何安排一所大学里的期末考试，使得没有学生同时要考两门试?

解 ”这样的安排问题可以用图模型来解决，用项点表示科目，若有学生要考两门坛，则在表
示考试科目的两个顶点之间有边。用不同颜色来表示期末考试的每个时间段。考试的安排就对应
于所关联的图的着色 。                        1

例如，假定要安排七门期末考试。假定科目从 1 到 7 编
号。假定下列各对科目的考试有学生要都参加:1 和2，1 和     7               2
3，1和4,，1和7，2和3，2和4，2和5，2和7，3和4，3
和6，3和7, 4和5, 4和6,，5和6, 5和7，以及6和7。在
图6-88 里显示这组科目所关联的图。一种安排就是由这个图  6          3
的一种着色来组成的。

因为这个图的色数为 4(读者应当验证这一点)，所以需要

四个时间段。图 6-89 显示使用了四种颜色的这个图的着色以          5       4
及所关联的调度 。                          醒 图6-88 表示期末考试安排的图
现在考虑对电视频道的分配。
1 红色
棕色 7有            2蓝色
时间段 考试科目
I      1.6
开      2
亚      了.5
红色6                  3绿色    四     4.7
5 绿色     4棕色

图 6-89 用着色来安排期末考试

例6 频率分配 ”把频道 2 到 13 分配给在北美洲的电视台，要避免 150 英里之内的两家电视
台在相同频道上播出。如何用图为频道分配建模?

解 这样构造一个图: 给每个电视台指定一个顶点。若两个电视台彼此位于 150 英里以内，则
用边连接这两个顶点。频道指派就对应于这个图的着色，其中每种颜色表示--个不同的频道。  面

例7 变址寄存器”在有效的编译器里，当把频繁地使用的变量暂时保存在中央处理单元的变
址寄存器里，而不是保存在常规内存里时，可以加速循环的执行。对于给定的循环来说，需要多
少个变址寄存器? 可以用图着色模型来讨论这个问题。为了建立这个模型，设图的每个顶点表示
循环里的一个变量。若在循环执行期间两个项点所表示的变量必须同时保存在变址寄存器里，则
在这两个项点之间有边。所以，这个图的色数就给出所需要的变址寄存器数，因为当表示变量的
项点在图中相邻时，就必须给这些变量分配不同的寄存器。                国



--- 第 313 页 ---
第 6 章 "295

练习
在练习1一2 里，构造所示地图的对偶图。然后求给这个地图着色使得相邻的两个区域都没有相同的颜色

所需要的颜色数。

1.                                                2.
7                                                            4

在练习 3一6 里，求给定的图的色数。
3. 4      心                          4      4

 

过

7. 哪些图具有色数 1?

8.W。的色数是什么?

9. 假定除了科目 Math 115 与 CS 473，Math 116 与 CS 473，Math 195 与 CS 101，Math 195 与 CS 102，Math
115 与 Math 116，Math 115 与 Math 185，Math 185 与 Math 195 以外，其他每种组合里都有学生要参加组
合里所有科目的考试，请使用最少个数的不同时间段，来为 Math 115，Math 116，Math 185，Math 195，
CS 101，CS 102，CS 273 和 CS 473 安排期末考试日程表。

10, 数学系有六个委员会，都是每月开一次会。假定委员会是 C: = {阿林豪斯，布兰德，沙斯拉夫斯基}，
C:一(布兰德，李，罗森) ，C: = {阿林豪斯，罗森，沙斯拉夫斯基}，C4={李，罗琳，沙斯拉夫斯基}，
Ci一{阿林豪斯，布兰德}和 Cs一{布兰德，罗森，沙斯拉夫斯基}，那么怎样安排才能确保没有人同时参
加两个会议。

-司B 图的边着色是指对各边指定颜色，使得关联到相同顶点的边指定不同的颜色。图的边色数是在该图的

边着色里可以使用的最少颜色数。

11. 求练习 3一6 里每个图的边色数。

12, 七个变量出现在计算机程序的循环里。这些变量以及必须保存它们的计算步骤是: :: 步骤1到6; v: 步
又2; v: 步骤2到4; 凤: 步又1，3和5; rzr: 步骤1和6; y: 步骤3到6 以及z: 步骤4和5。在执行
期间需要多少个不同的变址寄存器来保存这些变量?

下面的算法可以用来为简单图着色。首先，以度递减的顺序列出顶点 由，w，…，wu 使得 deg(uw )
deg(z)过…人deg(w)。把颜色 1 指定给 w 和在表中不与 w 相邻的下一个顶点(若存在一个这样的顶点)，并
且继续指定给每一个在表中不与已经指定了颜色 1 的项点相邻的项点。然后把颜色 2 指定给表中还没有着色
的第一个项点。继续把颜色 2 指定给那些在表中还没有着色，而且不与指定了颜色 2 的顶点相邻的顶点。若



--- 第 314 页 ---
296 "第6章 图

还有未着色的顶点，则指定颜色 3 给表中还没有着色的第一个顶点，并且用颜色 3 继续对还没有着色，而且
不与指定了颜色 3 的顶点相邻的那些顶点着色。继续这个过程直到所有顶点都着色为止。
13. 用这个算法构造下图的着色 。

人                也                C

8            刀            了
*]14- 证明: 这个算法所产生的着色数可能比着色一个图所需的颜色数更多。

如果一个连通图 G 的色数为&，但是对于 G 的任意一条边e，从 G 中删掉边e 后得到的新图的色数都是
类一1，则称 G 为着色大 关键的。
15. 证明: 只要)是正的奇数且 "三3，那么 克,就是着色 4 关键的。
16. 证明: 如果图 G 为着色A 关键的，那么 G 中的各个顶点的度至少是太一1。
 G的上重着多是对G 的顶点指定含有A 种不同颜色的集
合. 使得相邻的顶点不具有相同的颜色。用为(G)来表示使得
G 有用)种颜色的&重着色的最小正整数 mn。例如，X (CC ) 一
4。为了看出这一点，注意如图所示，只用四种颜色，就可以
对 C 的每个项点指定两种颜色，使得两个相邻顶点不具有相
同的颜色。另外，少于四种颜色是不够的，因为顶点 ww 和了
每个都必须指定两种颜色，而且不能对 w 和内 指定相同颜 。 {绿色、 黄色} 池          om{红色，蓝色}
色。(关于&重着色的更多信息，见[MiRo91]。)
*17. 设G和媚是图6-82 所示的图。求
a)Xz(G)         b)xX: (五)           c)Xs(G)           d)X CH)
18. 移动广播(或蜂窝)电话的频率是按地段分配的。每个地段分配一组该地段里的车辆所使用的频率。在产
生干扰问题的地段里不能使用相同频率。解释一下如何用&重着色来对一个地区里的每个移动广播地段
分配六 种频率。

著名的艺术馆问题求需要多少名保安才能看全艺术馆的所有部分，这里艺术馆是一个盖边形的边界及它
所围的内部。为了更精确地描述这个问题，需要一些术语。简单多边形 已边界上或己 内部的点 覆盖或看见
已边界上或己内部的点>?，如果线段 xy 上所有的点都在中 边界上或已内部。如果对于卫边界上或已内部的
每一个点 ?，都能够在一个点的集合中找到一个看见 y 的点 zx，就说这个点的集合是简单多边形的看守集。
把看守简单多边形 P 所需的最少点数的看守集记为G(P)。艺术馆问题求的就是一个函数 g(>)，它是所有
项点的简单多边形 已 的看守集 G(P)(的元素个数)的最大值(考虑 顶点的简单多边形 已 的各种形态一一译者
注)。也就是说，Sg(m)是一个最小的正整数，使得一个 ”顶点的简单多边形 忆 保证可以被g(z)个或更少的保
安看守。

*19, 证明:， &8(5)一1，即所有的五边形都能够被一个点守卫。[提示: 先分出有0个、1个、2 个顶点的内角大

于 180 度，然后再说明在各种情况下一个保安都足够了。]

*20. 证明: 8(m)之n/3引。[提示: 考虑具有 3个顶点和上 个齿尖的梳子状的多边形 ，就像如图所示的 15 边形

一样。]

{红色，蓝色} w            im {绿色，黄色}

 



--- 第 315 页 ---
第6章 图。297

关键术语和结果

术语

无向边; 与集合{zk，直关联的边，其中wx 和~ 都是顶点。

有向边; 与有序对(x，了关联的边，其中xx 和都是项点。

多重边; 连接同样一对项点的不同的边。

环: 连接一个顶点与它自身的边。

无向图: 一组顶点以及连接这些顶点的一组无向边。

简单图: 没有多重边和环的无向图。

多重图: 可能包含多重边但不包含环的无向图。

伪图: 可能包含多重边和环的无向图。

有向图: 一组顶点以及连接这些顶点的一组有向边。

有向多重图: 可能包含多重有向边的带有向边的图 。

相邻: 若在两个顶点之间有边则它们是相邻的。

关联: 若一个顶点是一条边的端点则那条边关联那个顶点。

deg(z)(无向图里顶点风的度): 与痰关联的边的数目。

deg-(z)(带有向边的图里顶点了的入度) : 以 作为终点的边的数目。

deg-(v)(带有向边的图里顶点了的出度) : 以作为起点的边的数目。

带有向边的图的底图: 通过忽略边的方向所获得的无向图。

开,(7 个顶点的完全图): 带?个顶点的无向图，其中每对顶点都用一条边连接。

偶图: 顶点集划分成两个子集合 W 和 V: 的图，使得每条边都连接 w 里的顶点和 里的顶点。

K,,(完全偶图): 顶点集划分成 m个元素的子集和)7 个元素的子集，使得两个顶点被一条边所连
接，当且仅当一个顶点属于第一个子集而另外一个顶点属于第二个子集。

C,(大小为寻的图图)，zm伍3: 带有7个顶点轨，了到，…，z 和边{轨，砍)，{(权，贡(ui，
ww，{uw，w 的图。

研,(大小为于的轮图)，z伍3: 通过向 C, 添加一个顶点以及从这个顶点到 C, 里原来每个顶点的一
条边所获得的图。

Q, (7立方体图)，z伺1: 用2"个长度为”的位串作为顶点，边连接恰好相差一位的每对位串的图。

孤立点: 0度顶点。

悬挂点: 1 度顶点。

正则图: 所有顶点都有相同的度的图。

图 C一(V，五)的子图: 图(奴，F) ，其中驳是Y的子图而顾是王 的子图。

GUG:(CG 与 G: 的并图): 图(WUV:，巨UE:)，其中CI一(mW，互)而G一(V ，开)。

邻接矩阵: 利用顶点的相邻关系来表示图的矩阵。

关联矩阵: 利用边与顶点的关联关系来表示图的抢阵。

同构的简单图: 对简单图 G,==(VW ，巨 )和简单图 G: 一(V: ，瓦; )来说，若存在从 到V: 的一一对
应 F，使得对所有属于WwW 的w 和了甸来说，(Fuw)，帮ww))E开 当用仅当(加 ，z) E已，则
G, 与 G, 是同构的。

同构不变量: 同构的图都有或都没有的性质。

无向图里从2到习的通路: 一条或多条边的序列 El ez eny 其中对 zi一0，1，…， 怀来说， Ei
关联着{z，zr+i)，其中mm一xz而zi一v。
有向图里从&到习的通路: 一条或多条边的序列 el ez eny 其中对 1一0，1，…， 妹来说， ei

关联着(z ，zr+)，其中因一zx而斌一u。
简单通路: 不多次包含一条边的通路。
回路: 在相同顶点处开始与结束的通路，通路长度 ”1。



--- 第 316 页 ---
298。第6章 图

连通图: 在图中每对顶点之间都有通路的无向图。

图 G 的连通分支: 图 C 的最大连通子图。

强连通有向图: 从每个顶点到每个顶点都存在有向通路的有向图。
有向图 CG 的强连通分支: G的最大强连通子图。

欧拉回路: 恰好包含图的每条边一次的回路。

欧拉通路: 恰好包含图的每条边一次的通路。

哈密顿通路: 简单图 C一(V，巨)里的通路 zx ，z ，…，xzr,，使得{zu，z ，…，z)一V 而且对 0过
i<j入2来说有z,天xz 。
哈密顿回路: 简单图里的回路 z。， TI TO TO 使得 To TI 是哈密顿通路。

带权图: 为各边指定数字的图。

最短通路问题: 确定带权图里的通路以使得这条通路里的边的权之和在所规定的顶点之间的所有
通路上是最小值这样的问题。

旅行商问题: 求访问图的每个顶点恰好一次的、总长度最短的回路的问题。

可平面图: 可以画在平面上而没有边交叉的图。

可平面图的平面表示面: 该图的平面表示把平面所分割成的区域。

初等细分: 删除无向图的边{x，丰而且添加新顶点 忆以及边{z，z) 和边{w，z) 。

同豚: 若两个无向图是从同一个无向图通过一系列初等细分来获得的，则它们同胚。

图着色: 给图的顶点指定颜色，使得相邻的两个顶点没有相同的颜色 。

色数: 在图的着色里所需要的最少颜色数。

结果

在连通多重图里存在欧拉回路当且仅当每个项点都有偶数度。

在连通多重图里存在欧拉通路当且仅当至多两个顶点有奇数度。

迪克斯特拉算法: 在带权图里求出两个项点之间最短通路的过程(见 6.6 节)。

欧拉公式: r一e一vz十2，其中 ~>，e 和 分别是可平面图的平面表示的面数、边数和顶点数。

庆拉图斯基定理: 图是不可平面的当且仅当它包含同胚于 K:.:或 Ks 的子图。(其证明超出本书
范围。)

四色定理: 每个平面图都可以用不超过四种颜色来着色。(其证明远远超出本书范围1)

复习题
1, a)定义: 简单图，多重图，伪图，有向图，有向多重图。
b)用例子说明: 如何用 a)里每种类型的图来建模。例如，解释一下如何为计算机网络或飞行航线的不同方
面来建模。
. 给出如何用图建模的至少四个例子。
. 在无向图里，项点度数之和与该图里边数之间的关系是什么?解释这个关系为什么成立。
' 为什么在无向图里奇数度顶点的个数必然是偶数?
' 在有向图里顶点的人度之和与出度之和之间的关系是什么? 解释这个关系为什么成立。
.描述下列图族 。
a)五。，在个顶点上的完全图
b)天。。，在 mm 和? 个顶点上的完全偶图
c)C,，带”个顶点的图图
d)丽,，大小为的轮图
e)Q.，7 立方体
- 在练习 6 的图族里，每个图有多少个顶点和多少条边?
-. a)什么是价图?
b)图 多 ，C，和 多 中哪些是偶图?

人

oo 一



--- 第 317 页 ---
第6章 图。299

c)你如何确定无向图是否为偶图?
9. a)描述用来表示图的三种不同方法。
b)画出至少带 5 个顶点和 8 条边的简单图。说明如何用你在 a)里所描述的方法来表示它。
10. a)两个简单图是同构的是什么意思?
b)对于简单图的同构来说，不变量是什么意思? 给出至少五个这样的不变量的例子。
c)给出带有相同的顶点数、边数和项点度但不同构的两个简单图的例子。
d)是否有一组已知的不变量可以用来有效地确定两个简单图是否同构?
11. a)图是连通的是什么意思?
b)什么是图的连通分支?
12. a)解释一下如何用邻接矩阵来表示图。
b)如何用邻接矩阵来确定从图 G 的顶点集到图 万 的顶点集的函数是否是同构的?
c)如何用图的邻接矩阵来确定在图的两个顶点之间长度为~的通路数? 其中-~是正整数。
13. a)定义无向图里的欧拉回路和欧拉通路。
b)撒述著名的哥尼斯保七桥问题，并且解释一下如何利用欧拉回路来重新叙述它。
c)如何确定无向图是否具有欧拉通路?
d)如何确定无向图是否具有欧拉回路?
14, a)定义简单图里的哈密顿回路。
b)给出一些性质，这些性质蕴含着简单图没有哈密顿回路。
15. 给出至少两个可以通过求出带权图里最短通路来解决的问题的例子。
16. a)摘述求在带权图两个顶点之间的最短通路的迪克斯特拉算法。
b)画出至少带 10 个项点和 20 条边的带权图。用迪克斯特拉算法求出在图中你所选择的两个顶点之间的
最短通路。
17. a)图是可平面的是什么意思?
b)给出不可平面的简单图的例子。
18. a)平面图的欧拉公式是什么?
b)如何用平面图的殉拉公式来证明简单图是不可平面的?
19. 叙述关于图的可平面性的库拉图斯基定理，并且解释一下它如何刻画了哪些图是可平面的。
20. a)定义图的色数。
b)当”是正整数时，图 玉, 的色数是什么?
c)当?是大于 2 的正整数时，图 C, 的色数是什么?
d)当和zz 都是正整数时，图 K。..的色数是什么?
21. 叙述四色定理。有没有不能用四种颜色来着色的图?
22. 解释一下在建模里可以如何使用图的着色 。至少举两个不同的例子。

补充练习
1. 一个带 100 个顶点的 50 正则图有多少条边?
2. 乓 有多少种非同构的子图?

在练习 3~5 里，确定所给的成对的图是否同构。

 



--- 第 318 页 ---
300"。第6章 图

4               2

呈
HUR                  1                 8                  加
47                         3          V7                          3
4a6                 4                  16                  V4
5
轴
18                   12
247                            13
6                   4
4145
完全 职 部图 下。 om 的顶点划分成 7 个子集合，  各有 7 ?re “1 个元素，  而且顶点相邻当且仅当
它们属于这个划分的不同子集合。
6. 画出下列图。
a)开.3                  b)关zz.                 C)下1r.2.3
*7. 完全普部图氏。.。 .有多少个顶点和多少条边?

*8, a)证明或反驱: 在至少有两个顶点的有穷简单图里，总是存在两个度数相同的顶点 。
b?对有穷多重图做与(a)里同样的事。

设 CG=(V，E)是简单图。项点集合 Y 的子集合多 的导出子图是图(双，F) ，其中边集合下包含着瑟 里的
一条边当且仅当这条边的两个端点都属于 W 。
9. 考虑 6.4 节图 6-42 所示的图。求下列项点的导出子图

a){a，b，c}         b)tae，e，g}        c){5，c，厂区，大}
10. 设 是正整数。证明: 天, 的顶点集的非空子集的导出子图是完全图。

C王 简单无向图里的团是一个完全子图，它不包含在任何更大的完全子图里。在练习 11一13 里，求所给的
图的所有团。

 

 



--- 第 319 页 ---
第6章 图。301

简单图里顶点的支配集是项点的一个集合，使得其他每个顶点都与这个集合里至少一个项点是相邻的。
带最少顶点数的支配集称为最小支配全。在练习 14一16 里，求所给的图的最小支配集。

14. 4               力       15.                      “       16.
也4           也
C                 可            必                         了

简单图可用来确定在棋盘上控制整个棋盘的最少皇后数。一个 zaXz 的棋盘具有对 个格子。如下图所示，
在所给位置里的皇后控制着同行、同列以及包含这个格子的两条斜线上的所有格子。与此对应的简单图具有
到 个项点，每个顶点表示一个格子，而且若一个顶点所表示的格子里的皇后控制着另外一个顶点所表示的格
子，则这两个顶点是相邻的。
17. 构造表示 m”Xzm 棋盘的简单图，用边表示皇后对格子的控制，
其中
a)7一3             bz一4
18. 解释一下最小支配集的概念如何应用到确定控制 axXzn 棋盘的
最少皇后数的问题 。
*#19. 求控制 >Xzn 棋盘的最少皇后数，其中
a)7一3        b)z王4        c)7m一5
20. 假定G, 和 瑟, 是同构的而且 Cz 和 瑟: 是同构的。证明或反驱:
GiUG: 和 囊UU吨: 是同构的。
21. 证明: 下列性质是同构的简单图都有或都没有的不变量。

 

 

a)连通性                        b)哈密顿回路的存在性
c)欧拉回路的存在性           d)有交叉数 C
e)有 ?个孤立顶点              纪是偶图

22. 如何从 G 的邻接矩阵求妈的邻接矩阵? 其中 G 是简单图。
23. 有多少种非同构的、带有 4 个顶点的连通简单偶图?
*24. 有多少种非同构的简单连通图带有 5 个顶点并且

a)没有任何顶点的度超过 2?

b)色数等于4?

c)非可平面的?

若有向图与它的逆同构，则它是自着的。
25，, 确定下列图是否为自逆的。

如    五

 

a)
26. 证明: 若有向图CG是自逆的而且 瑟 是同构于G 的有向图，则 互也是自六的。

无向简单图的定向就是指定它的各边的方向，使得所得到的有向图是强连通的。当无向图有定向时，这
个图称为可定向的。在练习 27一29 里，确定给定的图是否可定向。



--- 第 320 页 ---
302。

27.

9
写

#31.

32.
33.
#34.

36.

#37.

#38

第6章 图

人    必    c 28. a              厂 29. a    必    e
了

广     8

. 因为在城市中心区交通流量正在增长，所以交通工程师正在计划把目前所有双行街道都变成单行街道。

解释一下如何为这个问题建模。
证明: 若一个图具有割边，则它不是可定向的。

竞赛图是简单有向图，使得若 x 和v 是图里不同的项点，则(x，z) 和(w，z)中恰好有一个是图中的边。
有多少种不同的带m个顶点的竞赛图?

在竞赛图里一个顶点的人度与出庶之和是什么?

证明: 每个竞赛图都有了哈密顿通路 。

. 给定鸡群里的两只鸡，其中一只占优势。这样就定义了这个鸡群的吃食次序。如何用竞赛图来为吸食次
序建模?

假定 G 是带 2 个麻数度顶点的连通多重图。证明: 存在上个子图，它们的并图是G，其中每个子图都有
欧拉通路并且任何两个子图都没有公共边。[提示: 向该图添加条边，连接成对的奇数度顶点，并且利
用这个变大了的图的欧拉回路。]

设G是带有7? 个顶点的简单图。G 的带宽表示成B(G)，它是 max{ | ;一 | 1a, 与ca 是相邻的}在G的顶

C
纪      可          户      C      d      e   d

点 aa，az，…，a 的所有排列上所取的最小值。即带宽是赋给相邻顶点的下标的最大差值在顶点的所有
列表上所取的最小值。求下列图的带宽。
a)天。      b)天,3      C)开:3      d)玫:3      eaQx:      Cs

. 连通简单图的两个不同项点 w 和 w 之间的距离是在ww 和 之间的最短通路的长度(边数)。图的半径是

全项pg 从顶点 v 到其他顶点的最大距离在所有顶点w 上所取的最小值。图的直径是在两个不同顶点之间的最大

#39.

#40-.

41

42.
43，
44，
#45.

距离。求下列图的半径和直径。

a)Ke             b)政,5            c)Qs              d)Cs

a)证明: 若简单图 G 的直径至少为4，则它的补图 C 的直径不超过 2。

b)证明: 若简单图 G 的直径至少为3，则它的补图 C 的直径不超过 3。

假定一个多重图有 2 个奇数度顶点。证明: 任何包含该图中每条边的回路，必然至少包含 六条边超过
一次。

. 求 6.6 节图 6-64 中在顶点 a 与z 之间的次最短通路 。

设计一个算法，它在简单连通带权图里，求在两个项点之间的最短通路。

求 6.6 节图 6-65 中在顶点 a 与 之间经过顶点e 的最短通路 。

设计一个算法，它在简单连通带权图里，求在两个顶点之间经过第三个指定顶点的最短通路。

证明: 若 G是至少带 11 个顶点的简单图，则或者 G 不是可平面的，或者 CC不是可平面的, CC 是G 的
补图。

(王台车在图中一组顶点的集合里任何两个顶点都不相邻，则这个顶点集合称为独立的。图的独立数是图中

项

关和4和-

47.
48.
49.

点独立集里的最大项点数。

下列图的独立数是什么?

a)天。             b)C。              cJQ，              d)天。.。

证明: 一个简单图里的项点数小于或等于这个图的独立数与色数之积。

证明: 一个图的色数小于或等于v一;十1，其足是这个图的顶点数,，i 是这个图的独立数。

假定为了生成带有7 个项点的随机简单图，首先选择满足 0委妆1 的实数 训。对 C(n"，2)对不同顶点中的
每一对，都生成一个在0与 1 之间的随机数 x。若 0魏z委训，则用一条边连接这两个项点; 否则就不连接



--- 第 321 页 ---
第6章 图。303

这两个顶点。

a)生成带有zm 条边的图的概率是什么? 其中 0委m<C(z，2) 。

b)若以概率 户来包含每一条边，则在随机生成的带有 ”个项点的图中，边数的期望值是什么?
c)证明: 车 p一1/2，则以相等的概率生成每一个带 =个顶点的简单图。

每当向简单图添加更多的边(不添加顶点)时，都还保持的性质称为单调增的，每当从简单图刷除边(不删

除顶点)时，都还保持的性质称为单调减的。

50，

5
基关52。

对下列每个性质来说，确定它是香为单调增的并且确定它是否为单调减的。

a)图 G是连通的    b)图 G不是连通的   c)图 G 有欧拉回路   d)图 G 有哈密顿回路

e)图 G是可平面的    刀图 G 的色数为4     g)图 G 的半径为 3     h)图 G 的直径为 3

证明: 图的性质 已是单调增的当且仅当图的性质Q 是单调减的，其中@@是不具有人性质忆的性质。

假定 已是简单图的单调增的性质。证明: 带个顶点的随机图有性质 P 的概率是挑选一条边属于图的概
率户的单调非减函数。

计算机题目
按下述给定的输入与输出写出程序。

1
2
3
生
5.
6
7
8
9

10，
I1.

#]2，
13，

关] 和。
#共1 5。
##]6.

17，

18.
19.
20.

给定无向图的各边所关联的顶点对，确定每个顶点的度。

, 给定有向图的各边所关联的有序顶点对，确定每个顶点的人度和出度。
. 给定简单图的边列表 ，确定这个图是否为偶图。
. 给定图的各边所关联的顶点对，构造这个图的邻接矩阵。

给定图的邻接矩阵，列出这个图的各边，并且给出每条边出现的次数。

' 给定无向图各边所关联的顶点对，以及每条边出现的次数，构造这个图的关联矩阵。

: 给定无向图的关联矩阵，列出它的各边，并且给出每条边出现的次数。

' 给定正整数 "，通过产生图的邻接矩阵来生成无向图，使得以相等的概率来生成所有的简单图。
, 给定正整数 ">，通过产生图的邻接抢阵来生成有向图，使得以相等的概率来生成所有的有向图。

给定两个都带不超过 6 个项点的简单图的边列表，确定这两个图是否同构。

给定图的邻接矩阵和正整数 *，求顶点两两之间长度为”的通路数(产生对有向图和无向图来说都能工作
的程序) 。

给定简单图的边列表，确定它是否连通，若它不连通，则求连通分支数。

给定多重图的各边所关联的项点对，确定它是否有欧拉回路，若没有欧拉回路，则确定它是否有欧拉通
路。若存在欧拉通路或欧拉回路，则构造这样的通路或回路。

给定有向多重图的各边所关联的有序顶点对，若存在欧拉通路或欧拉回路，则构造这样的通路或回路。
给定简单图的边列表，产生一条哈密顿回路，或者确定该图没有这样的回路。

给定简单图的边列表，产生一条哈密顿通路，或者确定该图没有这样的通路。

给定带权连通简单图的边及其权的列表，以及该图中的两个顶点，用迪克斯特拉算法求这两点间最短通
路的长度。另外，求出这条通路。

给定无向图的边的表，用 6. 8 节练习里所给的算法求这个图的着色。

给定学生及其注册课程的表，构造期末考试日程表。

给定各对电视台之间的距离 ，为这些台分配频率。，

计算和研究
利用计算程序或你所编写的程序来做下面的练习。

站En

: 显示带4个项点的所有简单图。

' 显示全套的带 6 个顶点的所有非同构的简单图。

- 显示全套的带4 个顶点的所有非同构的有向图。

- 随机地生成 10 个不同的简单图，每个带 20 个顶点，使得每个这样的图都是以相等的概率来生成的。
. 构造一种格雷码，其中码字都是长度为 6 的位串。

. 构造马在不同大小的棋盘上的周游路线 。



--- 第 322 页 ---
30U4。第6童 图

7.
8.
9.

10.

11IL.

#x# 2

站13-

%#X% 和4

确定你在本组练习的练习4 里生成的每个图是否为平面图。若你可以做到，则确定每个非平面图的厚度。
确定你在本组练习的练习4 里生成的每个图是否连通。若有一个图不连通，则确定这个图的连通分支数。
随机地生成带 10 个顶点的简单图。当你生成了一个带欧拉回路的图时停止。显示这个图里的一个欧拉
回路 。

随机地生成带 10 个顶点的简单图。当你生成了一个带哈密顿回路的图时停止。显示这个图里的一个哈密
顿回路。

求你在本组练习的练习4 里所生成的每个图的色数。

求旅行推销员访问美国 50 个州的每个首府所能采取的最短路线，飞机在各城市之间直线通行。

对每个不超过 10 的正整数 ”来说，估计随机生成的带 m” 个顶点的简单图连通的概率，方法是生成一组随
机简单图并且确定每个图是否连通。

研究这个问题， 确定 K(7，7)的交叉数是否为77，79 或 81。已知它等于这三个数当中的一个。

写作题目
利用本书以外的资料，就下列问题写作短文。

DO

和
呈

. 描述一下在 1900 年以前图论的起源和发展。

. 讨论一下图论在生态系统研究中的应用。

- 讨论一下图论在社会学和心理学中的应用。

- 讨论一下通过研究网络图的性质可以了解到什么?

. 描述一下给定一个图的顶点和边，在纸面或屏幕上画出这个图的算法。

. 一个输入、显示和操纵各种图的软件工具应当具有什么功能? 现有的工具都具有这些功能中的哪些?

- 描述一下确定两个图是否同构的一些可用算法和这些算法的计算复杂性。目前已知最有效的算法是什么?
,描述一下如何用欧拉通路来帮助确定 DNA 序列。

,定义一下德布鲁因序列并且讨论它们如何出现在应用里。解释如何用欧拉回路来构造德布鲁因序列 。

. 描述一下中国邮到员问题并且解释如何解决这个问题。

- 描述一下蕴含着图具有哈密顿回路的一些不同条件。

.描述一下用来解决旅行推销员问题的几个不同策略和算法。

- 描述一下确定一个图是否可平面的几个不同算法。每个算法的计算复杂性是什么?

. 在建模中，有时把大规模集成电路(VLSID图蔡和信到一本书中，让顶点都在书脊上而边都在不同的书页上

《在同一页之内边与边互不相交)。 定义一下图的书页数(book number，即上述做法所需要的最少页
数一一译者注)并且对 一3，4，5 和6 求包括 K, 在内的各种图的书页数。

- 描述一下四色定理的历史。

' 描述一下在四色定理的证明中计算机所扮演的角色。如何肯定一个依赖计算机的证明是正确的?
.就是否产生最少颜色的着色以及复杂性而言，描述并比较一下给图着色的几个不同算法。

. 解释一下在各种不同模型里如何使用图的多重着色 。

， 解释一下在带特定性质的图的非构造性存在性证明中如何使用随机图理论。



--- 第 323 页 ---
| 第7章

Discrete Mathematics and Its Applications，f人6下

树

不包含简单回路的连通图称为树。早在 1857 年英国数学家亚瑟。凯菜就用树去计数某些类型
的化合物。本章中的例子将说明从那时起，树已经被用来解决各种学科分支里的问题。

树在计算机科学里特别有用，尤其是在算法中。例如，用树来构造求出项在表中位置的有效
算法;可以用树构造有效编码以节省数据存储和传输成本，比如赫夫曼编码; 可以用树来研究诸
如跳棋和象棋这样的博弈，并且可以帮助确定进行这些博弈的取胜策略，可以用树来为通过一系
列决策而完成的过程建立模型。构造这些模型可以帮助确定比如排序算法这样的基于一系列决策
的算法的计算复杂性。

通过深度优先搜索或宽度优先搜索，可以系统地遍历图的顶点，构造出一棵包括每个顶点的
树来。通过深度优先搜索来探索图的顶点，也称为回湖，人允许系统地搜索五花八门的问题的解，
比如确定在棋盘上如何放置 8 个王后使得这些王后不能互相攻击。

可以给树的边赋权来为许多问题建立模型。例如，用加权树可以开发出构造网络的算法，这
些网络含有最便宜的连接不同网络节点的电话线集合。

7.1 概述

汉庆= 第6 章说明了如何用图来建立模型和解决许多门题。本章将集中讨论称为村的一种特
“”” ，殊类型的图，之所以这样命名是因为这样的图就像是树。例如，家族树是表示族谱图

的图。家族树用顶点表示家族成员并且用边表示亲子关系。图 7-1 显示瑞士数学世家伯努利家族

的家族树。表示家族树的无向图是树的一个例子。

Nikolaus
(1623-1708)
Jacob工                                             Nikolaus                                          JohannI
(1654-1705)                   (1662-1716)                  (1667-1748)

 一| 人

 

Nikolaus        Nikolaus 工          Daniel           JohannI
(1687-1759)    (1695-1726) (1700-1782) (1710-1790)
Johann 可          Jacob I

(1746-1807) (1759-1789)
图7-1 伯努利数学世家

 

2  树是没有简单回路的连通无向图。

因为树没有简单回路，所以树不含多重边或环。因此任何树都必然是简单图。

例1 在图7-2 所示的图中，郧些图是树?

解 C, 和G@: 是树，因为都是没有简单回路的连通图。G: 不是树，因为e，5，a，qd，e 是这个
图中的简单回路。最后，G, 不是树，因为它不连通。                  力



--- 第 324 页 ---
306。第7章 树

六
.
人

人

Gi                  C，                  G3                  Gs
 7-2 Cl 和 G: 是树，G， 和 G4 不是树

任何一个不包含简单回路的连通图都是树。不含简单回路但不一定连通的图是什么? 这些图
称为森林，而且具有这样的性质: 它们的每个连通分支都是树。图 7-3 显示一个森林。

这是具有3个连通成分的图

信友

图 7-3 一个森林的例子

 

通常把树定义成具有在每对项点之间存在唯一简单通路的性质的无向图。下面的定理说明这
个定义与原来的定义等价。

一个无向图是树当且仅当在它的每对顶点之间存在唯一简单通路 。

证 首先假定 工是树。则 工是没有简单回路的连通图。设和>是工的两个顶点。因为工是
连通的，根据 6.4节定理1，在zx和> 之间存在一条简单通路。另外，这条通路必然是唯一的，因
为假如存在第二条这样的通路，那么从zx到y 的第一条通路以及将第二条通路逆转后所得到的从>
到 z的通路，将组合起来形成回路。利用 6. 4 节练习 24，这蕴含着在 了 中存在简单回路。因此，
在树的任何两个项点之间存在唯一简单通路 。

现在假定在图 工的任何两个顶点之间存在唯一简单通路。则 工是连通的，因为在它的任何两
个顶点之间存在通路。另外，工没有简单回路。为了看出这是个真命题，假定工有包含顶点zx 和>y
的简单回路。则在 zx 和>y 之间就有两条简单通路，因为这条简单回路包含一条从 z到y 的简单通
路和一条从> 到z 的简单通路。因此，在任何两个顶点之间存在唯一简单通路的图是树。   口

在树的许多应用里，指定树的一个特殊顶点作为根。一旦规定了根，就可以给每条边指定方
向如下 。因为从根到图的每个顶点存在唯一通路(根据定理 1) ，所以指定每条边是离开根的方向。
因此，树与它的根一起产生一个有向图，称为根树。

ES国松村是指定一个顶点作为根并且每条边的方向都离开根的树。

* 也可以递归地定义根树。通过选择任何一个项点来作为根，就可以把非根树变成根树。注意

 



--- 第 325 页 ---
第7童 树。307

对根的不同选择会导致产生不同的根树。例如，图7-4 显示通过在树 工里分别指定 和* 作为根所
形成的根树。通常在画根树时把根画在图的顶端。指示根树中边的方向的箭头可以省略，因为对
根的选择确定了边的方向。

以c为根                                        以c为根
低                                        C

  

 7-4 一棵树以及指定两个根所形成的根树

树这个术语起源于植物学和族谱学。假定 工是根树。若v是工里非根的顶点，则 v的父母是
使得从v“ 到v 存在有向边的唯一的项点 x(读者应当证明这样的顶点“是唯一的) 。当xx 是v 的父母
时，v称为x 的子女。具有相同父母的顶点称为兄弟。非根顶点的祖先是从根到该顶点的通路上的
项点，不包括该顶点自身但包括根(即该顶点的父母，该顶点的父母的父母，等等， 一直到根为
止)。顶点的后代是以vw 作为祖先的顶点。树的顶点若没有子女则称为树叶。有子女的顶点称为
内点。根是内点，除非它是图中唯一的顶点，在这种情况下它是树叶。

若a 是树里的项点，则以 a 为根的子树是由a 和a 的后代以及这些顶点所关联的边所组成的该
树的子图。

例2 在图7-5所示的根树里(有根 a)，求c 的父母，g 的子女，  的兄弟， e的所有祖先,2
的所有后代，所有内点以及所有树叶。什么是根在 g 处的子树?

了 解 c的父母是。g 的子女是户， i 和7 。户的兄弟是: 和7 。e 的祖先是c，2 和a。的

后代是c， 4和e。内点是a，D，c， 号， R和>。 树叶是 d， e， fi R，L 和和m。 根在 8

处的子树如图 7-6 所示。              本
开      QI

  

天   :     “   1
图7-5 根树 工 ?7-6 根在8处的子树

在许多不同的应用里都使用具有下面性质的根树， 它们的所有内点都有同样个数的子女。在

本章后面将用这样的树去研究涉及搜索 、排序和编码的问题。

ae: ER 若根树的每个内点都有不超过 mm个子女，则称它为由元树。若该树的每个内
”点都恰好有思个子女，则称它为正则 六元树。把 zz一2 的正则 几元树称为二又树。

例3 图7-7里的根树，对某个正整数 mm来说是否为正则mm 元树?

 



--- 第 326 页 ---
308“。第7章 树

人
和

 四 7-7 ”四个根树

解 ”Ti 是正则二叉树，因为它的每个内点都有两个子女。T: 是正则三元树，因为它的每个内
点都有三个子女。在 T 里每个内点都有五个子女，所以它是正则五元树。对任何普来说，T, 都
不是正则 关元树，因为它的某些内点有两个子女而其他内点有三个子女。               国

有序根树是把每个内点的子女们都排序的根树。画有序根树时，以从左向右的顺序来显示每
个内点的子女们。注意在常规方式下根树的表示将确定它的边的一种顺序。我们将在画图时使用
边的这种顺序，但不明确地指出认为根树是有序的。

在有序二叉树(通常只称为二叉树)中，若一个内点有两个子女，则第一个子女称为左子女而
第二个子女称为右子女。根处在一个项点的左子女处的树称为该顶点的左子树，而根处在一个项
点的右子女处的树称为该顶点的右子树。读者应当注意，对某些应用来说，二又树的每个非根项
点都指定为其父母的右子女或左子女。即使当某些顶点仅有一个子女时也这样做。具体指定方式
视需要而定。

可以递归地定义有序根树。

例4 在图7-8a 所示二又树工里，什么是 4 的左子女和右子女(其中顺序是画法所蕴含的)?
什么是 c 的左子树和右子树?

 

b)           c)
 7-8 二叉树 了和顶点ce 的左子树和右子树

解 dz的左子女是 了而右子女是 5。在图 7-8b 和图 7-8c 中分别显示 c 的左子树和右子树。 ”国
与图的情形恰好一样，不存在用来描述树、根树、有序根树和二叉树等的标准术语。出现这



--- 第 327 页 ---
第7章 树，309

种非标准的术语是因为在计算机科学里大量地使用树，而计算机科学还是相对年轻的领域。每当
碰到关于树的术语时，读者就应当仔细地核对这些术语所表示的意思。

7.1.1 树作为模型

以树为模型的应用领域非常广泛，比如计算机科学、化学、地理学、植物学和心理学等。下
面将描述基于树的各式各样的模型 。

例5 饱和碳氢化合物与树 ”图可以用来表示分子，其中用顶点表示原子，用边表示原子之间
的化学键。英国数学家亚琴' 凯莱在 1857 年发现了树，当时他正在试图列举形如 C,H,,:的化合
物的同分异构体，它们都称为饱和碳氢化合物。

在饱和碳氢化合物的图模型里，用4 度项点表示每个碳原子，用 1 度顶点表示每个氢原子。在
形如 C.H:+*的化合物的表示图里有 3*十2 个项点。在这个图中，边数是顶点度数之和的一半。因
此，在这个图中有(4z十2n"十2)/2一3n十1 条边。因为这个图是连通的，而且边数比顶点数少1，所

以它必然是树。
带有个4度顶点和 2n十2个1度顶点的非同   h

构的树，就表示 C,H:s的不同的同分异构体。例   |

如，当nm一4 时，恰好存在两个这种类型的不同的同 “人   1 人

分异构体。它们的结构如图 7-9 所示。这两种同分 8一c一HH一c-一c一-cc一

异构体称为丁烷和异丁烷。
例6 表示组织机构 大的组织机构的结构可    |      H一C一H

以用根树来奸模。在这个树里每个顶点表示机构里 8一人     |

的一个职务。从一个顶点到另外一个顶点的边的起    H

点所表示的人是终点所表示的人的(直接)上司。     丁烷          异丁烷

7-10 所示就是这样的树。在这个树所表示的组织机      图 7-9 丁烧的两种同分异构体

构里，硬件开发主任直接为研发经理工作。   国

 

 ?7-10 一家计算机公司的组织机构图

例7 计算机文件系统 ”计算机存储器中的文件可以组织成目录。目录可以包含文件和子目
录。根目录包含整个文件系统。因此，文件系统可以表示成根树，其中根表示根目录，内点表示
子目录，树叶表示文件或空目录。在图7-11 中显示一个这样的文件系统。在该系统中，文件 khr
属于目录 je。(注意文件的链接，同一个文件会有一个以上的路径名，导致计算机文件系统中有
回路.。)                                                         图

例8 树形连接并行处理系统 在6.2节例16里描述过多种并行处理的互联网络。树形连接
网络是把处理器互相连接的另外一种重要方式。这样的网络的表示图是正则二叉树。这样的网络
把 "一2 一1个处理器互连起来，其中上是正整数。一个非根也非树叶的顶点 v所表示的处理器具
有三个双向连接，一个连接通向w的父母所表示的处理器，两个连接通向v 的两个子女所表示的处
理器。根所表示的处理器具有两个双向连接，分别通向 v 的两个子女所表示的处理器。树叶所表



--- 第 328 页 ---
310"。第7童 树

根为根目录
内点为目录

一

UST                                   bin                                   tmp

人AN

bin         中e        spool        is         mail ”who                   junk

[人八| /AN

ed nroff vikhr opr tnicp

 

 

 

 

 

printer file

图7-11 一个计算机文件系统

示的处理器具有一个双向连接，通向vv的父母。在图 7-12 里显示带 7 个处理器的树形连接网络。
将要说明并行计算是如何使用树形连接网络的。具体地             户

说，将说明图 7-12 里的处理器是如何用三步来完成 8 个数
的相加的。在第一步用 P, 相加 zx 和盖。用 P:, 相加 zx 和
zt。用Ps 相加zx 和<。用P,相加xz和xz。在第二步用
忆 相加 z 十zz 和xz十zi。用 Pi 相加十zs 和盖十rs。最
后，在第三步用 忆 相加 z十z十za十z 和二十zs十z十         及    PP 请    妃

*。这种方法要优于申行地相加 8 个数所需要的七步，串行 ”图7 .12 带? 个处理器的树形连接网络
的步骤是依次把一个数与表中前面各数之和相加。      图

7.1.2 树的性质
我们常常需要知道树里各种各样的边和顶点的数目之间的联系。
定j     带有mm 个顶点的树含有m一1 条边。
二了  庆证 将用数学归纳法来证明这个定理。注意对于所有的树来说，在这里可以选择一个
1     树根并且认为这个树有根。
基础步骤: 当m=一1时，有z=1个顶点的树没有边。所有对于 nx一1 来说定理为真。
归纳步对: 归纳假设说有个顶点的每个树都有一1条边，其中上是正整数。假设树 工有
&十1 个顶点并且立是工的树叶(必定存在，因为树是有穷的)，设双是v的父母，从工删除顶点
 和连接记 和mv 的边，就产生有个顶点的树T，因为所得出的图还是连通的并且没有简单回路。
根据归纳假设，天有一1 条边。所以工有大条边，因为工比T多1条边，即连接v和zw 的边。这
样就完成了归纳步骤。                                              口
下面的定理说明，带有指定的内点数的 闫元树的顶点数是确定的。与定理 2 一样，将用”来
表示树中的项点数。
E 带有;个内点的正则m 元树含有mn一mi十1 个顶点。
证 ”除根之外的每个顶点都是内点的子女。因为每个内点有 关个子女，所以在树中除根之外
还有 zi 个顶点。因此，该树含有 "一mi十1 个顶点。                            口
假定工是完全关 元树。设:是该树的内点数而! 是树叶数。一旦zz，i 和! 之中的一个已知，另
外的两个量就随之确定了。下面的定理给出如何从已知的一个量求其他两个量的方法。
     一个正则 关元树若带有
(Dm 个顶点，则带有 ii一(n一1)V/m 个内点和/一[(m一1)nz十1]/m 个树叶}

 

 

 

 



--- 第 329 页 ---
第7章 树"311

《ii并个内点，则带有 z一mi十1 个顶点和 一(mm一1)i十1 个树叶;

(ii)z 个树叶，则带有 2一(一1)/(Cm一1)个顶点和 ;i一(一DC一1)个内点。

证 ”设”表示顶点数，i 表示内点数,! 表示树叶数。利用定理 3 中的等式，即 nx一mi十1，以
及等式 "一/十区这个等式为真，是因为每一个顶点要么是树叶、要人么是内点)，就可以证明本定理

的所有三个部分。将在这里证明(D 。(iD 和(iii)的证明留给读者作为练习。
在 ?一mi十1 里求解;得出;=人na一1)/m。然后把守的这个表达式代人等式=!十i，就证明
L一mx一i一?一(2一1)7m一[(mm一1)m十1]/mr。                              口

例 9 说明如何使用定理 4。

例9 假定某人寄出一封连环信。要求收到信的每个人再把它寄给另外4个人。有一些人这样
做了，但是其他人则没有寄出信。若没有人收到超过一封的信，而且若读过信和但是不寄出它的人
数超过 100 个后，连环信就终止了，则包括第一个人在内，有多少人看过信? 有多少人寄出过信?

解 ”可以用4元树表示连环信。内点对应于寄出信的人，而树叶对应于不寄出信的人。因为有
100 个人不寄出信，所以在这个根树里，树叶数是 ;=100。因此，定理4的(iii)说明， 已经看过信和的
人数是 z一(4，100一1)/(4一1)王133。另外，内点数是 133一100=33，所以 33 个人寄出过信。 ”国

经常需要使用这样的根树，它们是“平衡的"，所以在每个顶点处的子树都包含大约相同长度
的通路。下面的一些定义将解释清楚这个概念。在根树里顶点的有层是从根到这个顶点的唯一通
路的长度。根的层定义为0。根树的高度就是顶点层数的最大值。换句话说，根树的层数是从根到
任意项点的最长通路的长度。

例 10 求图7-13 所示的根树里每个顶点的层数。这棵树的高度是什么?

解 根在0层上。顶点b, 7和大都在1层上。顶点c<，e，丰和/都在2层上。顶点 d，g，i，mn
和?都在 3 层上。最后，顶点户在4层上。因为任意顶点的最大层数是4，所以这棵树的高度为4。 国

若一棵高度为疡的症元树的所有顶点都在疡层或六一1 层，则这棵树是平衡的。

例11 在图7-14所示的一些根树里，哪些根树是平衡的?

六

图 7-13 一棵根树              图 7-14 ”一些根树

 

解 Ti 是平衡的，因为它所有的树叶都在 3 层和4 层上。不过，全 不是平衡的，因为它有树
叶在2层、3 层和4 层上。最后，T, 是平衡的，因为它所有的树叶都在3 层上。       国

定理 5 中的结果建立 关元树的高度与顶点数之间的联系。

ES加 在高度为姑的” 元树里至多有mx 个树叶。

证 本证明对高度使用数学归纳法。首先，考虑高度为 1 的 头元树。这些树都是由带有不超
过圈个子女的一个根所组成的，每个子女都是树叶。因此在高度为1的z元树里有不超过



--- 第 330 页 ---
312*第7章 树

7 一Mi 个树叶。这是归纳论证的基础步骤。

现在假定对高度小于 m 的所有mm 元树来说，这个结果都为真; 这是归纳假设。设工是高度为
六的mm元树。工的树叶都是通过删除从根到每个在 1 层的顶点的边所获得的人的子树的树叶，如
图7-15 所示。

 

图7-15 证明的归纳步邓

这些子树的高度都小于或等于A一1。所以根据归纳假设，这些根树每个都有至多 m:条边。
因为最多有a个这样的子树，每个子树最多有 mm入:个树叶，所以在这个根树里最多有 m 。m和:一
ze 个树叶。这样就完成了归纳论证。                                        口
若一个高度为六的za 元树带有/ 个树叶，则 hflog.习。若这个闷元树是正则的和平
衡的，则 A一| log.! ](在这里使用向上取整机数。回忆一下, [zl是大于或等于 z 的最小整数) 。

证 从定理5 知道 委咪。取以m为底的对数就证明 A衬log。! 。因为九是整数，所以有 j
Jog.上]。现在假定这个树是平衡的。于是每个树叶都在六层或关一1 层上，而且因为树的高度
为六，所以在六层至少有一个树叶。所以必然有超过 mm:个树叶。因为上委闪，所以有 mr一/
和。在这个不等式里取以 mm为底的对数就得出 A一1二log,近A。因此ji一iog。0]。       口

练习
1 下面哪些图是树?

1
LA人 永

 

e)

安
7

ff

' 回答下列关于左下图所示的根树的问题 。

a)哪个项点是根?                             b)哪些顶点是内点?

c)哪些项点是树叶?                          d)哪些顶点是7 的子女?
e)哪些顶点是六的父母?                      全哪些顶点是 o 的兄弟?
g)哪些项点是 六的祖先?                     h)哪些项点是避的后代?

. 练习 2 里的根树对某个正整数 六来说，是否是正则 元树?
- 练习 2 里的根树的每个顶点的层数是什么?
- 画出练习 2 里的树以下列项点为根的子树。
a)a            by)c            c)e
- a)有多少种非同构的带有 3 个顶点的非根树?
b)有多少种非同构的带有 3 个顶点的根树(使用有向图的同构)?
*7. a)有多少种非同构的带有 5 个顶点的非根树?
b)有多人少种非同构的带有 5 个顶点的根树(使用有向图的同构)?
8. 带有 10 000 个顶点的树有多少条边?

CT 中

Cn



--- 第 331 页 ---
第7章 树，313

9. 带有 1000 个内点的正则二叉树有多少条边?

10, 假定 1000 个人参加象棋巡回赛。若一个选手输掉一盘就遭到淘汰，而且比赛进行到只有一位参加者还设
有输过为止，则利用这个巡回赛的根树模型，来确定为了决出冠军必须下多少盘棋(假定没有平局) 。

11. 一封连环信。开始时一个人寄出一封信给其他 10 个人。要求每个人寄出此信给其他 10 个人，而且每封
信都包含该连环里前面 6 个人的列表。除非表中不足 6 个名字，否则每个人都寄一美元给表中第一个人，
从表中删除这个人的名字，把其他 5 个人的名字向上移动一位，并且把他或她自己的名字插入到表的末
尾。若没有人中断这个连环，并且每人至多收到一封信，则这个连环里的一个人最终将收到多少钱?

*12. 要么画出带有 84 个树叶而且高度为 3 的正则 zz 元树，其中关是正整数，要么证明这样的树不存在。

一个完全普元树是其中每个树叶都在同一层上的正则 mm 元树。
13. 构造高度为 4 的完全二叉树和高度为 3 的完全 3 元树。
14. 证明: a)定理 4 的部分(ii) 。b)定理4的部分(iii) 。
15. 在包含总共m 个顶点的上个树的森林里有多少条边?
16. 下面的饱和碳气化合物有多少种不同的同分异构体?
alCa He         bcC; H，，         ccCi Hi，
17. 设”是2的等。证明: 可以用”一1个处理器的树形连接网络在 logn 步里求， 个数之和。
非根树里顶点的离心度是从这个项点开始的最长的简单通路的长度。若在树里没有其他顶点比一个顶点

的离心度更小，则这个顶点就称为中心。在练习 18一19 里，求每一个是所给的树的中心的顶点。
18，     全                   19. 6                       1      了

                                                                                                                                                                                                                              

*20. 证明， 树有一个中心或两个相邻的中心 。

根斐波那契树 T, 是以下面的方式来递归地定义的。T 和 T 都是包含单个顶点的根树，而对)一

3，4，…来说，都是从一个根以 T, :作为左子树并且以 T,_ :作为右子树来构造出根树 T, 。

21. 画出前 7 个根斐波那契树。

22. 下面这个使用数学归纳法的“证明”错在什么地方? 命题: 有?个顶点的每个树都有长度为”一1 的路径。
基础步又: 有 1 个项点的每个树显然有长度为 0 的路径。 归纳步骤: 假设有”个顶点的树有长度为mw一1
的路径， 这个路径以“作为终点。加入项点和从v* 到v 的边。所得出的树有 十1 个顶点并且有长度为
的路径。这样就完成了归纳步骤。

7.2 树的应用

7.2.1 引言

下面将要运用树来讨论三个问题。第一个问题是: 应当如何对列表里的项进行排序，以便可
以容易地找到项的位置? 第二个问题是: 为了在某种类型的一组对象里找出带某种性质的对象，
应当做出一系列什么样的决策? 第三个问题是; 应当如何用位串来有效地编码一组字符?

7.2.2 二又搜索树

:965 在列表里搜索一些项，是计算机科学的一项重要任务。主要目标是实现一个搜索算法，
   当项都完全排序时，这个算法有效地找出项。这个任务可以通过使用二又搜索树来完

成，二叉搜索树是一种二叉树，其中任何顶点的每个子女都指定为右子女或左子女，没有顶点具

有超过一个的右子女或左子女，而且每个顶点都用一个关键字来标记，这个关键字是各项中的一

个。另外，这样指定顶点的关键字，使得顶点的关键字不仅大于它的左子树里的所有顶点的关键



--- 第 332 页 ---
314。第7童 树

字，而且小于它的右子树里的所有顶点的关键字。

这个递归过程用来形成项的列表的二叉搜索树。从只包含一个顶点(即根)的树开始。指定列
表中第一个项作为这个根的关键字。为了添加新的项，首先比较它与已经在树里的顶点的关键字，
从根开始，若这个项小于所比较顶点的关键字而且这个顶点有左子女，则向左移动，若这个项大
于所比较项点的关键字而且这个顶点有右子女，则向右移动。当这个项小于所比较顶点的关键字
而且这个项点没有左子女时，就插入以这个项作为关键字的一个新顶点，并把新顶点作为这个顶
点的左子女。同理，当这个项大于所比较顶点的关键字而且这个顶点没有右子女时，就插人以这
个项作为关键字的一个新顶点，并把新顶点作为这个顶点的右子女。用例 1 来说明这个过程。

例1 构造下面这些单词的二又搜索树(用字母顺序):，mathematics，physics，geography，
zoology，meteorology，geology，psychology 和 chemistry。

解 图7-16 显示了构造这个二又搜索树所用的步又。单词 mathematics 是根的关键字。因为
physics 是在 mathematics 之后(按照字母顺序)，所以给根添加带关键字 physics 的右子女。因为
geography 是在 mathematics 之前，所以给根添加带关键字 geography 的左子女。下一步，给带关键
字 physics 的顶点添加右子女，并且给其指定关键字 zoology，因为 zoology 是在 mathematics 之后
且在 physics 之后。同理，给带关键字 physics 的顶点添加左子女，并且给其指定关键字
meteorology。给带关键字 geography 的顶点添加右子女，并且给其指定关键字 geology。给带关键
字 zoology 的顶点添加左子女，并且给其指定关键字 psychology。给带关键字 geography 的顶点添
加左子女，并且给其指定关键字 chemistry(读者应当完成在每步上所需的所有比较) 。       国

Mathematics                               Mathematics                                Mathematics

_                                                                                                                    Physics
Physics                  Geography “ Physics                    Geography

Zoology

Zoology > Mathematics
Physics > Mathematics         Geography < Mathematics         Zoology > Physics

Mathematics                               Mathematics

Physics
Geography

Zool
Meteorology Zoology                     Meteorology

Psychology          Meteorology Psychology
Psychology > Mathematics

Meteorotlogy > Mathematics        Geology < Mathematics         Psychology > Physics              Chemistry < Mathematics
Meteorology < Physics               Geology > Geography            Psychology < Zoojogy              Chemistry < Geography

 

 7-16 构造二叉搜索树

一旦建立了二叉搜索树 ，就需要一种在二又搜索树中定位元素的方法，还需要一种添加新元
素的方法。算法 1 是一个插和算法，尽管看上去它只是设计在二叉搜索树添加新节点，但实际上
它可以完成上面提到的两个任务。也就是说，算法 1 可以在二叉搜索树定位该元素， 如果一个元
素工不存在，也可以添加该元素 x。在下面的伪代码中，v 是当前正在查看的节点，laie!(y)是该
节点的关键字。算法从根开始查看。如果 的关键字等于zx，那么算法就找到了 z 的位置并结束;
如果工比" 的关键字小，就向v的左孩子节点移动并重复这个过程;，如果 z 比v 的关键字大，就向
”的右孩子节点移动并重复这个过程。如果在任何一步，要移动到的孩子节点并不存在，那么就知
道在这棵二又搜索树中没有 xz，然后就添加一个以 z 为关键字的节点作为这个孩子节点。



--- 第 333 页 ---
第7章 树" 315

 

算法1 二又搜索树算法
procedure insertior(T: 二叉搜索树，z: 项)
 :一了的根
{一个不在 工里出现、具有值 nxl 的顶点}
While v关zag 并且 Lapel(u)尖工
begin
证 zx<< apei(v)then
证的左子女尖null then v :一，的左子女
else 添加 nerw vertezr 作为vv 的左子女并且设置 v :=mzx以
else
证v的右子女尖null then uv :一习 的右子女
else 给 工添加 me vertez 作为ww 的右子女并且设置w :一mut
end
证了工的根一nx: then 给树添加顶点 ~并且用z 标记它
ejlse 证 /ape/(z) 天rz then 用标记pero vertez
{z一工的位置}

 

例 2 说明了算法 1 中二叉搜索树的用法。

例2 运用算法 1 在例 1 的二又搜索树中播人 ocearogratphmy 这个词。

解 算法1以v等于了的根节点开始，v 是当前查看的节点。因此 1apel(z) 一zatjhemaaiics。

因为 v天nx，且 label(u) 一mathematics<< oceanrograbhy，接下来就查看根的右孩子节点。右
孩子存在，因此置当前查看的节点等于这个右孩子。这一步，有 uv尖null, 且 Label(p) = ysics全
ocearography，所以要查看的左孩子。左孩子存在，因此置当前查看的节点 v等于这个左孩子。
在这一步，有 v兴mxi，且 apel(u) 一metereology 一oceanrograpbphy，所以试图查看 v 的右孩子。但
是，这个右孩子并不存在,所以添加一个新的节点来当v的右孩子(此时就是关键字为
oceantograpjhy 的节点)，然后置 v: 一zzxl。因为 v一mul，现在跳出了 while 循环。因为工的根不
是mul 而v一nxlL，所以使用算法结束处的 else 诈 语句让新节点以 oceanrograbphy 为关键字。

现在我们来确定这个过程的计算复杂人性。假定有 ”个项的列表的二叉搜索树工。可以从工这
样构造一个满二叉树 U: 在必要时添加无标记的顶点，以使得每个带关键字的顶点都有两个子女。
这个做法在图 7-17 里说明。一旦这样做了，就容易找出新项的位置，或者添加新项作为关键字而
不添加顶点。

克              也

未标记的项点加了圆图
 7-17 深加无标记顶点使二又搜索树满



--- 第 334 页 ---
316。第7章 树

添加一个新项所需要的比较次数，最多等于在 U 里从根到树叶的最长通路的长度。LU 的内点
都是工的顶点。所以避有?个内点。现在可以利用 7. 1 节定理 4 的部分(iD来得出口有mn十1 个树
叶。利用7. 1节的推论1，可以看出 太的高度大于或等于A= flog("*十1) 1]。所以，必须至少执行
[iog(z十1) 1次比较以添加某个项。注意若 U 是平衡的，则它的高度是[log(z十1)]1(根据 7. 1 节的
推论 1) 。因此，若二叉搜索树是平衡的，则确定一个项的位置或者添加一个项所需要的比较次数
不超过| log("*十1) ]次。当给二又搜索树添加一些项时，该树可能变得不平衡。因为平衡的二叉搜
索树给出二又搜索的最优的最坏情形复杂性，所以添加项时重新平衡二叉搜索树的算法已经设计
出来。感兴趣的读者可以查阅关于数据结构的参考文献来了解这些算法。

7.2.3 决策树
i志和5 根树可以用来为这样的问题建立模型，其中一系列决策将生成一个解。例如，二叉搜
”“， ， 索树可以用来基于一系列比较来找出项的位置，其中每次比较都说明是否已经找到了
项的位置，或者是否应当向右或向左进人子树。其中每个内点都对应着一次决策，这些顶点的子
树都对应着该决策的每种可能后果，这样的根树称为决策树。问题的可能的解对应着这个根树的
通向树叶的通路。下一个例子说明决策树的应用。

例3 假定有重量相同的 7 枚硬币和重量较轻的一枚伪币。为了用一架天平确定这 8 枚硬币中
娜个是伪币，需要多少次称重? 给出找出这个伪币的算法。

了 解 在天平上每次称重结果有三种可能性。分别是: 两个托盘有相同的重量，第一个

托盘较重，或第二个托盘较重。所以，称重序列的决策树是 3 元树。在决策树里至少
有8个树叶，这是因为有8 种可能的后果(因为每枚硬币都可能是较轻的伪币) ，而每种可能的后果
必须至少用一个树叶来表示。确定伪币所需要的最大称重次数是决策树的高度。从 7. 1 节的推论 1
得出决策树的高度至少是「log,8]1王2。因此，至少需要两次称重。

用两次称重来确定伪币，是可行的。说明如何这样做的决策树如图 7-18 所示。     面

  
  

II 加GD和姑

9      @      人@      的      ie      G)
SS入 | 委一一所天一>    一一-
[DO放，加寻 ][LO好用国bt | [DGRE |

亿  @  四      加     鲜      电  Ge

不可能
图7-18 找出伪币位置的决策树。最下面一行为伪币判断结果

 

排序算法的复杂性 已经开发了许多不同的排序算法。为了确定一个具体的排序算法是否有
效，就要确定这个算法的复杂性。用决策树作为模型，可以求出排序算法的最坏情形复杂性的下界。

可以用决策树为排序算法建立模型并且确定对这些算法的最坏情形复杂性的估计。注意给定
个元素，这些元素有 nl 种可能的排序，因为这些元素 "! 种排列中的每一个都可以是正确的顺序。
本书研究的排序算法以及最常用的排序算法都是基于二又比较，即一次比较两个元素。每次这样
的比较都缩小了可能顺序的集合。因此，基于二又比较的排序算法可以表示成二又决策树，其中
每个内点表示两个元素的一次比较。每个树叶表示 个元素的mn! 种排列中的一种。

例4 在图7-19 里显示排序列表 ，2b，c 里元素的决策树。              国

基于二又比较的排序的复杂性是用二叉比较的次数来度量的。排序有?个元素的列表所需要
的最多比较次数就给出了这个算法的最坏情形复杂性。所用的最多比较次数等于表示这个排序过



--- 第 335 页 ---
第7童 树。317

 

 7-19 排序三个不同元素的决策树

程的决策树里的最长通路长度。换名话说，所需要的最多比较次数等于这个决策树的高度。因为
带4l 个树叶的二叉树的高度至少是log z中(利用 7.1 节推论 1) ，所以定理 1 说至少需要fiog zx
次比较。

EEEB国”基于二又比较的排序算法至少需要fiog z赂次比较。

可以用定理 1 来给出基于二又比较的排序算法所用比较次数的大 O 估计。我们知道nog zx中是
@(n log m ，这是算法的计算复杂性经常使用的一个参照函数。推论 1 是这个估计的结果。

ES 基于二又比较的排序算法排序 ”个元素所用的比较次数是 Q(n log m) 。

推论 1 的一个后果是，基于二又比较的排序算法在最坏情形下使用 B(n log m)次比较来排序 "
个元素，其他这类算法都没有更好的最坏情形复杂性，在这个意义下，基于二叉比较的排序算法
是最优的。注意，在这个意义下归并排序算法是最优的。

对于排序算法的平均情形复杂性也可以证明类似的结果。基于二又比较的排序算法所用的平
均比较次数是表示这个排序算法的决策树中的平均树叶深度。我们知道，有 N 个顶点的二叉树的
平均树叶深度是 Q(log N) 。当令 N=mal! 并且注意到因为log nl 一9(n log z) ，所以是Q(liog nz1)的
函数也是 Q(nr log 思时，就会得出下面的估计。

天”基于二又比较的排序算法排序 ”个元素所用的平均比较次数是 Q(n log mm 。

7.2.4 前邹码

考虑一下这样的问题: 用位串来编码英语字母表里的字母(其中不区分小写和大写字母)。可
以用长度为 5 的位串来表示每个字母，因为只有 26 个字母而且有 32 个长度为 5 的位串。当每个字
母都用5 位来编码时，用来编码数据的总位数是 5 乘以文本中的字符数。有没有可能找出这些字母
的编码方案，使得在编码数据时使用的位更少? 若可能，那么就可以节省存储空间而且缩短传输
时间。

考虑用不同长度的位串来编码字母。较短的位串用来编码出现较频繁的字母，较长的位串应
当用来编码不经常出现的字母。当用变化的位数来给字母编码时，就必须用某种方法来确定每个
字母的位在何处开始和结束。例如，著把 e 编码成0，把 a 编码成1，而把 上编码成 01，则位串
0101 可能对应着 eat、tea、eaea 或红。

为了保证没有位串对应着多个字母的序列，可以令一个字母的位串永远不出现在另外一个字
母的位串的开头部分。具有这个性质的编码称为前缓码。例如，把 e 编码成0、把 < 编码成 10、而
把 上编码成 11 的编码就是前级码。从编码着一个单词的字母的唯一位串可以恢复这个单词。例如，
串 10110 是 ate 的编码。为了看明白这一点，注意开始的 1 不表示一个字符，但是 10 表示 a(并且
它不可能是另外一个字母的位串的开始部分)。然后，下一个 1 不表示一个字符，但是 11 表示 /

 



--- 第 336 页 ---
318“*“ 第7童”树

最后一位 0 表示 e。

前组码可以用二叉树来表示，其中字符是树里树叶的标记。标记树的边，使得通向左子女的
边标记为 0 而通向右子女的边标记为 1。用来编码一个字符的位串是在从根到以这个字符作为标记
的树叶的唯一通路上边的标记的序列。例如，图 7-20 里的树表示把 e 编码成0，把 a 编码成 10，
把 上编码成 110，把 ”编码成 1110 和把 * 编码成 1111。

表示编码的树可以用来解码位串。例如，考虑一个用
图7-20 里的编码编成 11111011100 的单词。这个位串可以这样
解码: 从根开始，用位的序列来形成一条到树叶为止的通路。
每个 0 位都使得通路向下到达通向通路里上一个顶点的左子女
的边，而每个 1 位都对应到上一个顶点的右子女。所以，开头
的 1111 对应这样的通路: 从根开始，向右前进四次，到达以*
作为标记的树叶，因为串 1111 是 * 的编码。从第五个位继续进
行，在向右再向左之后，就到达下一个树叶，这时访问以 a 作
为标记的顶点，其中把 a 编码成 10。从第七个位开始，在向右
三次然后向左之后，到达了下一个树叶，这时访问用半标记的
顶点，其中把编码成 1110。最后，末位 0 通向用e标记的树 ”图7-20 表示前级码的二又树
叶。因此，原来的单词是 sane。

可以从任何二叉树来构造一个前缀码，其中每个内点的左边都用 0 标记，而右边都用 1 标记，
树叶都用字符标记。字符都用从根到这个树叶的唯一通路里的边的标记所组成的位串来编码。
3 替夫曼编码 ”现在介绍一种算法，这种算法用一个字符串中符号的出现频率(即出现概

     率)作为输入，并且产生编码这个字符串的一个前级码作为输出，在这些符号的所有可
能的二叉前缀码中，这个编码使用最少的位。这个所谓赫夫受编码的算法是大卫。 替夫曼 1951年
做麻省理工学院的研究生时发表在一篇学期论文中的。(注意，这个算法假定已知字符串中每个符
号出现多少次，所以可以计算每个符号的出现频率，方法是用这个符号出现的次数除以这个字符
串的长度。)赫夫曼编码是数据压缩中的基本算法，数据压缩的目的在于减少表示信息所需要的位
数。赫夫曼编码广泛用于压缩表示文本的位串，并且在压缩视频和图像文件方面也起到重要作用。

cgeh55 算法 2 表示协夫曼编码算法。给定符号及其频率，目标是构造一个根二叉树，其中符

”号是树叶的标记。算法从一些树的一个森林开始， 每个树含有一个项点，每个顶点有
一个符号作为标记，并且这个顶点的权就等于所标记符号的频率。在每一步，都把具有最小总和
权的两个树组合成一个单独的树，方法是引入一个新的根，把具有较大的权的树作为左子树，把
具有较小的权的树作为右子树。另外，把这个树的两个子树的权之和作为这个树的总的权。(虽然
可以规定在具有相同的权的树之间进行选择以打破平局的过程，但是这里将不具体指定这样的过
程。)当构造出了一个树，即森林缩小为单个树时，算法就停止。

 

算法 2 ”幸夫总编码
procedure 再xj fanr(C: 具有频率 山 的符号aj，i一1，2，…，7m)
下 :一?个根树的森林，每个根树由单个项点 ai 组成并且赋权
while 上不是树
begin
把上中满足zw(三z(荆)的权最小的根树 了和T'换成具有新树根的一个树，

这个树根以 工作为左子树并且以 T作为右子树。
用0 标记树根到 T的新边，并且用 1 标记树根到 全的新边。
把 w(T)十ww(人)作为新树的权。
end

{符号 w 的赫夫曼编码是从树根到a, 的唯一路径上的边的标记的连接}

 



--- 第 337 页 ---
第7章 树。319

例 5 说明如何用算法 2 来编码一组 5 个符号 。
 例5 用赫夫总编码来编码下列符号，这些符号具有下列频率: A: 0.08，B: 0. 10，
     C:, 0.12，D: 0.15，E:, 0.20，F:， 0. 35。编码一个字符串所需要的平均位数是多少?
解 图7-21表示了编码这些符号所用的步骤。所产生的编码为; A是111，B是110，C 是
011，D是010, 下是10，F是00。使用这种编码来编码一个符号所用的平均位数是

 

3。0.08十3。0. 10十3 。 0. 12十3。0. 15十2。0. 20十2。0. 35一2. 45              出
0.08           0.10          0.12           0.15          0.20           0.35      最初
大             短
和A             B             &             D             的森林
0.12           0.15             0.18             0.20          0.35           第1步
二             生                               硬             生
C             D           0      1            下             F
B      A
0.18             0.20             0.27             0.35               第2步
如                                二
F
B      从                        D      C
0.27                 0.35                                                     第3步
D      C
0.38                                                     第4步
0      1
下
0      1
B      A
第5步

 

图7-21 例5中符号的赫夫坚编码

注意赫夫曼编码是贪心算法。在每一步奉换具有最小权的两棵树，在没有任何二叉前级码能
使用更少的位来编码这些符号的情况下，这样做就导出了最优编码。

赫夫曼编码有许多变种。例如，不编码单个符号，可以编码指定长度的符号块，比如两个符
号的块。这样做有可能减少编码这个字符串所需要的位数。也可以用两个以上的符号来编码这个
符号串中的原始符号(参看本节末练习 15 前面的说明)。另外，当事先不知道一个字符串中每个符
号的频率时，可以使用一种变种，即所谓的自适应替夫曼编码(参见[Sa00])，使得在读这个字符
中的同时来进行编码。



--- 第 338 页 ---
320。第7章 树

7.2.5 博弈树

.硬卫5 可以用树来分析某些类型的游戏，比如图叉游戏、轮流取石头游戏、跳棋和象棋。在
每一种游戏当中，两个选手轮流进行移动。每个选手知道另一个选手的移动并且游戏
里不存在偶然因素。使用博弈树为这样的游戏建立模型，这些树的顶点表示当游戏进行时游戏所
处的局面，边表示在这些局面之间合乎规则的移动。由于博弈树常常很大，所以通过用同一个项点
表示所有对称的局面来简化博弈树。但是，如果一个游戏的不同移动序列导致同一个局面，则可以
用不同的顶点来表示这个局面。通常的约定是用方框表示人偶数层的顶点并且用圆圈表示奇数层的项
点。当游戏处在偶数层顶点所表示的局面时，就轮到第一个选手移动。当游戏处在奇数层顶点所表
示的局面时，就轮到第二个选手移动。博弈树所表示的游戏可以永远不结束，比如进入了无穷循环，
因而博弈树可以是无穷的，但是对于大多数游戏来说，都存在一些规则导致有穷的博弈树。

博弈树的树叶表示游戏的终局。给每个树叶指定一个值，来表示当游戏在这个树叶所代表的
局面里终止时第一个选手的得分。对于非胜即负的游戏,用 1来标记圆圈所表示的终结顶点以表
示第一个选手获胜，用一1 来标记方框所表示的终结顶点以表示第二个选手获胜。对于允许平局的
游戏，用 0 来标记平局所对应的终结项点。注意，对于非胜即负的游戏，为终结顶点指定值，这
个值越高，第一个选手的结局就越好。

例 6 展示一个非常著名的和经过深入研究的游戏的博弈树 。

例6 轮流取石头游戏 轮流取石头游戏是这样的，在游戏的开始，有几堆石头，两个选手轮
流进行移动，一个合法的移动包括从其中一堆取走一块或多块石头，而不去移动其余的所有石头。
不能进行合法移动的选手告负。(也可以规定取走最后一块石头的选手告负，因为不允许没有石头
堆的局面.)图7-22 所示的博弈树表示这种形式的给定开局的轮流取石头游戏，其中有 3 堆石头，
分别包含2块、2 块和 1 块石头。用不同堆中石头数的无序表来表示每个局面(堆的顺序无关紧
要)。第一个选手的初始移动可以导致 3 种可能的局面，因为这个选手可以从有 2 块石头的堆中取
走 1 块石头(留下包含1块、1块和2 块石头的3堆)，可以从包含 2.块石头的堆中取走 2 块石头(留
下包含2块和1 块石头的2堆)，或者从包含 1 块石头的堆中取走 1 块石头(留下包含 2 块石头的 2
堆) 。当只剩下包含 1 块石头的 1 堆时，就不可能进行合法移动了，所以这样的局面就是终局。由
于轮流取石头游戏是非胜即负的游戏，所以用十1 标记表示第一个选手获胜的终结顶点，用一1 标
记表示第二个选手获胜的终结顶点 。           图

2
区 站 砚 加和 轧吕局
?99og99e9 eS
四|加           四1厅           四

-1      -上                       -1      -1                      本|              如果第二个选手获胜，
终结顶点标记为-1
图 7-22 ”轮流取石头游戏的博弈树



--- 第 339 页 ---
第7章 树"321

例7 国叉游戏 圈叉游戏的博弈树非常大，在这里不能画出，尽管计算机能轻而易举地构造
出这样的树。图 7-23a 显示圈叉游戏的博弈树的一部分。因为对称的顶点是等价的，所以只需要
考虑图 7-23a 所示的 3 种可能的初始移动。还显示这个博弈树的导致图7-23b 中终局的一个子树，
其中一个能够获胜的选手进行了制胜的移动。

 7-23 圈叉游戏的部分博弈树

可以用某种方式递归地定义博弈树中所有项点的值，使得可以确定当两个选手都遵循最优策
略时这个游戏的结果。所谓策略，就意味着一组规则，这些规则说明一个选手如何移动来赢得游
戏。第一个选手的最优策略就是把这个选手的得分最大化的策略，第二个选手的最优策略就是把
这个得分最小化的策略 。现在递归地定义项点的值。

区 圭弃树中顶点的值递归地定义为:

CD一个树叶的值是当游戏在这个树叶所表示的局面里终止时第一个选手的得分。

《iD偶数层内点的值是这个内点的子女的最大值，奇数层内点的值是这个内点的子女的最
小值。

第一个选手移动到具有最大值的子女所表示的局面并且第二个选手移动到具有最小值的子女
所表示的局面，这样的策略称为最小最大策略。当两个选手都遵循最小最大策略时，通过计算树
根的值就可以确定谁将赢得游戏，这个值称为树的值。这是定理 3 的后果。

如果两个选手都遵循最小最大策略并且从博弈树的某一个顶点所表示的局面开始进
行游戏，则这个顶点的值说明第一个选手的得分。

证 将用归纳法来证明这个定理。

基础步骤: 如果这个顶点是树叶，则根据定义指定给这个顶点的值就是第一个选手的得分。

归纳步骤: 归纳假设一个顶点的子女的值就是第一个选手的得分，假定从这些顶点所表示的
每一个局面中开始进行游戏。需要考虑两种情形 ，即当轮到第一个选手时和当轮到第二个选手时。

当轮到第一个选手时，这个选手遵循最小最大策略并且移动到具有最大值的子女所表示的局
面。根据归纳假设，当从这个子女所表示的局面开始游戏并且遵循最小最大策略时，这个值就是_

 



--- 第 340 页 ---
322。第7童 树

第一个选手的得分。根据偶数层内点的值的定义的递归步骤(作为其子女的最大值)，当从这个项
点所表示的局面开始游戏时，这个顶点的值就是这个得分。

当轮到第二个选手时，这个选手遵循最小最大策略并且移动到具有最小值的子女所表示的局
面。根据归纳假设，当从这个子女所表示的局面开始游戏并且遵循最小最大策略时，这个值就是
第一个选手的得分。根据把奇数层内点的值作为其子女的最小值的递归定义，当从这个顶点所表
示的局面开始游戏时，这个项点的值就是这个得分。                             口

注意 ”通过扩展定理 3 的证明，可以证明对于两个选手来说最小最大策略都是最优策略。

例8 解释最小最大过程如何工作。它说明为例6 的博弈树中的内点所指定的值。注意可以缩短
所需要的计算，注意到对于非胜即负游戏来说，一旦找到方框顶点具有十1 值的一个子女，则方杠
顶点的值也是十1，因为十1 是最大可能的得分。同样，一旦找到圆圈顶点具有一1 值的一个子女，
则这个值也是这个圆圈项点的值。

例8 例6构造了具有包含2块、2 块和1 块的 3 堆石头的开局的轮流取石头游戏的博弈树。
图7-24 说明这个博弈树的顶点的值。这些顶点的值是这样计算的: 使用树叶的值并且每次向上计
算 1 层。这个图的右边空白处说明究竟使用子女的最大值还是最小值来求出每层内点的值。例如，
一旦求出了树根的 3 个子女的值，则这样求出树根的值; 计算 max(1，一1，一1)=1。由于根的值
是 1，所以得出当两个选手都遵循最小最大策略时第一个选手获胜。                      轿

+ 22               max
|    团轴轴加1加 | [LU m
4   .   4    4      + 了酉       2 本

二

GiOkOIOOIOIOIOIORONEREOM
-1 -[ +| +1     -] +!}  二|  .

一!    -1 +    十

-1    -1              -|
图 7-24 说明轮流取石头游戏中顶点的值

“ ”估计象棋的博弈树有多达 10"个顶点! 由于博弈树规模的原因，也许不可能直接使用
定理 3 来研究这样的游戏，所以设计了各式各样的方法来帮助确定好的策略以及确定游戏的结果。
一种被称作c一8前枝的有用技巧减少了许多计算，它剪掉不能影响祖先项点的值的那部分博弈树
(关于 一8剪枝的信息，参考[Gr90]) 。另一种有用的方法是使用求值函数，当精确地计算博弈树
中内点值不可行时，它就估计这些值。例如，在圈叉游戏中，可以使用不含圈 O(O 用来表示第二
个选手的移动)的直行(行、列、对角线)数减去不含又 X(X 用来表示第一个选手的移动)的直行数
来作为一个局面的求值函数。这个求值本数给出了关于哪个选手在游戏中领先的一些说明。_一日
插入求值函数的值，遵循最小最大策略使用的规则就可以计算出游戏的值。科学家研制出来的用

0 一些著名游戏的博弈树可能非同寻常地大，因为这些游戏有多种移动选择。例如，据



--- 第 341 页 ---
第7童 树。，323

来下棋的计算机程序，比如著名的深蓝程序，都是基于复杂的求值函数的。关于计算机如何下模
的更多信息请参看[Le91] 。

练习

1. 用字母顺序建立下面这些单词的二叉搜索树 ，parara，zpeacji，appie，zpear，coconat，7mango 和 papaya。

2. 为了在练习 1 的搜索树里找出下面每个单词的位置或者添加它们，而且每次都重新开始，分别需要多少次
比较?
a)zpear        b)panana         C)大MT72gHGE         d)oramge

- 用字母顺序构造下面句子里的单词的二叉搜索树: “The guic& brorar oz jumaps ovuer ihe Lazy dog”。

- 著一枚伪币与其他硬币质量不等，  那么为了在《 枚硬币中找出这枚伪币，  需要用天平称多少次? 描述用同
样的称重次数来找出这枚伪币的算法。

*5. 若一枚伪币比其他硬币较轻，那么为了在 12 枚硬币中找出这枚伪币，需要用天平称多少次? 描述用同样

的称重次数来找出这枚伪币的算法。
*6. 求排序 4 个元素所需要的最少比较次数并且设计一个能够依此次数实现的算法。

竞者图排序是通过构造有序二叉树来工作的排序算法。用将成为树叶的顶点来表示待排序的元素。就如
同构造表示循环赛比赛胜者的树那样，一次构造这个树的一层。从左向右，比较成对的相邻元素，加入用所
比较的两个元素中较大的那个来标记的一个父母顶点。在每一层在顶点的标记之间进行类似的比较，直到到
达了用最大元素标记的树根为止。22，8，14，17，3，9，27，1l 的竞赛图排序所构造的树如下图(a)所示。
一旦确定了最大元素，具有这个标记的树叶就重新标记为一c"，定义为比每个元素都小。从这个顶点直到树
根的路径上所有项点的标记都重新计算，如下图(b)所示。这样就产生了第二大元素。这个过程继续进行下
去，直到整个表都已经排序为止。

吴 《3

27是最大元素

(22) 2?是第二大元素

    

a)                                                                                                                              b)

7. 完成表 22，8，14，17，3，9，27，11 的竞赛图排序。说明在每个步骤上顶点的标记。

8. 用伪码描述竞赛图排序 。

9. 竞赛图排序求第二大元素、第三大元素……: ，直到第(一1)大(或第二小?元素所使用的比较次数是多少?

10. 三面哪些编码是前组码?

a)a: 1]11，e: 00，!: 10，5s: 01

b)a: 0，e: 1，t:; 01，s:， 001

c)a:x 101，e: 11，t: 001，s: 011，mn:， 010

d)a: 010，e: 11，t: 011，s: 10I1，mn:， 1001，i，10101

11. 若编码方案是用右面的树来表示，那么什么是ae、e、i、A、o、
户和zx 的编码?

12. 用蔡夫曼编码来编码具有给定频率的如下符号: a; 0. 20，b，
0. 10，c: 0.15，d: 0.25，e: 0.30。编码一个符号所需要的
平均位数是多少?

13. 为如下符号和频率构造两个不同的赫夫曼编码: :+: 0.2，u:
0.3，p: 0.2，z: 0. 3。

14, 为英文字母表的字母构造赫夫受编码，其中典型英文文本中字
母的频率如下表所示 。

 



--- 第 342 页 ---
324"第7章 树

 

A                                                  N
也                                                  OO
C                                                  P
D                                                  马
己                                                  R
F                                                  S
G                                                  工
H                                                  U
1I                                                  V
J                       权
K                                                  X
LI                                                  Y
M                                                  了Z

假设 mm是正整数且普过2。对于 入个符号的集合来说，类似于二元替夫曼编码的构造，可以构造 普 元幸
夫曙编码。在初始步又，把由(CN一1)mod(m一1))十1 个权最小的单个顶点所组成的树组合成以这些顶点作
为树叶的一棵树 。在每个后续步又，把权最小的 mm 棵树组合成一棵关 元树 。

15. 使用符号0、1 和2，用三元(m一3)赫夫曼编码来编码具有给定频率的这些字母: A: 0.25，E:， 0. 30，

N: 0.10，R: 0.05，T: 0.12，Z: 0. 18。

16. 给定 za十1个符号 zi ，，…，xz，zo+l，它们在一个符号串中分别出现1，万，户，…，太次，其中万
是第/个斐波那契数。当在幸夫曼编码算法的每个阶段考虑所有可能的打破平局的选择时，用来编码一
个符号的最大位数是多少?

17. 画出轮流取石头游戏的博弈树，假设开局包括分别有 2 块和 3 块石头的两堆石头。在画这棵树的时候，
用同一个顶点表示相同移动所导致的对称局面。求出这个博弈树每个顶点的值。如果两个选手都遵循最
优策略，则哪个选手获胜?

18. 假设在轮流取石头游戏中修改获胜选手的得分，使得当= 是到达终局前所做合法移动的步数时得分就是
美元。求第一个选手的得分，假设开局包括 :

a)分别有 1 块和 3 块石头的两堆石头。
b)分别有 2 块和4 块石头的两堆石头。
c)分别有1块、2 块和 3 块石头的三堆石头。
19. 画出图又游戏博弈树从下列每个局面开始的子树。确定每个子树的值。

a O|X|x 95 Xj|o|x 9 xl |o
x|olo  O|x|x O
X    O  Xx| |x

20. 证明: 如果轮流取石头游戏从包含相同数目的 2 堆石头开始，只要这个数目至少是 2，则当两个选手都遵
循最优策略时第二个选手获胜。

21, 跳棋博弈树的根有多少个子女? 有多少个孙子女?

22. 画出圈叉游戏博弈树前两步移动所对应的层。指明正文中所提到的求值函数的值，这个函数给局面指定
不含口的直行数减去不含X的直行数来作为这一层每个项点的值，并且在求值函数给出这些项点的正确
值的假设下，对这些顶点计算树的值。

7.3 树的遍历

7.3.1 引言

2 有序根树常常用来保存信息。掌握一些访问有序根树的每个顶点以存取数据的算法是
“′… ”非常必要的。几个重要的算法将在下面描述。有序根树也可以用来表示各种类型的表
达式，比如由数字、变量和运算所组成的算术表达式。对用来表示这些表达式的有序根树来说，



--- 第 343 页 ---
第7章 树，325

它的顶点的一些不同的列表在这些表达式的求值中很有用。

7.3.2 通用地址系统
遍历有序根树的所有顶点的过程，都依赖于子女的顺序。在有序根树里， 一个内点的子女从
左向右地显示在表示这些有向图的图形里。
下面将描述一种完全地排序有序根树顶点的方法。为了产生这个顺序，必须首先标记所有的
顶点。如下递归地完成这件事。
1. 用整数 0 标记根。然后用1，2，3，…，,， 大从左向右标记它的&个子女(在1层上)。
2. 对在层上带标记A 的每个项点v，按照从左向右画出它的&. 个子女的顺序，用 4. 1，
A.2，…，A.&标记它的&. 个子女。
遵循这个过程，对 "1来说，在”层上的顶点标记成zi. rz.….zx,，其中从根到v的唯一通
路经过 1 层的第 z, 个顶点，以及 2 层的第 二 个顶点，依此类推。这样的标记称为根树的通用地址
系统。
可以利用顶点在通用地址系统里的标记的字典顺序将这些顶点完全排序。若存在 i(00委ji委站满
足z一力，T一yp Zr-i一yi，并且盖yi 或者若 na<mm 并且对i王1，2，…， 7来说 z,一
y，那么标记着 xi. zz. …-. r 的顶点就小于标记着 y yz. …. ， 的顶点。
例1 在如图7-25 所示的有序根树的顶点的旁边，显示出了通用地址系统的标记。这些标记
的字典顺序是
0一1一1.1二1.2一1.3一2一3一3.1一3.1.1一3.1.2一3.1.2.1一3.1.2.2
<一3.1.2.3一3.1.2.4二3.1.3一3.2一4一4.1一5一5.1一5.1.1一5.2一5.3    面

 

3.1.21 / 3.1.23 |
3.1.2.2   3.1.2.4

图 7-25 有序根树的通用地址系统

7.3.3 遍历算法

系统地访问有序根树每个顶点的过程都称为遍历算法。下面描述三  个最常用的此类算法:  前
序遍历、中序遍历和后序遍历。这些算法都可以递归地定义。首先定义前序遍历。
拓    设工是带根 ~ 的有序根树。若 工具包含r，则 ~是工的前序遍历。否则，假定 T，
五，…，下是工里在~处从左向右的子树。前序遍历首先访问 >。它接着以前序来遍历 站 ，然后

 



--- 第 344 页 ---
326。第7章 树

以前序来遍历 人 ，依此类推，直到以前序来遍历了 T, 为止。

读者应当验证，有序根树的前序遍历给出与利用通用地址系统所得出的顺序相同的顶点顺序。
图 7-26 说明如何执行前序遍历。

例 2 说明前序遍历。

例2 前序遍历以什么顺序访问图 7-27 所示的有序根树里的顶点?

步骤1 了  访问r

                                                                                                                                                                                                                                                                  
  

前序遍历

 

步骤2:        步骤3:                 步骤m+1:
前序访问mi 前序访问刀              前序访问到
图7-26 前序遍历                                  图 7-27 有序根树 代

了 解 工的前序遍历的步骤如图 7-28 所示。这样以前序来遍历 T，首先列出根 s，接着
        依次是带根的子树的前序列表，带根 c 的子树(它只有 c)的前序列表和带根 4 的子树
的前序列表。

带根尹的子树的前序列表首先列出4&，然后以前序列出带根 e 的子树的顶点，然后以前序列出
带根 了的子树(它只有 万的顶点。带根 4 的子树的前序列表首先列出d，接着是带根 & 的子树的前
序列表，接着是带根疡的子树(它只有 总 ，接着是带根i 的子树(它只有 站 。

带根 e 的子树的前序列表首先列出 *，接着是带根7 的子树(它只有 力的前序列表，接着是带根
的子树的前序列表。带根 g 的子树的前序列表是 g 接着!，接着是 m。带根& 的子树的前序列表是

 

&，7mz，o0，访。所以，工的前序遍历是ae，b，e，7J，，mz，o，访，，c，d，gE，!，m，疡，i。    国
现在将定义中序遍历。
ER 设工是带根r~ 的有序根树。若工只包含r，则-是工的中序遍历。否则，假定 ，
T，…，T,是工里在-处从左向右的子树。中序遍历首先以前序来遍历 T，然后访问 ~。它接着

以中序来遍历 T ，中序遍历  ，依此类推，直到以中序来凯历了 世, 为止。

图 7-29 说明如何执行中序遍历。例 3 说明对一棵特定的树，如何执行中序遍历 。

例3 中序遍历以什么顺序访问图 7-27 所示的有序根树 人工里的顶点?

要汉 解 工的中序遍历的步骤显示在图 7-30 里。中序遍历首先是带根 5 的子树的中序遍历，
    然后是根 gs，带根 c 的子树(它只有 c)的中序列表和带根 d 的子树的中序列表。

带根4 的子树的中序列表，首先是带根 e 的子树的中序列表，然后是根 5，以及 F。带根 d 的
子树的中序列表，首先是带根 g 的子树的中序列表，接着是根 &，接着是 A，接着是 ;i。

带根 e 的子树的中序列表是放，接着是根 e，接着是带根《的子树的中序列表。带根 g 的子树
的中序列表是上!，g，和2。带根& 的子树的中序列表是ma，&，o，z。所以，这个根树的中序遍历是
J，e，1， KR，0，力 D，夏，a，c，7L，5，71，d，，io。                            国
现在定义后序遍历。

本 设了是带根-的有序根树。若 工只包含r，则 >是工的后序遍历。否则，假定 T ，
Ti，…，T, 是工里在 处从左向右的子树。后序遍历首先以后序来人遍历 Ti ，然后以后序来遍历
T ，…然后以后序来遍历 T,，最后访问 ~。

 



--- 第 345 页 ---
第7章 树。327

   
                                                                                                                                                                                                                                                                    

前序遍历: 访问根，从左
至右访问子树

户 下
人八-
1
1 mm
烛 和 二

[
[
从
二
m
总
名

Prceoad8g Im 1
和

图7-28 了的前序遍历

步骤2: 访问r
中序遍历

步骤1:            步骤3:                          步骤m+1:
中序访问思       中序访问好                      中序访问7

图 7-29 中序遍历



--- 第 346 页 ---
325。第7章 树

中序妃历”访问最左子树，
访问根，从左至右态问其
他子树

 

 

了    1 用

站 0 访

Je人人prarc 1 8 hd ji

AN
1 oO 了

egkoDpbyrarc lg8mnnd 请 :
和

图 7-30 工的中序遍历

图7-31 说明后序遍历是如何执行的。例 4 说明后序遍历如何工作。
例4 后序遍历以什么顺序访问图 7-27 所示有序根树 工里的顶点?
民营。。 解 工的后序遍历的步骤显示在图 7-32 里。后序遍历首先是带根的子树的后序人遍历，
然后是带根 c 的子树(它只有 c)的后序遍历，带根 4 的子树的后序遍历，接着是根 a。
带根8 的子树的后序遍历首先是带根e 的子树的后序遍历，接着是 F，接着是根 5。带根 d 的
子树的后序遍历首先是带根 8 的子树的后序遍历 ，接着是 A，接着是;，接着是根 4 。



--- 第 347 页 ---
第7章 树。，329

六         步骤m+1   访问~

   

后序这历

步骤1:                 步骤2:                                       步骤六
后序访问嫉 后序访问刀      后序访问7
图7-31 后序遍历

后序遍历 : 从左至右
访问子树 ,访问根

鲁 从

 

了
雪 包 四

图7-32 工的后序遍历



--- 第 348 页 ---
330。第7童 树

带根 e 的子树的后序遍历是 ，接着是带根 &的子树的后序遍历，接着是根 e。带根 g 的子树
的后序遍历是!，zm，g8。带根&的子树的后序记历是z，o，户， 上。因此，根树 了的后序遍历是7，
1 0，力，R，e，厂，D，c，7!，71，g，疡id，a。                              图

有一些简易的方法以前序、中序和后序来列出有序根树的顶点。首先从根开始围绕有序根树
画一条曲线，如图 7-33 里的例子所示，沿着边移动。可以这样掖照前序来列出顶点: 当曲线第一
次经过一个项点时，就列出这个顶点。可以这样按照中序来列出顶点: 当曲线第一次经过一个树
叶时，就列出这个树叶，当曲线第二次经
过一个内点时就列出这个内点。可以这样
按照后序来列出顶点: 当曲线最后一次经
过一个顶点而返回这个顶点的父母时，就
列出这个项点。当在图 7-33 的根树里这样
做时，结果是前序遍历给出 <，5，d，A，
e， ijJ，c，厂，g，R&i 中序遍历给出 六
d， pp，i，e，jJ，a，，c， k，8gi 后序痪
历给 出 产， 过， 1 J，e， 了 &， 如，
C，a。

这些以前序、中序和后序来遍历有序
根树的算法，最容易用递归来表示。

 

图 7-33 以前序、中序和后序来遍历有序根树的快捷方法

算法1 前序记历
procedure reorder(T，有序根树)
ri:一了的根
列出 r
for 从左到右的~的每个子女
begin
Tc) :一以*e 为根的子树
思reorder(T(c))
end

算法 2 中序遍历
procedure ;imorcder(T: 有序根树)
r :一工的根
证是树叶 then 列出
else
begin
! :一从左到右的-的第一个子女
T(0 :一以!为根的子树
imporder(了(7))
列出-
for 除! 外从左到右的r 的每个子女 c
Tc) :=以e 为根的子树
iorcder(了(cec))
end

 



--- 第 349 页 ---
第7章 树"331

算法3 后序遍历

procedure ostorcder(T: 有序根树)
r ;一开的根

for 从左到右的-的每个子女c

begin
T(c) :=以ce为根的子树
思ostorcder(了T(c) )

end

列出

 

注意，当规定了每个项点的孩子数时，有序根树的前序遍历和后序遍历的编码结构相同。也
就是说，当指定树的前序遍历或者后序遍历所生成的顶点列表和每个顶点的孩子数目，有序根树
是唯一确定的(见练习 13) 。一般地，所有有序 z元树的前序人遍历和后序遍历的编码结构相同 。然
而，当不规定每个项点的孩子数时，有序根树的前序遍历和后序遍历编码结构都不同(见练习 14) 。

7.3.4 中妇、前缀和后邹记法

可以用有序树来表示复杂的表达式，比如复合命题，集合的组合，以及算术表达式。例如，
考虑由运算十(加)、一(减)、* (乘)、/(除) 、+《〈守)所组成的算术表达式的表示。我们将用括号
来说明运算次序。有序根树可以用来表示这样的表达式，其中内点表示运算，树叶表示变量或数
字。每个运算都作用在它的左子树和右子树上(以此顺序) 。

例5 表示表达式((z十y) 2)十((z一4)/3)的有序根树是什么?

解 ”这个表达式的二叉树可以自底向上来构造。首先，构造表达式 z十y 的子树; 然后，加人
这个子树作为表示(z十y) + 2 的更大子树的一部分。同样，构造表达式 zx一4 的子树，然后，加入
这个子树到表示(z一4)/3 的子树里， 最后,组合表示(z十y) 人2 与(xz一4)/3 的子树来形成表示
(CCz十y) 个2)十((z一4)V3)的有序根树。这些步骤都显示在图7-34 里。           国

 

 7-34 表示((z十y)人42)十((z一4)7/3)的二叉树

对表示一个表达式的二叉树的中序遍历，产生原来的表达式，其中元素和运算都是按原有的
次序出现，例外的是一元运算，它们紧随运算对象。例如，图 7-35 里的二叉树分别表示表达式
(z十y)/(z十3)，(z十(CXWz))十3 和<z十(CXWCz十3))，对它们的中序遍历都得出中表达式rz十Wz十3。
为了让这样的表达式无二义性，每当遇到运算时，就有必要在中序记历里包含括号。以这种方式
获得的带完整括号的表达式称为中缓形式。

当以前序来壳历表达式的根树时，就获得它的前组形式。写成前级形式的表达式称为波兰记法，
它的命名由来于逻辑学家扬，武卡谢维奇(其实他是乌克兰人而非波兰人)。前绷记法下的表达式(其
中每个运算都有规定的运算对象数)都是无二义性的。对这个事实的验证留给读者作为练习。



--- 第 350 页 ---
     AN AN
人      人
人AN AAS     AS

 7-35 ”表示(z十y)/(z十3)，(z十(yz))十3 和xz十(y/(Cz十3))的根树

例6 ((z+y)+2)十((z一4)V3)的前级形式是什么?

解 通过遍历图7-34 所示的表示这个表达式的二叉树，就获得它的前邹形式。这样就产
生十+十zy2/一z43。                                                           国

在表达式的前缀形式里，二元运算(比如十)在它的两个运算对象之前。因此，可以从右向左
地求前绥形式的表达式的值。当遇到一个运算时，就对在这个运算右边紧接着的两个运算对象来
执行相应的运算。另外，每当一个运算执行时，就认为结果是新的运算对象。

例7 前缀表达式十一* 235/ +234的值是什么?

解 ”用来从右向左地求这个表达式的值所用的步又，以及用右边的运算对象来执行的运算，
都如图 7-36 所示。这个表达式的值是 3。                                              国
他击感入 通过以后序来遍历表达式的二叉树，就获得它的后缓形式。写成后缀形式的表达式称

“人”为是递波兰记法。逆波兰记法下的表达式都是无二义性的，所以就不需要括号。对这
个事实的验证留给读者 。

例8 (〈((z十y)人2)十((z一4)/3)的后组形式是什么?

解 ”这个表达式的后组形式是这样获得的: 执行图7-34 所示的表示它的二叉树的后序遍历，
这样就产生后级表达式 xy十2 人 z4一3 /十。                      击

在表达式的后缀形式里，二元运算都是在它的两个运算对象之后。所以，为了从一个表达式
的后缀形式来求它的值，就从左向右地进行,每当一个运算后面跟着两个运算对象时，就执行这
个运算 。在一个运算执行之后，这个运算的结果就成为一个新的运算对象 。

例9 后缀表达式723 *一4个93/十的值是什么?

解 ”如图7-37 所示，求这个表达式的值所用的步骤是这样的: 从左边开始，当两个运算对象

后面接着一个运算时，就执行这个运算。这个表达式的值是4。              国
+ 一23511T 2 3 4   7 2 3* 一41T19 3 / +
|    L___ IJ
21T3=8      2x3=6
+ 一和和235 1/ 8 14      7 6 -419 3 / +

|
814=2      7-6=1

+ 一 * 2 3 5 2        141T19 3 / +
L-一-一          L___
2*3=6            14= 1

+ -6 5 2          1] 9 3 / +

|            LI
6-5=1              913=3
+ 1 2             1 3 +
一一            L_ 1
1+2=3              1+3=4

表达式的值: 3                                表达式的值: 4

图7-36 求一个前缀表达式的值        图 7-37 求一个后缀表达式的值



--- 第 351 页 ---
第7章 树。333

根树可以用来表示其他类型的表达式，比如那些表示复合命题、集合组合的表达式。在这些
例子里出现比如命题和否定这样的一元运算。为了表示这样的运算及其运算对象，就用顶点表示运
算并且用这个顶点的子女表示运算对象。    .

例 10 求表示复合命题(-(户人9))**(-训V -9)的有序根树。然后用这个根树求这个表达式的
前级、后级和中朋形式。         ，                          -

了 解 ”这个复合命题的有序根树是自底向上地构造的。首先，构造-户和-2 的子树(其中
把一当作一元运算)。另外，构造 训人ge 的子树。然后构造一(户人9)和(一户) V (-9)的子
树。最后，用这两个子树来构造最终的根树。这个过程的步骤显示在图7-38 中。

 

 7-38 构造一个复合命题的根树

求表达式的前缀、后级和中级形式:; 分别以前序、后序和中序来遍历这个根树(包含括号) 。
这些遍历分别给出一一人peV -如-9，p9g人-力-g 一V和(-(p人da))((玉)V(-9))。      国

因为前级表达式和后级表达式都是无二义性的，而且不用来回扫描就容易求出它们的值，所
以它们在计算机科学里大量使用。这样的表达式对编译器的构造是特别有用的。
练习

在练习 1一2 里，对给定的有序根树构造通用地址系统。然后利用这个通用地址系统并且用项点的标记的
字典顺序来排序项点。

人

3. 假定在有序根树 工里，地址最大的项点的地址是 2. 3. 4. 3. 1。是否有可能确定 工里的顶点数?
在练习 4一5 里，确定前序饥历访问所给的有序根树的顶点的顺序。



--- 第 352 页 ---
334。第7章 树

 

6. 使用后序遍历，以什么顺序访问练习4 里有序根树的顶点?
7. 使用后序遍历，以什么顺序访问练习 5 里有序根树的项点?
8. 用二叉树来表示表达式(z十zy)十(z/y)和 z十((zy十z)/y)。表示方式应采用:

a)前级记法      b)后缀记法      c)中组记法
9. 用有序根树来表示(4站B)一(4AU(B一A))。表示方式应采用;

a)前缀记法              b)后级记法              c)中缀记法
*10。 有多少种方式给字符串 4 B一AUB一4完全加上括号以便产生中邹表达式?
11. 下面每个前级表达式的值是什么?

a)一xx 2/1843              b) +一*33#x上 425
c)十一个32 个237/6一42            d)* 十3十3 个 3十3 3 3

12. 构造前序遍历为ae，b，F，c，g，jh，i，d，e，j, 大/的有序根树，其中 ae 有四个子女，c 有三个子女，
了有两个子女,上 和e 都有一个子女，所有其他顶点都是树叶 。

*13. 证明，当规定了有序根树的后序遍历所生成的顶点列表，并且规定了每个顶点的子女数时，这个有序根
树是唯一确定的。

14. 证明,， 下图所示的两个有序根树的后序遍历产生相同的顶点列表。注意这个结果不与练习 27 里的命题相
矛盾，因为在这两个有序根树里内点的子女数是不同的。

三

f  d了8 入  C d 旋8  卢

在一组符号和一组二元运算上用前级记法表示的合式公式是用下面的规则来递归地定义的;
GD)若z是符号，则 z是用前级记法表示的合式公式;
(i若 X 和了 都是合式公式并且 * 是运算，则 * XY是合式公式。

*15. 证明， 在一组符号和一组二元运算上用前级记法表示的任何合式公式所包含的符号数都比运算数恰好多
一个。

16. 给出在符号(tz，>，z}和二元运算集{十，X ，。}上带三个以上运算的、用后邹记法表示的合式公式的6
个例子。

7.4 生成树

7.4.1 引言
考虑一下图 7-39a 所示的简单图所表示的缅因州的道路系统。在冬天里保持道路通畅的唯一
方式就是经常扫雪。高速公路部门希望只扫尽可能少的道路上的雪，而确保总是存在连接任何两



--- 第 353 页 ---
第7章 树。335

个乡镇的干净道路。如何才能做到这一点?
至少扫除 5 条道路上的雪才能保证在任何两个乡镇之间有一 条通路。图 7-39b 说明了这样一
些道路。注意表示这些道路的子图是树，因为它是连通的并且包含 6 个顶点和 5 条边。

Etna Oilid Town                   Etna Old Town
Orono                                     Orono
Herman               Bangor               Herman 上 Bangor
Hampden                                 Hampden
a)道路系统      b)需要扫雪的一些道路

   7-39

这个问题是用包含原来简单图的所有项点、边数最小的连通子图来解决的。这样的图必然
是树。

 

ES 设c是简单图。G 的生成树是包含 G 的每个顶点的G 的子图。
有生成树的简单图必然是连通的，因为在任何两个顶点之间都有生成树里的通路。反过来也
是对的，即每个连通图都有生成树。在证明这个结果之前将给出一个例子。
例1 找出图7-40 所示简单图的生成树。
解 图G是连通的，但它不是树，因为它包含简单回路。删除边<   6  5  4
{a，e} 。这样就消除了一个简单回路，而且所得出的子图仍然是连通
的并且仍然包含 G 的每个顶点。其次删除边{e<，户以便消除第二个简
单回路。最后，删除边{c，g}以便产生一个没有简单回路的简单图。“      8
这个子图是生成树，因为它是包含 G 的每个顶点的树。图 7-41 中说
明了用来产生这个生成树的边的删除序列。              图7-40 简单图 G

可        书        C        如    如        旋        C        二    0        户        C        过
e                   员          e                   8          辐                   8
删除边 : {a.e}                           fe.朋                           fc.g

3)                              b)                              C)
图7-41 通过删除形成简单回路的边来产生 G 的一个生成树

图7-41 所示的生成树不是唯一的 G 的生成树。例如，图 7-42 所示的每个树都是 G 的生成树。
图
如   已   C   可  如   孔   尼   可
e   上   8      人
巡   九   C   过  如   睛   C   df
e   乒   8     “  了  ， 《

 7-42 G 的一些生成树



--- 第 354 页 ---
336。第7章 树

5营开名 ”简单图是连通的当且仅当它具有生成树。

证 首先，假定简单图 CG有生成树了。工包含G 的每个顶点。另外，在工的任何两个顶点之
间都有T 里的通路。因为工是G 的子图，所以在 G 的任何两个项点之间都有T 里的通路。因此，
C是连通的。

现在假定G是连通的。若G不是树，则它必然包含简单回路。从这些简单回路中的一个里删
除一条边。所得出的子图少了一条边，但是仍然包含 G 的所有顶点并且是连通的。若这个子图不
是树，则它有简单回路; 所以像前面那样，删除一个简单回路里的一条边。重复这个过程直到没
有简单回路为止。这是可能的，因为在图里只有有穷的边数。当没有简单回路剩下时，这个过程
终止。产生出一个树，因为在删除边时这个图保持连通。这个树是生成树，因为它包含 G 的每个
顶点。                                     口

例 2 说明，在数据网络里生成树是重要的 。

ii 例2 IP 组播 ”在网际协议(IP)网络上的组播里，生成树的作用很重要。为了从源计算

”机发送数据到多个接收计算机，每个接收计算机是一个子网，可以分别发送数据到每
个计算机。称为单点广播的这种类型的网络是无效的，这是因为在网络上存有发送相同数据的多
个副本。为了更有效地传送数据到多个接收计算机，就使用 IP组播。在 IP组播里，一个计算机在
网络上发送数据的单一副本，当数据到达中间路由器时，就把数据分发到一个或更多的其他路由
器，以便接收计算机都在它们不同的子网里最终接收到这些数据。(路由器是专门在网络里子网之
间分发 IP 数据报文的计算机。在组播里，路由器使用 了 类地址，每个都表示接收计算机可以加入
的一个会话，见 3. 1 节例 16。)

为了让数据尽可能快地到达接收计算机，在数据穿过网络的通路里就不应当存在环路(在图论
名词里它们是回路) 。即一旦数据已经到达一个具体的路由器，数据就再也不应当返回这个路由
器。为了避免环路，组播路由器用网络算法来构造图 7-43 所示的生成树，这个图以组播源、路由
器和包含接收计算机的子网来作为顶点，以边表示计算机和(或)路由器之间的连接。这个生成树
的根就是组播源。包含接收计算机的子网就是这个树的树叶(注意不包含接收计算机的子网都不包
含在这个图里)。在图 7-43 里说明这些内容。                      国

IP网络                                         组播生成树 .

  

a)                               b)

回路由
e 子网
@@带接收站的子网

图 7-43 ”一个组播生成树



--- 第 355 页 ---
第7童 树"，337

7.4.2 深度优先搜索
呈鹿也5 定理 1 的证明给出通过从简单回路删除边来找出生成树的算法。这个算法是低效的，
“ “上 ”因为它要求找出简单回路。另一种不采用删除边来构造生成树的方法是，通过相继地
添加边来建立生成树。在这里将给出基于这个原理的两个算法 。

.-ws … 可以用深度优先搜索来建立连通简单图的生成树。我们将形成一个根树，而生成树将

5 是这个根树的无向底图。任意选择图中一个顶点作为根。通过相继地添加边来形成从
这个顶点开始的通路，其中每条新边都与通路上的最后一个顶点以及还不在通路上的一个顶点相
关联。继续尽可能地添加边到这条通路。若这条通路经过图的所有顶点，则由这条通路组成的树
就是生成树。不过，若这条通路没有经过图的所有顶点，则必须添加其他的边。退到通路里的倒
数第二个顶点，若有可能，则形成从这个顶点上开始的经过还没有访问过的顶点的通路。若不能
这样向，则后退到通路里的另外一个顶点，即在通路里后退两个顶点，然后再试。

重复这个过程，从所访问过的最后一个顶点开始，在通路上一次后退一个项点，只要有可能
就形成新的通路，直到不能添加更多的边为止。因为这个图有有穷的边数并且是连通的，所以这
个过程以产生生成树而告终。在这个算法的一个阶段上是通路未端的顶点将是根树里的树叶，而
在其上开始构造一条通路的顶点将是内点。

读者应当注意到这个过程的递归本质。另外，注意若图中的顶点是排序的，则当总是选择在
该顺序里可用的第一个顶点时，在这个过程的每个阶段上对边的选择就全都是确定的。不过，将
不总是明显地对图的顶点排序。

深度优先搜索也称为回溯，因为这个算法返回以前访问过的项点以便添加边。下面的例子说
明回淹。

例3 用深度优先搜索来找出图 7-44 所示图 G 的生成树 。

res- ，解 在图7-45 里显示深度优先搜索为了产生 。     d  7

G 的生成树而使用的步又。任意地从顶点 了上开

始。一条通路是这样建立的: 相继地添加与还不在通路上
的顶点相关联的边，只要有可能就这样做。这样就产生通
路 J，g, h，A&，J7 (注意也可能建立其他的通路)。下一
步，回湖到&。不存在从大开始包含还没有访问过的顶点
的通路。所以回溯到记。形成通路，i。然后回溯到 g，
然后再回泣到 F。从 建立通路 ，d，e，c，ca。然后再
回潮到 c 并且形成通路c<，28%。这样就产生了生成树。 ”国

了                    乒

 

  

a)              b)                      ch)》                               d)                                      e)
图7-45 G 的深度优先搜索

一个图的深度优先搜索所选择的边都称为树边。这个图所有其他的边都必然连接一个顶点与
这个项点在树中的祖先或后代。这些边都称为背边(练习 20 要求证明这个事实) 。

例4 图7-46 中强调了从顶点 了开始的深度优先搜索所找到的树边，用粗线显示这些树边。
用细黑线显示背边(e，记和(太， hj 。                          国



--- 第 356 页 ---
338，。第7童 树

我们已经解释了如何用深度优先搜索来求图的生成树。但是，迁今为止的讨论还没有带出深
度优先搜索的递归本质。为了弄清深度优先搜索的递归本质，需要几个术语。当执行深度优先搜
索的步又时，当把顶点v加入树时说从顶点 v 开始
探索，当最后一次回潮回到v时说从顶点 v 结束探
索。理解算法的递归本质所需要的关键事实是，当
加入连接顶点 v到顶点 zw 的边时，在回到完成从
u 的探索之前就结束了从 ww 的探索。在算法 1 中构
造了带顶点 ww，…，mw 的图 G 的生成树，首先选
择顶点 mm 作为树根。开始时令 工是只有这一个项 “        8
点的树。在每个步骤，加入一个新顶点到工以及 图7-46 例4中深度优先搜索的树边和背边
从已在工中的一个顶点到这个新顶点的一条边，
并且从这个新顶点探索。注意当算法完成时，T没有简单回路，因为没有加入连接到已在树中的
顶点的边。另外，了在构造时保持连通(用数学归纳法可以轻而易举地证明最后这两个事实) 。由
于G是连通的，G 的每个顶点都被算法访问到并且加人到树中(读者可以验证) 。所以工是G 的生
成树。

 

算法 1 深度优先搜索

procedure DFS(CGC: 带顶点ww，…，w 的连通图)
了:一只包含顶点 由 的树

VasttC TI )

procedure visit(u: G的项点)

for 与v相邻并且还不在工中的每个顶点 记
begin
加入顶点 记和边{fm，世}到工

VESiE(CI)

end

 

现在分析深度优先搜索算法的计算复杂性。关键事实是对于每个顶点 v来说，当在搜索中首
次遇到顶点时，就调用过程 visit(岂并且以后不再调用这个过程。假设 G 的邻接表是可用的(参
见 6. 3 节)，求出与v相邻的顶点不需要任何计算。当遵循算法的步又时，至多检查每条边两次以
确定是否加和这条边及其一个端点到树中。因此，过程 DFS 用O(e)或 OO )个步骤来构造一个生
成树，其中 和) 分别是G 的边数和项点数。(注意一个步又包括: 检查一个项点是否已在正在构
造的树中，如果这个顶点还不在树中，则加入这个顶点和对应的边。还利用了不等式 e和zx(n一1)/2，
对于任意简单图来说这个不等式都成立。)          .

深度优先搜索可以作为解决许多不同问题的算法的基础。例如，可以用来求图的连通分支并
且可以用来求连通图的割点。将要看到，深度优先搜索是用来搜索计算困难问题的解的回湖技术
的基础(参见L[GrYe99]、[ Ma89]和[CoLeRiSt01]对基于深度优先搜索的算法的讨论) 。

7.4.3 宽度优先搜索

1 也可以通过使用宽度优先搜索来产生简单图的生成树。同样，将构造一个根树，而这
“， ”个根树的无向底图就形成生成树。 从图的顶点中任意地选择一个根。然后添加与这个

顶点相关联的所有边。在这个阶段所添加的新顶点成为生成树在 1 层上的顶点。将新顶点任意排

序。下一步，按顺序访问 1 层上的每个顶点，只要不产生简单回路，就将与这个顶点相关联的每

条边添加到树里。这样就产生了树在 2 层上的顶点。遵循相同的过程，直到已经添加了树里的所



--- 第 357 页 ---
第7童 树。339

有项点。因为在图中的边数是有限的，所以这个过程会终止。在产生了包含图中每一个顶点的树
之后，生成树也就产生了。下面是宽度优先搜索的一个例子。
例5 用宽度优先搜索来找出图 7-47 所示的图的生成树 。
本0 解 在图7-48 里显示宽度优先搜索过程的各步又。
选择顶点e作为根。然后添加与 e 相关联的所有边，
所以添加了从到，d，A和ft 的边。这四个顶点都是在树的 1
层上。下一步，添加从 1 层上的顶点到还不在树上的相邻顶点
的边。因此，添加从2到a 和 的边，以及从 4 到产，从 三到7
和&，从;i到A的边。新顶点ae，c，h，j，g 和 都是在2层上。
下一步，添加从这些顶点到还不在树上的相邻顶点的边。这样
就添加从 g到! 以及从太到靖的边。                  国

 

 

图7-48 G的宽度优先搜索

算法 2 的伪码描述了宽度优先搜索。在这个算法中假设连通图 G 的顶点排序为w ，…，zw。
在算法中，只要还没有产生简单回路就加入新的顶点和对应的边到树中，与正在处理的当前顶点
相邻。

算法2 宽度优先搜索
procedure BFSCG: 带顶点，…，muw 的连通图)
了:一只包含顶点 w 的树
L :一空表
把 ww 放人尚未处理顶点的表工 中
while 工 非空
begin
删除 志 中第一个顶点

for v 的每个邻居
这说 既不在工 中也不在了中 then
begin
加入 zw到表工 的末尾
加入 z和边{v，z)}到工

end

end

 

现在分析宽度优先搜索的计算复杂性。对于图中的每个顶点v来说，检查所有与v相邻的顶点
并且加人每个尚未访问过的顶点到树 工中。假设图的邻接表是可用的，确定哪些顶点与给定顶点
相邻就不需要任何计算。如同在深度优先搜索算法的分析中那样，我们检查每条边至多两次来确
定是否应当加入这条边及其尚未在树中的端点。所以宽度优先搜索算法使用 O(e)或 OO )个步骤。



--- 第 358 页 ---
340。第7章 树

7.4.4 回淹

有些问题只能通过执行对所有可行解的穷举搜索来解决。系统地搜索出一个解的一种方式是
使用决策树，其中每个内点都表示一次决策，而每个树叶都表示一个可行解。为了通过回潮来求
出一个解，首先尽可能地做出一系列决策来尝试得出一个解。可以用决策树里的通路来表示决策
序列。一旦知道了决策序列的任何扩展都不能得出解，就回淹到父母顶点并且若有可能，则用另
外一个决策序列来尝试得出一个解。继续这个过程，直到找到一个解，或者证明没有解存在为止。
下面的例子说明回湖的有用性。

例6 图着色 ”如何用回淹来判定是否可以用 ”种颜色给一个图着色?

解 以下面的方式用回湖来解决这个问题。首先选择某个顶点 & 并且指定它颜色为1。然后挑
选第二个顶点 5，而且若不与a 相邻，则指定它颜色为1。和否则，指定2颜色为 2。然后来到第三
个顶点 c。若有可能则对 “用颜色 1。和否则若有可能则用颜色 2。只有当颜色 1 和颜色 2 都不能用时
才使用颜色 3。继续这个过程，只要有可能就为每个新顶点指定种颜色中的一种，而且总是使用
表中第一种允许的颜色。若遇到不能用?种颜色中任何一种来着色的顶点，则回潮到最后一次所
做的指定，并且若有可能就改变最后着色的顶点的颜色，用表中下一种允许的颜色。若不可能改
变这个颜色，则再回潮到更前面的指定，一次后退一步，直到有可能改变一个顶点的颜色为止。
然后只要有可能就继续指定新项点的颜色。若使用”种颜色的着色存在，则可以通过回湖来产生
〈但是这个过程是极其低效的) 。

具体地说，考虑用三种颜色来着色图7-49 所示的图。图 7-49 所示的树说明如何用回溯来构造
3着色。在这个过程里，首先用红色，其次用蓝色，最后用绿色。显然用回溯来解决这个简单的例
子只是为了能够比较好地说明这项技术。

0红

 

4红.少蓝
已           过           1   NN
人7     4红,b蓝.c红     a红.旋蓝,c
避     旋     C      1
4红,蓝,c 红,g绿            a红,蓝,ec 绿,qd红

0红.b蓝,c绿.qd红.e绿
图 7-49 用回湖给图着色

在这个树里，从根开始的、表示指定红色给 a 的最初的通路，导致 红色、28 蓝色、c 红色而
d 绿色的着色。当以这种方式来着色 a，5，c 和qd 时，就不可能用这三种颜色中的任何一种来着色
e。所以，回湖到表示这个着色的项点的父母。因为没有其他颜色可以用在dd 上，所以再回潮一
层。然后改变 e 的颜色为绿色。通过接着指定红色给 d 和绿色给e。，就获得这个图的着色 。  国
 例7 mm皇后问题 皇后问题问: 在 ”X7z 棋盘上如何放置”个皇后，使得没有两个皇
”和”后可以互相攻击。如何用回潮来解决皇后问题?

解 为了解决这个问题，必须在 >Xz 棋盘上找出”个位置，使得这些位置中没有两个是在同
一行上、同一列上或在同一斜线上(斜线是由对某个冯来说满足;十7一和或对某个mm 来说满足
1一7一阅的所有位置(i，力组成的) 。将用回潮来解决 皇后问题。从空棋盘开始。在&十1 阶段，



--- 第 359 页 ---
第7章 树。341

尝试在棋盘上第&十1 列里放置一个新皇后，其中在前上列里已经有了皇后。检查第 &+1I 列里的格
子，从第一行的格子开始，寻找放置这个皇后的位置，使得它不与已经在棋盘上的皇后在同一行
里或在同一斜线上(已经知道它不在同一列里)。若不可能在第 &十1 列里找到放置皇后的位置，则
回溯到在第 k列里对皇后的放置。在这一列里下一个允许
的行里放置皇后，若这样的行存在的话。若没有这样的行
存在，则继续回漳。

具体地说，图 7-50 显示四皇后问题的回湖解法。在这
种解法里，在第一行第一列里放置一个皇后。然后在第二
列的第三行里放置一个皇后。不过，这样就使得不可能在
第三列里放置一个皇后。所以就回溯并且在第二列的第四
行里放交一个皇后。当这样做时，就可以在第三列的第二
行里放置一个皇后。但是没有办法在第四列里添加一个皇
后。这说明当在第一行第一列里放置一个皇后时就得不出
解。回溯到空棋盘，在第一列的第二行里放置一个皇后。

这样就得出图 7-50 所示的解。          国

例8 子集和”考虑下面的问题。给定一组正整数 r, ，
习，…，x，求这组整数的和为 M 的一个子集。如何用回
淹来解决这个问题?

解 ”从空无一项的和来开始。通过相继地添加项来构
造这个和。若当添加这个序列里的一个整数到和里而这个
和仍然小于 M 时，则包含这个整数。若得出使得添加任何
一项就大于 M 的一个和，则通过去掉这个和的最后一项来

 

回湖。
图7-51 显示下面这个问题的回湖解法，求131，27，
15，11，7，5}的和等于 39 的子集。          国   图7-50 四皇后问题的回潮解法
攻
和=0
{31}                                f27}
和-31和=27
{131,.7}          {31,5}          {27, 11}          {27,7}
和=38                           和=36                            和=38                         和=34

127,7,5}
和=39

图 7-51 用回漳求等于 39 的和

7.4.5 有向图中的深度优先搜索

可以轻而易举地修改深度优先搜索和宽度优先搜索，使得以有向图作为输入时它们也能运行。
但是，输出不一定是生成树，而可能是森林。在这两个算法中，只有当一条边从正在考虑的顶点
发出并且到一个尚未加人的顶点时才加入这条边。如果在其中任何一个算法的某个阶段找不到从
已经加入的顶点到尚未加入的顶点的边，则算法加入的下一个顶点成为生成森林中一个新树的根。



--- 第 360 页 ---
42。第7章 树

这一点在例 9 中解释。
例9 给定图7-52a 所示的图作为输入，深度优先搜索的输出是什么?

[7
 |

df        起)

 

二.

a)                                     b)
图 7-52 有向锅的深度优先搜索

解 ”从顶点 ae 开始深度优先搜索并且加入项点5、c和8 以及无路可走时对应的边。回溯到 c，
但是仍然无路可走，于是回溯到，在这里加入顶点了和e 以及对应的边。回漳最终又回到a。然
后在4 开始一个新的树并且加入项点户、!、& 和 以及对应的边。回湖到&，然后到上，然后到疡并
且回到 4。最后，在i开始一个新的树，完成深度优先搜索。输出如图7-52b 所示。         轿

有向图中的深度优先搜索是许多算法的基础(参见LGrYe99]j、[Ma89]j和[CoLeRiSt01])。它可
以用来确定有向图是否具有回路，可以用来完成图的拓扑排序，也可以用来求有向图的强连通
分支。

用深度优先搜索和宽度优先搜索在网络搜索引擎上的应用来结束本节 。

例10 网络蜂蛛 为了给网站建立索引，诸如 Hotbot 和 Lycos 这些著名的搜索引擎从已知的
站点开始系统地探索网络。这些搜索引擎使用所谓网络师蛛(或网络疏虫、网络机器人)的程序来
访问网站并且分析其内容。网络蚁蛛同时使用深度优先搜索和宽度优先搜索来创建索引。如 6.1
节例 8 所述，可以用所谓网络图的有向图来为网页和网页之间的链接建立模型。用项点表示网页
并且用有向边表示链接。利用深度优先搜索，选择一个初始的网页，循着一个链接(如果存在这样
的链接的话)到达第二个网页，循着第二个网页的一个链接(如果存在这样的链接的话)到达第三个
网页，等等，直到找到一个没有新的链接的网页为止。然后使用回溯来检查前面阶段的链接去寻
找新的链接，等等。(由于实际限制，网络蛛在深度优先搜索中的搜索深度是有限的.)利用宽度
优先搜索，选择一个初始的网页并且遵循这个网砚上的一个链接到达第二个网页，然后遵循初始
网页上的第二个链接(如果存在的话)，等等，直到已经遵循了初始网页上的所有链接为止。然后
逐页地遵循下一层网页上的链接 ，等等。                                 图

练习
1. 为了产生生成树，必须从带有 = 个顶点和着 条边的连通图里删除多少条边?
在练习 2一3 里， 通过型除简单回路里的边来求所示的图的生成树。 ，

[人

 



--- 第 361 页 ---
#06。

第7章 树。343

- 求下面每个图的生成树。
a)开5            b)天,，，            c)K开1           d)Q;           e)C5           旨Ws
- 画出下面所给的简单图的生成树 。

站      旋      了      8

C      可      e      大

下面的每个简单图各有多少个不同的生成树?
a)开3                         b)K，                         Cc)天,2                       d)C:

在练习 7一8 里，用深度优先搜索来构造所给的简单图的生成树。选择 a 作为这个生成树的根并且假定项

点都以字母顺序来排序。

7.

9.。

10，

11.

12，

15.

16，

同

避                        e       办        上         8.

 

用深度优先搜索求下列这些图的生成树。

a)W (参见 6.2 节例6)，从 6 度项点开始                   b)Ks

c)Ka，从3度顶点开始                d)Qs

描述一下轮图 本,的宽度优先搜索和深度优先搜索所产生的树，从 =”度顶点开始，其中关是整数满足nz三3
《参见 6. 2 节例 6) 。说明答案的合理性。

描述一下完全偶图 天。.,的宽度优先搜索和深度优先搜索所产生的树，其中mm 和) 都是正整数。说明答案
的合理性。

假定一家航空公司必须压缩它的航班以节省资金。若它原来的航线如下图所示，则可以中断酸些飞行以
保持在所有城市对之间的服务(其中从一个城市飞往另一个城市可能需要换乘飞机)?

 

，娜些连通简单图恰好有一个生成树?
关] 4

证明: 在连通简单图里顶点 v 和 之间的最短通路的长度，等于在以v 为根的G 的宽度优先生成树里x
的层数。

用回潮来对下面的m值解决皇后问题。

a)7一3              b)m一5              c)7m一6

解释一下如何用回溯来找出图中的哈密顿通路或哈密顿回路。

图 G 的生成森林是包含 G 的每个顶点的森林，使得当在两个顶点之间有 G 里的通路时，这两个项点就在

一个树里。

17. 证明: 每个有穷简单图都有生成森林。



--- 第 362 页 ---
344。第7章 树

18. 对带有， 个顶点、严条边和* 个连通分支的图来说，必须删除多少条边才能产生它的生成森林?

19. 设计基于深度优先搜索来构造图的生成森林的算法 。

20. 设 G是连通图。证明: 如果工是用深度优先搜索构造的 G 的生成树，则 G 的不在了中的边必定是背边，
换句话说，这条边必定连接一个顶点到这个顶点在 工中的祖先或后代。

21. 对于哪些图来说，无论选择哪个顶点作为树根，深度优先搜索和宽度优先搜索都产生同样的生成树? 说
明答案的合理性。

22. 用数学归纳法证明，宽度优先搜索按照顶点在所得出的生成树中的层数的顺序来访问这些顶点。

23. 用伪码来描述宽度优先搜索的一个变种，它把整数 m 指定给在搜索中访问的第zm 个顶点。

24, 证明: 如果 G是有向图并且T是用深度优先搜索构造的生成树，则不在这个生成树上的每条边都是连接
祖先到后代的前进边、连接后代到祖先的后退边，或者连接一个顶点到从前访问过的子树的一个顶点的
交叉边。

设 五 和 也 都是一个图的生成树。在 五 和 全 之间的距殖是在 Th 和 人 里非 五 和 歼 所共有的边的数目。

25. 求图 7-40 所示图 G 的在图 7-41e 和图 7-42 里所示的每对生成树之间的距离。

六26. 假定 六 和 T; 都是简单图 G 的生成树。另外，假定 e 是在 Ti 里但不在 Ti 里的一条边。 证明， 存在着在
五 里但不在 六里的一条边  ，使得若从 厂 里删除 = 而添加 c 到 五 里，则 仍然是生成树，并且若
从 六 里删除 e: 而添加 。 到 T; 里，则 T, 仍然是生成树。
有向图的根生成村是由这个图的边组成的根树，使得这个图的每个顶点都是树里一条边的终点。

27. 对 6. 5 节练习 10一12 里的每个有向图来说，求这个图的根生成树，或者确定不存在这样的树。

*28. 给出构造每个项点的和人度和出度都相等的连通有向图的根生成树的算法。

7.5 最小生成树

7.5.1 引言

3 一个公司计划建立一个通信网络来连接它的五个计算机中心。可以用租用的电话线连
 ”” 接这些中心的任何一对。应当建立娜些连接，以便保证在任何两个计算机中心之间都

有通路，且网络的总成本最小? 可以用图 7-53 所示的带权图为这个问题建模，其中顶点表示计算

机中心，边表示可能租用的电话线，边上的权是边所表示的电话线的月租费。通过找出一棵生成

树，使得这棵树的各边的权之和为最小，就可以解决这个问题。这样的生成树称为最小生成树。

$2000

旧金山

 

图7-53 说明计算机网络里的线路的月租费的带权图

7. 5. 2 ”最小生成树算法
有大量的问题可以这样解决， 求带权图里的一棵生成树，使得这棵树的各边的权之和为最小。
ES有 连通带权图里的最小生成树是具有最小可能的边的权之和的生成树，
:as: 下面将给出构造最小生成树的两个算法。这两个算法都是通过添加还没有使用过的、
“具有规定性质的、权最小的边来进行的。这些算法都是贪心算法的例子。贪心算法是
在每个步又上都做最优选择的算法。在算法的每个步骤上都最优化，并不保证产生全局最优解。
不过，本节里给出的构造最小生成树的这两个算法都是产生最优解的贪心算法。
二3鹿天和5 要讨论的第一个算法是罗伯特，普林在 1957 年给出的，虽然这个算法的基本想法有更
” ”时的起源。为了执行普林算法，首先选择带最小权的边，把它放进生成树里。相继地
向树里添加与已在树里的顶点关联的、并且不与已在树里的边形成简单回路的权最小的边。当已

  
 



--- 第 363 页 ---
第7章 树。345

经添加了 zx一1 条边时就停止。
本节稍后将证明这个算法产生任何连通带权图的最小生成树。算法 1 给出普林算法的伪码描述。

 

算法1 普林算法

procedure Prim(G: 带个顶点的连通无向图)

T:一权最小的边

for : :一1 to mn一2

begin
e :一与了里顶点关联、并且若添加到 工里则不形成简单回路的权最小的边
了:一添加e之后的工

end{T是G 的最小生成树}

 

 

注意，当有超过一条满足相应条件的带相同权的边时，在算法的这个阶段里对所添加的边的
选择就不是确定的。需要排序这些边以便让选择是确定的。在本节剩下的部分里将不再考虑这个
问题。另外注意，所给的连通带权简单图可能有多于一个的最小生成树(见练习5)。例 1 和例 2 说
明如何使用普林算法。

例1 用普林算法设计连接图 7-53 所表示的所有计算机的、具有最小成本的通信网络 。

解 ”办法是求图 7-53 的最小生成树。普林算法是这样执行的: 选择权最小的初始边，并且相
继地添加与树里顶点关联的不形成回路的权最小的边。在图 7-54 里，加粗的边表示普林算法所产
生的最小生成树，并且显示出在每个步骤上所做的选择。                 加

旧金山

 

1    {芝加哥，亚特兰大}        $ 700
2     {亚特兰大，纽约}          $ 800
3    {芝加哥，介金山}         $1200
4     {旧金山，丹佛}           $ 900

总计 :   $3600

 7-54 图7-53 里带权图的最小生成树
例2 用普林算法求图7-55 所示的图的最小生成树。

 

图 7-55 ”一个带权图
解 ”用普林算法所构造的最小生成树显示在图 7-56 里。相继选择的边都有显示 。    国



--- 第 364 页 ---
346。第7章 树

待
湛
区

{、 万
{a. 少}
{F 让
{a.e}
{ 了)
{人381
{c、8]
{c、 dl]
{8、作}
{h、 1
{K、7}

二号怕台DAmhwmwhp一
是-wowwbn- 党

 

总计 :
3)                                      b)
图 7-56 用普林算法构造的最小生成树

2 将要讨论的第二个算法是约瑟夫 克鲁斯卡尔在 1956 年发现的，但在此之前已经有人病
“ “”” 述过这一算法的基本思路。为了执行克重斯卡尔算法，要选择图中权最小的一条边。
相继添加不与已经选择的边形成简单回路的权最小的边。在已经挑选了 *一1 条边之后就停止。
在本节未尾，把证明克鲁斯卡尔算法对每个连通带权图都产生最小生成树留作练习。在算法 2
里给出克和鲁斯卡尔算法的伪代码。

 

 

算法 2 克鲁斯卡尔算法

procedure 氏rxskal(G: 带?个顶点的带权连通无向图)

了T:王空图

for i :一1 tom一1

begin
e :一当添加到 了里时不形成简单回路的权最小的G 里的边
了:一添加e之后的工

end{了是G 的最小生成树}

 

读者应当注意普林算法与克鲁斯卡尔算法的区别。在普林算法里，选择与已在树里的一个顶
点相关联、并且不形成回路的权最小的边; 相反地，在克鲁斯卡尔算法里，选择不一定与已在树
里的一个顶点相关联、并且不形成回路的权最小的边。注意，在普林算法里，若没有对边排序，
则在这个过程的某个阶段上，对添加的边来说就可能有多于一种的选择。因此，为了让这个过程
是确定的，就需要对边进行排序。 下面的例子说明如何使用克重斯卡尔算法 。

例3 用克和鲁斯卡尔算法求图 7-55 所示的带权图的最小生成树。

er， 解 在图7-57 里显示这个最小生成树和在克鲁斯卡尔算法每个阶段上对边的选择 。 国
现在将证明普林算法产生连通带权图的最小生成树。

证 设CG是一个连通带权图。假定普林算法相继地选择的边是ae，e，…，e-i。设S是以
El ECEz，， ”1 e, -作为边的树 ， 而设 S， 是以el， ez ER 作为边的树。 设工是包含边ei， ez ”1
e 的G 的最小生成树，其中上是满足下列性质的最大整数: 存在着包含普林算法所选择的前&条
边的最小生成树。若证明了 S=T，则该定理得证。

假定 S关T，所以&<nz一1。因此，了包含边e，e，…，e，但是不包含 e+,。考虑由了工和
et+1所组成的图。因为这个图是连通的并且有条边，边过多不可能是树，所以它必然包含简单回
路。这个简单回路必然包含 w+，因为在 工里没有简单回路。另外，在这个简单回路里必然有不
属于 Si:的边，因为 Si是一棵树。通过从 e+的一个端点开始，该端点也是边e ，e ，…，ex 之
一的端点，并且遵循回路直到它到达一条不在 et:里的边为止，就可以找出一条不在 Si,,里的边
e，它有一个端点也是边 ae ，e ，…，e: 之一的端点。通过从 工里删除e 并且添加es+,、就获得带



--- 第 365 页 ---
第7章 树。，347

 

选择    边     权

4        {c、 dd        1

2        {. 由        1

3        {2. 丹        1

4        {c.、 8}        2

5        {a.、        2

6   (了月    2

了        {p、c}        3

8        人 大        3

9        {8，作        3

10       人 让        3

11        {a、e       3

总计: 24

al)                               b)
图 7-57 克鲁斯卡尔算法产生的最小生成树
?一1 条边的树 六(它是树，因为它没有简单回路) 。注意树 开包含e ，e ，…，e+i。另外，因为

普林算法在第 &十1 个步骤上选择 w+ ，并且在这个步骤上 e 也是可用的，所以 e+的权就小于或
等于e的权。根据这个观察结果就得出 工也是最小生成树，因为它的边的权之和不超过工的边的
权之和。这与对的选择相矛盾，& 是使得包含e，e ，…，e 的最小生成树存在的最大整数。因
此, &一?一1 并且 S=T。所以普林算法产生最小生成树。                          口

可以证明(参见LColLeRiSt01])为了求出具有 e 条边和mv个项点的图的最小生成树，可以用
O(e log e)次运算来完成克鲁斯卡尔算法并且可以用 O(e log z)次运算来完成普林算法。因此，对
于乔玖图来说使用克鲁斯卡尔算法更好。在稀朴图中,，e 远远小于C(w，2)王z(z一1)/2，即具有)
个顶点的无向图的可能的总边数。否则，这两个算法的复杂性没有什么差别。

练习
1. 下图所表示的道路都还没有铺设路面。边的权表示在成对的乡镇之间的道路长度。哪些道路应当铺设路面，以

便在每对乡镇之间都有铺设路面的道路，而且使得铺设的道路的长度最短?〈注: 这些乡镇都在内华达州。)
Manhattan

   

难                                                     、
Tonopah          Warm Springs

     
 

Gold
Point 9

Deep Springs

Beatty
2.  用普宁算法求下面所给的带权图的最小生成树。

瑟dd
人



--- 第 366 页 ---
348。第7章 树

. 用克鲁斯卡尔算法设计在本节开头所描述的通信网络。
4. 用克鲁斯卡尔算法求练习 2 里带权图的最小生成树。
5. 找出具有多于一棵最小生成树的、带有最少可能边数的连通带权简单图。

连通带权无向图的最大生成树是带最大可能的权的生成树 。

6. 设计与普林算法类似的、构造连通带权图的最大生成树的算法 。

*?, 设计求连通带权图里次最短生成树的算法 。

8. 证明: 车所有边的权都不相同，则连通带权图里有唯一的最小生成树。
9. 求图 7-55 的带权图里包含边{e，t计和(1g，有的总权最小的生成树 。

索林(Sollin)算法从连通带权简单图 G=(V，巨)这样产生最小生成树: 相继地添加成组的边。假定对 V
里项点进行了排序。这样就产生边的一个顺序，其中若 we 先于四，或者若 由一由 并且 ww 先于内 ，则{om，
m}先于{x ，z}。这个算法首先同时选择每个顶点关联的权最小的边。在平局情形下选择在上述顺序里的第
一条边。这样就产生出一个没有简单回路的图，即一些树组成的一个森林。其次，对录林里的每棵树，同时
选择在该树里一个顶点与在不同的一棵树里项点之间的最短的边。同样在平局情形下选择在上述顺序里的第
一条边。(这样就产生出一个没有简单回路的图，它包含着比在这一步之前出现的更少的树。)继续进行同时
地添加连接树的边的过程，直到已经选择了 "一!条边为止。在这个阶段上就已经构造了一柠最小生成树。
10. 用索林算法产生图 7-53 和图 7-55 所示的带权图的最小生成树。

*#x11. 证明: 索林算法产生连通无向带权图里的最小生成树。
*12. 证明: 若在索林算法的某个中间步骤里存在 > 棵树，则算法的下一次迭代至少添加[my/2]条边。
*13- 证明: 索林算法至少需要 log m” 次迭代，以便从带有个顶点的连通无向带权图产生一棵最小生成树。

关键术语和结果

术语

树: 没有简单回路的连通无向图。

森林: 没有简单回路的无向图。

根树: 具有一个规定的顶点(称为根)，使得从这个根到任意其他顶点有唯一通路的有向图。

子树: 树的子图，子图本身也是一棵树 。

根树里忆的父母: 使得(xw，攻是根树的一条边的顶点 w。

根树里顶点也的子女: 以作为父母的任何顶点。

根树里顶点了的兄弟: 与具有相同父母的顶点。

根树里顶点忆的祖先: 在从根到v的通路上的任何顶点。

根树里顶点了的后代: 以作为祖先的任何顶点。

内点: 具有子女的项点。

树叶: 没有子女的顶点。

顶点的层: 从根到这个顶点的通路的长度。

树的高度: 树里顶点的最大层数。

交元树: 每个内点都有不超过 za 个子女的树。

满妈元树: 每个内点都有恰好 mm个子女的树。

二又树: 满足mm一2 的普元树(可以指定每个子女作为父母的左子女或右子女) 。

有序树: 在其中对每个内点的子女都线性地排序的树。

平衡树: 在其中每个顶点都是在产层或六一1 层上的树，其中广是这棵树的高度。

二又搜索树: 这样的二叉树，在其中以项对顶点进行标记，使得一个顶点的标记大于这个顶点的
左子树里所有项点的标记，并且小于这个顶点的右子树里所有顶点的标记。

决策树: 性质如下的根树，在其中每个顶点表示一次决策的可能输出 ，而树叶表示可能的解。

前缓码: 一种编码，其中一个字符的编码永远不是另外一个字符的编码的前级。

最小最大策略: 第一个选手和第二个选手分别移动到具有最大值和最小值的顶点所表示的局面的

《3



--- 第 367 页 ---
第7章 树"。349

策略。

博弈树里顶点的值:， 对于树叶来说，就是当游戏在这个树叶所表示的局面里结束时第一个选手的
得分。对于分别在偶数或奇数层上的内点来说，就是这个内点的子女的最大值或最小值。

树的遍历: 树的顶点的列表。

前序亿历: 通过规定列出根，接着列出第一棵子树，接着以从左到右的出现顺序列出其余子树，
来递归地定义的有序根树的顶点列表。

中序饥历， 通过规定列出第一棵子树，接着列出根，接着以从左到右的出现顺序列出其余子树，
来递归地定义的有序根树的顶点列表。

后序遍历: 通过规定以从左到右的出现顺序列出各子树，接着列出根，来递归地定义的有序根树
的顶点列表 。

中缓记法: 从表示表达式(包括全套括号)的二叉树的中序遍历所获得的表达式形式。

前缀记法，或波兰记法:从表示表达式的二又树的前序遍历所获得的表达式形式。

后缓记法，或逆波兰记法: 从表示表达式的二叉树的后序遍历所获得的表达式形式。

生成树: 包含图的所有顶点的树。

最小生成树: 带最小可能的边的权之和的生成树。

贪心算法: 在每个步骤上都做出最优选择的最优化算法。

结果

一个图是树，当且仅当在它的任何两个顶点之间都存在唯一简单通路 。

带有个顶点的树具有一1 条边。

带有ii 个内点的满关 元树具有mi十1 个顶点。

在满 m元树的顶点数、树叶数和内点数之间的关系(见 7.1节定理 4) 。

在高度为疡的满巴元树里至多有思* 个树叶 。

若闷元树有:个树叶，则它的高度至少是[ log ]。若这树也是满的和平衡的，则它的高度就是
「 log。 | 。

赫夫受编码: 给定一组符号的频率，为这些符号构造最优二元码的过程。

深度优先搜索，或回淹， 构造生成树的过程，通过添加形成通路的边，直到不可能这样做为止，
然后沿这条通路往回移动，直到找到可以形成新的通路的顶点为止。

宽度优先搜索: 构造生成树的过程 ，通过相继添加与上次添加的边相关联的所有边，除非形成简
单回路。

善林算法: 产生带权图里最小生成树的过程，通过相继添加与已经在树里的顶点相关联的所有边
中权最小的边，使得再添加边时不会产生简单回路。

克重斯卡尔算法: 产生带权图里最小生成树的过程，通过相继添加还不在树里的权最小的边，使
得再添加边时不会产生简单回路。

复习题

- a)定义树。    b)定义森林。

. 在树的顶点之间能和否有两条不同的简单通路?

. 至少给出三个例子说明如何在建模中使用树。

. a)定义根树和这样的树的根。

b)定义根树里顶点的父母和顶点的子女。

c)什么是根树里的内点、树叶和子树?

d)画出至少带 10 个顶点的根树，其中每个项点的度都不超过 3。指出树根、每个顶点的父母、每个顶点的
子女、内点和树叶 。

5. a)带?个顶点的树有多少条边?

b)为确定带有?个顶点的森林里的边数，你需要知道什么值?

让 一



--- 第 368 页 ---
350。

9.

第7章 树

. a)定义正则 关元树 。

b)若正则 关元树有;i 个内点，则它有多少个顶点? 此树有多少个树叶?

. a)什么是根树的高度?

b)什么是平衡树?
c)高度为疡的za 元树可以有多少个树叶?

. a)什么是二又搜索树?

b)描述构造二叉搜索树的算法 。

c)构造单词 wireo，ruarbler，egret，8grosbeak ，Pathatch 和KingFisher 的二叉搜索树 。
a)什么是前级码?

b)二叉树如何表示前缀码?

10. a)定义前序遍历、中序遍历和后序遍历。

11.

12.
13.

b)给出至少带 12 个顶点的二叉树的前序遍历、中序遍历和后序遍历的实例。

a)解释一下如何用前序遍历、中序遍历和后序遍历来求算术表达式的前缀形式、中级形式和后缀形式。
b)画出表示((z一3)十((z/4)十(z一y) 全3))的有序根树 。

c)求在(b)里的表达式的前级和后组形式。

证明: 排序算法所使用的比较次数至少是log z曲。

a)描述一下替夫名编码算法，这个算法求一组给定频率的符号的最优编码。

b)用赫夫曼编码求下列符号和频率的最优编码: A: 0.2，B:, 0.1，C: 0.3，C: 0. 4。

- 画出 nim 游戏的博弈树，假设初始局面由两堆石头组成，分别含有 1 块和4 块石头。假如两个选手都遵

循最优策略的话，谁将赢得游戏呢?

. a)什么是简单图的生成树?

b)哪些简单图具有生成树?
c)描述需要求出简单图的生成树的应用，至少举两个不同的应用。

“. a)描述求简单图里生成树的两个不同算法。

b)用你所选择的至少带8个顶点和 15 条边的图,来解释你在(a)里所描述的两个算法是如何求简单图的
生成树的。

. a)解释如何用回湖来确定能否用 ”种颜色来着色简单图。

b)用例子说明如何用回湖来证明: 色数等于4 的图不能用 3 种颜色来着色，但是可以用 4 种颜色来着色。

, a)什么是连通带权图的最小生成树?

b)至少描述出两个不同的、需要求出连通带权图的最小生成树的应用。

， a)描述求最小生成树的普林算法和克鲁斯卡尔算法 。

b)用至少带8 个项点和 15 条边的图，来解释克鲁斯卡尔算法和普林算法是如何求最小生成树的。

补充练习

共卫。

#2.
3.
4

<n

#6，

7.
8.
9.

证明: 简单图是树当且仅当它不包含简单回路，并且添加连接两个不相邻顶点的一条边，就产生恰好有两
条回路的新图(其中不认为包含相同的边的回路是不同的) 。

有多少种非同构的带 6 个顶点的根树?

证明: 每一个至少有一条边的树都至少有两个悬挂点 。

证明: 有 "一1个悬挂点的、带有 = 个顶点的树必然同构于 天:.。-: 。

- 带有7个项点的树的顶点的度之和是什么?

假定心，心，…，d 是和为 2一2 的个正整数。证明: 存在一个带有z 个顶点的树，使得这些顶点的度
为几， de，…，d。

证明， 每个树都是可平面图。

证明: 每个树都是偶图。

证明， 每个森林都可以用两种颜色来着色。

-天上度日树是一个根树，它的所有树叶都是在同一层上，它的根具有至少两个和至多大个子女，除非根

就是树叶，并且除根外的每个内点有至少[&/23]个、但不超过&个子女。当用 吕树来表示计算机文件

时，就可以有效地访问这些文件。



--- 第 369 页 ---
第7章 树。351

10. 画出三种不同的高度为4的3度召树。
*11. 给出高度为产的上度妃树里树叶数的上界和下界。
*12. 给出有mm 个树叶的大度召树的高度的上界和下界。

二项式树 Bi(i一0，1，2，…)是如下递归定义的有序根树。
基础步骤: 二项式树 Bo 是具有单个顶点的树 。
递归步骤: 设上是非负整数。为了构造二项式树 Bt-:，把 B, 的一个副本加入 B, 的第二个副本， 方法是
加入一条边，这条边让 Bk 的第一个副本的根成为 Bi 的第二个副本的最左子女。
13. 对&一0，1，2，3，4，夯出 如 。
14. 8 有多少个项点? 证明你的答案是正确的。
15. 求 B, 的高度。证明你的答案是正确的。
16，B, 在深度/ 有多少个顶点? 其中 0过/<上。证明你的答案是正确的。
17.， Bu 的根的度数是多少? 证明你的答案是正确的。
18. 证明: B 中度数最大的顶点是根。

若根树 工满足下面的递归定义，则称它为 S, 树。若它只有一个顶点，则它是 S。 树。对 上>0来说，若通
过把一个 St-:树的根作为一个新树的根，把另外一个 S,-,树的根作为新树的根的子女，从两个 S'_,树来建
立一个新树，  则这个新树是 SS 树。

19. 对4一0，1，2，3，4，画出一个 S, 树。
20. 证明: Se 树有 2* 个顶点并且在& 层上有唯一一个顶点。在大层上的这个顶点称为把柄。

#21. 假定 工是带有把柄的S 树 。 证明 : 工可以从不相交的树 To，Ti，…， T-:来这样获得， 其中 7不在
这些树的任何一个里， 对:一0， 1，…， 类一1 来说， 刀 是 S， 树; 对;一0， 1，…w，A上一2， 连接到 w 并
且连接关到ri+i。

有序根树在层顺序下的项点列表从根开始，接着是从左到右在 1 层上的顶点，从左到右在 2 层上的顶点，
依此类推。

22. 列出 7. 3 节图 7-27 和图 7-33 里的有序根树在层顺序下的顶点列表。
23, 设计列出有序根树在层顺序下的顶点列表的算法 。

*24. 设计一种算法，确定一组通用地址能否成为根树的树叶地址。

25. 设计从树叶的通用地址来构造根树的算法 。

图的齐集是这样一些边的集合，使得删除这些边就产生一个子图，这个子图的连通分支比诛来的图要多，
但是这些边的任何真子集都没有这个性质。
26. 证明: 图的割集必然与这个图的任何生成树都有至少一条公共边。

仙人掌图是连通图，其中没有边是在多于一条的简单回路上，这些简单回路不经过除了起点以外的任何
顶点超过一次，而且不在除了终点以外的其他地方经过起点(其中不认为由相同的边所组成的两个回路是不
同的) 。
27. 下面的图哪些是仙人掌图?

a)                 b)                         c)

28. 树是否必然是仙人人掌图?



--- 第 370 页 ---
352，第7音 树

29. 证明:, 若在树里添加一条回路，它包含一些起止于树里顶点上的新边，则形成一个仙人人掌图。
*30. 证明: 若在连通图里，每条不经过任何顶点(除起点以外)超过一次的回路都包含奇数条边，则这个图必
然是仙人掌图。

简单图 C 的限制度数生成树具有下面性质，在这个树里顶点的度不能超过某个规定的界限。在运输系统
的模型里，在交叉路口处的道路数目是有限的，在通信网络的模型里，进入一个结点的连接数目是有限的，
这种模型都可以使用限制度数生成树 。

在练习 31一33 里，求所给的图的限制度数生成树，其中每个顶点的度都小于或等于3，或者证明不存在

这样的生成树 。
31.                            32.       记     ，           33， 4      放      c

IN
SC               |

34, 证明: 简单图的限制度数生成树(其中每个顶点的度都不超过 2)是由该图里的单独一条哈密顿回路所组
成的。

35. 若可以用整数 1，2，…，?来标记带有n 个顶点的树的顶点，使得相邻顶点的标记之差的绝对值全都是
不同的，则称这棵树为优美的。证明: 下面的树都是优美的。

毛虫图是含有一条简单通路的树 ，使得不包含在这条通路里的每个顶点都与这条通路里的一个顶点相邻。
36. 练习 35 里的图，哪些是毛虫图?
37. 带 6 个顶点的互不同构的毛虫图有多少种?
**38，a)证明或反驳: 其边形成一条简单通路的所有树都是优美的。
b)证明或反驳: 所有的毛虫图都是优美的。
39, 假设在一个很长的位串中，位 0 出现的频率是 0.9，位 1 出现的频率是 0.1，并且位都是独立地出现的。
a)为4个两位的块00、01、10 和 11 构造幸夫电编码。用这个编码来编码一个位串，所需要的平均位数是
多少?
b)为 8 个三位的块构造幸夫曼编码。用这个编码来编码--个位串，所需要的平均位数是多少?
40. 假设 CG 是没有回路的有向图。描述如何用深度优先搜索来完成 G 的顶点的拓扑排序。
*41. 假定e是带权图里与顶点 v 关联的一条边，使得 e 的权不超过与顶点 v 关联的任何其他边的权。证明，存
在一棵包含这条边的最小生成树。
三对夫妇到达一条河流的岸边。每个妻子都容易嫉妒，当她的丈夫与其他的妻子(或其他人)在一起、但
是她不在场时，她就不信任她的丈夫。六个人如何用一条只能装载不超过两个人的船来渡河，使得每位
丈夫无法与妻子之外的女人单独相处? 解答时使用图论模型。
*43, 证明: 若在带权图里没有两条边具有相同的权，则在每个最小生成树里都包含着与顶点 uv关联的权最小
的边。
44. 求下面两个图的最小生成树，其中在生成树里每个顶点的度都不超过 2。
a)            b)           5

 

了                           7       上

了

>

42.

fo

  



--- 第 371 页 ---
第7章 树。353

计算机题目
按下述给定的输入与输出写出程序。

站

- 给定无向简单图的相邻矩阵，确定这个图是不是树 。

. 给定根树的相邻矩阵和这棵树里的一个项点，求出这个顶点的父母、子女、祖先、后代和层数。
' 给定根树的边的列表和这棵树里的一个项点 求出这个项点的父母、子女、祖先、后代和层数。
- 给定项的列表，构造包含这些项的二又搜索树 。

: 给定二又搜索树和一个项，在这个二叉搜索树里求出这个项的位置或添加这个项。

: 给定有序根树的边的有序列表，求出它的边的通用地址。

. 给定有序根树的边的有序列表，以前序、中序和后序列出它的顶点。

 给定前缀形式的算术表达式，求它的值。

. 给定后绷形式的算术表达式，求它的值。

: 给定一组符号的频率，用赫夫甸编码来求这些符号的最优编码。

. 给定轮流取石头游戏的开局，确定第一个选手的最优策略。

: 给定连通无向简单图的相邻矩阵，用深度优先搜索找出这个图的生成树。

. 给定连通无向简单图的相邻矩阵.用宽度优先搜索找出这个图的生成树。

' 给定一组正整数和一个正整数 N，利用回潮求这些整数的其和为 N 的子集合。

: 给定无向简单图的相邻矩阵，若有可能，则利用回潮来用三种颜色为这个图着色 。

: 给定一个正整数 ”，利用回潮来解决皇后问题。

: 给定带权无向连通图的边的列表和它们的权，用普林算法求这个图的最小生成树。

, 给定带权无向连通图的边的列表和它们的权，用克鲁斯卡尔算法求这个图的最小生成树。

计算和研究
利用计算程序或你所编写的程序来做下面的练习。

1.
2.
%3。
和4
5.

#7.
8，

显示所有的带有 6 个顶点的树 。

显示全部的互不同构的带有 ?7 个顶点的树。

根据 ASCI 码字符在典型输入中出现的频率， 构造它们的赫夫曼编码。

对nm=1，2，3，4，5，6，计算 K。 的不同的生成树的个数。猜想它们的公式。

对于 "一100， "一1000 和 "一10 000 来说，比较一下排序 ”个元素的表所需要的比较次数，其中元素都是
随机选择的正整数，使用选择排序、插人排序、归并排序和快速排序。

: 对于不超过 10 的所有正整数来说，计算一下在 xzXz 棋盘上放置 个皇后，使得这些皇后不能互相攻击

的不同方式数。
求把美国 50 个州的首府互相连接起来的图的最小生成树，其中每条边上的权是首府之间的距离 。
画出4X4 棋盘上跳棋游戏的完全博弈树 。

写作题目
利用本书以外的资料，就下列问题写出短文。

1.
2.
3.

iD 0 D门中 轴 卢

解释凯莱如何用树来枚举特定类型的碳水化合物的个数。

定义AVL 树(有时也称为均高树) 。解释如何以及为什么在许多不同的算法中都用到 AVL 树。

定义四又树并解释如何用四叉树来表示图像。描述如何通过操纵对应的四又树来旋转、缩放和转换
图像 。

- 定义一个堆，并解释如何把树转化成堆。堆为什么在排序中有用?

- 描述一下针对连续读人字符时字母频率发生变化的数据压缩的动态规划算法，比如自适应赫夫曼编码。
' 解释如何用 e一8草枝来简化对博弈树的值的计算 。

- 描述下棋程序(比如深蓝)所使用的技术。

- 为树网这种类型的图下定义。解释一下这种图如何用在非常大的系统集成和并行计算中。

- 讨论在 IP 组播中避免路由器之间回路所用的算法。



--- 第 372 页 ---
354。第7章 树

10.
. 描述基于深度优先搜索来求有向图的强连通分支的算法 。
12.
13.
14.
15.
16.

11

描述基于深度优先搜索来求图的节点的算法。

描述在 Web 上不同搜索引擎的网络疏虫和网络蜘蛛所用的搜索技术 。

描述一下求图的最小生成树的算法，使得生成树上任意项点的最大度数不超过一个固定的常数&。
就复杂度和应用场合而言，对一些最重要的排序算法进行比较。

讨论一下构造最小生成树的算法的历史和起源。

描述产生随机树的算法 。

